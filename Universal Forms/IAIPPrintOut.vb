Imports Oracle.DataAccess.Client

Imports CrystalDecisions.Shared
Imports CrystalDecisions.CrystalReports.Engine

Public Class IAIPPrintOut
    Dim SQL As String
    Dim cmd As oraclecommand
    Dim dr As OracleDataReader
    Dim recExist As Boolean
    Dim ConfidentialData As String = "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    Dim ReportType As String
    Dim WitnessingEngineer As String
    Dim WitnessingEngineer2 As String
    Dim Result As DialogResult
    Dim ds As DataSet
    Dim da As OracleDataAdapter
    Dim da2 As OracleDataAdapter
    Dim j As Integer
    Dim k As Integer
    Dim l As Integer

    Private Sub IAIPPrintOut_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        monitor.TrackFeature("Forms." & Me.Name)

        Try

            LoadCorrectReport()
        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
#Region "Page Load Functions"
    Private Sub LoadCorrectReport()
        Dim SQL As String = ""
        Dim temp As String = ""
        Dim da As OracleDataAdapter
        Dim ds As New dsIAIP10
        Dim rpt As New ReportClass

        Try
             

            If txtPrintType.Text = "Letter" Or txtPrintType.Text = "BasicFacilityReport" Then 'Or _
                'txtPrintType.Text = "FullFacilityReport" Then

                rpt = New crAPBPrintOut2
                monitor.TrackFeature("Report." & rpt.ResourceName)

                Dim Commissioner As String = ""
                Dim Director As String = ""
                Dim PermitCount As String = "0"
                Dim MonitoringCount As String = "0"
                Dim EnforcementCount As String = "0"
                Dim FCECount As String = "0"
                Dim ComplianceCount As String = "0"

                Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
                Dim ParameterField As CrystalDecisions.Shared.ParameterField
                Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

                'Do this just once at the start
                ParameterFields = New CrystalDecisions.Shared.ParameterFields

                SQL = "Select " & _
                "strManagementName from " & _
                "" & DBNameSpace & ".LookUpAPBManagementType " & _
                "where strCurrentContact = '1' " & _
                "and strKey = '1' "

                cmd = New OracleCommand(SQL, Conn)
                If Conn.State = ConnectionState.Closed Then
                    Conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    If IsDBNull(dr.Item("strManagementName")) Then
                        Director = ""
                    Else
                        Director = dr.Item("strManagementName")
                    End If
                End While
                dr.Close()

                SQL = "Select " & _
                "strManagementName from " & _
                "" & DBNameSpace & ".LookUpAPBManagementType " & _
                "where strCurrentContact = '1' " & _
                "and strKey = '2' "

                cmd = New OracleCommand(SQL, Conn)
                If Conn.State = ConnectionState.Closed Then
                    Conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    If IsDBNull(dr.Item("strManagementName")) Then
                        Commissioner = ""
                    Else
                        Commissioner = dr.Item("strManagementName")
                    End If
                End While
                dr.Close()

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = Director
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = Commissioner
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                Select Case txtPrintType.Text
                    Case "Letter"
                        Select Case txtOther.Text
                            Case "SSPP Confirm"
                                SQL = "Select * " & _
                                "from " & DBNameSpace & ".VW_SSPP_Acknowledge " & _
                                "where strApplicationNumber = '" & txtAIRSNumber.Text & "' "

                                da = New OracleDataAdapter(SQL, Conn)
                                If Conn.State = ConnectionState.Closed Then
                                    Conn.Open()
                                End If
                                ds.EnforceConstraints = False
                                da.Fill(ds, "VW_SSPP_Acknowledge")

                                'Do this at the beginning of every new entry 
                                ParameterField = New CrystalDecisions.Shared.ParameterField
                                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                                ParameterField.ParameterFieldName = "ReportType"
                                spValue.Value = txtOther.Text
                                ParameterField.CurrentValues.Add(spValue)
                                ParameterFields.Add(ParameterField)
                            Case Else
                        End Select
                    Case "BasicFacilityReport"
                        'Do this at the beginning of every new entry 
                        ParameterField = New CrystalDecisions.Shared.ParameterField
                        spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                        ParameterField.ParameterFieldName = "ReportType"
                        spValue.Value = "Basic Report"
                        ParameterField.CurrentValues.Add(spValue)
                        ParameterFields.Add(ParameterField)

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".VW_APBFacilityLocation " & _
                        "where " & DBNameSpace & ".VW_APBFacilityLocation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_APBFacilityLocation")

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".VW_APBFacilityHeader " & _
                        "where " & DBNameSpace & ".VW_APBFacilityHeader.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_APBFacilityHeader")
                    Case "FullFacilityReport"
                        ' This branch should never get hit (?)
                        'Do this at the beginning of every new entry 
                        ParameterField = New CrystalDecisions.Shared.ParameterField
                        spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                        ParameterField.ParameterFieldName = "ReportType"
                        spValue.Value = "Full Report"
                        ParameterField.CurrentValues.Add(spValue)
                        ParameterFields.Add(ParameterField)

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".VW_APBFacilityLocation " & _
                        "where " & DBNameSpace & ".VW_APBFacilityLocation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_APBFacilityLocation")

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".VW_APBFacilityHeader " & _
                        "where " & DBNameSpace & ".VW_APBFacilityHeader.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_APBFacilityHeader")

                        SQL = "select " & _
                        "* " & _
                        "From " & DBNameSpace & ".VW_AIR_PROGRAM_POLLUTANTS " & _
                        "where " & DBNameSpace & ".VW_AIR_PROGRAM_POLLUTANTS.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "order by aircode desc "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_AIR_PROGRAM_POLLUTANTS")

                        SQL = "select " & _
                        "* " & _
                        "From " & DBNameSpace & ".APBContactInformation " & _
                        "where " & DBNameSpace & ".APBContactInformation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "APBContactInformation")

                        SQL = "select " & _
                        "* " & _
                        "From " & DBNameSpace & ".VW_Report_OLAPUSERS " & _
                        "where " & DBNameSpace & ".VW_Report_OLAPUSERS.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_Report_OLAPUSERS")

                        SQL = "select " & _
                        "* " & _
                        "From " & DBNameSpace & ".VW_REPORT_STATECONTACTS " & _
                        "where " & DBNameSpace & ".VW_REPORT_STATECONTACTS.SSPPAIRS = '0413" & txtAIRSNumber.Text & "' "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_REPORT_STATECONTACTS")

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".APBContactInformation " & _
                        "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "order by substr(strKey,1,1) desc, substr(strKey, 2,1) desc  "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "APBContactInformation")

                        'SQL = "select " & _
                        '"* " & _
                        '"from " & DBNameSpace & ".VW_Report_SSPP " & _
                        '"where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        '"or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc "

                        SQL = "select " & _
                        "* " & _
                        "from " & DBNameSpace & ".VW_Report_SSPP " & _
                        "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                            "(datFinalizedDate is null or datFinalizedDate >= '" & txtEndDate.Text & "'))) " & _
                        "order by datReceivedDate desc "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_Report_SSPP")

                        'SQL = "select " & _
                        '"count(*) as PermitCount " & _
                        '"from " & DBNameSpace & ".VW_Report_SSPP " & _
                        '"where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        '"or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc "

                        SQL = "select " & _
                        "count(*) as PermitCount " & _
                        "from " & DBNameSpace & ".VW_Report_SSPP " & _
                        "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                        "(datFinalizedDate is null or datFinalizedDate >= '" & txtEndDate.Text & "'))) " & _
                        "order by datReceivedDate desc "

                        cmd = New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("PermitCount")) Then
                                PermitCount = "0"
                            Else
                                PermitCount = dr.Item("PermitCount")
                            End If
                        End While
                        dr.Close()

                        'SQL = "select * from " & _
                        '"" & DBNameSpace & ".VW_REPORT_ISMP " & _
                        '"where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc, strReferenceNumber desc  "

                        SQL = "select * from " & _
                        "" & DBNameSpace & ".VW_REPORT_ISMP " & _
                        "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                        "(datCompleteDate is null or datCompleteDate >= '" & txtEndDate.Text & "' ))) " & _
                        "order by datReceivedDate desc, strReferenceNumber desc  "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_REPORT_ISMP")

                        'SQL = "select count(*) as MonitoringCount " & _
                        '"from " & DBNameSpace & ".VW_REPORT_ISMP " & _
                        '"where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc, strReferenceNumber desc  "

                        SQL = "select count(*) as MonitoringCount " & _
                        "from " & DBNameSpace & ".VW_REPORT_ISMP " & _
                        "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                        "(datCompleteDate is null or datCompleteDate >= '" & txtEndDate.Text & "' ))) " & _
                        "order by datReceivedDate desc, strReferenceNumber desc  "

                        cmd = New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("MonitoringCount")) Then
                                MonitoringCount = "0"
                            Else
                                MonitoringCount = dr.Item("MonitoringCount")
                            End If
                        End While
                        dr.Close()

                        SQL = "Select * " & _
                        "From " & DBNameSpace & ".VW_REPORT_Enforcement " & _
                        "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and ((datDiscoveryDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datDayZero between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datEnforcementFinalized between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datDiscoveryDate <= '" & txtStartDate.Text & "' and " & _
                        "(datEnforcementFinalized is null or datEnforcementFinalized >= '" & txtEndDate.Text & "')) " & _
                        "or (datDayZero <= '" & txtStartDate.Text & "' and " & _
                        "(datEnforcementFinalized is null or datEnforcementFinalized >= '" & txtEndDate.Text & "'))) " & _
                        "order by datDiscoveryDate desc "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_REPORT_Enforcement")

                        'SQL = "Select count(*) as EnforcementCount " & _
                        '"From " & DBNameSpace & ".VW_REPORT_Enforcement " & _
                        '"where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and ((datDiscoveryDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"or (datDayZero between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"or (datEnforcementFinalized between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "')) " & _
                        '"order by datDiscoveryDate desc "

                        SQL = "Select count(*) as EnforcementCount " & _
                        "From " & DBNameSpace & ".VW_REPORT_Enforcement " & _
                        "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and ((datDiscoveryDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datDayZero between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datEnforcementFinalized between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        "or (datDiscoveryDate <= '" & txtStartDate.Text & "' and " & _
                        "(datEnforcementFinalized is null or datEnforcementFinalized >= '" & txtEndDate.Text & "')) " & _
                        "or (datDayZero <= '" & txtStartDate.Text & "' and " & _
                        "(datEnforcementFinalized is null or datEnforcementFinalized >= '" & txtEndDate.Text & "'))) " & _
                        "order by datDiscoveryDate desc "

                        cmd = New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("EnforcementCount")) Then
                                EnforcementCount = "0"
                            Else
                                EnforcementCount = dr.Item("EnforcementCount")
                            End If
                        End While
                        dr.Close()

                        SQL = "Select * " & _
                        "From " & DBNameSpace & ".VW_REPORT_SSCP_FCE " & _
                        "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and strFCEYear between '" & CDate(txtStartDate.Text).Year.ToString & "' and '" & CDate(txtEndDate.Text).Year.ToString & "' " & _
                        "order by strFCEYear desc "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_REPORT_SSCP_FCE")

                        SQL = "Select count(*) as FCECount " & _
                       "From " & DBNameSpace & ".VW_REPORT_SSCP_FCE " & _
                       "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                       "and strFCEYear between '" & CDate(txtStartDate.Text).Year.ToString & "' and '" & CDate(txtEndDate.Text).Year.ToString & "' " & _
                       "order by strFCEYear desc "

                        cmd = New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("FCECount")) Then
                                FCECount = "0"
                            Else
                                FCECount = dr.Item("FCECount")
                            End If
                        End While
                        dr.Close()

                        'SQL = "Select * " & _
                        '"From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                        '"where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        '"or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc "

                        SQL = "Select * " & _
                        "From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                        "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                        "(datCompleteDate is null or datCompleteDate >= '" & txtEndDate.Text & "'))) " & _
                        "order by datReceivedDate desc "

                        da = New OracleDataAdapter(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        ds.EnforceConstraints = False
                        da.Fill(ds, "VW_REPORT_SSCP_EVENT")

                        'SQL = "Select count(*) as ComplianceCount " & _
                        '"From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                        '"where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        '"and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        '"or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                        '"order by datReceivedDate desc "

                        SQL = "Select count(*) as ComplianceCount " & _
                        "From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                        "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                        "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                        "or (datReceivedDate <= '" & txtStartDate.Text & "' and " & _
                        "(datCompleteDate is null or datCompleteDate >= '" & txtEndDate.Text & "'))) " & _
                        "order by datReceivedDate desc "

                        cmd = New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("ComplianceCount")) Then
                                ComplianceCount = "0"
                            Else
                                ComplianceCount = dr.Item("ComplianceCount")
                            End If
                        End While
                        dr.Close()

                    Case Else

                End Select

                rpt.SetDataSource(ds)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields
                CRViewer.ReportSource = rpt
                CRViewer.Refresh()

                Exit Sub
            End If

            Select Case txtPrintType.Text
                Case "ISMPTestReport"
                    If txtReferenceNumber.Text <> "" Then
                        SQL = "select " & DBNameSpace & ".ISMPDocumentType.strDocumentType " & _
                         "from " & DBNameSpace & ".ISMPDocumentType, " & DBNameSpace & ".ISMPReportInformation " & _
                         "where " & DBNameSpace & ".ISMPReportInformation.strDocumentType = " & DBNameSpace & ".ISMPDocumentType.strKey and " & _
                         "strReferenceNumber = '" & txtReferenceNumber.Text & "'"
                        Dim cmd As New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        Dim dr As OracleDataReader = cmd.ExecuteReader
                        Dim recExist As Boolean = dr.Read
                        If recExist = True Then
                            temp = dr.Item("strDocumentType")
                        End If

                        Select Case temp
                            Case "Unassigned"
                            Case "One Stack (Two Runs)"
                                LoadOneStackTwoRun()
                            Case "One Stack (Three Runs)"
                                LoadOneStackThreeRun()
                            Case "One Stack (Four Runs)"
                                LoadOneStackFourRun()
                            Case "Two Stack (Standard)"
                                LoadTwoStackStandard()
                            Case "Two Stack (DRE)"
                                LoadTwoStackDRE()
                            Case "Loading Rack"
                                LoadLoadingRack()
                            Case "Pond Treatment"
                                LoadPondTreatment()
                            Case "Gas Concentration"
                                LoadGasConcentration()
                            Case "Flare"
                                LoadFlare()
                            Case "Rata"
                                LoadRata()
                            Case "Memorandum (Standard)"
                                LoadMemorandumStandard()
                            Case "Memorandum (To File)"
                                LoadMemorandumToFile()
                            Case "Method 9 (Multi.)"
                                LoadMethod9Multi()
                            Case "Method 22"
                                LoadMethod22()
                            Case "Method9 (Single)"
                                LoadMethod9Single()
                            Case "PEMS"
                                LoadPEMS()
                            Case "PTE (Perminate Total Enclosure)"
                                LoadPTE()
                            Case Else
                                MsgBox("Unable to Print at this time.")
                                Me.Close()
                        End Select
                    Else
                        MsgBox("Unable to Print at this time.")
                        Me.Close()
                    End If
                Case "SSPPCDS"

                Case "SSCP"
                    If txtReferenceNumber.Text <> "" Then
                        SQL = "select " & DBNameSpace & ".ISMPDocumentType.strDocumentType " & _
                         "from " & DBNameSpace & ".ISMPDocumentType, " & DBNameSpace & ".ISMPReportInformation " & _
                         "where " & DBNameSpace & ".ISMPReportInformation.strDocumentType = " & DBNameSpace & ".ISMPDocumentType.strKey and " & _
                         "strReferenceNumber = '" & txtReferenceNumber.Text & "'"
                        Dim cmd As New OracleCommand(SQL, Conn)
                        If Conn.State = ConnectionState.Closed Then
                            Conn.Open()
                        End If
                        Dim dr As OracleDataReader = cmd.ExecuteReader
                        Dim recExist As Boolean = dr.Read
                        If recExist = True Then
                            temp = dr.Item("strDocumentType")
                        End If

                        Select Case temp
                            Case "Unassigned"
                            Case "One Stack (Two Runs)"
                                LoadOneStackTwoRun()
                            Case "One Stack (Three Runs)"
                                LoadOneStackThreeRun()
                            Case "One Stack (Four Runs)"
                                LoadOneStackFourRun()
                            Case "Two Stack (Standard)"
                                LoadTwoStackStandard()
                            Case "Two Stack (DRE)"
                                LoadTwoStackDRE()
                            Case "Loading Rack"
                                LoadLoadingRack()
                            Case "Pond Treatment"
                                LoadPondTreatment()
                            Case "Gas Concentration"
                                LoadGasConcentration()
                            Case "Flare"
                                LoadFlare()
                            Case "Rata"
                                LoadRata()
                            Case "Memorandum (Standard)"
                                LoadMemorandumStandard()
                            Case "Memorandum (To File)"
                                LoadMemorandumToFile()
                            Case "Method 9 (Multi.)"
                                LoadMethod9Multi()
                            Case "Method 22"
                                LoadMethod22()
                            Case "Method9 (Single)"
                                LoadMethod9Single()
                            Case "PEMS"
                                LoadPEMS()
                            Case "PTE (Perminate Total Enclosure)"
                                LoadPTE()
                            Case Else
                                MsgBox("Unable to Print at this time.")
                                Me.Close()
                        End Select
                    Else
                        MsgBox("Unable to Print at this time.")
                        Me.Close()
                    End If
                Case "SSCPFCE"
                    'If txtOther.Text <> "" Then
                    'LoadSSCPFCEReport()
                    'Else
                    MsgBox("Unable to Print at this time.", MsgBoxStyle.Information, "Print Out Form")
                    'End If
                Case "TitleVRenewal"
                    PrintOutTitleVRenewals()
                Case "ESPrintOut"
                    rpt = New crESinfoByAirsNumber
                    monitor.TrackFeature("Report." & rpt.ResourceName)

                    SQL = "Select * from " & DBNameSpace & ".ESSchema " & _
                    "where strConfirmationNbr = '" & txtOther.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "ESSchema")
                    rpt.SetDataSource(ds)

                    CRViewer.ReportSource = rpt
                Case "ES Print Out"
                    rpt = New crESDataViewer
                    monitor.TrackFeature("Report." & rpt.ResourceName)

                    SQL = "Select * from " & DBNameSpace & ".ESSchema " & _
                    "where strConfirmationNbr = '" & txtSQLLine.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "ESSchema")
                    rpt.SetDataSource(ds)

                    CRViewer.ReportSource = rpt
                Case "OrgChart"
                    OpenOrgChart()
                Case "PhoneList"
                    OpenPhoneList()
                    'Case "BasicFacilityReport"
                    '    rpt = New CRBasicPrint

                    '    SQL = "select " & _
                    '    "strDirector, strCommissioner " & _
                    '    "from " & DBNameSpace & ".LookUpAPBManagement "

                    '    da = New OracleDataAdapter(SQL, Conn)
                    '    If Conn.State = ConnectionState.Closed Then
                    '        Conn.Open()
                    '    End If
                    '    ds.EnforceConstraints = False
                    '    da.Fill(ds, "LookUpAPBManagement")

                    '    SQL = "select " & _
                    '    "* " & _
                    '    "from " & DBNameSpace & ".VW_APBFacilityLocation " & _
                    '    "where " & DBNameSpace & ".VW_APBFacilityLocation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    '    da = New OracleDataAdapter(SQL, Conn)
                    '    If Conn.State = ConnectionState.Closed Then
                    '        Conn.Open()
                    '    End If
                    '    ds.EnforceConstraints = False
                    '    da.Fill(ds, "VW_APBFacilityLocation")

                    '    SQL = "select " & _
                    '    "* " & _
                    '    "from " & DBNameSpace & ".VW_APBFacilityHeader " & _
                    '    "where " & DBNameSpace & ".VW_APBFacilityHeader.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    '    da = New OracleDataAdapter(SQL, Conn)
                    '    If Conn.State = ConnectionState.Closed Then
                    '        Conn.Open()
                    '    End If
                    '    ds.EnforceConstraints = False
                    '    da.Fill(ds, "VW_APBFacilityHeader")

                    '    rpt.SetDataSource(ds)

                    '    CRViewer.ReportSource = rpt
                    '    CRViewer.Refresh()
                Case "FullFacilityReport"
                    rpt = New CRFullPrint
                    monitor.TrackFeature("Report." & rpt.ResourceName)

                    Dim PermitCount As String = "0"
                    Dim MonitoringCount As String = "0"
                    Dim EnforcementCount As String = "0"
                    Dim FCECount As String = "0"
                    Dim ComplianceCount As String = "0"

                    Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
                    Dim ParameterField As CrystalDecisions.Shared.ParameterField
                    Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

                    'Do this just once at the start
                    ParameterFields = New CrystalDecisions.Shared.ParameterFields

                    SQL = "select " & _
                    "strDirector, strCommissioner " & _
                    "from " & DBNameSpace & ".LookUpAPBManagement "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "LookUpAPBManagement")

                    SQL = "select " & _
                    "* " & _
                    "from " & DBNameSpace & ".VW_APBFacilityLocation " & _
                    "where " & DBNameSpace & ".VW_APBFacilityLocation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_APBFacilityLocation")

                    SQL = "select " & _
                    "* " & _
                    "from " & DBNameSpace & ".VW_APBFacilityHeader " & _
                    "where " & DBNameSpace & ".VW_APBFacilityHeader.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_APBFacilityHeader")

                    SQL = "select " & _
                    "* " & _
                    "From " & DBNameSpace & ".VW_AIR_PROGRAM_POLLUTANTS " & _
                    "where " & DBNameSpace & ".VW_AIR_PROGRAM_POLLUTANTS.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "order by aircode desc "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_AIR_PROGRAM_POLLUTANTS")

                    SQL = "select " & _
                    "* " & _
                    "From " & DBNameSpace & ".APBContactInformation " & _
                    "where " & DBNameSpace & ".APBContactInformation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "APBContactInformation")

                    SQL = "select " & _
                    "* " & _
                    "From " & DBNameSpace & ".VW_Report_OLAPUSERS " & _
                    "where " & DBNameSpace & ".VW_Report_OLAPUSERS.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_Report_OLAPUSERS")

                    SQL = "select " & _
                    "* " & _
                    "From " & DBNameSpace & ".VW_REPORT_STATECONTACTS " & _
                    "where " & DBNameSpace & ".VW_REPORT_STATECONTACTS.SSPPAIRS = '0413" & txtAIRSNumber.Text & "' "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_REPORT_STATECONTACTS")

                    SQL = "select " & _
                    "* " & _
                    "from " & DBNameSpace & ".APBContactInformation " & _
                    "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "order by substr(strKey,1,1) desc, substr(strKey, 2,1) desc  "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "APBContactInformation")

                    SQL = "select " & _
                    "* " & _
                    "from " & DBNameSpace & ".VW_Report_SSPP " & _
                    "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                    "or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_Report_SSPP")

                    SQL = "select " & _
                    "count(*) as PermitCount " & _
                    "from " & DBNameSpace & ".VW_Report_SSPP " & _
                    "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datFinalizedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                    "or datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("PermitCount")) Then
                            PermitCount = "0"
                        Else
                            PermitCount = dr.Item("PermitCount")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "PermitCount"
                    spValue.Value = PermitCount
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    SQL = "select * from " & _
                    "" & DBNameSpace & ".VW_REPORT_ISMP " & _
                    "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc, strReferenceNumber desc  "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_REPORT_ISMP")

                    SQL = "select count(*) as MonitoringCount " & _
                    "from " & DBNameSpace & ".VW_REPORT_ISMP " & _
                    "where strAIRSnumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc, strReferenceNumber desc  "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("MonitoringCount")) Then
                            MonitoringCount = "0"
                        Else
                            MonitoringCount = dr.Item("MonitoringCount")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "MonitoringCount"
                    spValue.Value = MonitoringCount
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    SQL = "Select * " & _
                    "From " & DBNameSpace & ".VW_REPORT_Enforcement " & _
                    "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and ((datDiscoveryDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "or (datDayZero between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "or (datEnforcementFinalized between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "')) " & _
                    "order by datDiscoveryDate desc "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_REPORT_Enforcement")

                    SQL = "Select count(*) as EnforcementCount " & _
                    "From " & DBNameSpace & ".VW_REPORT_Enforcement " & _
                    "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and ((datDiscoveryDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "or (datDayZero between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "or (datEnforcementFinalized between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "')) " & _
                    "order by datDiscoveryDate desc "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("EnforcementCount")) Then
                            EnforcementCount = "0"
                        Else
                            EnforcementCount = dr.Item("EnforcementCount")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "EnforcementCount"
                    spValue.Value = EnforcementCount
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    SQL = "Select * " & _
                    "From " & DBNameSpace & ".VW_REPORT_SSCP_FCE " & _
                    "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and strFCEYear between '" & CDate(txtStartDate.Text).Year.ToString & "' and '" & CDate(txtEndDate.Text).Year.ToString & "' " & _
                    "order by strFCEYear desc "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_REPORT_SSCP_FCE")


                    SQL = "Select count(*) as FCECount " & _
                   "From " & DBNameSpace & ".VW_REPORT_SSCP_FCE " & _
                   "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                   "and strFCEYear between '" & CDate(txtStartDate.Text).Year.ToString & "' and '" & CDate(txtEndDate.Text).Year.ToString & "' " & _
                   "order by strFCEYear desc "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("FCECount")) Then
                            FCECount = "0"
                        Else
                            FCECount = dr.Item("FCECount")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "FCECount"
                    spValue.Value = FCECount
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    SQL = "Select * " & _
                    "From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                    "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                    "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc "

                    da = New OracleDataAdapter(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    ds.EnforceConstraints = False
                    da.Fill(ds, "VW_REPORT_SSCP_EVENT")

                    SQL = "Select count(*) as ComplianceCount " & _
                    "From " & DBNameSpace & ".VW_REPORT_SSCP_EVENT " & _
                    "where strAIRSNumber = '0413" & txtAIRSNumber.Text & "' " & _
                    "and (datReceivedDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "' " & _
                    "or datCompleteDate between '" & txtStartDate.Text & "' and '" & txtEndDate.Text & "') " & _
                    "order by datReceivedDate desc "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("ComplianceCount")) Then
                            ComplianceCount = "0"
                        Else
                            ComplianceCount = dr.Item("ComplianceCount")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "ComplianceCount"
                    spValue.Value = ComplianceCount
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    rpt.SetDataSource(ds)
                    'Load Variables into the Fields
                    CRViewer.ParameterFieldInfo = ParameterFields

                    CRViewer.ReportSource = rpt
                    CRViewer.Refresh()

                Case "Letter"
                    rpt = New crAPBPrintOut2
                    monitor.TrackFeature("Report." & rpt.ResourceName)

                    Dim Commissioner As String = ""
                    Dim Director As String = ""

                    Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
                    Dim ParameterField As CrystalDecisions.Shared.ParameterField
                    Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

                    'Do this just once at the start
                    ParameterFields = New CrystalDecisions.Shared.ParameterFields

                    SQL = "Select " & _
                    "strManagementName from " & _
                    "" & DBNameSpace & ".LookUpAPBManagementType " & _
                    "where strCurrentContact = '1' " & _
                    "and strKey = '1' "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strManagementName")) Then
                            Director = ""
                        Else
                            Director = dr.Item("strManagementName")
                        End If
                    End While
                    dr.Close()

                    SQL = "Select " & _
                    "strManagementName from " & _
                    "" & DBNameSpace & ".LookUpAPBManagementType " & _
                    "where strCurrentContact = '1' " & _
                    "and strKey = '2' "

                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strManagementName")) Then
                            Commissioner = ""
                        Else
                            Commissioner = dr.Item("strManagementName")
                        End If
                    End While
                    dr.Close()

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "Director"
                    spValue.Value = Director
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "Commissioner"
                    spValue.Value = Commissioner
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    Select Case txtOther.Text
                        Case "SSPP Confirm"
                            SQL = "Select * " & _
                            "from " & DBNameSpace & ".VW_SSPP_Acknowledge " & _
                            "where strApplicationNumber = '" & txtAIRSNumber.Text & "' "

                            da = New OracleDataAdapter(SQL, Conn)
                            If Conn.State = ConnectionState.Closed Then
                                Conn.Open()
                            End If
                            ds.EnforceConstraints = False
                            da.Fill(ds, "VW_SSPP_Acknowledge")

                            'Do this at the beginning of every new entry 
                            ParameterField = New CrystalDecisions.Shared.ParameterField
                            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                            ParameterField.ParameterFieldName = "ReportType"
                            spValue.Value = txtOther.Text
                            ParameterField.CurrentValues.Add(spValue)
                            ParameterFields.Add(ParameterField)


                        Case "BasicFacilityReport"
                            ' This branch should never get hit (?)
                            rpt = New CRBasicPrint
                            monitor.TrackFeature("Report." & rpt.ResourceName)

                            SQL = "select " & _
                            "strDirector, strCommissioner " & _
                            "from " & DBNameSpace & ".LookUpAPBManagement "

                            da = New OracleDataAdapter(SQL, Conn)
                            If Conn.State = ConnectionState.Closed Then
                                Conn.Open()
                            End If
                            ds.EnforceConstraints = False
                            da.Fill(ds, "LookUpAPBManagement")

                            SQL = "select " & _
                            "* " & _
                            "from " & DBNameSpace & ".VW_APBFacilityLocation " & _
                            "where " & DBNameSpace & ".VW_APBFacilityLocation.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                            da = New OracleDataAdapter(SQL, Conn)
                            If Conn.State = ConnectionState.Closed Then
                                Conn.Open()
                            End If
                            ds.EnforceConstraints = False
                            da.Fill(ds, "VW_APBFacilityLocation")

                            SQL = "select " & _
                            "* " & _
                            "from " & DBNameSpace & ".VW_APBFacilityHeader " & _
                            "where " & DBNameSpace & ".VW_APBFacilityHeader.strAIRSNumber = '0413" & txtAIRSNumber.Text & "' "

                            da = New OracleDataAdapter(SQL, Conn)
                            If Conn.State = ConnectionState.Closed Then
                                Conn.Open()
                            End If
                            ds.EnforceConstraints = False
                            da.Fill(ds, "VW_APBFacilityHeader")

                            rpt.SetDataSource(ds)

                            CRViewer.ReportSource = rpt
                            CRViewer.Refresh()
                        Case Else
                    End Select

                    rpt.SetDataSource(ds)

                    'Load Variables into the Fields
                    CRViewer.ParameterFieldInfo = ParameterFields
                    CRViewer.ReportSource = rpt
                    CRViewer.Refresh()

                    'da = New OracleDataAdapter(SQL, Conn)
                    'If Conn.State = ConnectionState.Closed Then
                    '    Conn.Open()
                    'End If
                    'ds.EnforceConstraints = False
                    'da.Fill(ds, "LookUpAPBManagementType")

                    'Select Case txtOther.Text
                    '    Case "SSPP Confirm"
                    '        SQL = "Select * " & _
                    '        "from " & DBNameSpace & ".VW_SSPP_Acknowledge " & _
                    '        "where strApplicationNumber = '" & txtAIRSNumber.Text & "' "

                    '        da = New OracleDataAdapter(SQL, Conn)
                    '        If Conn.State = ConnectionState.Closed Then
                    '            Conn.Open()
                    '        End If
                    '        ds.EnforceConstraints = False
                    '        da.Fill(ds, "VW_SSPP_Acknowledge")

                    '    Case Else

                    'End Select

                    'Commentted out for testing purposes. 
                    'rpt = New crAPBPrintOut

                    'SQL = "select " & _
                    '"strDirector, strCommissioner " & _
                    '"from " & DBNameSpace & ".LookUpAPBManagement "

                    'da = New OracleDataAdapter(SQL, Conn)
                    'If Conn.State = ConnectionState.Closed Then
                    '    Conn.Open()
                    'End If
                    'ds.EnforceConstraints = False
                    'da.Fill(ds, "LookUpAPBManagement")

                    'Select Case txtOther.Text
                    '    Case "SSPP Confirm"
                    '        SQL = "Select * " & _
                    '        "from " & DBNameSpace & ".VW_SSPP_Acknowledge " & _
                    '        "where strApplicationNumber = '" & txtAIRSNumber.Text & "' "

                    '        da = New OracleDataAdapter(SQL, Conn)
                    '        If Conn.State = ConnectionState.Closed Then
                    '            Conn.Open()
                    '        End If
                    '        ds.EnforceConstraints = False
                    '        da.Fill(ds, "VW_SSPP_Acknowledge")

                    '    Case Else

                    'End Select

                    'rpt.SetDataSource(ds)
                    'CRViewer.ReportSource = rpt
                    'CRViewer.Refresh()

                Case Else

            End Select

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub

#End Region
#Region "Test Reports"
    Private Sub LoadOneStackTwoRun()
        Dim rpt As New CROneStackTwoRuns
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber,  " & _
           "strMaxOperatingCapacity,  " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strMaxOperatingCapacityUnit   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit,   " & _
           "strOperatingCapacity,   " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strOperatingCapacityUnit   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,    " & _
           "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3,   " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strAllowableEmissionRateUnit1   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1,   " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strAllowableEmissionRateUnit2   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2,   " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strAllowableEmissionRateUnit3   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3,   " & _
           "strRunNumber1a, strRunNumber1b, strGasTemperature1A, strGasTemperature1b,   " & _
           "strGasMoisture1A, strGasMoisture1B,   " & _
           "strGasFlowRateACFM1A, strGasFlowRateACFM1B, " & _
           "strGasFlowRateDSCFM1A, strGasFlowRateDSCFM1B,   " & _
           "strPollutantConcentration1A, strPollutantConcentration1B,   " & _
           "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitkey = strPollutantConcentrationUnit   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit,   " & _
           "strPOllutantConcentrationAvg,   " & _
           "strEmissionRate1A, strEmissionRate1B, " & _
           "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where strUnitKey = strEmissionRateUnit   " & _
           "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit,   " & _
           "strEmissionRateAvg, strPercentAllowable, strConfidentialData   " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCommissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                spValue.Value = dr.Item("strReportTYpe")
                ReportType = spValue.Value
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPercentAllowable")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUSerProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUSerProfiles.numUserProfiles  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt
            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub      'Complete
    Private Sub LoadOneStackThreeRun()
        Dim rpt As New CROneStackThreeRuns
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields
         
            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPReportOneStack.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit1 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit2 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit3 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strRunNumber1a, strRunNumber1b, strRunNumber1c, strGasTemperature1A, strGasTemperature1b, " & _
            "strGasTemperature1C, strGasMoisture1A, strGasMoisture1B, strGasMoisture1C, " & _
            "strGasFlowRateACFM1A, strGasFlowRateACFM1B, strGasFlowRateACFM1c, " & _
            "strGasFlowRateDSCFM1A, strGasFlowRateDSCFM1B, strGasFlowRateDSCFM1C, " & _
            "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, " & _
            "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strPollutantConcentrationUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
            "strPOllutantConcentrationAvg, " & _
            "strEmissionRate1A, strEmissionRate1B, strEmissionRate1C, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitKey = strEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
            "strEmissionRateAvg, strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            Dim recExist As Boolean = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)
                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                spValue.Value = dr.Item("strReportTYpe")
                ReportType = spValue.Value
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = ", --Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                Try
                     
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                    End If
                Catch ex As Exception
                    MsgBox(ex.ToString)
                End Try
                 

                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 57, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 58, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 59, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPercentAllowable")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()
            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub    'Complete
    Private Sub LoadOneStackFourRun()
        Dim rpt As New CROneStackFourRuns
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPReportOneStack.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit1 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit2 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit3 " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strRunNumber1a, strRunNumber1b, strRunNumber1c, strRunNumber1D, strGasTemperature1A, strGasTemperature1b, " & _
            "strGasTemperature1C, strGasTemperature1D, strGasMoisture1A, strGasMoisture1B, strGasMoisture1C, strGasMoisture1D, " & _
            "strGasFlowRateACFM1A, strGasFlowRateACFM1B, strGasFlowRateACFM1c, strGasFlowRateACFM1D, " & _
            "strGasFlowRateDSCFM1A, strGasFlowRateDSCFM1B, strGasFlowRateDSCFM1C, strGasFlowRateDSCFM1D, " & _
            "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, strPollutantConcentration1D, " & _
            "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitkey = strPollutantConcentrationUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
            "strPOllutantConcentrationAvg, " & _
            "strEmissionRate1A, strEmissionRate1B, strEmissionRate1C, strEmissionRate1D, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportOneStack " & _
            "where strUnitKey = strEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
            "strEmissionRateAvg, strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportOneStack   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportOneStack.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            Dim recExist As Boolean = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = ", --Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf - -"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 57, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 58, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 59, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 60, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 61, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 63, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 64, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1D"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 62, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1D")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 65, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 66, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPercentAllowable")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If
        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub     'Complete
    Private Sub LoadTwoStackStandard()
        Dim rpt As New CRTwoStackStandard
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPReportTwoStack.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit1 " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit2 " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strAllowableEmissionRateUnit3 " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strStackOneName, strStackTwoName, " & _
            "strRunNumber1a, strRunNumber1b, strRunNumber1c, strRunNumber2a, strRunNumber2b, strRunNumber2c, " & _
            "strGasTemperature1A, strGasTemperature1b, strGasTemperature1C, " & _
            "strGasTemperature2A, strGasTemperature2b, strGasTemperature2C, " & _
            "strGasMoisture1A, strGasMoisture1B, strGasMoisture1C, " & _
            "strGasMoisture2A, strGasMoisture2B, strGasMoisture2C, " & _
            "strGasFlowRateACFM1A, strGasFlowRateACFM1B, strGasFlowRateACFM1c, " & _
            "strGasFlowRateACFM2A, strGasFlowRateACFM2B, strGasFlowRateACFM2c, " & _
            "strGasFlowRateDSCFM1A, strGasFlowRateDSCFM1B, strGasFlowRateDSCFM1C, " & _
            "strGasFlowRateDSCFM2A, strGasFlowRateDSCFM2B, strGasFlowRateDSCFM2C, " & _
            "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, " & _
            "strPollutantConcentration2A, strPollutantConcentration2B, strPollutantConcentration2C, " & _
            "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitkey = strPollutantConcentrationUnit " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
            "strPOllutantConcentrationAvg1, " & _
            "strPOllutantConcentrationAvg2, " & _
            "strEmissionRate1A, strEmissionRate1B, strEmissionRate1C, " & _
            "strEmissionRate2A, strEmissionRate2B, strEmissionRate2C, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
            "where strUnitKey = strEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
            "strEmissionRateAvg1, " & _
            "strEmissionRateAvg2, " & _
            "strEmissionRateTotal1, " & _
            "strEmissionRateTotal2, " & _
            "strEmissionRateTotal3, " & _
            "strEmissionRateTotalAvg, " & _
            "strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportTwoStack   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            Dim recExist As Boolean = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "StackOneName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strStackOneName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "StackTwoName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strStackTwoName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 58, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 65, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 72, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 59, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 66, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 73, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 60, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 67, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 74, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 61, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 68, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 75, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 62, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 69, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 76, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 78, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 79, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage2"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 80, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg2")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 63, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 70, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 77, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 81, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 82, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage2"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 83, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg2")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateTotal1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 84, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateTotal1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateTotal2"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 85, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateTotal2")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateTotal3"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 86, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateTotal3")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateTotalAverage"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 87, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateTotalAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 88, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPercentAllowable")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub    'Complete
    Private Sub LoadTwoStackDRE()
        Dim rpt As New CRTwoStackDRE
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPReportTwoStack.strReferencenumber, strMaxoperatingCapacity, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strMaxOperatingCapacityUnit " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
        "strOperatingCapacity, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strOperatingCapacityUnit " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
        "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strAllowableEmissionRateUnit1 " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strAllowableEmissionRateUnit2 " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strAllowableEmissionRateUnit3 " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
        "strStackOneName, strStackTwoName, " & _
        "strRunNumber1a, strRunNumber1b, strRunNumber1c, strRunNumber2a, strRunNumber2b, strRunNumber2c, " & _
        "strGasTemperature1A, strGasTemperature1b, strGasTemperature1C, " & _
        "strGasTemperature2A, strGasTemperature2b, strGasTemperature2C, " & _
        "strGasMoisture1A, strGasMoisture1B, strGasMoisture1C, " & _
        "strGasMoisture2A, strGasMoisture2B, strGasMoisture2C, " & _
        "strGasFlowRateACFM1A, strGasFlowRateACFM1B, strGasFlowRateACFM1c, " & _
        "strGasFlowRateACFM2A, strGasFlowRateACFM2B, strGasFlowRateACFM2c, " & _
        "strGasFlowRateDSCFM1A, strGasFlowRateDSCFM1B, strGasFlowRateDSCFM1C, " & _
        "strGasFlowRateDSCFM2A, strGasFlowRateDSCFM2B, strGasFlowRateDSCFM2C, " & _
        "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, " & _
        "strPollutantConcentration2A, strPollutantConcentration2B, strPollutantConcentration2C, " & _
        "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitkey = strPollutantConcentrationUnit " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
        "strPOllutantConcentrationAvg1, " & _
        "strPOllutantConcentrationAvg2, " & _
        "strEmissionRate1A, strEmissionRate1B, strEmissionRate1C, " & _
        "strEmissionRate2A, strEmissionRate2B, strEmissionRate2C, " & _
        "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportTwoStack " & _
        "where strUnitKey = strEmissionRateUnit " & _
        "and " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
        "strEmissionRateAvg1, " & _
        "strEmissionRateAvg2, " & _
        "strDestructionPercent, " & _
        "strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportTwoStack   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportTwoStack.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If

            dr = cmd.ExecuteReader

            Dim recExist As Boolean = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                    If spValue.Value = "  Unassigned" Then
                        spValue.Value = "No Manager"
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "StackOneName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strStackOneName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "StackTwoName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strStackTwoName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 58, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 65, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasTemperature2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 72, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasTemperature2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 59, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 66, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasMoisture2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 73, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasMoisture2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 60, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 67, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(ACFM)2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 74, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateACFM2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 61, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 68, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "GasFlowRate(DSCFM)2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 75, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strGasFlowRateDSCFM2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 62, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 69, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 76, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 78, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 79, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage2"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 80, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg2")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 63, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 70, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate2C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 77, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate2C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 81, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 82, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage2"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 83, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRateAvg2")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "DestructionEfficiency1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 84, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strDestructionPercent")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()


                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub         'Complete
    Private Sub LoadLoadingRack()
        Dim rpt As New CRLoadingRack
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
          "" & DBNameSpace & ".ISMPReportFlare.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1A, strAllowableEmissionRate2A, strAllowableEmissionRate3A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strAllowEmissionRateUnit1A " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strAllowEmissionRateUnit2A " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strAllowEmissionRateUnit3A " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strTestDuration, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strTestDurationUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as TestDurationUnit, " & _
            "strPollutantConcenIn, strPollutantConcenOut, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strPollutantConcenUnitIN " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as PollutantConcentrationUnitIN, " & _
             "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strPollutantConcenUnitOUT " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as PollutantConcentrationUnitOUT, " & _
            "strEmissionRate, " & _
             "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
            "strDestructionEfficiency, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportFlare   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportFlare.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2A")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3A")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If


                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TestDuration"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strTestDuration") & " " & dr.Item("TestDurationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationIN"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcenIn") & " " & dr.Item("PollutantConcentrationUnitIN")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationOUT"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcenOUT") & " " & dr.Item("PollutantConcentrationUnitOUT")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionRate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("EmissionRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "DestructionReductionEfficiency"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strDestructionEfficiency")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                     "(strFirstName||' '||strLastName) as WitnessingEng " & _
                     "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                     "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                     "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub         'Complete
    Private Sub LoadPondTreatment()
        Dim rpt As New CRPondTreatment
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
          "" & DBNameSpace & ".ISMPReportPondAndGas.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit1 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit2 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit3 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strRunNumber1a, strRunNumber1b, strRunNumber1c, " & _
            "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, " & _
            "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strPollutantConcentrationUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
            "strPOllutantConcentrationAvg, " & _
            "strTreatmentRate1A, strTreatmentRate1B, strTreatmentRate1C, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitKey = strTreatmentRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber = '" & txtReferenceNumber.Text & "') as TreatmentRateUnit, " & _
            "strTreatmentRateAvg, strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportPondAndGas   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = dr.Item("ForTestDateStart")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ForReceivedDate")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("mmoCommentArea")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ComplianceStatement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strControlEquipmentData")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = ", " & dr.Item("CC")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strMaxoperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("stroperatingCapacity")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("OperatingCapacityUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strAllowableEmissionRate1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1a")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strRunNumber1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPollutantConcentration1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("POllutantConcentrationUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPOllutantConcentrationAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TreatmentRate1A"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strTreatmentRate1A")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TreatmentRate1B"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strTreatmentRate1B")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TreatmentRate1C"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strTreatmentRate1C")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TreatmentRateUnits"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("TreatmentRateUnit")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "TreatmentRateAverage1"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strTreatmentRateAvg")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strPercentAllowable")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub       'Complete
    Private Sub LoadGasConcentration()
        Dim rpt As New CRGasConcentration
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
          "" & DBNameSpace & ".ISMPReportPondAndGas.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1, strAllowableEmissionRate2, strAllowableEmissionRate3, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit1 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit2 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strAllowableEmissionRateUnit3 " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
            "strRunNumber1a, strRunNumber1b, strRunNumber1c, " & _
            "strPollutantConcentration1A, strPollutantConcentration1B, strPollutantConcentration1C, " & _
            "(Select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitkey = strPollutantConcentrationUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber = '" & txtReferenceNumber.Text & "') as POllutantConcentrationUnit, " & _
            "strPOllutantConcentrationAvg, " & _
            "strEmissionRate1A, strEmissionRate1B, strEmissionRate1C, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportPondAndGas " & _
            "where strUnitKey = strEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber = '" & txtReferenceNumber.Text & "') as EmissionRateUnit, " & _
            "strEmissionRateAvg, strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportPondAndGas   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportPondAndGas.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strProgrammanager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityName")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("PollutantDescription")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strEmissionSource")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("strApplicableRequirement")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("ReviewingEngineer")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                spValue.Value = dr.Item("strControlEquipmentData")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                spValue.Value = dr.Item("strMaxoperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                spValue.Value = dr.Item("stroperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                spValue.Value = dr.Item("strAllowableEmissionRate1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate2")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1a"
                spValue.Value = dr.Item("strRunNumber1a")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1B"
                spValue.Value = dr.Item("strRunNumber1B")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1C"
                spValue.Value = dr.Item("strRunNumber1C")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1A"
                spValue.Value = dr.Item("strPollutantConcentration1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1B"
                spValue.Value = dr.Item("strPollutantConcentration1B")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentration1C"
                spValue.Value = dr.Item("strPollutantConcentration1C")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationUnits"
                spValue.Value = dr.Item("POllutantConcentrationUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PollutantConcentrationAverage1"
                spValue.Value = dr.Item("strPOllutantConcentrationAvg")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1A"
                spValue.Value = dr.Item("strEmissionRate1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1B"
                spValue.Value = dr.Item("strEmissionRate1B")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRate1C"
                spValue.Value = dr.Item("strEmissionRate1C")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateUnits"
                spValue.Value = dr.Item("EmissionRateUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionRateAverage1"
                spValue.Value = dr.Item("strEmissionRateAvg")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                spValue.Value = dr.Item("strPercentAllowable")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        If dr.Item("WitnessingEng") = "  Unassigned" Then
                        Else
                            WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                        End If

                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Or WitnessingEngineer2 = "" Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub    'Complete
    Private Sub LoadFlare()
        Dim rpt As New CRFlare
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
          "" & DBNameSpace & ".ISMPReportFlare.strReferencenumber, strMaxoperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strLimitationVelocity, strLimitationHeatCapacity, " & _
            "strHeatingValue1A, strHeatingValue2A, strHeatingValue3A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strHeatingValueUnits " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as HeatingValueUnits, " & _
            "strHeatingValueAvg, strVelocity1A, strVelocity2A, strVelocity3A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportFlare " & _
            "where strUnitkey = strVelocityUnits " & _
            "and " & DBNameSpace & ".ISMPReportFlare.strreferencenumber = '" & txtReferenceNumber.Text & "') as VelocityUnits, " & _
            "strVelocityAvg, strPercentAllowable, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportFlare   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportFlare.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"
          
            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                spValue.Value = dr.Item("strControlEquipmentData")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                spValue.Value = dr.Item("strMaxoperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                spValue.Value = dr.Item("stroperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "LimitationVelocity"
                spValue.Value = "Velocity less than " & dr.Item("strLimitationVelocity") & " ft/sec;"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "Velocity Limitation --Conf--;"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "LimitationHeatCapacity"
                spValue.Value = " Heat Content greater than or equal to " & dr.Item("strLimitationHeatCapacity") & " BTU/scf."
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = " Heat Content Limitation --Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "HeatingValue1A"
                spValue.Value = dr.Item("strHeatingValue1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "HeatingValue1B"
                spValue.Value = dr.Item("strHeatingValue2A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "HeatingValue1C"
                spValue.Value = dr.Item("strHeatingValue3A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "HeatingValueUnits"
                spValue.Value = dr.Item("HeatingValueUnits")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "HeatingValueAverage"
                spValue.Value = dr.Item("strHeatingValueAvg")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Velocity1A"
                spValue.Value = dr.Item("strVelocity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Velocity1B"
                spValue.Value = dr.Item("strVelocity2A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Velocity1C"
                spValue.Value = dr.Item("strVelocity3A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "VelocityUnits"
                spValue.Value = dr.Item("VelocityUnits")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "VelocityAverage"
                spValue.Value = dr.Item("strVelocityAvg")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PercentAllowable"
                spValue.Value = dr.Item("strPercentAllowable")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If
        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub               'Complete
    Private Sub LoadMemorandumStandard()
        Dim rpt As New CRMemorandumStandard
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
         "" & DBNameSpace & ".ISMPREportMemo.strReferencenumber, strMemorandumField, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportMemo   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportMemo.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"
           
            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Memorandum"
                spValue.Value = dr.Item("strMemorandumField")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub  'Complete
    Private Sub LoadMemorandumToFile()
        Dim rpt As New CRMemorandumToFile
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
        "" & DBNameSpace & ".ISMPREportMemo.strReferencenumber, strMemorandumField, " & _
      "strMonitormanufactureandmodel, strmonitorserialnumber, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportMemo   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportMemo.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = ReportType
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("UnitManager")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Memorandum"
                spValue.Value = dr.Item("strMemorandumField")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ManufacturerAndModel"
                spValue.Value = dr.Item("strMonitormanufactureandmodel")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "SerialNumber"
                spValue.Value = dr.Item("strmonitorserialnumber")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub    'Complete
    Private Sub LoadPTE()
        Dim rpt As New CRMemorandumPTE
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
       "" & DBNameSpace & ".ISMPREportMemo.strReferencenumber, strMemorandumField, " & _
      "strMaxoperatingCapacity, " & _
      "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportMemo " & _
      "where strUnitkey = strMaxOperatingCapacityUnit " & _
      "and " & DBNameSpace & ".ISMPREportMemo.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
      "strOperatingCapacity, " & _
      "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportMemo " & _
      "where strUnitkey = strOperatingCapacityUnit " & _
      "and " & DBNameSpace & ".ISMPREportMemo.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
      "strAllowableEmissionrate1A, strAllowableEmissionRate1B, strAllowableEmissionRate1C, " & _
      "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportMemo " & _
      "where strUnitkey = strAllowableEmissionRateUnit1A " & _
      "and " & DBNameSpace & ".ISMPREportMemo.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
      "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportMemo " & _
      "where strUnitkey = strAllowableEmissionRateUnit1B " & _
      "and " & DBNameSpace & ".ISMPREportMemo.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit2, " & _
      "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportMemo " & _
      "where strUnitkey = strAllowableEmissionRateUnit1C " & _
      "and " & DBNameSpace & ".ISMPREportMemo.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit3, " & _
      "strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportMemo   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportMemo.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                spValue.Value = dr.Item("strControlEquipmentData")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Memorandum"
                spValue.Value = dr.Item("strMemorandumField")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                spValue.Value = dr.Item("strMaxoperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                spValue.Value = dr.Item("stroperatingCapacity")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                spValue.Value = dr.Item("strAllowableEmissionrate1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("AllowableEmissionRateUnit2") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionrate1B")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    spValue.Value = dr.Item("AllowableEmissionRateUnit2")
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit2"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                If dr.Item("AllowableEmissionRateUnit3") <> "N/A" Then

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = "; " & vbCrLf & dr.Item("strAllowableEmissionRate1C")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = "; " & vbCrLf & "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = dr.Item("AllowableEmissionRateUnit3")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)

                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "AllowableEmissionRateUnit3"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()
            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub                 'Complete
    Private Sub LoadMethod22()
        Dim rpt As New CRMethod22
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "(Select " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceStatus " & _
           "from " & DBNameSpace & ".LookUPISMPComplianceStatus, " & DBNameSpace & ".ISMPReportInformation " & _
           "where " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceKey = " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus " & _
            "and " & DBNameSpace & ".ISMPReportInformation.strReferencenumber = '" & txtReferenceNumber.Text & "') as ComplianceStatement2, " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
       "" & DBNameSpace & ".ISMPREportOpacity.strReferencenumber, strMaxOperatingCapacity1A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity1A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "STRALLOWABLEEMISSIONRATE22, " & _
            "strOpacityTestDuration, strAccumulatedEmissionTime, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportOpacity   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportOpacity.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                ReportType = dr.Item("strReportTYpe")
                Select Case ReportType
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus2"
                spValue.Value = dr.Item("ComplianceStatement2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)


                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                spValue.Value = dr.Item("strMaxOperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                spValue.Value = dr.Item("strOperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                spValue.Value = dr.Item("STRALLOWABLEEMISSIONRATE22")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityTestDuration"
                spValue.Value = dr.Item("strOpacityTestDuration") & " minutes "
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AccumulatedEmissionTime"
                spValue.Value = dr.Item("strAccumulatedEmissionTime")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub            'Complete
    Private Sub LoadMethod9Single()
        Dim rpt As New CRMethod9Single
        monitor.TrackFeature("Report." & rpt.ResourceName)
        Dim temp As String

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "(Select " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceStatus " & _
           "from " & DBNameSpace & ".LookUPISMPComplianceStatus, " & DBNameSpace & ".ISMPReportInformation " & _
           "where " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceKey = " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferencenumber = '" & txtReferenceNumber.Text & "') as ComplianceStatement2, " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ISMPREportOpacity.strReferencenumber, strMaxOperatingCapacity1A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity1A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strAllowableEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "strOpacityTestDuration, " & _
            "strOpacityPointA, strConfidentialData, strOpacityStandard  " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportOpacity   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportOpacity.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"
           
            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportTYpe"
                temp = dr.Item("strReportTYpe")
                Select Case temp
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus2"
                spValue.Value = dr.Item("ComplianceStatement2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                spValue.Value = dr.Item("strControlEquipmentData")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity"
                spValue.Value = dr.Item("strMaxoperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity"
                spValue.Value = dr.Item("stroperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                spValue.Value = dr.Item("strAllowableEmissionRate1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRateUnit1"
                spValue.Value = dr.Item("AllowableEmissionRateUnit1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityTestDuration"
                spValue.Value = dr.Item("strOpacityTestDuration")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointA"
                spValue.Value = dr.Item("strOpacityPointA") & " % Opacity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)


                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityStandard"
                If IsDBNull(dr.Item("strOpacityStandard")) Then
                    temp = "6"
                Else
                    temp = dr.Item("strOpacityStandard")
                End If

                Select Case temp
                    Case "6"
                        spValue.Value = "(Highest 6-minute average)"
                    Case "30"
                        spValue.Value = "(30-minute average)"
                    Case Else
                        spValue.Value = "(Highest 6-minute average)"
                End Select

                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

             
                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()
            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub       'Complete
    Private Sub LoadMethod9Multi()
        Dim rpt As New CRMethod9Multi
        monitor.TrackFeature("Report." & rpt.ResourceName)
        Dim temp As String

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             
            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "(Select " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceStatus " & _
           "from " & DBNameSpace & ".LookUPISMPComplianceStatus, " & DBNameSpace & ".ISMPReportInformation " & _
           "where " & DBNameSpace & ".LookUPISMPComplianceStatus.strComplianceKey = " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus " & _
            "and " & DBNameSpace & ".ISMPReportInformation.strReferencenumber = '" & txtReferenceNumber.Text & "') as ComplianceStatement2, " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
       "" & DBNameSpace & ".ISMPREportOpacity.strReferencenumber, strMaxOperatingCapacity1A, " & _
            "strMaxOperatingCapacity2A, strMaxOperatingCapacity3A, " & _
            "strMaxOperatingCapacity4A, strMaxOperatingCapacity5A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strMaxOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as MaxOperatingCapacityUnit, " & _
            "strOperatingCapacity1A, strOperatingCapacity2A, " & _
            "strOperatingCapacity3A, strOperatingCapacity4A, " & _
            "strOperatingCapacity5A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strOperatingCapacityUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as OperatingCapacityUnit,  " & _
            "strAllowableEmissionRate1A, strAllowableEmissionRate2A, " & _
            "strAllowableEmissionRate3A, strAllowableEmissionRate4A, " & _
            "strAllowableEmissionRate5A, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPREportOpacity " & _
            "where strUnitkey = strAllowableEmissionRateUnit " & _
            "and " & DBNameSpace & ".ISMPREportOpacity.strreferencenumber = '" & txtReferenceNumber.Text & "') as AllowableEmissionRateUnit1, " & _
            "strOpacityTestDuration, " & _
            "strOpacityPointA, strOpacityPointB, strOpacityPointC, " & _
            "strOpacityPointD, strOpacityPointE, " & _
            "strEquipmentItem1, strEquipmentItem2, strEquipmentItem3, " & _
            "strEquipmentItem4, strEquipmentItem5, " & _
            "strConfidentialData, strOpacityStandard " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPREportOpacity   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPREportOpacity.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"
          
            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportType"
                temp = dr.Item("strReportTYpe")
                Select Case temp
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = " "
                    Else
                        spValue.Value = ", --Conf--"
                    End If
                Else
                    If Mid(ConfidentialData, 9, 1) = "1" Then
                        spValue.Value = ", " & dr.Item("UnitManager")
                    Else
                        spValue.Value = ", " & dr.Item("UnitManager")
                    End If
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus2"
                spValue.Value = dr.Item("ComplianceStatement2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ControlEquipmentOperatingData"
                spValue.Value = dr.Item("strControlEquipmentData")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity1"
                spValue.Value = dr.Item("strMaxoperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity2"
                spValue.Value = dr.Item("strMaxoperatingCapacity2A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity3"
                spValue.Value = dr.Item("strMaxoperatingCapacity3A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity4"
                spValue.Value = dr.Item("strMaxoperatingCapacity4A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacity5"
                spValue.Value = dr.Item("strMaxoperatingCapacity5A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "MaximumOperatingCapacityUnit"
                spValue.Value = dr.Item("MaxOperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity1"
                spValue.Value = dr.Item("stroperatingCapacity1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity2"
                spValue.Value = dr.Item("stroperatingCapacity2A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity3"
                spValue.Value = dr.Item("stroperatingCapacity3A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity4"
                spValue.Value = dr.Item("stroperatingCapacity4A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "operatingCapacity5"
                spValue.Value = dr.Item("stroperatingCapacity5A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OperatingCapacityUnit"
                spValue.Value = dr.Item("OperatingCapacityUnit")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate1"
                spValue.Value = dr.Item("strAllowableEmissionRate1A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate2"
                spValue.Value = dr.Item("strAllowableEmissionRate2A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate3"
                spValue.Value = dr.Item("strAllowableEmissionRate3A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate4"
                spValue.Value = dr.Item("strAllowableEmissionRate4A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AllowableEmissionRate5"
                spValue.Value = dr.Item("strAllowableEmissionRate5A")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointA"
                spValue.Value = dr.Item("strOpacityPointA")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointB"
                spValue.Value = dr.Item("strOpacityPointB")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointC"
                spValue.Value = dr.Item("strOpacityPointC")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointD"
                spValue.Value = dr.Item("strOpacityPointD")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityPointE"
                spValue.Value = dr.Item("strOpacityPointE")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Attachment1"
                spValue.Value = dr.Item("strEquipmentItem1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Attachment2"
                spValue.Value = dr.Item("strEquipmentItem2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Attachment3"
                spValue.Value = dr.Item("strEquipmentItem3")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Attachment4"
                spValue.Value = dr.Item("strEquipmentItem4")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Attachment5"
                spValue.Value = dr.Item("strEquipmentItem5")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)


                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "OpacityStandard"
                temp = dr.Item("strOpacityStandard")
                Select Case temp
                    Case "6"
                        spValue.Value = "(Highest 6-minute average)"
                    Case "30"
                        spValue.Value = "(30-minute average)"
                    Case Else
                        spValue.Value = "(Highest 6-minute average)"
                End Select

                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)


                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()

            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub        'Complete
    Private Sub LoadRata()
        Dim rpt As New CRRata
        monitor.TrackFeature("Report." & rpt.ResourceName)
        Dim temp As String

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

        Try
             

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "" & DBNameSpace & ".ISMPMaster.strAIRSNumber as AIRSNumber, " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName as FacilityName, " & _
            "strFacilityCity as FacilityCity, " & _
             "strFacilityState as FacilityState, " & _
            "strPollutantDescription as PollutantDescription, " & _
            "strEmissionSource, " & _
            "" & DBNameSpace & ".ISMPReportType.strReportType, " & _
           "strApplicableRequirement, " & _
           "(strFirstName||' '||strLastName) as ReviewingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = '0' then 'N/W' " & _
           "Else " & _
             "(select (strFirstName||' '||strLastName) " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation " & _
             "where " & DBNameSpace & ".ISMPReportInformation.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') " & _
           "End as WitnessingEngineer, " & _
           "Case " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng is Null then 'N/W' " & _
             "when " & DBNameSpace & ".ISMPReportInformation.strOtherWitnessingEng = '0' then 'N/W' " & _
           "Else  " & _
             "'M/W' " & _
           "End WitnessingEngineer2,     " & _
           "Case  " & _
             "when " & DBNameSpace & ".ISMPReportInformation.numReviewingManager is Null then 'N/A' " & _
           "Else  " & _
             "(Select (strFirstName||' '||strLastName) as UnitManager  " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation  " & _
             "where " & DBNameSpace & ".ISMPReportInformation.numReviewingManager = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
             "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "')  " & _
           "END UnitManager,  " & _
           "datReviewedByUnitManager,  " & _
           "(Select (strFirstName||' '||strLastName) as ComplianceManager  " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".ISMPReportInformation   " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strComplianceManager = " & DBNameSpace & ".EPDUserProfiles.nuMUserID " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as ComplianceManager,  " & _
           "to_char(datTestDateStart, 'FMMonth DD, YYYY') as ForTestDateStart,  " & _
           "to_char(datTestDateEnd, 'FMMonth DD, YYYY') as ForTestDateEnd,  " & _
           "to_char(datReceivedDate, 'FMMonth DD, YYYY') as ForReceivedDate,  " & _
           "datCompleteDate,  " & _
           "mmoCommentArea, strCommissioner, strDirector, strProgramManager,  " & _
           "strComplianceStatement as ComplianceStatement,  " & _
           "strControlEquipmentData,  " & _
           "(Select (strFirstName||' '||strLastName) as CC  " & _
           "from " & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".EPDUserProfiles  " & _
           "where " & DBNameSpace & ".ISMPReportInformation.strCC = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPREportInformation.strReferenceNumber = '" & txtReferenceNumber.Text & "') as CC,  " & _
           "" & DBNameSpace & ".ismpreportinformation.strComplianceStatus, " & _
       "" & DBNameSpace & ".ISMPReportRATA.strReferencenumber, " & _
            "(Select strPOllutantDescription " & _
            "from " & DBNameSpace & ".LookUPPollutants, " & DBNameSpace & ".ISMPReportRATA " & _
            "where " & DBNameSpace & ".LookUPPollutants.strPOllutantCode = " & DBNameSpace & ".ISMPReportRATA.strDiluent " & _
            "and " & DBNameSpace & ".ISMPReportRATA.strReferenceNumber = '" & txtReferenceNumber.Text & "') as Diluent, " & _
            "strAPplicableStandard, strRelativeAccuracyPercent, " & _
            "strReferenceMethod1, strReferenceMethod2, strReferenceMethod3, " & _
            "strReferenceMethod4, strReferenceMethod5, strReferenceMethod6, " & _
            "strReferenceMethod7, strReferenceMethod8, strReferenceMethod9, " & _
            "strReferenceMethod10, strReferenceMethod11, strReferenceMethod12, " & _
            "(select strUnitDescription from " & DBNameSpace & ".LookUPUnits, " & DBNameSpace & ".ISMPReportRATA " & _
            "where strUnitkey = strRataUnits " & _
            "and " & DBNameSpace & ".ISMPReportRATA.strreferencenumber = '" & txtReferenceNumber.Text & "') as RataUnits, " & _
            "StrCMS1, StrCMS2, StrCMS3, StrCMS4, StrCMS5, StrCMS6, " & _
            "StrCMS7, StrCMS8, StrCMS9, StrCMS10, StrCMS11, StrCMS12, " & _
            "strAccuracyRequiredPercent, strAccuracyREquiredStatement, strAccuracyChoice, " & _
            "strRunsINcludedKey, strConfidentialData " & _
           "From " & DBNameSpace & ".ISMPMaster, " & DBNameSpace & ".APBFacilityInformation,  " & _
           "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUpPollutants,  " & _
           "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".EPDUserProfiles,  " & _
           "" & DBNameSpace & ".LookUpISMPComplianceStatus, " & DBNameSpace & ".ISMPReportRATA   " & _
           "where " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strReviewingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
           "and " & DBNameSpace & ".ISMPReportInformation.strComplianceStatus = " & DBNameSpace & ".LookUpISMPComplianceStatus.strComplianceKey   " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportRATA.strReferenceNumber  " & _
           "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = '" & txtReferenceNumber.Text & "'"

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist Then
                If IsDBNull(dr.Item("strConfidentialData")) Then
                    ConfidentialData = "0"
                Else
                    ConfidentialData = dr.Item("strConfidentialData")
                End If
                If Mid(ConfidentialData, 1, 1) = "1" Then
                    If txtOther.Text = "ToFile" Then
                        ConfidentialData = "0" & Mid(ConfidentialData, 2)
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Commissioner"
                spValue.Value = dr.Item("strCOmmissioner")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Director"
                spValue.Value = dr.Item("strDirector")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ProgramManager"
                spValue.Value = dr.Item("strProgrammanager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 9, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "AIRSNumber"
                spValue.Value = Mid(dr.Item("AIRSNumber"), 5, 8)
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 3, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityName"
                spValue.Value = dr.Item("FacilityName")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 4, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityCity"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("FacilityCity") & ", "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "FacilityState"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 5, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = dr.Item("FacilityState")
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Pollutant"
                spValue.Value = dr.Item("PollutantDescription")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 15, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "EmissionSourceTested"
                spValue.Value = dr.Item("strEmissionSource")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 14, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReportType"
                temp = dr.Item("strReportTYpe")
                Select Case temp
                    Case "SOURCE TEST"
                        spValue.Value = "SOURCE TEST REPORT REVIEW"
                    Case "RATA/CEMS"
                        spValue.Value = "RELATIVE ACCURACY TEST AUDIT REPORT REVIEW"
                    Case "Monitor Certification"
                        spValue.Value = "MONITOR CERTIFICATION"
                    Case Else
                        spValue.Value = spValue.Value
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 6, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableRequirement"
                spValue.Value = dr.Item("strApplicableRequirement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 27, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReviewingEngineer"
                spValue.Value = dr.Item("ReviewingEngineer")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 7, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                If IsDBNull(dr.Item("WitnessingEngineer")) Then
                    WitnessingEngineer = "Not Witnessed"
                Else
                    WitnessingEngineer = dr.Item("WitnessingEngineer")
                End If

                If IsDBNull(dr.Item("WitnessingEngineer2")) Then
                    WitnessingEngineer2 = "N/W"
                Else
                    WitnessingEngineer2 = dr.Item("WitnessingEngineer2")
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "UnitManager"
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 10, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = dr.Item("UnitManager")
                End If

                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceManager"
                spValue.Value = dr.Item("ComplianceManager")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 24, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("forTestDateEnd") = dr.Item("ForTestDateStart") Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = dr.Item("ForTestDateStart")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "TestDates"
                    spValue.Value = (dr.Item("ForTestDateStart") & " to " & dr.Item("ForTestDateEnd"))
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 19, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReceivedDate"
                spValue.Value = dr.Item("ForReceivedDate")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 21, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CommentArea"
                spValue.Value = dr.Item("mmoCommentArea")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 56, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ComplianceStatus"
                spValue.Value = dr.Item("ComplianceStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "PassFail"
                temp = dr.Item("strComplianceStatus")
                Select Case temp
                    Case "01"
                        spValue.Value = "N/A"
                    Case "02"
                        spValue.Value = "Pass"
                    Case "03"
                        spValue.Value = "Pass"
                    Case "04"
                        spValue.Value = "N/A"
                    Case "05"
                        spValue.Value = "Fail"
                    Case Else
                        spValue.Value = "N/A"
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 18, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                If dr.Item("CC") <> "" And dr.Item("CC") <> "  Unassigned" Then
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = ", " & dr.Item("CC")
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 25, 1) = "1" Then
                        spValue.Value = "--Conf--"
                    Else
                        spValue.Value = spValue.Value
                    End If
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                Else
                    'Do this at the beginning of every new entry 
                    ParameterField = New CrystalDecisions.Shared.ParameterField
                    spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                    ParameterField.ParameterFieldName = "CC"
                    spValue.Value = " "
                    ParameterField.CurrentValues.Add(spValue)
                    ParameterFields.Add(ParameterField)
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Referencenumber"
                spValue.Value = dr.Item("strReferencenumber")
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "Diluent"
                spValue.Value = dr.Item("Diluent")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 28, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ApplicableStandard"
                spValue.Value = dr.Item("strAPplicableStandard")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 26, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RelativeAccuracyPercent"
                spValue.Value = dr.Item("strRElativeAccuracyPercent")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RelativeAccuracyChoice"
                temp = dr.Item("strAccuracyChoice")
                Select Case temp
                    Case "N/A"
                        spValue.Value = " "
                    Case "RefMethod"
                        spValue.Value = "of the Reference Method"
                    Case "AppStandard"
                        spValue.Value = "of the Applicable Standard"
                    Case "Diluent"
                        spValue.Value = dr.Item("strAccuracyChoice")
                    Case Else
                        spValue.Value = " "
                End Select
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 54, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod1"
                spValue.Value = dr.Item("strReferenceMethod1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 29, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod2"
                spValue.Value = dr.Item("strReferenceMethod2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 30, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod3"
                spValue.Value = dr.Item("strReferenceMethod3")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 31, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod4"
                spValue.Value = dr.Item("strReferenceMethod4")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 32, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod5"
                spValue.Value = dr.Item("strReferenceMethod5")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 33, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod6"
                spValue.Value = dr.Item("strReferenceMethod6")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 34, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod7"
                spValue.Value = dr.Item("strReferenceMethod7")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 35, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod8"
                spValue.Value = dr.Item("strReferenceMethod8")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 36, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod9"
                spValue.Value = dr.Item("strReferenceMethod9")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 37, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod10"
                spValue.Value = dr.Item("strReferenceMethod10")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 38, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod11"
                spValue.Value = dr.Item("strReferenceMethod11")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 39, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "ReferenceMethod12"
                spValue.Value = dr.Item("strReferenceMethod12")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 40, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RATAUnits"
                spValue.Value = dr.Item("RataUnits")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 53, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS1"
                spValue.Value = dr.Item("StrCMS1")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 41, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS2"
                spValue.Value = dr.Item("StrCMS2")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 42, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS3"
                spValue.Value = dr.Item("StrCMS3")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 43, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS4"
                spValue.Value = dr.Item("StrCMS4")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 44, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS5"
                spValue.Value = dr.Item("StrCMS5")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 45, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS6"
                spValue.Value = dr.Item("StrCMS6")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 46, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS7"
                spValue.Value = dr.Item("StrCMS7")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 47, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS8"
                spValue.Value = dr.Item("StrCMS8")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 48, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS9"
                spValue.Value = dr.Item("StrCMS9")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 49, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS10"
                spValue.Value = dr.Item("StrCMS10")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 50, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS11"
                spValue.Value = dr.Item("StrCMS11")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 51, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "CMS12"
                spValue.Value = dr.Item("StrCMS12")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 52, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RelativeAccuracyRequiredPercent"
                spValue.Value = dr.Item("strAccuracyRequiredPercent")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = "--Conf--"
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RelativeAccuracyRequiredStatement"
                spValue.Value = dr.Item("strAccuracyREquiredStatement")
                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 55, 1) = "1" Then
                    spValue.Value = " "
                Else
                    spValue.Value = spValue.Value
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                Dim OmitRuns As String = dr.Item("strRunsINcludedKey")

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber1"
                If Mid(OmitRuns, 1, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber2"
                If Mid(OmitRuns, 2, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber3"
                If Mid(OmitRuns, 3, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If

                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber4"
                If Mid(OmitRuns, 4, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber5"
                If Mid(OmitRuns, 5, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber6"
                If Mid(OmitRuns, 6, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber7"
                If Mid(OmitRuns, 7, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber8"
                If Mid(OmitRuns, 8, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber9"
                If Mid(OmitRuns, 9, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber10"
                If Mid(OmitRuns, 10, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber11"
                If Mid(OmitRuns, 11, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

                ParameterField.ParameterFieldName = "RunNumber12"
                If Mid(OmitRuns, 12, 1) = "1" Then
                    spValue.Value = "*"
                Else
                    spValue.Value = " "
                End If
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                dr.Close()

                If WitnessingEngineer2 = "M/W" Then
                    SQL = "select " & _
                    "(strFirstName||' '||strLastName) as WitnessingEng " & _
                    "from " & DBNameSpace & ".ISMPWitnessingEng, " & DBNameSpace & ".EPDUserProfiles " & _
                    "where " & DBNameSpace & ".ISMPWitnessingEng.strWitnessingEngineer = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and strReferenceNumber = '" & Me.txtReferenceNumber.Text & "'  "
                    cmd = New OracleCommand(SQL, Conn)
                    If Conn.State = ConnectionState.Closed Then
                        Conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    WitnessingEngineer2 = ""
                    While dr.Read
                        WitnessingEngineer2 = WitnessingEngineer2 & vbCrLf & dr.Item("WitnessingEng")
                    End While
                    dr.Close()
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                        WitnessingEngineer2 = "--Conf--"
                    Else
                        WitnessingEngineer2 = WitnessingEngineer2
                    End If
                Else
                    WitnessingEngineer2 = " "
                End If

                If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 2) = "11" Then
                    WitnessingEngineer = "--Conf--"
                Else
                    If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 12, 1) = "1" Then
                        If WitnessingEngineer2 = " " Then
                            WitnessingEngineer = "--Conf--"
                        Else
                            WitnessingEngineer = "--Conf--" & WitnessingEngineer2
                        End If
                    Else
                        If Mid(ConfidentialData, 1, 1) <> "0" And Mid(ConfidentialData, 13, 1) = "1" Then
                            If WitnessingEngineer = "N/W" Then
                                WitnessingEngineer = "--Conf--"
                            Else
                                WitnessingEngineer = WitnessingEngineer & vbCrLf & "--Conf--"
                            End If
                        Else
                            If WitnessingEngineer = "N/W" Then
                                If WitnessingEngineer2 = " " Then
                                    WitnessingEngineer = "Not Witnessed"
                                Else
                                    WitnessingEngineer = "--" & WitnessingEngineer2
                                End If
                            Else
                                WitnessingEngineer = WitnessingEngineer & WitnessingEngineer2
                            End If
                        End If
                    End If
                End If

                'Do this at the beginning of every new entry 
                ParameterField = New CrystalDecisions.Shared.ParameterField
                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue
                ParameterField.ParameterFieldName = "WitnessingEngineer"
                spValue.Value = WitnessingEngineer
                ParameterField.CurrentValues.Add(spValue)
                ParameterFields.Add(ParameterField)

                'Load Variables into the Fields
                CRViewer.ParameterFieldInfo = ParameterFields

                'Display the Report
                CRViewer.ReportSource = rpt

            Else
                MsgBox("Unable to Print at this time.")
                PrintOut.Close()
            End If

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub                'Complete
    Private Sub LoadPEMS()
        Try
             

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub

#End Region
#Region "SSCP"
    'Sub LoadSSCPFCEReport()
    '    Dim Commissioner As String = ""
    '    Dim Director As String = ""
    '    Dim ProgramManager As String = ""
    '    Dim FiscalYear As String = ""
    '    Dim AIRSNumber As String = ""
    '    Dim FacilityName As String = ""
    '    Dim FacilityAddress As String = ""
    '    Dim Engineer As String = ""
    '    Dim UserUnit As String = ""
    '    Dim UserAFSGCode As String = ""
    '    Dim AirProgramCode As String = ""
    '    Dim FCECompleteDate As String = ""
    '    Dim FCEComment As String = ""

    '    Dim FCEInspections As String = ""
    '    Dim FCEPerformanceTests As String = ""
    '    Dim FCEReports As String = ""
    '    Dim FCEAnnualCertifications As String = ""

    '    Dim rpt As New CRFCE2
    '    Dim temp As String = ""

    '    Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
    '    Dim ParameterField As CrystalDecisions.Shared.ParameterField
    '    Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

    '    Try
    '        'Do this just once at the start
    '        ParameterFields = New CrystalDecisions.Shared.ParameterFields

    '        SQL = "Select " & _
    '        "strCommissioner, strDirector, " & _
    '        "STRSSCPPROGRAMMANG, " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber, " & _
    '        "strFacilitYname, strFacilityStreet1, strFirstName, " & _
    '        "strLastName, strUnitDesc, " & _
    '        "'G36' as strAFSGCode, " & _
    '        "strAirProgramCodes, strFCEYear, datFCECompleted, " & _
    '        "strFCEComments " & _
    '        "from " & DBNameSpace & ".SSCPFCE, " & DBNameSpace & ".SSCPFCEMaster, " & _
    '        "" & DBNameSpace & ".APBFacilityInformation, " & DBNameSpace & ".APBHeaderData, " & _
    '        "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits, " & _
    '        "" & DBNameSpace & ".LookUpAPBManagement " & _
    '        "Where " & DBNameSpace & ".SSCPFCE.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.strFCENumber " & _
    '        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber " & _
    '        "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
    '        "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
    '        "and strReviewer = numUserID  " & _
    '        "and " & DBNameSpace & ".SSCPFCE.strFCENumber = '" & txtOther.Text & "' "

    '        cmd = New OracleCommand(SQL, Conn)

    '        If Conn.State = ConnectionState.Closed Then
    '            Conn.Open()
    '        End If

    '        dr = cmd.ExecuteReader
    '        recExist = dr.Read
    '        If recExist = True Then
    '            If IsDBNull(dr.Item("strFCEYear")) Then
    '                FiscalYear = "N/A"
    '            Else
    '                FiscalYear = dr.Item("strFCEYear")
    '            End If
    '            If IsDBNull(dr.Item("strCommissioner")) Then
    '                Commissioner = "N/A"
    '            Else
    '                Commissioner = dr.Item("strCommissioner")
    '            End If
    '            If IsDBNull(dr.Item("strDirector")) Then
    '                Director = "N/A"
    '            Else
    '                Director = dr.Item("strDirector")
    '            End If
    '            If IsDBNull(dr.Item("STRSSCPPROGRAMMANG")) Then
    '                ProgramManager = "N/A"
    '            Else
    '                ProgramManager = dr.Item("STRSSCPPROGRAMMANG")
    '            End If
    '            If IsDBNull(dr.Item("strAIRSNumber")) Then
    '                AIRSNumber = "N/A"
    '            Else
    '                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 5)
    '            End If
    '            If IsDBNull(dr.Item("strFacilityName")) Then
    '                FacilityName = "N/A"
    '            Else
    '                FacilityName = dr.Item("strFacilityname")
    '            End If
    '            If IsDBNull(dr.Item("strFacilityStreet1")) Then
    '                FacilityAddress = "N/A"
    '            Else
    '                FacilityAddress = dr.Item("strFacilityStreet1")
    '            End If
    '            If IsDBNull(dr.Item("strFirstName")) Then
    '                Engineer = ""
    '            Else
    '                Engineer = dr.Item("strFirstName")
    '            End If
    '            If IsDBNull(dr.Item("strLastName")) Then
    '                Engineer = Engineer
    '            Else
    '                Engineer = Engineer & " " & dr.Item("strLastName")
    '            End If
    '            If IsDBNull(dr.Item("strUnitDesc")) Then
    '                UserUnit = "N/A"
    '            Else
    '                UserUnit = dr.Item("strUnitDesc")
    '            End If
    '            If IsDBNull(dr.Item("strAFSGCode")) Then
    '                UserAFSGCode = "N/A"
    '            Else
    '                UserAFSGCode = dr.Item("strAFSGCode")
    '            End If
    '            If IsDBNull(dr.Item("strAirProgramCodes")) Then
    '                AirProgramCode = "N/A"
    '            Else
    '                AirProgramCode = dr.Item("strAirProgramCodes")
    '            End If
    '            If IsDBNull(dr.Item("datFCECompleted")) Then
    '                FCECompleteDate = "N/A"
    '            Else
    '                FCECompleteDate = Format(dr.Item("datFCECompleted"), "dd-MMM-yyyy")
    '            End If
    '            If IsDBNull(dr.Item("strFCEComments")) Then
    '                FCEComment = "N/A"
    '            Else
    '                FCEComment = dr.Item("strFCEComments")
    '            End If
    '        End If

    '        dr.Close()

    '        If recExist = True Then
    '            FCEInspections = ""

    '            'FCE Inspections
    '            SQL = "Select " & DBNameSpace & ".SSCPInspections.strTrackingNumber, " & _
    '            "datInspectionDateStart, " & _
    '            "Case " & _
    '            "     When strInspectionFollowUp = 'True' Then 'True' " & _
    '            "else 'No' " & _
    '            "End as InspectionFollowUp, " & _
    '            "strinspectionComments  " & _
    '            "from " & DBNameSpace & ".SSCPInspections, " & DBNameSpace & ".SSCPItemMaster,  " & _
    '            "" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE   " & _
    '            "where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPInspections.strTrackingNumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber  " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365) " & _
    '             "and (strDelete is Null or strDelete <> 'True') " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' "

    '            cmd = New OracleCommand(SQL, Conn)

    '            If Conn.State = ConnectionState.Closed Then
    '                Conn.Open()
    '            End If

    '            dr = cmd.ExecuteReader
    '            recExist = dr.Read
    '            dr.Close()

    '            If recExist = True Then
    '                cmd = New OracleCommand(SQL, Conn)

    '                If Conn.State = ConnectionState.Closed Then
    '                    Conn.Open()
    '                End If

    '                dr = cmd.ExecuteReader
    '                While dr.Read

    '                    FCEInspections = FCEInspections & "GA EPD Tracking Number:  " & vbTab & dr.Item("strTrackingNumber") & vbCrLf & _
    '                                                      "Inspection Date:         " & vbTab & vbTab & Format(dr.Item("datInspectionDateStart"), "dd-MMM-yyyy") & vbCrLf & _
    '                                                      "Follow Up Action Taken:  " & vbTab & dr.Item("InspectionFollowUp") & vbCrLf & _
    '                                                      "Comments:                " & vbCrLf & vbTab & vbTab & vbTab & dr.Item("strInspectionComments") & vbCrLf & vbCrLf

    '                End While
    '            Else
    '                FCEInspections = "N/A"

    '            End If

    '            'Performance Tests
    '            SQL = "Select " & DBNameSpace & ".SSCPTestReports.strTrackingNumber, " & _
    '            "" & DBNameSpace & ".SSCPTestREports.strReferenceNumber,  " & _
    '            "Case  " & _
    '            "	When strTestReportFollowUp = 'True' then 'True'  " & _
    '            "Else 'No' " & _
    '            "End as TestReportFollowUp,  " & _
    '            "strTestReportComments   " & _
    '            "from " & DBNameSpace & ".SSCPTestREports, " & DBNameSpace & ".SSCPItemMaster,   " & _
    '            "" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE    " & _
    '            "where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPTestREports.strTrackingNumber   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber   " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365)  " & _
    '             "and (strDelete is Null or strDelete <> 'True') " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' "


    '            SQL = "Select " & DBNameSpace & ".SSCPTestReports.strTrackingNumber, " & _
    '            "" & DBNameSpace & ".SSCPTestREports.strReferenceNumber,   " & _
    '            "Case   " & _
    '            "         When strTestReportFollowUp = 'True' then 'True'   " & _
    '            "Else 'No' " & _
    '            "End as TestReportFollowUp,   " & _
    '            "strTestReportComments,  " & _
    '            "strEmissionSource, strPollutantDescription,  " & _
    '            "" & DBNameSpace & ".ISMPReportType.strReportType,  " & _
    '            "" & DBNameSpace & ".ISMPDocumentType.strDocumentType, mmoCommentArea     " & _
    '            "from " & DBNameSpace & ".SSCPTestREports, " & DBNameSpace & ".SSCPItemMaster,    " & _
    '            "" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE,  " & _
    '            "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".LookUPPollutants,  " & _
    '            "" & DBNameSpace & ".ISMPReportType, " & DBNameSpace & ".ISMPDocumentType  " & _
    '            "where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPTestREports.strTrackingNumber    " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber    " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber    " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365)  " & _
    '            "and (" & DBNameSpace & ".SSCPItemMaster.strDelete is Null or " & DBNameSpace & ".SSCPItemMaster.strDelete <> 'True')  " & _
    '            "and " & DBNameSpace & ".SSCPTestReports.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
    '            "and " & DBNameSpace & ".LookUPPollutants.strPollutantCode = " & DBNameSpace & ".ISMPReportInformation.strPollutant  " & _
    '            "and " & DBNameSpace & ".ISMPReportInformation.strReportType = " & DBNameSpace & ".ISMPReportType.strKey  " & _
    '            "and " & DBNameSpace & ".ISMPDocumentType.strKey = " & DBNameSpace & ".ISMPReportInformation.strDocumentType  " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' "


    '            If Conn.State = ConnectionState.Closed Then
    '                Conn.Open()
    '            End If

    '            dr = cmd.ExecuteReader
    '            recExist = dr.Read
    '            dr.Close()

    '            If recExist = True Then
    '                cmd = New OracleCommand(SQL, Conn)

    '                If Conn.State = ConnectionState.Closed Then
    '                    Conn.Open()
    '                End If

    '                dr = cmd.ExecuteReader
    '                While dr.Read
    '                    FCEPerformanceTests = FCEPerformanceTests & "GA EPD Reference Number:  " & dr.Item("strReferenceNumber") & vbCrLf & _
    '                                                                "Follow Up Action Taken:   " & vbTab & dr.Item("TestReportFollowUp") & vbCrLf & _
    '                                                                "SSCP Comments: " & vbCrLf & vbTab & vbTab & vbTab & dr.Item("strTestReportComments") & vbCrLf & vbCrLf & _
    '                                                                "Test Type:                " & vbTab & dr.Item("strReportType") & " - " & dr.Item("strDocumentType") & vbCrLf & _
    '                                                                "Emission Source:          " & vbTab & dr.Item("strEmissionSource") & vbCrLf & _
    '                                                                "Pollutant:                " & vbTab & vbTab & dr.Item("strPollutantDescription") & vbCrLf & _
    '                                                                "ISMP Comments:" & vbCrLf & vbTab & vbTab & dr.Item("mmoCommentArea") & vbCrLf & vbCrLf
    '                End While
    '            Else
    '                FCEPerformanceTests = "N/A"
    '            End If

    '            'Reports
    '            'SQL = "Select " & DBNameSpace & ".SSCPREports.strTrackingNumber, " & _
    '            '"strReportPeriod, datCompleteDate, " & _
    '            '"Case " & _
    '            '"     When strEnforcementNeeded = 'True' Then 'True' " & _
    '            '"else 'N0' " & _
    '            '"End as ReportFollowUp, " & _
    '            '"strGeneralComments  " & _
    '            '"from " & DBNameSpace & ".SSCPREports, " & DBNameSpace & ".SSCPItemMaster,  " & _
    '            '"" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE   " & _
    '            '"where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPREports.strTrackingNumber  " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber  " & _
    '            '"and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber  " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365) " & _
    '            ' "and (strDelete is Null or strDelete <> 'True') " & _
    '            '"and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' "

    '            SQL = "Select " & _
    '            "(" & DBNameSpace & ".SSCPReportsHistory.strTrackingNumber||'-'||strSubmittalNumber) as strTrackingNumber, " & _
    '            "strReportPeriod, datCompleteDate, " & _
    '            "Case " & _
    '            "     When strEnforcementNeeded = 'True' Then 'True' " & _
    '            "else 'N0' " & _
    '            "End as ReportFollowUp, " & _
    '            "strGeneralComments  " & _
    '            "from " & DBNameSpace & ".SSCPReportsHistory, " & DBNameSpace & ".SSCPItemMaster,  " & _
    '            "" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE   " & _
    '            "where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPReportsHistory.strTrackingNumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber  " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365) " & _
    '            "and (strDelete is Null or strDelete <> 'True') " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' " & _
    '            "order by datCompleteDate, strTrackingnumber desc "

    '            cmd = New OracleCommand(SQL, Conn)

    '            If Conn.State = ConnectionState.Closed Then
    '                Conn.Open()
    '            End If

    '            dr = cmd.ExecuteReader
    '            recExist = dr.Read
    '            dr.Close()

    '            If recExist = True Then
    '                cmd = New OracleCommand(SQL, Conn)

    '                If Conn.State = ConnectionState.Closed Then
    '                    Conn.Open()
    '                End If

    '                dr = cmd.ExecuteReader
    '                While dr.Read
    '                    FCEReports = FCEReports & "GA EPD Tracking Number:  " & vbTab & dr.Item("strTrackingNumber") & vbCrLf & _
    '                                              "Type of Report:          " & vbTab & vbTab & dr.Item("strReportPeriod") & vbCrLf & _
    '                                              "Date Report Completed:   " & vbTab & Format(dr.Item("datCompleteDate"), "dd-MMM-yyyy") & vbCrLf & _
    '                                              "Follow Up Action Taken:  " & vbTab & dr.Item("ReportFollowUp") & vbCrLf & _
    '                                              "Comments:                " & vbCrLf & vbTab & vbTab & vbTab & dr.Item("strGeneralComments") & vbCrLf & vbCrLf
    '                End While
    '            Else
    '                FCEReports = "N/A"
    '            End If

    '            'ACCs 
    '            'Changed the code to include submittals. 
    '            'SQL = "Select " & DBNameSpace & ".SSCPACCS.strTrackingNumber, " & _
    '            '"datReceivedDate, datCompleteDate, " & _
    '            '"Case " & _
    '            '"     When strEnforcementNeeded = 'True' Then 'True' " & _
    '            '"else 'No' " & _
    '            '"End as ACCFollowUp, " & _
    '            '"strComments  " & _
    '            '"from " & DBNameSpace & ".SSCPACCS, " & DBNameSpace & ".SSCPItemMaster,  " & _
    '            '"" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE   " & _
    '            '"where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPACCS.strTrackingNumber  " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber  " & _
    '            '"and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber  " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            '"and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365) " & _
    '            ' "and (strDelete is Null or strDelete <> 'True') " & _
    '            '"and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' "

    '            SQL = "Select " & _
    '            "AIRBranch.SSCPACCSHistory.strTrackingNumber||'-'||strSubmittalNumber as strTrackingNumber, " & _
    '            "datReceivedDate, datCompleteDate, " & _
    '            "Case " & _
    '            "     When strEnforcementNeeded = 'True' Then 'True' " & _
    '            "else 'No' " & _
    '            "End as ACCFollowUp, " & _
    '            "strComments  " & _
    '            "from " & DBNameSpace & ".SSCPACCSHistory, " & DBNameSpace & ".SSCPItemMaster,  " & _
    '            "" & DBNameSpace & ".SSCPFCEMaster, " & DBNameSpace & ".SSCPFCE   " & _
    '            "where " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPACCSHistory.strTrackingNumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSnumber  " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber  " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate <= " & DBNameSpace & ".SSCPFCE.datFCECompleted   " & _
    '            "and " & DBNameSpace & ".SSCPItemMaster.datCompleteDate >= (SSCPFCE.datFCECompleted - 365) " & _
    '            "and (strDelete is Null or strDelete <> 'True') " & _
    '            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = '" & txtOther.Text & "' " & _
    '            "order by datCompleteDate, strTrackingNumber desc "

    '            cmd = New OracleCommand(SQL, Conn)

    '            If Conn.State = ConnectionState.Closed Then
    '                Conn.Open()
    '            End If

    '            dr = cmd.ExecuteReader
    '            recExist = dr.Read
    '            dr.Close()

    '            If recExist = True Then
    '                cmd = New OracleCommand(SQL, Conn)

    '                If Conn.State = ConnectionState.Closed Then
    '                    Conn.Open()
    '                End If

    '                dr = cmd.ExecuteReader
    '                While dr.Read
    '                    FCEAnnualCertifications = FCEAnnualCertifications & "GA EPD Tracking Number:  " & vbTab & dr.Item("strTrackingNumber") & vbCrLf & _
    '                                                                      "Date Received:             " & vbTab & vbTab & Format(dr.Item("datReceivedDate"), "dd-MMM-yyyy") & vbCrLf & _
    '                                                                      "Date Report Completed:     " & vbTab & Format(dr.Item("datCompleteDate"), "dd-MMM-yyyy") & vbCrLf & _
    '                                                                      "Follow Up Action Taken:  " & vbTab & dr.Item("ACCFollowUp") & vbCrLf & _
    '                                                                      "Comments:                " & vbCrLf & vbTab & vbTab & vbTab & dr.Item("strComments") & vbCrLf & vbCrLf
    '                End While
    '            Else
    '                FCEAnnualCertifications = "N/A"
    '            End If

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "Commissioner"
    '            spValue.Value = Commissioner
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "Director"
    '            spValue.Value = Director
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "FiscalYear"
    '            spValue.Value = "Sep 30, " & FiscalYear
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "AIRSNumber"
    '            spValue.Value = AIRSNumber
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "FacilityName"
    '            spValue.Value = FacilityName
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "FacilityAddress"
    '            spValue.Value = FacilityAddress
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "ComplianceEngineer"
    '            spValue.Value = Engineer
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "Unit"
    '            spValue.Value = UserUnit
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "GCode"
    '            spValue.Value = UserAFSGCode
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            If Mid(AirProgramCode, 1, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "SIPSource"
    '                spValue.Value = "SIP Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "SIPSource"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            If Mid(AirProgramCode, 5, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "PSDSource"
    '                spValue.Value = "PSD Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "PSDSource"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            If Mid(AirProgramCode, 7, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "MACT61Source"
    '                spValue.Value = "MACT 61 Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "MACT61Source"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            If Mid(AirProgramCode, 8, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "NSPSSource"
    '                spValue.Value = "NSPS Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "NSPSSource"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            If Mid(AirProgramCode, 12, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "MACT63Source"
    '                spValue.Value = "MACT 63 Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "MACT63Source"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            If Mid(AirProgramCode, 13, 1) = "1" Then
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "TitleVSource"
    '                spValue.Value = "Title V Subject"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            Else
    '                'Do this at the beginning of every new entry 
    '                ParameterField = New CrystalDecisions.Shared.ParameterField
    '                spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '                ParameterField.ParameterFieldName = "TitleVSource"
    '                spValue.Value = "N/A"
    '                ParameterField.CurrentValues.Add(spValue)
    '                ParameterFields.Add(ParameterField)
    '            End If

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "FCECompleteDate"
    '            spValue.Value = FCECompleteDate
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "FCEComments"
    '            spValue.Value = FCEComment
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "Inspections"
    '            spValue.Value = FCEInspections
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "PerformanceTests"
    '            spValue.Value = FCEPerformanceTests
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "Reports"
    '            spValue.Value = FCEReports
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Do this at the beginning of every new entry 
    '            ParameterField = New CrystalDecisions.Shared.ParameterField
    '            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

    '            ParameterField.ParameterFieldName = "AnnualCertifications"
    '            spValue.Value = FCEAnnualCertifications
    '            ParameterField.CurrentValues.Add(spValue)
    '            ParameterFields.Add(ParameterField)

    '            'Load Variables into the Fields
    '            CRViewer.ParameterFieldInfo = ParameterFields

    '            'Display the Report
    '            CRViewer.ReportSource = rpt

    '        Else
    '            MsgBox("Unable to Print at this time.", MsgBoxStyle.Information, "Print Out")
    '            PrintOut.Close()
    '        End If

    '    Catch ex As Exception
    '        ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
    '    Finally

    '    End Try



    'End Sub

#End Region
#Region "SSPP"
    Sub PrintOutTitleVRenewals()
        Dim Commissioner As String = ""
        Dim Director As String = ""
        Dim ProgramManager As String = ""
        Dim rpt As New ReportClass

        If Oracledll = "2.111.6.20" Then
            rpt = New CRTitleVRenewal10
        Else
            rpt = New CRTitleVRenewal
        End If
        monitor.TrackFeature("Report." & rpt.ResourceName)

        Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
        Dim ParameterField As CrystalDecisions.Shared.ParameterField
        Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue
        Try
            ds = New DataSet
            SQL = "Select * " & _
            "from " & DBNameSpace & ".VW_Title_V_Renewals " & _
            "where datPermitIssued between '" & txtStartDate.Text & "' " & _
            "and '" & txtEndDate.Text & "' " & _
            "or datEffective between '" & txtStartDate.Text & "' " & _
            "and '" & txtEndDate.Text & "' "

            If txtSQLLine.Text <> "*" Then
                SQL = "Select * " & _
                "from " & DBNameSpace & ".VW_Title_V_Renewals " & _
                "where strApplicationNumber = '" & Replace(txtSQLLine.Text, "'", "''") & "' "
            End If

            da = New OracleDataAdapter(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If

            ds.EnforceConstraints = False
            da.Fill(ds, "VW_Title_V_Renewals")
            rpt.SetDataSource(ds)

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields
            SQL = "Select strDirector, strCommissioner, " & _
            "strSSPPProgramMang " & _
            "from " & DBNameSpace & ".LookUpAPBManagement "

            cmd = New OracleCommand(SQL, Conn)

            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                Commissioner = dr.Item("strCommissioner")
                Director = dr.Item("strDirector")
                ProgramManager = dr.Item("strSSPPProgramMang")
            End While
            dr.Close()

            'Do this at the beginning of every new enTry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "Commissioner"
            spValue.Value = Commissioner
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new enTry
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "Director"
            spValue.Value = Director
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new enTry
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ProgramManager"
            spValue.Value = ProgramManager
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Load Variables into the Fields
            CRViewer.ParameterFieldInfo = ParameterFields
            CRViewer.ReportSource = rpt

        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         

    End Sub
#End Region
    Sub OpenOrgChart()
        Try
            Dim rpt As New crOrganizationChart
            monitor.TrackFeature("Report." & rpt.ResourceName)
            Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
            Dim ParameterField As CrystalDecisions.Shared.ParameterField
            Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

            Dim BranchChief As String = ""
            Dim AdminOp As String = ""
            Dim AdminOp2 As String = ""
            Dim AmpPMII As String = ""
            Dim AMPAdmin As String = ""
            Dim AMPStaff As String = ""
            Dim DataAnalysisPMI As String = ""
            Dim DataAnalysisUnit As String = ""
            Dim OperationsPMI As String = ""
            Dim OperationsUnit As String = ""
            Dim MeteorologyPMI As String = ""
            Dim MeteorologyUnit As String = ""
            Dim QAPMI As String = ""
            Dim QAUnit As String = ""
            Dim Operations2PMI As String = ""
            Dim Operations2Unit As String = ""
            Dim MASPMII As String = ""
            Dim MASTeamLeader As String = ""
            Dim MASAdmin As String = ""
            Dim MASHourlyAdmin As String = ""
            Dim MASLawEnforcement As String = ""
            Dim MASStaff As String = ""
            Dim EFUPMI As String = ""
            Dim EFUUnit As String = ""
            Dim IMPMI As String = ""
            Dim IMUnit As String = ""
            Dim EnforcementPMI As String = ""
            Dim EnforcementUnit As String = ""
            Dim PublicAffairsPMI As String = ""
            Dim PublicAffairsUnit As String = ""
            Dim PIRTPMI As String = ""
            Dim PIRTAdmin As String = ""
            Dim PIRTUnit As String = ""
            Dim PlanningSupportPMII As String = ""
            Dim PlanningSupportAdmin As String = ""
            Dim FinancialPMI As String = ""
            Dim FinancialAdmin As String = ""
            Dim FinancialHourly As String = ""
            Dim FinancialStaff As String = ""
            Dim DataModelingPMI As String = ""
            Dim DataModelingUnit As String = ""
            Dim PlanningRegulatoryPMI As String = ""
            Dim PlanningRegulatoryUnit As String = ""
            Dim ISMPPMII As String = ""
            Dim ISMPAdmin As String = ""
            Dim ChemicalVOCPMI As String = ""
            Dim ChemicalVOCUnit As String = ""
            Dim CombustionMineralPMI As String = ""
            Dim CombustionMineralUnit As String = ""
            Dim DMUPMI As String = ""
            Dim DMUHourly As String = ""
            Dim DMUUnit As String = ""
            Dim SSCPPMII As String = ""
            Dim SSCPAdmin As String = ""
            Dim SSPPAdmin2 As String = ""
            Dim SSCPDistrictLiason As String = ""
            Dim AirToxicsPMI As String = ""
            Dim AirToxicsUnit As String = ""
            Dim ChemicalsMineralsPMI As String = ""
            Dim ChemicalsMineralsUnit As String = ""
            Dim VOCCombustionPMI As String = ""
            Dim VOCCombustionUnit As String = ""
            Dim SSPPPMII As String = ""
            Dim SSPPAdmin As String = ""
            Dim ChemicalPermittingPMI As String = ""
            Dim ChemicalPermittingunit As String = ""
            Dim CombustionPMI As String = ""
            Dim combustionUnit As String = ""
            Dim MineralsPMI As String = ""
            Dim MineralsUnit As String = ""
            Dim NOxPMI As String = ""
            Dim NOxUnit As String = ""
            Dim VOCPMI As String = ""
            Dim VOCUnit As String = ""

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            SQL = "Select " & _
            "strBranchChief " & _
            "from " & DBNameSpace & ".LookUpAPBManagement "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strBranchChief")) Then
                    BranchChief = "vacant"
                Else
                    BranchChief = dr.Item("strBranchChief")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AirBranchChief"
            spValue.Value = BranchChief
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram is null " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(42)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AdminOp = "vacant"
                Else
                    AdminOp = dr.Item("Staff")
                End If
            End While

            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AdministrativeOpManager"
            spValue.Value = AdminOp
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = ""

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AdministrativeOpManager2"
            spValue.Value = "vacant"
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(45)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AmpPMII = "vacant"
                Else
                    AmpPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AMPPMII"
            spValue.Value = AmpPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(46)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AMPAdmin = AMPAdmin & " " & vbCrLf
                Else
                    AMPAdmin = AMPAdmin & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AMPAdmin"
            spValue.Value = AMPAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
              "(strLastName|| ', ' ||strFirstName) as Staff " & _
              "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
              "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
              "and numbranch = '1' " & _
              "and numprogram = '6' " & _
              "and numunit is null " & _
              "and numEmployeeStatus = '1' " & _
              "and strIAIPPermissions like '%(72)%'  " & _
              "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AMPStaff = AMPStaff & " " & vbCrLf
                Else
                    AMPStaff = AMPStaff & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AMPStaff"
            spValue.Value = AMPStaff
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '25' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(47)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DataAnalysisPMI = "vacant"
                Else
                    DataAnalysisPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DataAnalysisPMI"
            spValue.Value = DataAnalysisPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '25' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(48)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DataAnalysisUnit = DataAnalysisUnit & vbCrLf
                Else
                    DataAnalysisUnit = DataAnalysisUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 5 Then
                Do Until i = 5
                    DataAnalysisUnit = DataAnalysisUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DataAnalysisUnit"
            spValue.Value = DataAnalysisUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '6' " & _
             "and numunit = '26' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(49)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    OperationsPMI = "vacant"
                Else
                    OperationsPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "OperationsPMI"
            spValue.Value = OperationsPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '26' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(50)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    OperationsUnit = OperationsUnit & vbCrLf
                Else
                    OperationsUnit = OperationsUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    OperationsUnit = OperationsUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "OperationsUnit"
            spValue.Value = OperationsUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '27' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(51)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MeteorologyPMI = "vacant"
                Else
                    MeteorologyPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MeteorologyPMI"
            spValue.Value = MeteorologyPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
              "(strLastName|| ', ' ||strFirstName) as Staff " & _
              "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
              "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
              "and numbranch = '1' " & _
              "and numprogram = '6' " & _
              "and numunit = '27' " & _
              "and numEmployeeStatus = '1' " & _
              "and strIAIPPermissions like '%(52)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MeteorologyUnit = MeteorologyUnit & vbCrLf
                Else
                    MeteorologyUnit = MeteorologyUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 4 Then
                Do Until i = 4
                    MeteorologyUnit = MeteorologyUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MeteorologyUnit"
            spValue.Value = MeteorologyUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '28' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(53)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    QAPMI = "vacant"
                Else
                    QAPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "QAPMI"
            spValue.Value = QAPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '28' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(54)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    QAUnit = QAUnit & vbCrLf
                Else
                    QAUnit = QAUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    QAUnit = QAUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "QAUnit"
            spValue.Value = QAUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '29' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(55)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    Operations2PMI = "vacant"
                Else
                    Operations2PMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "Operations2PMI"
            spValue.Value = Operations2PMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '6' " & _
            "and numunit = '29' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(56)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    Operations2Unit = Operations2Unit & vbCrLf
                Else
                    Operations2Unit = Operations2Unit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 9 Then
                Do Until i = 9
                    Operations2Unit = Operations2Unit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "Operations2Unit"
            spValue.Value = Operations2Unit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit is null " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(57)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASPMII = "vacant"
                Else
                    MASPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASPMII"
            spValue.Value = MASPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(73)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASTeamLeader = MASTeamLeader
                Else
                    MASTeamLeader = MASTeamLeader & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASTeamLeader"
            spValue.Value = MASTeamLeader
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(58)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASAdmin = MASAdmin
                Else
                    MASAdmin = MASAdmin & dr.Item("Staff")
                End If

            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASAdmin"
            spValue.Value = MASAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
           "(strLastName|| ', ' ||strFirstName) as Staff " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
           "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
           "and numbranch = '1' " & _
           "and numprogram = '1' " & _
           "and numunit is null " & _
           "and numEmployeeStatus = '1' " & _
           "and strIAIPPermissions like '%(75)%'  " & _
           "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASHourlyAdmin = MASHourlyAdmin
                Else
                    MASHourlyAdmin = MASHourlyAdmin & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASHourlyAdmin"
            spValue.Value = MASHourlyAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
         "(strLastName|| ', ' ||strFirstName) as Staff " & _
         "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
         "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
         "and numbranch = '1' " & _
         "and numprogram = '1' " & _
         "and numunit is null " & _
         "and numEmployeeStatus = '1' " & _
         "and strIAIPPermissions like '%(76)%'  " & _
         "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASStaff = MASStaff
                Else
                    MASStaff = MASStaff & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASStaff"
            spValue.Value = MASStaff
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
      "(strLastName|| ', ' ||strFirstName) as Staff " & _
      "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
      "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
      "and numbranch = '1' " & _
      "and numprogram = '1' " & _
      "and numunit is null " & _
      "and numEmployeeStatus = '1' " & _
      "and strIAIPPermissions like '%(74)%'  " & _
      "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MASLawEnforcement = MASLawEnforcement & vbCrLf
                Else
                    MASLawEnforcement = MASLawEnforcement & "<" & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MASLawEnforcement"
            spValue.Value = MASLawEnforcement
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit = '1' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(59)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    EFUPMI = "vacant"
                Else
                    EFUPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "EFUPMI"
            spValue.Value = EFUPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit = '1' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(60)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    EFUUnit = EFUUnit & vbCrLf
                Else
                    EFUUnit = EFUUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    EFUUnit = EFUUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "EFUUnit"
            spValue.Value = EFUUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit = '7' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(61)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    IMPMI = "vacant"
                Else
                    IMPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "IMPMI"
            spValue.Value = IMPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit = '7' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(62)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    IMUnit = IMUnit & vbCrLf
                Else
                    IMUnit = IMUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 5 Then
                Do Until i = 5
                    IMUnit = IMUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "IMUnit"
            spValue.Value = IMUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
                "(strLastName|| ', ' ||strFirstName) as Staff " & _
                "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                "and numbranch = '1' " & _
                "and numprogram = '1' " & _
                "and numunit = '8' " & _
                "and numEmployeeStatus = '1' " & _
                "and strIAIPPermissions like '%(63)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    EnforcementPMI = "vacant"
                Else
                    EnforcementPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "EnforcementPMI"
            spValue.Value = EnforcementPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit = '8' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(64)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    EnforcementUnit = EnforcementUnit & vbCrLf
                Else
                    EnforcementUnit = EnforcementUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 5 Then
                Do Until i = 5
                    EnforcementUnit = EnforcementUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "EnforcementUnit"
            spValue.Value = EnforcementUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit = '6' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(65)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PublicAffairsPMI = "vacant"
                Else
                    PublicAffairsPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PublicAffairsPMI"
            spValue.Value = PublicAffairsPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit = '6' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(66)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PublicAffairsUnit = PublicAffairsUnit & vbCrLf
                Else
                    PublicAffairsUnit = PublicAffairsUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 4 Then
                Do Until i = 4
                    PublicAffairsUnit = PublicAffairsUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PublicAffairsUnit"
            spValue.Value = PublicAffairsUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '1' " & _
            "and numunit = '3' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(67)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PIRTPMI = "vacant"
                Else
                    PIRTPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PIRTPMI"
            spValue.Value = PIRTPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit = '3' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(77)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PIRTAdmin = PIRTAdmin
                Else
                    PIRTAdmin = PIRTAdmin & dr.Item("Staff")
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PIRTAdmin"
            spValue.Value = PIRTAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '1' " & _
             "and numunit = '3' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(68)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PIRTUnit = PIRTUnit & vbCrLf
                Else
                    PIRTUnit = PIRTUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    PIRTUnit = PIRTUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PIRTUnit"
            spValue.Value = PIRTUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '2' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(11)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PlanningSupportPMII = "vacant"
                Else
                    PlanningSupportPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PlanningSupportPMII"
            spValue.Value = PlanningSupportPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)




            SQL = "select " & _
                "(strLastName|| ', ' ||strFirstName) as Staff " & _
                "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                "and numbranch = '1' " & _
                "and numprogram = '2' " & _
                "and numunit is null " & _
                "and numEmployeeStatus = '1' " & _
                "and strIAIPPermissions like '%(44)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PlanningSupportAdmin = PlanningSupportAdmin & vbCrLf
                Else
                    PlanningSupportAdmin = PlanningSupportAdmin & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PlanningSupportAdmin"
            spValue.Value = PlanningSupportAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '2' " & _
            "and numunit = '9' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(17)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    FinancialPMI = "vacant"
                Else
                    FinancialPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "FinancialPMI"
            spValue.Value = FinancialPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '2' " & _
            "and numunit = '9' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(18)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    FinancialAdmin = FinancialAdmin & vbCrLf
                Else
                    FinancialAdmin = FinancialAdmin & "*" & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "FinancialAdmin"
            spValue.Value = FinancialAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
           "(strLastName|| ', ' ||strFirstName) as Staff " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
           "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
           "and numbranch = '1' " & _
           "and numprogram = '2' " & _
           "and numunit = '9' " & _
           "and numEmployeeStatus = '1' " & _
           "and strIAIPPermissions like '%(70)%'  " & _
           "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    FinancialHourly = FinancialHourly
                Else
                    FinancialHourly = FinancialHourly & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "FinancialHourly"
            spValue.Value = FinancialHourly
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
          "(strLastName|| ', ' ||strFirstName) as Staff " & _
          "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
          "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
          "and numbranch = '1' " & _
          "and numprogram = '2' " & _
          "and numunit = '9' " & _
          "and numEmployeeStatus = '1' " & _
          "and strIAIPPermissions like '%(71)%'  " & _
          "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    FinancialStaff = FinancialStaff
                Else
                    FinancialStaff = FinancialStaff & dr.Item("Staff")
                End If
                i += 1
            End While
            dr.Close()

            If i < 2 Then
                Do Until i = 2
                    FinancialStaff = FinancialStaff & vbCrLf & "(vacant)"
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "FinancialStaff"
            spValue.Value = FinancialStaff
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '2' " & _
            "and numunit = '10' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(15)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DataModelingPMI = "vacant"
                Else
                    DataModelingPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DataModelingPMI"
            spValue.Value = DataModelingPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
                "(strLastName|| ', ' ||strFirstName) as Staff " & _
                "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                "and numbranch = '1' " & _
                "and numprogram = '2' " & _
                "and numunit = '10' " & _
                "and numEmployeeStatus = '1' " & _
                "and strIAIPPermissions like '%(16)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DataModelingUnit = DataModelingUnit & vbCrLf
                Else
                    DataModelingUnit = DataModelingUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 8 Then
                Do Until i = 8
                    DataModelingUnit = DataModelingUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DataModelingUnit"
            spValue.Value = DataModelingUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '2' " & _
             "and numunit = '11' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(12)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PlanningRegulatoryPMI = "vacant"
                Else
                    PlanningRegulatoryPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PlanningRegulatoryPMI"
            spValue.Value = PlanningRegulatoryPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '2' " & _
            "and numunit = '11' " & _
            "and numEmployeeStatus = '1' " & _
            "and (strIAIPPermissions like '%(14)%' or strIAIPPermissions like '%(13)%') " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    PlanningRegulatoryUnit = PlanningRegulatoryUnit & vbCrLf
                Else
                    PlanningRegulatoryUnit = PlanningRegulatoryUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 8 Then
                Do Until i = 8
                    PlanningRegulatoryUnit = PlanningRegulatoryUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PlanningRegulatoryUnit"
            spValue.Value = PlanningRegulatoryUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(2)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ISMPPMII = "vacant"
                Else
                    ISMPPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ISMPPMII"
            spValue.Value = ISMPPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(7)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ISMPAdmin = ISMPAdmin & vbCrLf
                Else
                    ISMPAdmin = ISMPAdmin & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ISMPAdmin"
            spValue.Value = ISMPAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '3' " & _
             "and numunit = '12' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(3)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalVOCPMI = "vacant"
                Else
                    ChemicalVOCPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalVOCPMI"
            spValue.Value = ChemicalVOCPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit = '12' " & _
            "and numEmployeeStatus = '1' " & _
            "and (strIAIPPermissions like '%(8)%' or strIAIPPermissions like '%(6)%')  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalVOCUnit = ChemicalVOCUnit & vbCrLf
                Else
                    ChemicalVOCUnit = ChemicalVOCUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    ChemicalVOCUnit = ChemicalVOCUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalVOCUnit"
            spValue.Value = ChemicalVOCUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
              "(strLastName|| ', ' ||strFirstName) as Staff " & _
              "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
              "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
              "and numbranch = '1' " & _
              "and numprogram = '3' " & _
              "and numunit = '13' " & _
              "and numEmployeeStatus = '1' " & _
              "and strIAIPPermissions like '%(4)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    CombustionMineralPMI = "vacant"
                Else
                    CombustionMineralPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "CombustionMineralPMI"
            spValue.Value = CombustionMineralPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)




            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit = '13' " & _
            "and numEmployeeStatus = '1' " & _
            "and (strIAIPPermissions like '%(9)%' or strIAIPPermissions like '%(5)%')  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    CombustionMineralUnit = CombustionMineralUnit & vbCrLf
                Else
                    CombustionMineralUnit = CombustionMineralUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    CombustionMineralUnit = CombustionMineralUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "CombustionMineralUnit"
            spValue.Value = CombustionMineralUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit = '14' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(69)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DMUPMI = "vacant"
                Else
                    DMUPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DMUPMI"
            spValue.Value = DMUPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
           "(strLastName|| ', ' ||strFirstName) as Staff " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
           "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
           "and numbranch = '1' " & _
           "and numprogram = '3' " & _
           "and numunit = '14' " & _
           "and numEmployeeStatus = '1' " & _
           "and strIAIPPermissions like '%(10)%'  " & _
           "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DMUHourly = DMUHourly & vbCrLf
                Else
                    DMUHourly = DMUHourly & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DMUHourly"
            spValue.Value = DMUHourly
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '3' " & _
            "and numunit = '14' " & _
            "and numEmployeeStatus = '1' " & _
            "and (strIAIPPermissions like '%(43)%' or strIAIPPermissions like '%(1)%')  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    DMUUnit = DMUUnit & vbCrLf
                Else
                    DMUUnit = DMUUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 8 Then
                Do Until i = 8
                    DMUUnit = DMUUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "DMUUnit"
            spValue.Value = DMUUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '4' " & _
             "and numunit is null " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(19)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSCPPMII = "vacant"
                Else
                    SSCPPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSCPPMII"
            spValue.Value = SSCPPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(20)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSCPAdmin = SSCPAdmin & vbCrLf
                Else
                    SSCPAdmin = SSCPAdmin & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSCPAdmin"
            spValue.Value = SSCPAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
           "(strLastName|| ', ' ||strFirstName) as Staff " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
           "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
           "and numbranch = '1' " & _
           "and numprogram = '4' " & _
           "and numunit is null " & _
           "and numEmployeeStatus = '1' " & _
           "and strIAIPPermissions like '%(27)%'  " & _
           "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSCPDistrictLiason = SSCPDistrictLiason & vbCrLf
                Else
                    SSCPDistrictLiason = SSCPDistrictLiason & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSCPDistrictLiason"
            spValue.Value = SSCPDistrictLiason
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '30' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(21)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AirToxicsPMI = "vacant"
                Else
                    AirToxicsPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AirToxicsPMI"
            spValue.Value = AirToxicsPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '30' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(22)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    AirToxicsUnit = AirToxicsUnit & vbCrLf
                Else
                    AirToxicsUnit = AirToxicsUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    AirToxicsUnit = AirToxicsUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "AirToxicsUnit"
            spValue.Value = AirToxicsUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '31' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(23)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalsMineralsPMI = "vacant"
                Else
                    ChemicalsMineralsPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalsMineralsPMI"
            spValue.Value = ChemicalsMineralsPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '31' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(24)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalsMineralsUnit = ChemicalsMineralsUnit & vbCrLf
                Else
                    ChemicalsMineralsUnit = ChemicalsMineralsUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    ChemicalsMineralsUnit = ChemicalsMineralsUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalsMineralsUnit"
            spValue.Value = ChemicalsMineralsUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '32' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(25)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    VOCCombustionPMI = "vacant"
                Else
                    VOCCombustionPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "VOCCombustionPMI"
            spValue.Value = VOCCombustionPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '4' " & _
            "and numunit = '32' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(26)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    VOCCombustionUnit = VOCCombustionUnit & vbCrLf
                Else
                    VOCCombustionUnit = VOCCombustionUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 6 Then
                Do Until i = 6
                    VOCCombustionUnit = VOCCombustionUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "VOCCombustionUnit"
            spValue.Value = VOCCombustionUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(28)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSPPPMII = "vacant"
                Else
                    SSPPPMII = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSPPPMII"
            spValue.Value = SSPPPMII
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
           "(strLastName|| ', ' ||strFirstName) as Staff " & _
           "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
           "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
           "and numbranch = '1' " & _
           "and numprogram = '5' " & _
           "and numunit is null " & _
           "and numEmployeeStatus = '1' " & _
           "and strIAIPPermissions like '%(30)%'  " & _
           "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSPPAdmin2 = SSPPAdmin2 & vbCrLf
                Else
                    SSPPAdmin2 = SSPPAdmin2 & dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSPPAdmin2"
            spValue.Value = SSPPAdmin2
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit is null " & _
            "and numEmployeeStatus = '1' " & _
            "and  strIAIPPermissions like '%(29)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    SSPPAdmin = SSPPAdmin & vbCrLf
                Else
                    SSPPAdmin = SSPPAdmin & "*" & dr.Item("Staff") & vbCrLf
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "SSPPAdmin"
            spValue.Value = SSPPAdmin
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit = '18' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(31)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalPermittingPMI = "vacant"
                Else
                    ChemicalPermittingPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalPermittingPMI"
            spValue.Value = ChemicalPermittingPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit = '18' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(32)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    ChemicalPermittingunit = ChemicalPermittingunit & vbCrLf
                Else
                    ChemicalPermittingunit = ChemicalPermittingunit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    ChemicalPermittingunit = ChemicalPermittingunit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "ChemicalPermittingunit"
            spValue.Value = ChemicalPermittingunit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
                 "(strLastName|| ', ' ||strFirstName) as Staff " & _
                 "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                 "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                 "and numbranch = '1' " & _
                 "and numprogram = '5' " & _
                 "and numunit = '19' " & _
                 "and numEmployeeStatus = '1' " & _
                 "and strIAIPPermissions like '%(33)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    CombustionPMI = "vacant"
                Else
                    CombustionPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()


            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "CombustionPMI"
            spValue.Value = CombustionPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
                "(strLastName|| ', ' ||strFirstName) as Staff " & _
                "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                "and numbranch = '1' " & _
                "and numprogram = '5' " & _
                "and numunit = '19' " & _
                "and numEmployeeStatus = '1' " & _
                "and strIAIPPermissions like '%(34)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    combustionUnit = combustionUnit & vbCrLf
                Else
                    combustionUnit = combustionUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    combustionUnit = combustionUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "combustionUnit"
            spValue.Value = combustionUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit = '20' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(35)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MineralsPMI = "vacant"
                Else
                    MineralsPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MineralsPMI"
            spValue.Value = MineralsPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '5' " & _
             "and numunit = '20' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(36)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    MineralsUnit = MineralsUnit & vbCrLf
                Else
                    MineralsUnit = MineralsUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    MineralsUnit = MineralsUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "MineralsUnit"
            spValue.Value = MineralsUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
                "(strLastName|| ', ' ||strFirstName) as Staff " & _
                "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
                "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
                "and numbranch = '1' " & _
                "and numprogram = '5' " & _
                "and numunit = '33' " & _
                "and numEmployeeStatus = '1' " & _
                "and strIAIPPermissions like '%(37)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    NOxPMI = "vacant"
                Else
                    NOxPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "NOxPMI"
            spValue.Value = NOxPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)



            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit = '33' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(38)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    NOxUnit = NOxUnit & vbCrLf
                Else
                    NOxUnit = NOxUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    NOxUnit = NOxUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "NOxUnit"
            spValue.Value = NOxUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            SQL = "select " & _
            "(strLastName|| ', ' ||strFirstName) as Staff " & _
            "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
            "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
            "and numbranch = '1' " & _
            "and numprogram = '5' " & _
            "and numunit = '34' " & _
            "and numEmployeeStatus = '1' " & _
            "and strIAIPPermissions like '%(39)%'  "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    VOCPMI = "vacant"
                Else
                    VOCPMI = dr.Item("Staff")
                End If
            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "VOCPMI"
            spValue.Value = VOCPMI
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            SQL = "select " & _
             "(strLastName|| ', ' ||strFirstName) as Staff " & _
             "from " & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".IAIPPermissions  " & _
             "where " & DBNameSpace & ".EPDUserProfiles.numUserID = " & DBNameSpace & ".IAIPPermissions.numUserID " & _
             "and numbranch = '1' " & _
             "and numprogram = '5' " & _
             "and numunit = '34' " & _
             "and numEmployeeStatus = '1' " & _
             "and strIAIPPermissions like '%(40)%'  " & _
            "order by strLastName "

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            While dr.Read
                If IsDBNull(dr.Item("Staff")) Then
                    VOCUnit = VOCUnit & vbCrLf
                Else
                    VOCUnit = VOCUnit & dr.Item("Staff") & vbCrLf
                End If
                i += 1
            End While
            dr.Close()

            If i < 7 Then
                Do Until i = 7
                    VOCUnit = VOCUnit & "(vacant)" & vbCrLf
                    i += 1
                Loop
            End If

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "VOCUnit"
            spValue.Value = VOCUnit
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)


            'Load Variables into the Fields
            CRViewer.ParameterFieldInfo = ParameterFields

            'Display the Report
            CRViewer.ReportSource = rpt


        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub OpenPhoneList()
        Try
            Dim rpt As New crAPBPhoneList
            monitor.TrackFeature("Report." & rpt.ResourceName)
            Dim ParameterFields As CrystalDecisions.Shared.ParameterFields
            Dim ParameterField As CrystalDecisions.Shared.ParameterField
            Dim spValue As CrystalDecisions.Shared.ParameterDiscreteValue

            Dim NameColumn As String = ""
            Dim RoomColumn As String = ""
            Dim PhoneColumn As String = ""

            Dim NameColumn1 As String = ""
            Dim RoomColumn1 As String = ""
            Dim PhoneColumn1 As String = ""

            Dim NameColumn2 As String = ""
            Dim RoomColumn2 As String = ""
            Dim PhoneColumn2 As String = ""

            Dim NameColumn3 As String = ""
            Dim RoomColumn3 As String = ""
            Dim PhoneColumn3 As String = ""

            'Do this just once at the start
            ParameterFields = New CrystalDecisions.Shared.ParameterFields

            If txtOther.Text = "" Then
                SQL = "select " & _
                "(strLastName||', '||strFirstName) as PhoneListName, " & _
                "strOffice, strPhone " & _
                "from " & DBNameSpace & ".EPDUSerProfiles " & _
                "where numBranch = '1' " & _
                "and numEmployeeStatus = '1' " & _
                "order by strLastName "
            Else
                SQL = txtOther.Text
            End If

            cmd = New OracleCommand(SQL, Conn)
            If Conn.State = ConnectionState.Closed Then
                Conn.Open()
            End If
            dr = cmd.ExecuteReader
            i = 0
            j = 0
            k = 0
            l = 0
            While dr.Read
                If IsDBNull(dr.Item("PhoneListName")) Then
                    NameColumn = ""
                Else
                    NameColumn = dr.Item("PhoneListName")
                End If
                If IsDBNull(dr.Item("strOffice")) Then
                    RoomColumn = ""
                Else
                    RoomColumn = dr.Item("strOffice")
                End If
                If IsDBNull(dr.Item("strPhone")) Then
                    PhoneColumn = ""
                Else
                    temp = dr.Item("strPhone")
                    PhoneColumn = Mid(dr.Item("strPhone"), 4, 3) & "-" & Mid(dr.Item("strPhone"), 7, 4)
                End If
                i += 1

              
                If k = 68 And l < 68 Then
                    NameColumn3 = NameColumn3 & NameColumn & vbCrLf
                    If NameColumn.Length > 22 Then
                        RoomColumn3 = RoomColumn3 & vbCrLf & RoomColumn & vbCrLf
                        PhoneColumn3 = PhoneColumn3 & vbCrLf & PhoneColumn & vbCrLf
                        l += 2
                    Else
                        RoomColumn3 = RoomColumn3 & RoomColumn & vbCrLf
                        PhoneColumn3 = PhoneColumn3 & PhoneColumn & vbCrLf
                        l += 1
                    End If
                End If
                If j = 68 And k < 68 Then
                    NameColumn2 = NameColumn2 & NameColumn & vbCrLf
                    If NameColumn.Length > 22 Then
                        RoomColumn2 = RoomColumn2 & vbCrLf & RoomColumn & vbCrLf
                        PhoneColumn2 = PhoneColumn2 & vbCrLf & PhoneColumn & vbCrLf
                        k += 2
                    Else
                        RoomColumn2 = RoomColumn2 & RoomColumn & vbCrLf
                        PhoneColumn2 = PhoneColumn2 & PhoneColumn & vbCrLf
                        k += 1
                    End If
                End If
                If j < 68 Then
                    NameColumn1 = NameColumn1 & NameColumn & vbCrLf
                    If NameColumn.Length > 22 Then
                        RoomColumn1 = RoomColumn1 & vbCrLf & RoomColumn & vbCrLf
                        PhoneColumn1 = PhoneColumn1 & vbCrLf & PhoneColumn & vbCrLf
                        j += 2
                    Else
                        RoomColumn1 = RoomColumn1 & RoomColumn & vbCrLf
                        PhoneColumn1 = PhoneColumn1 & PhoneColumn & vbCrLf
                        j += 1
                    End If
                End If

            End While
            dr.Close()

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "NameColumn1"
            spValue.Value = NameColumn1
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "RoomColumn1"
            spValue.Value = RoomColumn1
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PhoneColumn1"
            spValue.Value = PhoneColumn1
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "NameColumn2"
            spValue.Value = NameColumn2
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "RoomColumn2"
            spValue.Value = RoomColumn2
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PhoneColumn2"
            spValue.Value = PhoneColumn2
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "NameColumn3"
            spValue.Value = NameColumn3
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "RoomColumn3"
            spValue.Value = RoomColumn3
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Do this at the beginning of every new entry 
            ParameterField = New CrystalDecisions.Shared.ParameterField
            spValue = New CrystalDecisions.Shared.ParameterDiscreteValue

            ParameterField.ParameterFieldName = "PhoneColumn3"
            spValue.Value = PhoneColumn3
            ParameterField.CurrentValues.Add(spValue)
            ParameterFields.Add(ParameterField)

            'Load Variables into the Fields
            CRViewer.ParameterFieldInfo = ParameterFields

            'Display the Report
            CRViewer.ReportSource = rpt


        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub MmiBack_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MmiBack.Click
        Try
             
            PrintOut = Nothing
            Me.Close()
        Catch ex As Exception
            ErrorReport(ex, Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub mmiHelp_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles mmiHelp.Click
            OpenHelpUrl(Me)
    End Sub

End Class