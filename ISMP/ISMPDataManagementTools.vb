Imports System.DateTime
Imports System.Data.OracleClient
Imports System.IO

Public Class ISMPDataManagementTools
    Inherits DefaultForm

    Dim SQL, SQL2, SQL3 As String
    Dim cmd, cmd2, cmd3 As OracleCommand
    Dim dr, dr2, dr3 As OracleDataReader
    Dim recExist As Boolean
    Dim dsWebPublisher As DataSet
    Dim daWebPublisher As OracleDataAdapter
    Dim dsStaff As DataSet
    Dim dsApplicationGrid As DataSet
    Dim daStaff As New OracleDataAdapter
    Dim daApplicationGrid As OracleDataAdapter
    Dim ds As DataSet
    Dim da As OracleDataAdapter
    Dim airsno As String
    Dim password, encryptpwd As String
    Dim Startdate As String
    Dim EndDate As String
    Dim dsErrorLog As DataSet
    Dim daErrorLog As OracleDataAdapter
    Dim dsWebErrorLog As DataSet
    Dim daWebErrorLog As OracleDataAdapter
    Dim Emssionyear As String = Now.Year
    Dim year As String
    Dim inventoryYear As Integer
    Dim recExist2 As Boolean
    Dim dsWorkEntry As DataSet
    Dim daWorkEnTry As OracleDataAdapter
    Public dsES As DataSet
    Public daES As OracleDataAdapter
    Dim dsViewCount As DataSet
    Dim daViewCount As OracleDataAdapter
    Dim TriggerStatus As String
    Dim dsAFSVerify As DataSet
    Dim daAFSVerify As OracleDataAdapter
    Dim cmdBuild As OracleCommandBuilder

    Private Sub DEVDataManagementTools_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles MyBase.Load
        monitor.TrackFeature("Forms." & Me.Name)
        Try

            Panel1.Text = "Select a Function..."
            Panel2.Text = UserName
            Panel3.Text = OracleDate

            LoadPermissions()
            loadYear()
            loadMailOutYear()
            loadEIYear()
            loadEIMailOutYear()
            loadEIEnrollmentYear()
            loadESEnrollmentYear()
            loadEIType()
            rdbDEVTransfer.Text = Conn.DataSource.ToString & " --> DEV "
            rdbTESTTransfer.Text = Conn.DataSource.ToString & " --> TEST "
            lblEITypeYear.Text = cboEIMailoutYear.SelectedItem

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub

#Region "Page Load Functions"
    Sub LoadWebPublisherDataGrid(ByVal AppNum As String)
        Dim SQLLine As String

        Try
            
            

            If AppNum = "Load" Then
                SQLLine = ""
            Else
                SQLLine = " and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & AppNum & "' "
            End If

            SQL = "select " & _
            "to_Number(" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber) as ApplicationNumber, " & _
            "case " & _
            "When datDraftIssued is Null then ' ' " & _
            "ELSE to_char(datDraftIssued, 'RRRR-MM-dd') " & _
            "END datDraftIssued, " & _
            "case " & _
            "When datPermitIssued is Null then ' ' " & _
            "ELSE to_Char(datPermitIssued, 'RRRR-MM-dd') " & _
            "END datPermitIssued, " & _
            "case " & _
            "When datExperationDate is Null then ' ' " & _
            "ELSE to_char(datExperationDate, 'RRRR-MM-dd') " & _
            "END datExperationDate, " & _
            "strFacilityName, " & _
            "case  " & _
            "        when strPermitNumber is NULL then ' '  " & _
            "         else substr(strPermitNumber, 1, 4)|| '-' ||substr(strPermitNumber, 5, 3)|| '-'  " & _
            "        ||substr(strPermitNumber, 8, 4)|| '-' ||substr(strPermitNumber, 12, 1)|| '-'           " & _
            "        ||substr(strPermitNumber, 13, 2)|| '-' ||substr(strPermitNumber, 15, 1) " & _
            "end As strPermitNumber, " & _
            "Case " & _
            "when datFinalizedDate is Null then ' ' " & _
            "Else to_char(datFinalizedDate, 'RRRR-MM-dd') " & _
            "End datFinalizedDate, " & _
            "strApplicationTypeDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationTracking, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".LookUpApplicationTypes " & _
            "where " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode = strApplicationType " & _
            "and " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber " & _
            "and (datDraftIssued is Not Null or datPermitIssued is Not Null or datEPAStatesNotified is Not Null) " & _
            "and datFinalOnWeb is Null " & _
            "and datFinalizedDate is Null " & _
            "and (strApplicationType = '17' or strApplicationType = '14' or strApplicationType = '16' " & _
            " or strApplicationType = '15' or strApplicationType = '26' or strApplicationType = '19' " & _
            " or strApplicationType = '20' or strApplicationType = '22' or strApplicationType = '21')" & SQLLine

            SQL = "SELECT " & _
            "TO_NUMBER(" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber) AS ApplicationNumber,  " & _
            "CASE  " & _
            "   WHEN datDraftIssued IS NULL THEN ' '  " & _
            "   ELSE TO_CHAR(datDraftIssued, 'RRRR-MM-dd') " & _
            "END datDraftIssued,  " & _
            "CASE  " & _
            "   WHEN datPermitIssued IS NULL THEN ' '  " & _
            "   ELSE TO_CHAR(datPermitIssued, 'RRRR-MM-dd') " & _
            "END datPermitIssued,  " & _
            "CASE  " & _
            "   WHEN datExperationDate IS NULL THEN ' '  " & _
            "   ELSE TO_CHAR(datExperationDate, 'RRRR-MM-dd') " & _
            "END datExperationDate,  " & _
            "strFacilityName,  " & _
            "CASE   " & _
            "   WHEN strPermitNumber IS NULL THEN ' '   " & _
            "   ELSE SUBSTR(strPermitNumber, 1, 4)|| '-' ||SUBSTR(strPermitNumber, 5, 3)|| '-'   " & _
            "    ||SUBSTR(strPermitNumber, 8, 4)|| '-' ||SUBSTR(strPermitNumber, 12, 1)|| '-'         " & _
            "    ||SUBSTR(strPermitNumber, 13, 2)|| '-' ||SUBSTR(strPermitNumber, 15, 1)  " & _
            "END AS strPermitNumber,  " & _
            "CASE  " & _
            "   WHEN datFinalizedDate IS NULL THEN ' '  " & _
            "   ELSE TO_CHAR(datFinalizedDate, 'RRRR-MM-dd') " & _
            "END datFinalizedDate,  " & _
            "strApplicationTypeDesc  " & _
            "from " & DBNameSpace & ".SSPPApplicationTracking, " & DBNameSpace & ".SSPPApplicationData,  " & _
            "" & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".LookUpApplicationTypes " & _
            "WHERE " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
            "AND " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode = strApplicationType  " & _
            "AND " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber " & _
            "AND ( " & _
            "(strApplicationType = '14' OR strApplicationType = '16' OR strApplicationType = '17') " & _
            "AND (datDraftOnWeb IS NULL OR datPNExpires IS NULL " & _
            "OR datEPAStatesNotified IS NULL OR datFinalOnWeb IS NULL " & _
            "OR datEPANotified IS NULL OR datEffective IS NULL " & _
            "OR datExperationDate IS NULL) " & _
            "OR " & _
            "(strApplicationType = '19' OR strApplicationType = '20') " & _
            "AND (datEPAStatesNotifiedAppRec IS NULL  " & _
            "OR datFinalOnWeb IS NULL OR datEPANotified IS NULL " & _
            "OR datEffective IS NULL OR datExperationDate IS NULL) " & _
            "OR " & _
            "(strApplicationType = '21' OR strApplicationType = '22') " & _
            "AND (datEPAStatesNotifiedAppRec IS NULL OR datDraftOnWeb IS NULL " & _
            "OR datPNExpires IS NULL OR datEPAStatesNotified IS NULL " & _
            "OR datFinalOnWeb IS NULL OR datEPANotified IS NULL " & _
            "OR datEffective IS NULL OR datExperationDate IS NULL) " & _
            "OR " & _
            "(strApplicationType = '15' OR strApplicationType = '26') " & _
            "AND (datFinalOnWeb IS NULL OR datEPANotified IS NULL " & _
            "OR datEffective IS NULL OR datExperationDate IS NULL) " & _
            "or " & _
            "strApplicationType = '2' " & _
            "OR " & _
            "strApplicationType = '11' " & _
            "and substr(strTrackedRules, 1, 1) = '1' " & _
            ") " & _
            "and datFinalizedDate is Null " & SQLLine & _
            " order by ApplicationNumber Desc "

            dsWebPublisher = New DataSet

            daWebPublisher = New OracleDataAdapter(SQL, conn)

            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            Try
                

                daWebPublisher.Fill(dsWebPublisher, "WebPublisher")
                dgrWebPublisher.DataSource = dsWebPublisher
                dgrWebPublisher.DataMember = "WebPublisher"

            Catch ex As Exception
                MsgBox(ex.ToString())
            End Try

            txtTVCount.Text = dsWebPublisher.Tables(0).Rows.Count

             
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub FormatWebPublisherDataGrid()
        Try
            
            'Formatting our DataGrid
            Dim objGrid As New DataGridTableStyle
            Dim objtextcol As New DataGridTextBoxColumn
            Dim objbooleancol As New DataGridBoolColumn

            objGrid.AlternatingBackColor = Color.WhiteSmoke
            objGrid.MappingName = "WebPublisher"
            objGrid.RowHeadersVisible = False
            objGrid.AllowSorting = True
            objGrid.ReadOnly = True

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "ApplicationNumber"
            objtextcol.HeaderText = "APL #"
            objtextcol.Width = 80
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strFacilityName"
            objtextcol.HeaderText = "Facility Name"
            objtextcol.Width = 250
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strPermitNumber"
            objtextcol.HeaderText = "Permit Number"
            objtextcol.Width = 150
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strApplicationTypeDesc"
            objtextcol.HeaderText = "App Type"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "datDraftIssued"
            objtextcol.HeaderText = "Draft Issued"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "datPermitIssued"
            objtextcol.HeaderText = "Final Action"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "datExpirationDate"
            objtextcol.HeaderText = "Experation Date"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            'Applying the above formating 
            dgrWebPublisher.TableStyles.Clear()
            dgrWebPublisher.TableStyles.Add(objGrid)

            'Setting the DataGrid Caption, which defines the table title
            dgrWebPublisher.CaptionText = "Web Publisher Active Title V Applications"
            dgrWebPublisher.ColumnHeadersVisible = True
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub CheckForLinks()
        Dim MasterApplication As String
        Dim ApplicationCount As String = 0

        Try
            
            MasterApplication = ""
            lbLinkApplications.Items.Clear()

            If txtWebPublisherApplicationNumber.Text <> "" Then
                SQL = "Select " & _
                "strMasterApplication, strApplicationNumber " & _
                "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                "where strApplicationNumber = '" & txtWebPublisherApplicationNumber.Text & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = True Then
                    MasterApplication = dr.Item("strMasterApplication")
                Else
                    MasterApplication = ""
                    lbLinkApplications.Items.Clear()
                    lblLinkWarning.Visible = False
                End If
                If MasterApplication <> "" Then
                    SQL = "Select " & _
                    "strMasterApplication, strApplicationNumber " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strMasterApplication = '" & MasterApplication & "' " & _
                    "order by strApplicationNumber "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        lbLinkApplications.Items.Add(dr.Item("strApplicationNumber"))
                        ApplicationCount += 1
                    End While
                    lblLinkWarning.Visible = True
                End If
            Else
                lbLinkApplications.Items.Clear()
                lblLinkWarning.Visible = False
            End If
            If lbLinkApplications.Items.Contains(txtWebPublisherApplicationNumber.Text) Then
            Else
                lbLinkApplications.Items.Add(txtWebPublisherApplicationNumber.Text)
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Sub LoadPermissions()
        Try
            
            TCDMUTools.TabPages.Remove(TPAFSFileGenerator)
            TCDMUTools.TabPages.Remove(TPWebPublishing)
            TCDMUTools.TabPages.Remove(TPTVEmails)
            TCDMUTools.TabPages.Remove(TPAddNewFacility)
            TCDMUTools.TabPages.Remove(TPEmissionInventory)
            TCDMUTools.TabPages.Remove(TPFeeTools)
            TCDMUTools.TabPages.Remove(TPTitleVRenewals)
            TCDMUTools.TabPages.Remove(TPErrorLog)
            TCDMUTools.TabPages.Remove(TPWebErrorLog)
            TCDMUTools.TabPages.Remove(TPLatitudeLongitude)
            TCDMUTools.TabPages.Remove(TPESTools)
            TCDMUTools.TabPages.Remove(TPUpdateDEVTest)
            TCDMUTools.TabPages.Remove(TPAFSValidator)

            'AFS Users
            If AccountArray(2, 1) = "1" Then
                TCDMUTools.TabPages.Add(TPAFSFileGenerator)
                TCDMUTools.TabPages.Add(TPAddNewFacility)
                TCDMUTools.TabPages.Add(TPLatitudeLongitude)

                LoadOtherComboBoxes()

                ISMPDMU.Width = 800
                ISMPDMU.Height = 730
            End If
            'Web Publishers
            If AccountArray(2, 2) = "1" Then
                TCDMUTools.TabPages.Add(TPWebPublishing)
                TCDMUTools.TabPages.Add(TPTVEmails)
                TCDMUTools.TabPages.Add(TPTitleVRenewals)

                LoadWebPublisherDataGrid("Load")
                FormatWebPublisherDataGrid()

                DTPNotifiedAppReceived.Text = OracleDate
                DTPDraftOnWeb.Text = OracleDate
                DTPEffectiveDateofPermit.Text = OracleDate
                DTPEPANotifiedPermitOnWeb.Text = OracleDate
                DTPEPAStatesNotified.Text = OracleDate
                DTPFinalOnWeb.Text = OracleDate
                DTPTitleVRenewalStart.Text = OracleDate
                DTPTitleVRenewalEnd.Text = OracleDate
                DTPTitleVRenewalStart.Text = OracleDate
                DTPPNExpires.Text = OracleDate
                DTPExperationDate.Text = OracleDate
                DTPTitleVRenewalEnd.Text = Format(CDate(OracleDate).AddMonths(1), "dd-MMM-yyyy")

                ISMPDMU.Width = 800
                ISMPDMU.Height = 600

            End If
            If AccountArray(2, 3) = "1" Or AccountArray(2, 4) = "1" Then
                TCDMUTools.TabPages.Add(TPEmissionInventory)
                TCDMUTools.TabPages.Add(TPESTools)
                TCDMUTools.TabPages.Add(TPFeeTools)
                TCDMUTools.TabPages.Add(TPErrorLog)
                rdbViewUnresolvedErrors.Checked = True
                FormatErrorListGrid()

                TCDMUTools.TabPages.Add(TPWebErrorLog)
                Me.rdbUnresolvedWebErrors.Checked = True
                FormatWebErrorListGrid()

                If SystemInformation.PrimaryMonitorSize.Width > 1200 Then
                    ISMPDMU.Width = (SystemInformation.PrimaryMonitorSize.Width - 400)
                Else
                    ISMPDMU.Width = 800
                End If
                ISMPDMU.Height = 1000
                TCDMUTools.TabPages.Add(TPUpdateDEVTest)
                TCDMUTools.TabPages.Add(TPAFSValidator)
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
    Private Sub LoadDataSetInformation()
        Try
            SQL = "select " & _
            "(strLastName||', '||strFirstName) as UserName,  " & _
            "numUserID  " & _
            "from AIRBranch.EPDUserProfiles  " & _
            "order by strLastName  "

            dsStaff = New DataSet

            daStaff = New OracleDataAdapter(SQL, conn)

            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            daStaff.Fill(dsStaff, "Staff")

           
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub FormatErrorListGrid()
        Try
            
            'Formatting our DataGrid
            Dim objGrid As New DataGridTableStyle
            Dim objtextcol As New DataGridTextBoxColumn

            objGrid.AlternatingBackColor = Color.WhiteSmoke
            objGrid.MappingName = "ErrorLog"
            objGrid.AllowSorting = True
            objGrid.ReadOnly = True
            objGrid.RowHeadersVisible = False

            '0
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strErrorNumber"
            objtextcol.HeaderText = "Error #"
            objtextcol.Width = 50
            objGrid.GridColumnStyles.Add(objtextcol)

            '1
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "ErrorUser"
            objtextcol.HeaderText = "User"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            '2
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strErrorLocation"
            objtextcol.HeaderText = "Error Location"
            objtextcol.Width = 180
            objGrid.GridColumnStyles.Add(objtextcol)

            '3
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "ErrorDate"
            objtextcol.HeaderText = "Error Date"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            '4
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strSolution"
            objtextcol.HeaderText = "Error Solution"
            objtextcol.Width = 200
            objGrid.GridColumnStyles.Add(objtextcol)

            '5
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strErrorMessage"
            objtextcol.HeaderText = "Error Message"
            objtextcol.Width = 400
            objGrid.GridColumnStyles.Add(objtextcol)

            'Applying the above formating 
            dgrErrorList.TableStyles.Clear()
            dgrErrorList.TableStyles.Add(objGrid)

            'Setting the DataGrid Caption, which defines the table title
            dgrErrorList.CaptionText = "Error Log"
            dgrErrorList.ColumnHeadersVisible = True

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         

    End Sub
    Sub FormatWebErrorListGrid()
        Try
            
            'Formatting our DataGrid
            Dim objGrid As New DataGridTableStyle
            Dim objtextcol As New DataGridTextBoxColumn

            objGrid.AlternatingBackColor = Color.WhiteSmoke
            objGrid.MappingName = "WebErrorLog"
            objGrid.AllowSorting = True
            objGrid.ReadOnly = True
            objGrid.RowHeadersVisible = False

            '0
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "NumError"
            objtextcol.HeaderText = "Error #"
            objtextcol.Width = 50
            objGrid.GridColumnStyles.Add(objtextcol)

            '1
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strUserEmail"
            objtextcol.HeaderText = "User Email"
            objtextcol.Width = 200
            objGrid.GridColumnStyles.Add(objtextcol)

            '2
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strErrorPage"
            objtextcol.HeaderText = "Web Page"
            objtextcol.Width = 180
            objGrid.GridColumnStyles.Add(objtextcol)

            '3
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "dateTimeStamp"
            objtextcol.HeaderText = "Error Time Stamp"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            '4
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strErrorMsg"
            objtextcol.HeaderText = "Details"
            objtextcol.Width = 400
            objGrid.GridColumnStyles.Add(objtextcol)

            '5
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strSolution"
            objtextcol.HeaderText = "Error Solution"
            objtextcol.Width = 200
            objGrid.GridColumnStyles.Add(objtextcol)

            '6
            'Setting the Column Headings
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strIPAddress"
            objtextcol.HeaderText = "IP Address"
            objtextcol.Width = 100
            objGrid.GridColumnStyles.Add(objtextcol)

            'Applying the above formating 
            dgrWebErrorList.TableStyles.Clear()
            dgrWebErrorList.TableStyles.Add(objGrid)

            'Setting the DataGrid Caption, which defines the table title
            dgrWebErrorList.CaptionText = "Web Error Log"
            dgrWebErrorList.ColumnHeadersVisible = True

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Private Sub LoadOtherComboBoxes()
        Try
            
            cboCDSOperationalStatus.Items.Add("O - Operating")
            cboCDSOperationalStatus.Items.Add("P - Planned")
            cboCDSOperationalStatus.Items.Add("C - Under Construction")
            cboCDSOperationalStatus.Items.Add("T - Temporarily Closed")
            cboCDSOperationalStatus.Items.Add("X - Permanently Closed")
            cboCDSOperationalStatus.Items.Add("I - Seasonal Operation")

            cboCDSClassCode.Items.Add("A - MAJOR")
            cboCDSClassCode.Items.Add("B - MINOR")
            cboCDSClassCode.Items.Add("C - UNKNOWN")
            cboCDSClassCode.Items.Add("SM - SYNTHETIC MINOR")
            cboCDSClassCode.Items.Add("PR - PERMIT BY RULE")
            cboCDSClassCode.Items.Add("U - UNDEFINED")

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub loadYear()
        Dim year As String

        Try
            SQL = "Select " & _
            "distinct intESYear " & _
            "from " & DBNameSpace & ".esschema " & _
            "order by intESYear desc"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
             dr.Read()
            Do
                year = dr("intESYear")
                cboYear.Items.Add(year)

            Loop While dr.Read
            cboYear.SelectedIndex = 0

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
             
        End Try
    End Sub
    Private Sub loadMailOutYear()
        'Load MailOut Year dropdown boxes
        Dim year As Integer
        Dim SQL As String

        Try
            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If
        

            SQL = "Select distinct STRESYEAR " & _
                  "from " & DBNameSpace & ".esmailout " & _
                  "order by STRESYEAR desc"
            Dim cmd As New OracleCommand(SQL, conn)

            Dim dr As OracleDataReader = cmd.ExecuteReader()
            dr.Read()
            year = dr("STRESYEAR") + 1
            cboMailoutYear.Items.Add(year)
            Do
                year = dr("STRESYEAR")
                cboMailoutYear.Items.Add(year)
            Loop While dr.Read
            cboMailoutYear.SelectedIndex = 0

      
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
#End Region

#Region "Subs and Functions"
    Sub LoadWebPublisherApplicationData()
        Try
            
            Dim AppType As String = ""

            SQL = "Select " & _
            "datDraftOnWeb, datEPAStatesNotified, " & _
            "datFinalONWeb, DatEPANotified, " & _
            "datEffective, strTargeted, " & _
            "datEPAStatesNotifiedAppRec, " & _
            "datExperationDate, datPNExpires, " & _
            "strApplicationType " & _
            "from " & DBNameSpace & ".SSPPApplicationTracking, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".SSPPApplicationMaster " & _
            "where " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber  " & _
            "and " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber = '" & txtWebPublisherApplicationNumber.Text & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = True Then
                If IsDBNull(dr.Item("datEPAStatesNotifiedAppRec")) Then
                    chbNotifiedAppReceived.Checked = False
                Else
                    chbNotifiedAppReceived.Checked = True
                    DTPNotifiedAppReceived.Text = dr.Item("datEPAStatesNotifiedAppRec")
                End If
                If IsDBNull(dr.Item("datDraftOnWeb")) Then
                    chbDraftOnWeb.Checked = False
                Else
                    chbDraftOnWeb.Checked = True
                    DTPDraftOnWeb.Text = dr.Item("datDraftOnWEb")
                End If
                If IsDBNull(dr.Item("datEPAStatesNotified")) Then
                    chbEPAandStatesNotified.Checked = False
                Else
                    chbEPAandStatesNotified.Checked = True
                    DTPEPAStatesNotified.Text = dr.Item("datEPAStatesNotified")
                End If
                If IsDBNull(dr.Item("datFinalOnWeb")) Then
                    chbFinalOnWeb.Checked = False
                Else
                    chbFinalOnWeb.Checked = True
                    DTPFinalOnWeb.Text = dr.Item("datFinalOnWeb")
                End If
                If IsDBNull(dr.Item("datEPANotified")) Then
                    chbEPANotifiedPermitOnWeb.Checked = False
                Else
                    chbEPANotifiedPermitOnWeb.Checked = True
                    DTPEPANotifiedPermitOnWeb.Text = dr.Item("datEPANotified")
                End If
                If IsDBNull(dr.Item("datEffective")) Then
                    chbEffectiveDateOfPermit.Checked = False
                Else
                    chbEffectiveDateOfPermit.Checked = True
                    DTPEffectiveDateofPermit.Text = dr.Item("datEffective")
                End If
                If IsDBNull(dr.Item("strTargeted")) Then
                    txtEPATargetedComments.Text = ""
                Else
                    txtEPATargetedComments.Text = dr.Item("strTargeted")
                End If
                If IsDBNull(dr.Item("datExperationDate")) Then
                    chbExpirationDate.Checked = False
                    DTPExperationDate.Text = OracleDate
                Else
                    chbExpirationDate.Checked = True
                    DTPExperationDate.Text = dr.Item("datExperationDate")
                End If
                If IsDBNull(dr.Item("strApplicationType")) Then
                    chbPNExpires.Visible = False
                    DTPPNExpires.Visible = False
                Else
                    AppType = dr.Item("strApplicationType")
                    Select Case AppType
                        Case 22
                            chbPNExpires.Visible = True
                        Case 21
                            chbPNExpires.Visible = True
                        Case 14
                            chbPNExpires.Visible = True
                        Case 16
                            chbPNExpires.Visible = True
                        Case Else
                            chbPNExpires.Visible = False
                            DTPPNExpires.Visible = False
                    End Select
                End If
                If IsDBNull(dr.Item("datPNExpires")) Then
                    chbPNExpires.Checked = False
                    DTPPNExpires.Text = OracleDate
                Else
                    chbPNExpires.Checked = True
                    DTPPNExpires.Text = dr.Item("datPNExpires")
                End If


            End If
            CheckForLinks()

            If txtWebPublisherApplicationNumber.Text <> "" Then
                'LoadWebPublisherDataGrid(txtWebPublisherApplicationNumber.Text)
            End If

             
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub SaveWebPublisherData()
        Dim EPAStatesNotifiedAppRec As String
        Dim DraftOnWeb As String
        Dim EPAStatesNotified As String
        Dim FinalOnWeb As String
        Dim EPANotifiedPermitOnWeb As String
        Dim EffectiveDateOnPermit As String
        Dim TargetedComments As String
        Dim ExperationDate As String
        Dim PNExpires As String

        Try
            
            If chbNotifiedAppReceived.Checked = True Then
                EPAStatesNotifiedAppRec = DTPNotifiedAppReceived.Text
            Else
                EPAStatesNotifiedAppRec = ""
            End If
            If chbDraftOnWeb.Checked = True Then
                DraftOnWeb = DTPDraftOnWeb.Text
            Else
                DraftOnWeb = ""
            End If
            If chbEPAandStatesNotified.Checked = True Then
                EPAStatesNotified = DTPEPAStatesNotified.Text
            Else
                EPAStatesNotified = ""
            End If
            If chbFinalOnWeb.Checked = True Then
                FinalOnWeb = DTPFinalOnWeb.Text
            Else
                FinalOnWeb = ""
            End If
            If chbEPANotifiedPermitOnWeb.Checked = True Then
                EPANotifiedPermitOnWeb = DTPEPANotifiedPermitOnWeb.Text
            Else
                EPANotifiedPermitOnWeb = ""
            End If
            If chbEffectiveDateOfPermit.Checked = True Then
                EffectiveDateOnPermit = DTPEffectiveDateofPermit.Text
            Else
                EffectiveDateOnPermit = ""
            End If
            If chbExpirationDate.Checked = True Then
                ExperationDate = DTPExperationDate.Text
            Else
                ExperationDate = ""
            End If
            If txtEPATargetedComments.Text <> "" Then
                TargetedComments = Replace(txtEPATargetedComments.Text, "'", "''")
                TargetedComments = Mid(TargetedComments, 1, 4000)
            Else
                TargetedComments = ""
            End If
            If chbPNExpires.Checked = True Then
                PNExpires = DTPPNExpires.Text
            Else
                PNExpires = ""
            End If

            If txtWebPublisherApplicationNumber.Text <> "" Then
                SQL = "Update " & DBNameSpace & ".SSPPApplicationTracking set " & _
                "datDraftOnWeb = '" & DraftOnWeb & "', " & _
                "datEPAStatesNotified = '" & EPAStatesNotified & "', " & _
                "datFinalOnWeb = '" & FinalOnWeb & "', " & _
                "datEPANotified = '" & EPANotifiedPermitOnWeb & "', " & _
                "datEffective = '" & EffectiveDateOnPermit & "', " & _
                "datEPAStatesNotifiedAppRec = '" & EPAStatesNotifiedAppRec & "', " & _
                "datExperationDate = '" & ExperationDate & "', " & _
                "datPNExpires = '" & PNExpires & "' " & _
                "where strApplicationNumber = '" & txtWebPublisherApplicationNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strTargeted = '" & TargetedComments & "' " & _
                "where strApplicationNumber = '" & txtWebPublisherApplicationNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                If lblLinkWarning.Visible = True Then
                    Dim LinkedApplication As String
                    Dim i As Integer

                    For i = 0 To lbLinkApplications.Items.Count - 1
                        If lbLinkApplications.Items.Item(i) <> txtWebPublisherApplicationNumber.Text Then
                            LinkedApplication = lbLinkApplications.Items.Item(i)
                        Else
                            LinkedApplication = ""
                        End If
                        If LinkedApplication <> "" Then
                            SQL = "Update " & DBNameSpace & ".SSPPApplicationTracking set " & _
                            "datDraftOnWeb = '" & DraftOnWeb & "', " & _
                            "datEPAStatesNotified = '" & EPAStatesNotified & "', " & _
                            "datFinalOnWeb = '" & FinalOnWeb & "', " & _
                            "datEPANotified = '" & EPANotifiedPermitOnWeb & "', " & _
                            "datEffective = '" & EffectiveDateOnPermit & "', " & _
                            "datExperationDate = '" & ExperationDate & "', " & _
                            "datEPAStatesNotifiedAppRec = '" & EPAStatesNotifiedAppRec & "',  " & _
                            "datPNExpires = '" & PNExpires & "' " & _
                            "where strApplicationNumber = '" & LinkedApplication & "' "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If
                            dr = cmd.ExecuteReader
                            dr.Read()
                            dr.Close()

                            SQL = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                            "strTargeted = '" & TargetedComments & "' " & _
                            "where strApplicationNumber = '" & LinkedApplication & "' "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If
                            dr = cmd.ExecuteReader
                            dr.Read()
                            dr.Close()
                        End If
                    Next
                End If

                MsgBox("Web Information Saved", MsgBoxStyle.Information, "Application Tracking Log")
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Sub GenerateBatchFile()
        Try
            Try
                GenerateNewFacilities()
                AddNewAirPollutants()
                GenerateFacilityChanges()
                PermittingActions()
                FCEActions()
                ComplianceActions()
                EnforcementActions()
                ISMPActions()
            Catch ex As Exception
                MsgBox("There was an error that occured while generating the batch." & vbCrLf & _
                     "What is currently run is saved and can be uploaded to AFS.", MsgBoxStyle.Exclamation, "DMU AFS Batch")
            End Try

            Dim FileName As String = ""
            Dim path As New SaveFileDialog
            Dim DestFilePath As String = "N/A"
            Dim OutPutFile As String = ""
            Dim da As OracleDataAdapter
            Dim cmdCB As OracleCommandBuilder
            Dim ds As DataSet

            If txtAFSBatchFile.Text <> "" Then

                SQL = "select " & DBNameSpace & ".afsFileNumber.nextval from Dual"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    FileName = "GA" & dr.Item(0)
                End While
                dr.Close()

                If FileName <> "" Then
                    path.InitialDirectory = "S:\ISMP\DMU\Production\APB IAIP\Batches"
                    path.FileName = FileName
                    path.Filter = "AFS Data (.txt)|.txt"
                    path.FilterIndex = 1
                    path.DefaultExt = ".txt"

                    If path.ShowDialog = Windows.Forms.DialogResult.OK Then
                        DestFilePath = path.FileName.ToString
                    Else
                        DestFilePath = "N/A"
                    End If

                    If DestFilePath <> "N/A" Then
                        Dim Encoder As New System.Text.ASCIIEncoding
                        Dim bytedata As Byte() = Encoder.GetBytes(txtAFSBatchFile.Text)

                        Dim fs As New System.IO.FileStream(DestFilePath, IO.FileMode.Create, IO.FileAccess.Write)
                        fs.Write(bytedata, 0, bytedata.Length)
                        fs.Close()

                        SQL = "Select * " & _
                        "from " & DBNameSpace & ".AFSBatchFiles " & _
                        "where AFSFileName = '" & FileName & "' "

                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        da = New OracleDataAdapter(SQL, conn)
                        cmdCB = New OracleCommandBuilder(da)
                        ds = New DataSet("AFSData")
                        da.MissingSchemaAction = MissingSchemaAction.AddWithKey

                        da.Fill(ds, "AFSData")
                        Dim row As DataRow = ds.Tables("AFSData").NewRow()
                        row("AFSFileName") = FileName
                        row("AFSBatchFile") = bytedata
                        row("strStaffResponsible") = UserGCode
                        row("DatModifingDate") = OracleDate
                        ds.Tables("AFSData").Rows.Add(row)
                        da.Update(ds, "AFSData")

                    End If
                End If
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub GenerateNewFacilities()
        Dim BatchText As String = ""
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String
        Dim AIRSNumber As String
        Dim UserAFSCode As String
        Dim FacilityName As String
        Dim FacilityStreet As String
        Dim FacilityCity As String
        Dim FacilityZipCode As String
        Dim SICCode As String
        Dim FacilityContactPerson As String
        Dim ContactPhoneNumber As String
        Dim PlantDesc As String
        Dim AirProgramCode As String
        Dim Pollutant As String
        Dim Classification As String
        Dim ComplianceStatus As String
        Dim AttainmentStatus As String
        Dim AirProgramPollutantLines As String
        Dim CMSMember As String
        Dim Inspector As String
        Dim OperationalStatus As String
        Dim temp As String

        Try
            'G81 was Ender 
            'G62 is for Permitting Manager
            'G36 is for Compliance Manager 
            'GM8 is for Monitoring Manager 

            SQL = "Select " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber, " & _
            "strFacilityName, strFacilityStreet1,   " & _
            "strFacilityCity, strFacilityzipCode,   " & _
            "strSICCode, strContactFirstName,   " & _
            "strContactLastName, strContactTitle,   " & _
            "strContactPhoneNumber1, strPlantDescription,   " & _
            "" & DBNameSpace & ".AFSFacilityData.strModifingPerson, strUpdateStatus,  " & _
            "strCMSMember  " & _
            "from " & DBNameSpace & ".APBMasterAIRS, " & DBNameSpace & ".APBFacilityInformation,  " & _
            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".APBContactInformation,  " & _
            "" & DBNameSpace & ".APBSupplamentalData, " & DBNameSpace & ".AFSFacilityData  " & _
            "where " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".AFSFacilityData.strAIRSNumber    " & _
            "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSnumber  " & _
            "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber   " & _
            "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBContactInformation.strAIRSNumber " & _
            "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBSupplamentalData.strAIRSNumber   " & _
            "and " & DBNameSpace & ".APBContactInformation.strKEy = '30'  " & _
            "and strUpDateStatus = 'A'  "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                temp = dr.Item("strUpdateStatus")
                Select Case temp
                    Case "A"
                        UpdateCode = "A"
                    Case Else
                        UpdateCode = "N"
                End Select
                If UpdateCode = "A" Then
                    If IsDBNull(dr.Item("strAIRSNumber")) Then
                        AIRSNumber = "N/A"
                    Else
                        AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                    End If
                    If AIRSNumber <> "N/A" Then
                        UserAFSCode = "G62"
                        If IsDBNull(dr.Item("StrFacilityname")) Then
                            FacilityName = "N/A"
                        Else
                            FacilityName = dr.Item("strFacilityName")
                        End If
                        If FacilityName.Length > 40 Then
                            FacilityName = Mid(FacilityName, 1, 40)
                        End If
                        len = FacilityName.Length
                        For i = len To 63
                            FacilityName = FacilityName & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityStreet1")) Then
                            FacilityStreet = "N/A"
                        Else
                            FacilityStreet = dr.Item("strFacilityStreet1")
                        End If
                        If FacilityStreet.Length > 30 Then
                            FacilityStreet = Mid(FacilityStreet, 1, 30)
                        End If
                        len = FacilityStreet.Length
                        For i = len To 63
                            FacilityStreet = FacilityStreet & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacilityCity = "N/A"
                        Else
                            FacilityCity = dr.Item("strFacilityCity")
                        End If
                        If FacilityCity.Length > 30 Then
                            FacilityCity = Mid(FacilityCity, 1, 30)
                        End If
                        len = FacilityCity.Length
                        For i = len To 29
                            FacilityCity = FacilityCity & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityZipCode")) Then
                            FacilityZipCode = "000000000"
                        Else
                            FacilityZipCode = Replace(dr.Item("strFacilityZipCode"), "-", "")
                        End If
                        If FacilityZipCode.Length > 9 Then
                            FacilityZipCode = Mid(FacilityZipCode, 1, 9)
                        End If
                        len = FacilityZipCode.Length
                        If FacilityZipCode.Length <> 9 Then
                            For i = len To 8
                                FacilityZipCode = FacilityZipCode & " "
                            Next
                        End If
                        If IsDBNull(dr.Item("strContactFirstName")) Then
                            FacilityContactPerson = ""
                        Else
                            FacilityContactPerson = dr.Item("strContactFirstName")
                        End If
                        If IsDBNull(dr.Item("strContactLastName")) Then
                            FacilityContactPerson = FacilityContactPerson
                        Else
                            If FacilityContactPerson <> "" Then
                                FacilityContactPerson = FacilityContactPerson & " " & dr.Item("strContactLastName")
                            Else
                                FacilityContactPerson = dr.Item("strContactLastName")
                            End If
                        End If
                        If FacilityContactPerson = "" Then
                            FacilityContactPerson = "N/A"
                        End If
                        If FacilityContactPerson.Length > 20 Then
                            FacilityContactPerson = Mid(FacilityContactPerson, 1, 20)
                        End If
                        len = FacilityContactPerson.Length
                        If FacilityContactPerson.Length <> 20 Then
                            For i = len To 19
                                FacilityContactPerson = FacilityContactPerson & " "
                            Next
                        End If
                        If IsDBNull(dr.Item("strContactPhoneNumber1")) Then
                            ContactPhoneNumber = "0000000000"
                        Else
                            ContactPhoneNumber = Replace(Replace(dr.Item("strContactPhoneNumber1"), ")", ""), "(", "")
                        End If
                        len = ContactPhoneNumber.Length
                        If len > 10 Then
                            ContactPhoneNumber = Mid(ContactPhoneNumber, 1, 10)
                        End If
                        If ContactPhoneNumber.Length <> 10 Then
                            For i = len To 9
                                ContactPhoneNumber = ContactPhoneNumber & "0"
                            Next
                        End If
                        If IsDBNull(dr.Item("strPlantDescription")) Then
                            PlantDesc = "N/A"
                        Else
                            PlantDesc = dr.Item("strPlantDescription")
                        End If
                        len = PlantDesc.Length
                        If PlantDesc.Length > 25 Then
                            PlantDesc = Mid(PlantDesc, 1, 25)
                        End If
                        len = PlantDesc.Length
                        If PlantDesc.Length <> 36 Then
                            For i = len To 35
                                PlantDesc = PlantDesc & " "
                            Next
                        End If
                        If IsDBNull(dr.Item("strCMSMember")) Then
                            CMSMember = "**"
                        Else
                            CMSMember = dr.Item("strCMSMember")
                            Select Case CMSMember
                                Case "A"
                                    CMSMember = CMSMember & "2"
                                Case "S"
                                    CMSMember = CMSMember & "5"
                                Case Else
                                    CMSMember = "**"
                            End Select
                        End If
                        len = CMSMember.Length
                        If len <> 66 Then
                            For i = len To 65
                                CMSMember = CMSMember & " "
                            Next
                        End If

                        Inspector = "G36"

                        If IsDBNull(dr.Item("strSICCode")) Then
                            SICCode = "0000"
                        Else
                            SICCode = dr.Item("strSICCode")
                        End If
                        If FacilityZipCode.Length > 4 Then
                            SICCode = Mid(dr.Item("strSICCode"), 1, 4)
                        End If
                        len = FacilityZipCode.Length
                        If SICCode.Length <> 4 Then
                            For i = len To 3
                                SICCode = SICCode & " "
                            Next
                        End If
                        SICCode = SICCode & "            " & Inspector & "      "

                        SQL2 = "Select " & _
                        "" & DBNameSpace & ".AFSAirPollutantData.strAIRPollutantKey, " & _
                        "" & DBNameSpace & ".AFSAirPollutantData.strPollutantKey, " & _
                        "strComplianceStatus, strClass, " & _
                        "" & DBNameSpace & ".APBHeaderData.strAttainmentStatus, " & _
                        "" & DBNameSpace & ".APBAirProgramPollutants.strOperationalStatus " & _
                        "from " & DBNameSpace & ".APBAirProgramPollutants, " & DBNameSpace & ".AFSAirPollutantData, " & _
                        "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".LookUpCountyInformation " & _
                        "where " & DBNameSpace & ".APBAirProgramPollutants.strAIRSNumber = '" & dr.Item("strAIRSNumber") & "' " & _
                        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".APBAirProgramPollutants.strAIRSNumber " & _
                        "and substr(" & DBNameSpace & ".APBHeaderData.strAIRSNumber, 5, 3) = " & DBNameSpace & ".LookUpCountyInformation.strCountyCode " & _
                        "and " & DBNameSpace & ".AFSAirPollutantData.strAirPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strAirPollutantKey " & _
                        "and " & DBNameSpace & ".AFSAirPollutantData.strPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strPollutantKey " & _
                        "and " & DBNameSpace & ".AFSAirPollutantData.strAIRSNumber  = '04" & AIRSNumber & "' "

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader

                        AirProgramPollutantLines = ""

                        While dr2.Read
                            If IsDBNull(dr2.Item("strAIRPollutantKey")) Then
                                AirProgramCode = "0"
                            Else
                                AirProgramCode = Mid(dr2.Item("strAIRPollutantKey"), 13)
                            End If
                            If IsDBNull(dr2.Item("strOperationalStatus")) Then
                                OperationalStatus = "O"
                            Else
                                OperationalStatus = dr2.Item("strOperationalStatus")
                            End If
                            If IsDBNull(dr2.Item("strPollutantKey")) Then
                                Pollutant = "OT"
                            Else
                                Pollutant = dr2.Item("strPollutantKey")
                            End If

                            If Pollutant.Length > 9 Then
                                Pollutant = Mid(Pollutant, 1, 9)
                            End If
                            len = Pollutant.Length
                            If Pollutant.Length <> 9 Then
                                For i = len To 8
                                    Pollutant = Pollutant & " "
                                Next
                            End If
                            If IsDBNull(dr2.Item("strClass")) Then
                                Classification = "B "
                            Else
                                Classification = dr2.Item("strClass")
                            End If
                            Select Case Classification
                                Case "A"
                                    Classification = "A "
                                Case "SM"
                                    Classification = "SM"
                                Case "B"
                                    Classification = "B "
                                Case "C"
                                    Classification = "B "
                                Case "PR"
                                    Classification = "SM"
                                Case "U"
                                    Classification = "B "
                                Case Else
                                    Classification = "B "
                            End Select
                            If IsDBNull(dr2.Item("strComplianceStatus")) Then
                                ComplianceStatus = "C"
                            Else
                                ComplianceStatus = dr2.Item("strComplianceStatus")
                            End If
                            If IsDBNull(dr2.Item("strAttainmentStatus")) Then
                                AttainmentStatus = "A"
                            Else
                                AttainmentStatus = dr2.Item("strAttainmentStatus")
                                If AttainmentStatus = "True" Then
                                    AttainmentStatus = "A"
                                Else
                                    AttainmentStatus = "N"
                                End If
                            End If

                            Pollutant = Pollutant & ComplianceStatus & Classification & AttainmentStatus & "                                                    "
                            AirProgramPollutantLines = AirProgramPollutantLines & AIRSNumber & "121" & AirProgramCode & OperationalStatus & "                                         " & UserAFSCode & "                    " & UpdateCode & vbCrLf & _
                            AIRSNumber & "131" & AirProgramCode & Pollutant & UpdateCode & vbCrLf
                        End While
                        dr2.Close()

                        SQL2 = "Update " & DBNameSpace & ".AFSAirPollutantData set " & _
                        "strUpDateStatus = 'N' " & _
                        "where strAIRSNumber = '" & dr.Item("strAIRSNumber") & "' "

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If

                        dr2 = cmd2.ExecuteReader
                        dr2.Close()

                        BatchText = BatchText & _
                        AIRSNumber & "101  " & FacilityName & UpdateCode & vbCrLf & _
                        AIRSNumber & "102  " & FacilityStreet & UpdateCode & vbCrLf & _
                        AIRSNumber & "103  " & FacilityCity & FacilityZipCode & SICCode & UpdateCode & vbCrLf & _
                        AIRSNumber & "1040                                                                 " & UpdateCode & vbCrLf & _
                        AIRSNumber & "105" & FacilityContactPerson & ContactPhoneNumber & PlantDesc & UpdateCode & vbCrLf & _
                        AirProgramPollutantLines & _
                        AIRSNumber & "181" & CMSMember & UpdateCode & vbCrLf & _
                        AIRSNumber & "1617000     00 EPA ACTION >700      " & Format(Date.Today, "yyMMdd") & "                          NA" & vbCrLf

                    End If
                End If
            End While
            dr.Close()

            SQL = "Update " & DBNameSpace & ".AFSFacilityData set " & _
            "strUpDateStatus = 'N' " & _
            "where strUpDateStatus = 'A' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = BatchText
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub AddNewAirPollutants()
        Dim AirProgramPollutantLines As String
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String
        Dim AIRSNumber As String
        Dim UserAFSCode As String
        Dim Pollutant As String
        Dim Classification As String
        Dim ComplianceStatus As String
        Dim AttainmentStatus As String
        Dim AirProgramCode As String
        Dim OperationalStatus As String
        Dim Subpart As String
        Dim SubpartData As String

        SQL = "Select " & _
        "" & DBNameSpace & ".AFSAirPollutantData.strAIRSNUmber, " & _
        "" & DBNameSpace & ".AFSAirPollutantData.strAIRPollutantKey, " & _
        "" & DBNameSpace & ".AFSAirPollutantData.strPollutantKey, " & _
        "strComplianceStatus, strClass, " & _
        "" & DBNameSpace & ".APBHeaderData.strAttainmentStatus, " & _
        "strUpdatestatus, " & _
        "" & DBNameSpace & ".APBAirProgramPollutants.strOperationalStatus " & _
        "from " & DBNameSpace & ".APBAirProgramPollutants, " & DBNameSpace & ".AFSAirPollutantData, " & _
        "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".LookUpCountyInformation  " & _
        "where " & _
        "" & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".APBAirProgramPollutants.strAIRSNumber " & _
        "and substr(" & DBNameSpace & ".APBHeaderData.strAIRSNumber, 5, 3) = " & DBNameSpace & ".LookUpCountyInformation.strCountyCode " & _
        "and " & DBNameSpace & ".AFSAirPollutantData.strAirPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strAirPollutantKey " & _
        "and " & DBNameSpace & ".AFSAirPollutantData.strPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strPollutantKey " & _
        "and strUpdateStatus <> 'N' "

        Try
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            AirProgramPollutantLines = ""

            While dr.Read
                If IsDBNull(dr.Item("strAIRSNumber")) Then
                    AIRSNumber = ""
                Else
                    AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                End If

                If AIRSNumber.Length = 10 Then
                    If IsDBNull(dr.Item("strUpdateStatus")) Then
                        UpdateCode = "A"
                    Else
                        UpdateCode = dr.Item("strUpdateStatus")
                    End If
                    If IsDBNull(dr.Item("strAIRPollutantKey")) Then
                        AirProgramCode = "0"
                    Else
                        AirProgramCode = Mid(dr.Item("strAIRPollutantKey"), 13)
                    End If
                    If IsDBNull(dr.Item("strOperationalStatus")) Then
                        OperationalStatus = "O"
                    Else
                        OperationalStatus = dr.Item("strOperationalStatus")
                    End If
                    UserAFSCode = "G62"
                    If IsDBNull(dr.Item("strPollutantKey")) Then
                        Pollutant = "OT"
                    Else
                        Pollutant = dr.Item("strPollutantKey")
                    End If

                    If Pollutant.Length > 9 Then
                        Pollutant = Mid(Pollutant, 1, 9)
                    End If
                    len = Pollutant.Length
                    If Pollutant.Length <> 9 Then
                        For i = len To 8
                            Pollutant = Pollutant & " "
                        Next
                    End If
                    If IsDBNull(dr.Item("strClass")) Then
                        Classification = "B "
                    Else
                        Classification = dr.Item("strClass")
                    End If
                    Select Case Classification
                        Case "A"
                            Classification = "A "
                        Case "SM"
                            Classification = "SM"
                        Case "B"
                            Classification = "B "
                        Case "C"
                            Classification = "B "
                        Case "PR"
                            Classification = "SM"
                        Case "U"
                            Classification = "B "
                        Case Else
                            Classification = "B "
                    End Select
                    If IsDBNull(dr.Item("strComplianceStatus")) Then
                        ComplianceStatus = "C"
                    Else
                        ComplianceStatus = dr.Item("strComplianceStatus")
                    End If
                    If IsDBNull(dr.Item("strAttainmentStatus")) Then
                        AttainmentStatus = "A"
                    Else
                        AttainmentStatus = dr.Item("strAttainmentStatus")
                        If AttainmentStatus <> "00000" Then
                            AttainmentStatus = "A"
                        Else
                            AttainmentStatus = "N"
                        End If
                    End If

                    Pollutant = Pollutant & ComplianceStatus & Classification & AttainmentStatus & "      "
                    AirProgramPollutantLines = AirProgramPollutantLines & AIRSNumber & "121" & _
                    AirProgramCode & OperationalStatus & "                                         " & UserAFSCode & "                    " & UpdateCode & vbCrLf & _
                    AIRSNumber & "131" & AirProgramCode & Pollutant & "                                              " & UpdateCode & vbCrLf

                End If
            End While
            dr.Close()

            Subpart = ""
            SubpartData = ""

            SQL = "Select " & _
            "distinct(substr(strSubPartkey, 13, 1)) as subpart,  " & _
            "" & DBNameSpace & ".APBSubpartData.strAIRSnumber, strUpdateStatus    " & _
            "from " & DBNameSpace & ".APBSubpartData, " & DBNameSpace & ".AFSAirPollutantData   " & _
            "where " & DBNameSpace & ".APBSubpartData.strSubpartKey = " & DBNameSpace & ".AFSAirPollutantData.strAIRPollutantKey  " & _
            "and strUpdateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                AirProgramCode = ""
                AIRSNumber = ""
                UpdateCode = "N"

                If IsDBNull(dr.Item("SubPart")) Then
                    AirProgramCode = ""
                Else
                    AirProgramCode = dr.Item("SubPart")
                    If IsDBNull(dr.Item("strAIRSnumber")) Then
                    Else
                        AIRSNumber = Mid(dr.Item("strAIRSnumber"), 3)
                    End If
                    If IsDBNull(dr.Item("strUpdateStatus")) Then
                    Else
                        UpdateCode = dr.Item("strUpdateStatus")
                    End If
                End If

                Select Case AirProgramCode
                    Case "8"
                        SQL = "Select " & _
                        "strSubPart " & _
                        "from " & DBNameSpace & ".APBSubpartData " & _
                        "where strSubpartKey = '04" & AIRSNumber & "8' "

                        cmd2 = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader
                        While dr2.Read
                            If IsDBNull(dr2.Item("strSubPart")) Then
                                Subpart = ""
                            Else
                                Subpart = dr2.Item("strSubpart")
                                If Subpart <> "" Then
                                    If Subpart.Length > 5 Then
                                        Subpart = Mid(Subpart, 1, 5)
                                    End If
                                    len = Subpart.Length
                                    If Subpart.Length <> 5 Then
                                        For i = len To 4
                                            Subpart = Subpart & " "
                                        Next
                                    End If
                                    SubpartData = SubpartData & Subpart
                                    Subpart = ""
                                End If
                            End If
                        End While
                        dr2.Close()
                        If SubpartData <> "" Then
                            If SubpartData.Length > 64 Then
                                SubpartData = Mid(SubpartData, 1, 64)
                            End If
                            len = SubpartData.Length
                            If SubpartData.Length <> 64 Then
                                For i = len To 63
                                    SubpartData = SubpartData & " "
                                Next
                            End If
                            SubpartData = AIRSNumber & "1228A" & SubpartData & UpdateCode
                        End If
                    Case "9"
                        SQL = "Select " & _
                        "strSubPart " & _
                        "from " & DBNameSpace & ".APBSubpartData " & _
                        "where strSubpartKey = '04" & AIRSNumber & "9' "

                        cmd2 = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader
                        While dr2.Read
                            If IsDBNull(dr2.Item("strSubPart")) Then
                                Subpart = ""
                            Else
                                Subpart = dr2.Item("strSubpart")
                                If Subpart <> "" Then
                                    If Subpart.Length > 5 Then
                                        Subpart = Mid(Subpart, 1, 5)
                                    End If
                                    len = Subpart.Length
                                    If Subpart.Length <> 5 Then
                                        For i = len To 4
                                            Subpart = Subpart & " "
                                        Next
                                    End If
                                    SubpartData = SubpartData & Subpart
                                    Subpart = ""
                                End If
                            End If
                        End While
                        dr2.Close()
                        If SubpartData <> "" Then
                            If SubpartData.Length > 64 Then
                                SubpartData = Mid(SubpartData, 1, 64)
                            End If
                            len = SubpartData.Length
                            If SubpartData.Length <> 64 Then
                                For i = len To 63
                                    SubpartData = SubpartData & " "
                                Next
                            End If
                            SubpartData = AIRSNumber & "1229A" & SubpartData & UpdateCode
                        End If
                    Case "M"
                        SQL = "Select " & _
                         "strSubPart " & _
                         "from " & DBNameSpace & ".APBSubpartData " & _
                         "where strSubpartKey = '04" & AIRSNumber & "M' "

                        cmd2 = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader
                        While dr2.Read
                            If IsDBNull(dr2.Item("strSubPart")) Then
                                Subpart = ""
                            Else
                                Subpart = dr2.Item("strSubpart")
                                If Subpart <> "" Then
                                    If Subpart.Length > 5 Then
                                        Subpart = Mid(Subpart, 1, 5)
                                    End If
                                    len = Subpart.Length
                                    If Subpart.Length <> 5 Then
                                        For i = len To 4
                                            Subpart = Subpart & " "
                                        Next
                                    End If
                                    SubpartData = SubpartData & Subpart
                                    Subpart = ""
                                End If
                            End If
                        End While
                        dr2.Close()
                        If SubpartData <> "" Then
                            If SubpartData.Length > 64 Then
                                SubpartData = Mid(SubpartData, 1, 64)
                            End If
                            len = SubpartData.Length
                            If SubpartData.Length <> 64 Then
                                For i = len To 63
                                    SubpartData = SubpartData & " "
                                Next
                            End If
                            SubpartData = AIRSNumber & "122MA" & SubpartData & UpdateCode
                        End If
                    Case Else
                        SubpartData = ""
                End Select
                If SubpartData <> "" Then
                    AirProgramPollutantLines = AirProgramPollutantLines & SubpartData & vbCrLf
                End If
                SubpartData = ""
                Subpart = ""

            End While

            SQL = "Update " & DBNameSpace & ".AFSAirPollutantData set " & _
            "strUpDateStatus = 'N' " & _
            "where strUpDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & AirProgramPollutantLines

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Sub GenerateFacilityChanges()
        Dim BatchText As String = ""
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String
        Dim UpdateCode2 As String
        Dim AIRSNumber As String
        Dim UserAFSCode As String
        Dim FacilityName As String
        Dim FacilityStreet As String
        Dim FacilityCity As String
        Dim FacilityZipCode As String
        Dim SICCode As String
        Dim FacilityContactPerson As String
        Dim ContactPhoneNumber As String
        Dim PlantDesc As String
        Dim AirProgramCode As String
        Dim Pollutant As String
        Dim AirProgramPollutantLines As String
        Dim Inspector As String
        Dim OperationalStatus As String
        Dim CMSMember As String
        Dim temp As String = ""

        SQL = "Select " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber, " & _
        "strFacilityName, strFacilityStreet1,  " & _
        "strFacilityCity, strFacilityzipCode,  " & _
        "strSICCode, strContactFirstName,  " & _
        "strContactLastName, strContactTitle,  " & _
        "strContactPhoneNumber1, strPlantDescription,  " & _
        "" & DBNameSpace & ".AFSFacilityData.strModifingPerson, strUpdateStatus, " & _
        "strCMSMember " & _
        "from " & DBNameSpace & ".APBMasterAIRS, " & DBNameSpace & ".APBFacilityInformation, " & _
        "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".APBContactInformation, " & _
        "" & DBNameSpace & ".APBSupplamentalData, " & DBNameSpace & ".AFSFacilityData " & _
        "where " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".AFSFacilityData.strAIRSNumber   " & _
        "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSnumber " & _
        "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber  " & _
        "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBContactInformation.strAIRSNumber  " & _
        "and " & DBNameSpace & ".APBMasterAIRS.strAIRSNumber = " & DBNameSpace & ".APBSupplamentalData.strAIRSNumber  " & _
        "and " & DBNameSpace & ".APBContactInformation.strKEy = '30' " & _
        "and strUpDateStatus = 'C' "

        Try
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                temp = dr.Item("strUpdateStatus")
                Select Case temp
                    Case "C"
                        UpdateCode = "C"
                    Case Else
                        UpdateCode = "N"
                End Select
                If UpdateCode = "C" Then
                    If IsDBNull(dr.Item("strAIRSNumber")) Then
                        AIRSNumber = "N/A"
                    Else
                        AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                    End If
                    If AIRSNumber <> "N/A" Then
                        UserAFSCode = "G62"
                        If IsDBNull(dr.Item("StrFacilityname")) Then
                            FacilityName = "N/A"
                        Else
                            FacilityName = dr.Item("strFacilityName")
                        End If
                        len = FacilityName.Length
                        If len > 40 Then
                            FacilityName = Mid(FacilityName, 1, 40)
                        End If
                        len = FacilityName.Length
                        For i = len To 63
                            FacilityName = FacilityName & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityStreet1")) Then
                            FacilityStreet = "N/A"
                        Else
                            FacilityStreet = dr.Item("strFacilityStreet1")
                        End If
                        len = FacilityStreet.Length
                        If len > 30 Then
                            FacilityStreet = Mid(FacilityStreet, 1, 30)
                        End If
                        len = FacilityStreet.Length
                        For i = len To 63
                            FacilityStreet = FacilityStreet & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacilityCity = "N/A"
                        Else
                            FacilityCity = dr.Item("strFacilityCity")
                        End If
                        len = FacilityCity.Length
                        If len > 30 Then
                            FacilityCity = Mid(FacilityCity, 1, 30)
                        End If
                        For i = len To 29
                            FacilityCity = FacilityCity & " "
                        Next
                        If IsDBNull(dr.Item("strFacilityZipCode")) Then
                            FacilityZipCode = "000000000"
                        Else
                            FacilityZipCode = Replace(dr.Item("strFacilityZipCode"), "-", "")
                        End If
                        len = FacilityZipCode.Length
                        If len > 9 Then
                            FacilityZipCode = Mid(FacilityZipCode, 1, 9)
                        End If
                        If FacilityZipCode.Length <> 9 Then
                            For i = len To 8
                                FacilityZipCode = FacilityZipCode & " "
                            Next
                        End If
                        If IsDBNull(dr.Item("strContactFirstName")) Then
                            FacilityContactPerson = ""
                        Else
                            FacilityContactPerson = dr.Item("strContactFirstName")
                        End If
                        If IsDBNull(dr.Item("strContactLastName")) Then
                            FacilityContactPerson = FacilityContactPerson
                        Else
                            If FacilityContactPerson <> "" Then
                                FacilityContactPerson = FacilityContactPerson & " " & dr.Item("strContactLastName")
                            Else
                                FacilityContactPerson = dr.Item("strContactLastName")
                            End If
                        End If
                        If FacilityContactPerson = "" Then
                            FacilityContactPerson = "N/A"
                        End If
                        len = FacilityContactPerson.Length
                        If len > 20 Then
                            FacilityContactPerson = Mid(FacilityContactPerson, 1, 20)
                        End If
                        len = FacilityContactPerson.Length
                        If FacilityContactPerson.Length <> 20 Then
                            For i = len To 19
                                FacilityContactPerson = FacilityContactPerson & " "
                            Next
                        End If
                        If IsDBNull(dr.Item("strContactPhoneNumber1")) Then
                            ContactPhoneNumber = "0000000000"
                        Else
                            ContactPhoneNumber = Replace(Replace(dr.Item("strContactPhoneNumber1"), "(", ""), ")", "")
                        End If
                        len = ContactPhoneNumber.Length
                        If len > 10 Then
                            ContactPhoneNumber = Mid(ContactPhoneNumber, 1, 10)
                        End If
                        len = ContactPhoneNumber.Length
                        If ContactPhoneNumber.Length <> 10 Then
                            For i = len To 9
                                ContactPhoneNumber = ContactPhoneNumber & "0"
                            Next
                        End If
                        If IsDBNull(dr.Item("strPlantDescription")) Then
                            PlantDesc = "N/A"
                        Else
                            PlantDesc = Replace(dr.Item("strPlantDescription"), "'", "")
                        End If
                        len = PlantDesc.Length
                        If len > 25 Then
                            PlantDesc = Mid(PlantDesc, 1, 25)
                        End If
                        len = PlantDesc.Length
                        If PlantDesc.Length <> 36 Then
                            For i = len To 35
                                PlantDesc = PlantDesc & " "
                            Next
                        End If

                        Inspector = "G36"

                        If IsDBNull(dr.Item("strSICCode")) Then
                            SICCode = "0000"
                        Else
                            SICCode = dr.Item("strSICCode")
                        End If

                        If FacilityZipCode.Length > 4 Then
                            SICCode = Mid(dr.Item("strSICCode"), 1, 4)
                        End If
                        len = FacilityZipCode.Length
                        If SICCode.Length <> 4 Then
                            For i = len To 3
                                SICCode = SICCode & " "
                            Next
                        End If
                        SICCode = SICCode & SICCode & SICCode & "    " & Inspector & "      "

                        If IsDBNull(dr.Item("strCMSMember")) Then
                            CMSMember = "**"
                        Else
                            CMSMember = dr.Item("strCMSMember")
                            Select Case CMSMember
                                Case "A"
                                    CMSMember = CMSMember & "2"
                                Case "S"
                                    CMSMember = CMSMember & "5"
                                Case Else
                                    CMSMember = "**"
                            End Select
                        End If
                        len = CMSMember.Length
                        If len <> 66 Then
                            For i = len To 65
                                CMSMember = CMSMember & " "
                            Next
                        End If

                        SQL2 = "Select " & _
                        "" & DBNameSpace & ".AFSAirPollutantData.strAIRPollutantKey, " & _
                        "" & DBNameSpace & ".AFSAirPollutantData.strPollutantKey, " & _
                        "strComplianceStatus, strUpdateStatus, " & _
                        "strOperationalStatus " & _
                        "from " & DBNameSpace & ".APBAirProgramPollutants, " & DBNameSpace & ".AFSAirPollutantData " & _
                        "where " & DBNameSpace & ".APBAirProgramPollutants.strAIRSNumber = '" & dr.Item("strAIRSNumber") & "' " & _
                        "and " & DBNameSpace & ".AFSAirPollutantData.strAirPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strAirPollutantKey " & _
                        "and " & DBNameSpace & ".AFSAirPollutantData.strPollutantKey = " & DBNameSpace & ".APBAirProgramPollutants.strPollutantKey " & _
                        "and strUpdateStatus <> 'N' "

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader

                        AirProgramPollutantLines = ""

                        While dr2.Read
                            If IsDBNull(dr2.Item("strAIRPollutantKey")) Then
                                AirProgramCode = "0"
                            Else
                                AirProgramCode = Mid(dr2.Item("strAIRPollutantKey"), 13)
                            End If
                            If IsDBNull(dr2.Item("strOperationalStatus")) Then
                                OperationalStatus = "O"
                            Else
                                OperationalStatus = dr2.Item("strOperationalStatus")
                            End If
                            If IsDBNull(dr2.Item("strPollutantKey")) Then
                                Pollutant = "OT"
                            Else
                                Pollutant = dr2.Item("strPollutantKey")
                            End If
                            len = Pollutant.Length
                            If len > 9 Then
                                Pollutant = Mid(Pollutant, 1, 9)
                            End If
                            If Pollutant.Length <> 9 Then
                                For i = len To 8
                                    Pollutant = Pollutant & " "
                                Next
                            End If
                            If IsDBNull(dr2.Item("strUpdateStatus")) Then
                                UpdateCode2 = "N"
                            Else
                                UpdateCode2 = dr2.Item("strUpdateStatus")
                            End If
                            Pollutant = Pollutant & "4A A                                                    "
                            AirProgramPollutantLines = AirProgramPollutantLines & AIRSNumber & "121" & AirProgramCode & OperationalStatus & "                                         " & UserAFSCode & "                    " & UpdateCode2 & vbCrLf & _
                            AIRSNumber & "131" & AirProgramCode & Pollutant & UpdateCode2 & vbCrLf
                        End While
                        dr2.Close()

                        SQL2 = "Update " & DBNameSpace & ".AFSAirPollutantData set " & _
                        "strUpDateStatus = 'N' " & _
                        "where strAIRSNumber = '" & dr.Item("strAIRSNumber") & "' "

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If

                        dr2 = cmd2.ExecuteReader
                        dr2.Close()

                        BatchText = BatchText & _
                        AIRSNumber & "101  " & FacilityName & UpdateCode & vbCrLf & _
                        AIRSNumber & "102  " & FacilityStreet & UpdateCode & vbCrLf & _
                        AIRSNumber & "103  " & FacilityCity & FacilityZipCode & SICCode & UpdateCode & vbCrLf & _
                        AIRSNumber & "1040                                                                 " & UpdateCode & vbCrLf & _
                        AIRSNumber & "105" & FacilityContactPerson & ContactPhoneNumber & PlantDesc & UpdateCode & vbCrLf & _
                        AirProgramPollutantLines & _
                        AIRSNumber & "181" & CMSMember & UpdateCode & vbCrLf
                    End If
                End If
            End While
            dr.Close()

            SQL = "Update " & DBNameSpace & ".AFSFacilityData set " & _
            "strUpDateStatus = 'N' " & _
            "where strUpDateStatus = 'C' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        
        End Try
         

    End Sub
    Sub PermittingActions()
        Dim BatchText As String = ""
        Dim Comments As String = ""
        Dim PermitFile As String = ""
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String = ""
        Dim AIRSNumber As String = ""
        Dim AIRProgramCodes As String = ""
        Dim UserAFSCode As String = ""
        Dim ActionNumber As String = ""
        Dim ActionType As String = ""
        Dim ResultsCode As String = ""
        Dim ActionComments As String = ""
        Dim ActionComments2 As String = ""
        Dim ActionComments3 As String = ""
        Dim ActionComments4 As String = ""
        Dim DateAcheived As String = ""
        Dim DateExpire As String = ""
        Dim SubmitPermit As String = ""
        Dim PermitState As String = ""
        Dim PermitNumber As String = ""

        SQL = "Select " & _
        "" & DBNameSpace & ".ssppapplicationmaster.strApplicationnumber, " & _
        "strAFSActionNumber, strUpDateStatus,  " & _
        "" & DBNameSpace & ".SSPPApplicationMaster.strAIRSNumber, " & _
        "" & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible,  " & _
        "Case " & _
        "    when strPermitType = '1' then '35' " & _
        "    when strPermitType = '4' then '33' " & _
        "    when strPermitType = '5' then '36' " & _
        "    when strPermitType = '7' then '33' " & _
        "    when strPermitType = '10' then '34' " & _
        "    when strPermitType = '12' then '33' " & _
        "    when strPermitType = '13' then '33' " & _
        "    else '00' " & _
        "end as strActionType, " & _
        "" & DBNameSpace & ".SSPPApplicationData.strComments, " & _
        "to_Char(" & DBNameSpace & ".SSPPApplicationMaster.DatFinalizedDate, 'YYMMDD') as AchievedDate, " & _
        "" & DBNameSpace & ".SSPPApplicationData.strAirProgramCodes, " & _
        "" & DBNameSpace & ".SSPPApplicationData.strPermitNumber " & _
        "from " & DBNameSpace & ".AFSSSPPRecords, " & DBNameSpace & ".SSPPApplicationMaster,  " & _
        "" & DBNameSpace & ".SSPPApplicationData " & _
        "where strUpDateStatus <> 'N'  " & _
        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
        "and " & DBNameSpace & ".AFSSSPPRecords.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber " & _
        "and (strPermitType = '1' or strPermitType = '4' or strPermitType = '5' " & _
        "or strPermitType = '7' or strPermitType = '10' or strPermitType = '12' " & _
        "or strPermitType = '13') " & _
        "and " & DBNameSpace & ".SSPPApplicationMaster.strAIRSNumber not like '0413APL%' "

        Try
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3, 10)
                If AIRSNumber.Length = 10 Then
                    If IsDBNull(dr.Item("strUpDatestatus")) Then
                        UpdateCode = "A"
                    Else
                        UpdateCode = dr.Item("strUpDateStatus")
                    End If
                    AIRProgramCodes = ""
                    If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                        AIRProgramCodes = "0"
                    Else
                        If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "0"
                        End If
                        'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                        '    AIRProgramCodes = AIRProgramCodes & "1"
                        'End If
                        If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "3"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "4"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "6"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "7"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "8"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "9"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "F"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "A"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "I"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "M"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "V"
                            SubmitPermit = "V"
                        Else
                            SubmitPermit = ""
                        End If
                        If AIRProgramCodes = "" Then
                            AIRProgramCodes = "0"
                        End If
                    End If
                    If AIRProgramCodes.Length > 6 Then
                        AIRProgramCodes = Mid(AIRProgramCodes, 1, 6)
                    End If
                    len = AIRProgramCodes.Length
                    If len <> 6 Then
                        For i = len To 5
                            AIRProgramCodes = AIRProgramCodes & " "
                        Next
                    End If
                    If IsDBNull(dr.Item("strPermitNumber")) Then
                        PermitNumber = ""
                    Else
                        PermitNumber = dr.Item("strPermitNumber")
                    End If
                    len = PermitNumber.Length
                    If PermitNumber.Length > 15 Then
                        PermitNumber = Mid(PermitNumber, 1, 15)
                    End If
                    If len <> 15 Then
                        For i = len To 14
                            PermitNumber = PermitNumber & " "
                        Next
                    End If

                    If IsDBNull(dr.Item("strAFSActionNumber")) Then
                        ActionNumber = "00001"
                    Else
                        ActionNumber = dr.Item("strAFSActionNumber")
                    End If
                    'strStaffResponsible
                    UserAFSCode = "G62"
                   
                    len = UserAFSCode.Length
                    If len <> 18 Then
                        For i = len To 17
                            UserAFSCode = UserAFSCode & " "
                        Next
                    End If
                    If IsDBNull(dr.Item("strActionType")) Then
                        ActionType = "00"
                    Else
                        ActionType = dr.Item("strActionType")
                    End If
                    If ActionType = "N " Then
                        ActionType = "00"
                    End If
                    Select Case ActionType
                        Case "33"
                            ResultsCode = "01"
                            PermitState = "Issued"
                        Case "34"
                            ResultsCode = "01"
                        Case "35"
                            ResultsCode = "01"
                            PermitState = "Admend"
                        Case "36"
                            ResultsCode = "01"
                            PermitState = "No Permit Req"
                        Case "38"
                            ResultsCode = "01"
                        Case "00"
                            ResultsCode = "01"
                            PermitState = "Draft"
                        Case Else
                            ResultsCode = "01"
                    End Select
                    len = ActionType.Length
                    If len <> 18 Then
                        For i = len To 17
                            ActionType = ActionType & " "
                        Next
                    End If
                    'strComments
                    If IsDBNull(dr.Item("strApplicationnumber")) Then
                        ActionComments = "N/A"
                    Else
                        ActionComments = Replace(dr.Item("strApplicationnumber"), "'", "")
                        ActionComments = "GA Application Number: " & ActionComments
                    End If

                    len = ActionComments.Length
                    If len < 55 Then
                        For i = len To 54
                            ActionComments = ActionComments & " "
                        Next
                    Else
                        ActionComments = Mid(ActionComments, 1, 54)
                    End If

                    If IsDBNull(dr.Item("AchievedDate")) Then
                        DateAcheived = Format(Date.Today, "yyMMdd")
                    Else
                        DateAcheived = dr.Item("AchievedDate")
                    End If

                    DateExpire = CStr(CInt(Mid(DateAcheived, 1, 2)) + 5) & Mid(DateAcheived, 3)

                    If SubmitPermit = "V" Then
                        Select Case PermitState
                            Case "Issued"
                                PermitFile = "13                  A21" & PermitNumber & "V                                       N" & UpdateCode & vbCrLf & _
                                "13                  A22" & PermitNumber & DateAcheived & "        " & DateExpire & "                 " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A71" & PermitNumber & "                                         " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A81               " & PermitNumber & "IF001  13                 " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A82               " & PermitNumber & "IF0010120" & DateAcheived & "           " & UpdateCode & vbCrLf
                            Case "Admend"
                                PermitFile = "13                  A21" & PermitNumber & "V                                       N" & UpdateCode & vbCrLf & _
                                "13                  A22" & PermitNumber & DateAcheived & "        " & DateExpire & "                 " & UpdateCode & vbCrLf & _
                                "13                  A23" & PermitNumber & "AMENDMENT                                " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A71" & PermitNumber & "                                         " & UpdateCode & vbCrLf
                            Case "No Permit Req"
                                PermitFile = "13                  A21" & PermitNumber & "V                                       N" & UpdateCode & vbCrLf & _
                                "13                  A22" & PermitNumber & DateAcheived & "        " & DateExpire & "                 " & UpdateCode & vbCrLf & _
                                "13                  A23" & PermitNumber & "AMENDMENT                                " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A71" & PermitNumber & "                                         " & UpdateCode & vbCrLf
                            Case "Draft"
                                PermitFile = "13                  A21" & PermitNumber & "V                                       N" & UpdateCode & vbCrLf & _
                                "13                  A22" & PermitNumber & DateAcheived & "        " & DateExpire & "                 " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A71" & PermitNumber & "                                         " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A81               " & PermitNumber & "DP001  13                 " & UpdateCode & vbCrLf & _
                                AIRSNumber & "          A82               " & PermitNumber & "DP0010120" & DateAcheived & "           " & UpdateCode & vbCrLf
                        End Select
                    End If
                    BatchText = BatchText & _
                    AIRSNumber & "161" & ActionNumber & AIRProgramCodes & ActionType & DateAcheived & _
                    DateAcheived & ResultsCode & "0000000" & UserAFSCode & UpdateCode & vbCrLf
                    Comments = AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                    If Comments <> "" Then
                        BatchText = BatchText & Comments
                    End If
                End If
            End While
            dr.Close()

            SQL = "Update " & DBNameSpace & ".AFSSSPPRecords set " & _
            "strUpDateStatus = 'N' " & _
            "where strUPDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub FCEActions()
        Dim BatchText As String = ""
        Dim Comments As String
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String
        Dim AIRSNumber As String
        Dim AIRProgramCodes As String
        Dim UserAFSCode As String
        Dim ActionNumber As String
        Dim ResultsCode As String
        Dim ActionComments As String
        Dim DateAcheived As String
        Dim SiteStatus As String

        SQL = "Select strUpDateStatus, " & _
        "" & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber, strAFSActionNumber, " & _
        "" & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber, strAIRProgramCodes, " & _
        "to_char(datFCECompleted, 'YYMMDD') as AchievedDate, strFCEStatus, " & _
        "strFCEComments, strSiteInspection " & _
        "from " & DBNameSpace & ".AFSSSCPFCERecords, " & DBNameSpace & ".SSCPFCEMaster, " & _
        "" & DBNameSpace & ".SSCPFCE, " & DBNameSpace & ".APBHeaderData " & _
        "where strUpDateStatus <> 'N' " & _
        "and " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.strFCENumber " & _
        "and " & DBNameSpace & ".SSCPFCE.strFCENumber = " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber " & _
        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber " 

        Try
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                If AIRSNumber.Length = 10 Then
                    If IsDBNull(dr.Item("strUpDatestatus")) Then
                        UpdateCode = "A"
                    Else
                        UpdateCode = dr.Item("strUpDateStatus")
                    End If
                    AIRProgramCodes = ""
                    If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                        AIRProgramCodes = "0"
                    Else
                        If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "0"
                        End If
                        'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                        '    AIRProgramCodes = AIRProgramCodes & "1"
                        'End If
                        If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "3"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "4"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "6"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "7"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "8"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "9"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "F"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "A"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "I"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "M"
                        End If
                        If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                            AIRProgramCodes = AIRProgramCodes & "V"
                        End If
                        If AIRProgramCodes = "" Then
                            AIRProgramCodes = "0"
                        End If
                    End If
                    If AIRProgramCodes.Length > 6 Then
                        AIRProgramCodes = Mid(AIRProgramCodes, 1, 6)
                    End If
                    len = AIRProgramCodes.Length
                    If len <> 6 Then
                        For i = len To 5
                            AIRProgramCodes = AIRProgramCodes & " "
                        Next
                    End If
                    If IsDBNull(dr.Item("strAFSActionNumber")) Then
                        ActionNumber = "00001"
                    Else
                        ActionNumber = dr.Item("strAFSActionNumber")
                    End If
                    UserAFSCode = "G62"
                    If IsDBNull(dr.Item("AchievedDate")) Then
                        DateAcheived = Format(Date.Today, "yyMMdd")
                    Else
                        DateAcheived = dr.Item("AchievedDate")
                    End If
                    If IsDBNull(dr.Item("strFCEStatus")) Then
                        ResultsCode = ""
                    Else
                        ResultsCode = "21"
                    End If
                    If IsDBNull(dr.Item("strSiteInspection")) Then
                        SiteStatus = "FF"
                    Else
                        If dr.Item("strSiteInspection") = "True" Then
                            SiteStatus = "FS"
                        Else
                            SiteStatus = "FF"
                        End If
                    End If
                    If ResultsCode.Length > 9 Then
                        ResultsCode = Mid(ResultsCode, 1, 9)
                    End If

                    len = ResultsCode.Length
                    If len <> 9 Then
                        For i = len To 8
                            ResultsCode = ResultsCode & " "
                        Next
                    End If
                    If IsDBNull(dr.Item("strFCENumber")) Then
                        ActionComments = ""
                    Else
                        ActionComments = dr.Item("strFCENumber")
                        ActionComments = "GA FCE Number: " & ActionComments
                    End If

                    len = ActionComments.Length
                    If len < 55 Then
                        For i = len To 54
                            ActionComments = ActionComments & " "
                        Next
                    Else
                        ActionComments = Mid(ActionComments, 1, 54)
                    End If
                    Comments = AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf

                    BatchText = BatchText & _
                    AIRSNumber & "161" & ActionNumber & AIRProgramCodes & SiteStatus & "                      " & DateAcheived & ResultsCode & UserAFSCode & "               " & UpdateCode & vbCrLf

                    If Comments <> "" Then
                        BatchText = BatchText & Comments
                    End If
                End If
            End While

            SQL = "Update " & DBNameSpace & ".AFSSSCPFCERecords set " & _
            "strUpDateStatus = 'N' " & _
            "where strUPDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub ComplianceActions()
        Dim BatchText As String = ""
        Dim len As Integer
        Dim i As Integer

        Dim UpdateCode As String
        Dim AIRSNumber As String
        Dim AIRProgramCodes As String
        Dim UserAFSCode As String
        Dim ActionNumber As String
        Dim ActionComments As String
        Dim DateAcheived As String
        Dim EventType As String
        Dim EnforcementNumber As String

        SQL = "Select " & _
        "strUpDateStatus, " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber,  " & _
        "strEventType,  " & _
        "strResponsibleStaff,  " & _
        "to_char(datCompleteDate, 'YYMMDD') as AchievedDate,  " & _
        "" & DBNameSpace & ".APBHeaderData.strAIRSNumber,  " & _
        "strAIRProgramCodes, strAFSActionNumber,  " & _
        "strEnforcementNumber  " & _
        "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster,  " & _
        "" & DBNameSpace & ".APBHeaderData,  " & _
        "" & DBNameSpace & ".SSCPEnforcementItems  " & _
        "where strUpdateStatus <> 'N'  " & _
        "and " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber  " & _
        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber   " & _
        "and " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPEnforcementItems.strTrackingNumber (+)  "

        Try
            
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                If IsDBNull(dr.Item("strUpDatestatus")) Then
                    UpdateCode = "A"
                Else
                    UpdateCode = dr.Item("strUpDateStatus")
                End If
                AIRProgramCodes = ""
                If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                    AIRProgramCodes = "0"
                Else
                    If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "0"
                    End If
                    'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                    '    AIRProgramCodes = AIRProgramCodes & "1"
                    'End If
                    If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "3"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "4"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "6"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "7"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "8"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "9"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "F"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "A"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "I"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "M"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "V"
                    End If
                    If AIRProgramCodes = "" Then
                        AIRProgramCodes = "0"
                    End If
                End If
                If AIRProgramCodes.Length > 6 Then
                    AIRProgramCodes = Mid(AIRProgramCodes, 1, 6)
                End If
                len = AIRProgramCodes.Length
                If len <> 6 Then
                    For i = len To 5
                        AIRProgramCodes = AIRProgramCodes & " "
                    Next
                End If
                UserAFSCode = "G36"

                len = UserAFSCode.Length
                If len <> 18 Then
                    For i = len To 17
                        UserAFSCode = UserAFSCode & " "
                    Next
                End If
                If IsDBNull(dr.Item("strAFSActionNumber")) Then
                    ActionNumber = "00001"
                Else
                    ActionNumber = dr.Item("strAFSActionNumber")
                End If
                If IsDBNull(dr.Item("AchievedDate")) Then
                    DateAcheived = Format(Date.Today, "yyMMdd")
                Else
                    DateAcheived = dr.Item("AchievedDate")
                End If
                If IsDBNull(dr.Item("strEventType")) Then
                    EventType = ""
                Else
                    EventType = dr.Item("strEventType")
                End If
                If IsDBNull(dr.Item("strTrackingNumber")) Then
                    ActionComments = "GA EPD# "
                Else
                    ActionComments = "GA EPD Compliance# " & dr.Item("strTrackingNumber")
                End If
                len = ActionComments.Length
                If len <> 55 Then
                    For i = len To 54
                        ActionComments = ActionComments & " "
                    Next
                End If
                If IsDBNull(dr.Item("strEnforcementNumber")) Then
                    EnforcementNumber = ""
                Else
                    EnforcementNumber = dr.Item("strEnforcementNumber")
                End If

                Select Case EventType
                    Case "01" 'Reports 
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "37                      " & DateAcheived & "010000000" & UserAFSCode & UpdateCode & vbCrLf & _
                        AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                    Case "02" 'Inspections
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "27                      " & DateAcheived & "010000000" & UserAFSCode & UpdateCode & vbCrLf & _
                        AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                    Case "03" 'Stack Test
                        'BatchText = BatchText & _
                        'AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "SR                      " & DateAcheived & "010000000" & UserAFSCode & UpdateCode & vbCrLf & _
                        'AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                    Case "04" 'Title V ACC Reviews
                        If EnforcementNumber <> "" Then
                            BatchText = BatchText & _
                            AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "SR                      " & DateAcheived & "MV0000000" & UserAFSCode & UpdateCode & vbCrLf & _
                            AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                        Else
                            BatchText = BatchText & _
                            AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "SR                      " & DateAcheived & "MC0000000" & UserAFSCode & UpdateCode & vbCrLf & _
                            AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                        End If
                    Case "05" 'Other
                        'BatchText = BatchText & _
                        'AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "00                      " & DateAcheived & "010000000" & UserAFSCode & UpdateCode & vbCrLf & _
                        'AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                    Case "06" 'Title V Compliance Cert Due
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "CS                      " & DateAcheived & "         " & UserAFSCode & UpdateCode & vbCrLf & _
                        AIRSNumber & "171  " & ActionNumber & "001C" & ActionComments & "NN" & UpdateCode & vbCrLf
                End Select
            End While
            dr.Close()


            SQL = "Update " & DBNameSpace & ".AFSSSCPRecords set " & _
            "strUpDateStatus = 'N' " & _
            "where strUPDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        
        End Try
         

    End Sub
    Sub EnforcementActions()
        Dim BatchText As String = ""
        Dim len As Integer
        Dim i As Integer
        Dim UpdateCode As String
        Dim AIRSNumber As String
        Dim AIRProgramCodes As String
        Dim UserAFSCode As String
        Dim ActionType As String
        Dim KeyActionNumber As String
        Dim ActionNumber As String
        Dim DiscoveryDate As String
        Dim DayZero As String
        Dim NOVSent As String
        Dim NFALetter As String
        Dim COProposed As String
        Dim COExecuted As String
        Dim COResolved As String
        Dim AOExecuted As String
        Dim CivilCourt As String
        Dim AOResolved As String
        Dim StipulatedDate As String
        Dim PenaltyAmount As String
        Dim StipulatedPenalty As String
        Dim HPV As String
        Dim TrackingNumber As String
        Dim Pollutants As String
        Dim Pollutant1 As String
        Dim Pollutant2 As String
        Dim Pollutant3 As String
        Dim LinkedEvent As String

        Try
            SQL = "Select   " & _
            "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strUpDateStatus,   " & _
            "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,    " & _
            "strStaffResponsible,    " & _
            "to_Char(datDiscoveryDate, 'YYMMDD') as DiscoveryDate,    " & _
            "to_char(datDayZero, 'YYMMDD') as DayZero,    " & _
            "to_char(datEnforcementFinalized, 'YYMMDD') as AchievedDate,    " & _
            "to_char(datNOVSent, 'YYMMDD') as NOVSent,    " & _
            "to_char(datNFALetterSent, 'YYMMDD') as NFALetterSent,    " & _
            "to_char(datCOProposed, 'YYMMDD') as COProposed,    " & _
            "to_char(datCOExecuted, 'YYMMDD') as COExecuted,    " & _
            "to_Char(datCOResolved, 'YYMMDD') as COResolved,    " & _
            "to_char(datAOExecuted, 'YYMMDD') as AOExecuted,    " & _
            "to_char(datAOAppealed, 'YYMMDD') as AOAppealed,    " & _
            "to_char(datAOResolved, 'YYMMDD') as AOResolved,    " & _
            "to_char(SSCPEnforcement.datModifingDate, 'YYMMDD') as StipulatedDate,    " & _
            "strCOPenaltyAmount,    " & _
            "" & DBNameSpace & ".SSCPENforcementStipulated.strStipulatedPenalty,    " & _
            "" & DBNameSpace & ".APBHeaderData.strAIRSNumber, strAIRProgramCodes,    " & _
            "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber,    " & _
            "strAFSKeyActionNumber,  " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber,    " & _
            "case    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSKeyActionNumber then '04'    " & _
             "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSNOVSentNumber then '56'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSNOVResolvedNumber then 'AW'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSCOProposedNumber then '57'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSCOExecutedNumber then 'X1'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSCOResolvedNumber then 'AS'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSStipulatedPenaltyNumber then 'Z4'   " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSAOtoAGNumber then '60'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSCivilCourtNumber then '64'    " & _
            "when " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = strAFSAOResolvedNumber then 'AS'    " & _
            "Else 'ERROR'     " & _
            "End as ActionType,    " & _
            "strPollutants, strHPV,  " & _
            "" & DBNameSpace & ".AFSSSCPRecords.strAFSActionNumber as LinkingEvent  " & _
            "from  " & DBNameSpace & ".AFSSSCPEnforcementRecords,    " & _
            "" & DBNameSpace & ".SSCPEnforcementItems,  " & DBNameSpace & ".SSCPEnforcement,    " & _
            "" & DBNameSpace & ".APBHeaderData,  " & DBNameSpace & ".SSCPENforcementStipulated,    " & _
            "" & DBNameSpace & ".SSCPItemMaster,  " & _
            "" & DBNameSpace & ".AFSSSCPRecords    " & _
            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strUpdateStatus <> 'N'    " & _
            "and  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber =  " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber    " & _
            "and  " & DBNameSpace & ".APBHeaderData.strAIRSNumber =  " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber    " & _
            "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber    " & _
            "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPENforcementStipulated.strEnforcementNumber (+)    " & _
            "and  " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber =  " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber (+)   " & _
            "and strEventType <> '03' " & _
            "and " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber = " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber (+) " & _
            "Order by strAFSActionNumber ASC "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                If IsDBNull(dr.Item("strUpDatestatus")) Then
                    UpdateCode = "A"
                Else
                    UpdateCode = dr.Item("strUpDateStatus")
                End If
                AIRProgramCodes = ""
                If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                    AIRProgramCodes = "0"
                Else
                    If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "0"
                    End If
                    'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                    '    AIRProgramCodes = AIRProgramCodes & "1"
                    'End If
                    If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "3"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "4"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "6"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "7"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "8"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "9"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "F"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "A"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "I"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "M"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "V"
                    End If
                    If AIRProgramCodes = "" Then
                        AIRProgramCodes = "0"
                    End If
                End If
                If AIRProgramCodes.Length > 6 Then
                    AIRProgramCodes = Mid(AIRProgramCodes, 1, 6)
                End If
                len = AIRProgramCodes.Length
                If len <> 6 Then
                    For i = len To 5
                        AIRProgramCodes = AIRProgramCodes & " "
                    Next
                End If
                UserAFSCode = "G36"
                If IsDBNull(dr.Item("ActionType")) Then
                    ActionType = "XX"
                Else
                    ActionType = dr.Item("ActionType")
                End If
                If IsDBNull(dr.Item("strHPV")) Then
                    HPV = "NOV"
                Else
                    HPV = dr.Item("strHPV")
                End If
                If ActionType = "04" Then
                    If HPV = "NOV" Then
                        ActionType = "VZ"
                    Else
                        ActionType = ActionType
                    End If
                End If
                If IsDBNull(dr.Item("DiscoveryDate")) Then
                    DiscoveryDate = Format(Date.Today, "yyMMdd")
                Else
                    DiscoveryDate = dr.Item("DiscoveryDate")
                End If
                If IsDBNull(dr.Item("DayZero")) Then
                    DayZero = Format(Date.Today, "yyMMdd")
                Else
                    DayZero = dr.Item("DayZero")
                End If
                If IsDBNull(dr.Item("NOVSent")) Then
                    NOVSent = Format(Date.Today, "yyMMdd")
                Else
                    NOVSent = dr.Item("NOVSent")
                End If
                If IsDBNull(dr.Item("NFALetterSent")) Then
                    NFALetter = Format(Date.Today, "yyMMdd")
                Else
                    NFALetter = dr.Item("NFALetterSent")
                End If
                If IsDBNull(dr.Item("COProposed")) Then
                    COProposed = Format(Date.Today, "yyMMdd")
                Else
                    COProposed = dr.Item("COProposed")
                End If
                If IsDBNull(dr.Item("COExecuted")) Then
                    COExecuted = Format(Date.Today, "yyMMdd")
                Else
                    COExecuted = dr.Item("COExecuted")
                End If
                If IsDBNull(dr.Item("COResolved")) Then
                    COResolved = Format(Date.Today, "yyMMdd")
                Else
                    COResolved = dr.Item("COResolved")
                End If
                If IsDBNull(dr.Item("AOExecuted")) Then
                    AOExecuted = Format(Date.Today, "yyMMdd")
                Else
                    AOExecuted = dr.Item("AOExecuted")
                End If
                If IsDBNull(dr.Item("AOAppealed")) Then
                    CivilCourt = Format(Date.Today, "yyMMdd")
                Else
                    CivilCourt = dr.Item("AOAppealed")
                End If
                If IsDBNull(dr.Item("AOResolved")) Then
                    AOResolved = Format(Date.Today, "yyMMdd")
                Else
                    AOResolved = dr.Item("AOResolved")
                End If
                If IsDBNull(dr.Item("StipulatedDate")) Then
                    StipulatedDate = Format(Date.Today, "yyMMdd")
                Else
                    StipulatedDate = dr.Item("StipulatedDate")
                End If
                If IsDBNull(dr.Item("strCOPenaltyAmount")) Then
                    PenaltyAmount = "0"
                Else
                    PenaltyAmount = Replace(dr.Item("strCOPenaltyAmount"), "$", "")
                    PenaltyAmount = Replace(PenaltyAmount, ",", "")
                    'PenaltyAmount = Replace(PenaltyAmount, ".", "")
                    If PenaltyAmount.Contains(".") Then
                        PenaltyAmount = Mid(PenaltyAmount, 1, (PenaltyAmount.IndexOf(".")))
                    End If
                End If

                If PenaltyAmount.Length > 7 Then
                    PenaltyAmount = CSng(PenaltyAmount)
                End If
                len = PenaltyAmount.Length
                If PenaltyAmount.Length <> 7 Then
                    For i = len To 6
                        PenaltyAmount = "0" & PenaltyAmount
                    Next
                End If
                If IsDBNull(dr.Item("strStipulatedPenalty")) Then
                    StipulatedPenalty = "0"
                Else
                    StipulatedPenalty = Replace(dr.Item("strStipulatedPenalty"), "$", "")
                End If
                If StipulatedPenalty.Contains(".") Then
                    StipulatedPenalty = Mid(StipulatedPenalty, 1, (StipulatedPenalty.IndexOf(".")))
                End If

                If StipulatedPenalty.Length > 7 Then
                    StipulatedPenalty = CSng(StipulatedPenalty)
                End If
                len = StipulatedPenalty.Length
                If StipulatedPenalty.Length <> 7 Then
                    For i = len To 6
                        StipulatedPenalty = "0" & StipulatedPenalty
                    Next
                End If
                If IsDBNull(dr.Item("strTrackingNumber")) Then
                    TrackingNumber = ""
                Else
                    TrackingNumber = dr.Item("strTrackingNumber")
                End If
                If IsDBNull(dr.Item("strAFSActionNumber")) Then
                    ActionNumber = ""
                Else
                    ActionNumber = dr.Item("strAFSActionNumber")
                End If
                If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                    KeyActionNumber = ""
                Else
                    KeyActionNumber = dr.Item("strAFSKeyActionNumber")
                End If
                If IsDBNull(dr.Item("strPollutants")) Then
                    Pollutants = "0OT,"
                Else
                    Pollutants = dr.Item("strPollutants")
                End If

                Pollutant1 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                If Pollutants <> "" Then
                    Pollutant2 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                    Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                    If Pollutants <> "" Then
                        Pollutant3 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                        Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                    Else
                        Pollutant3 = ""
                    End If
                Else
                    Pollutant2 = ""
                    Pollutant3 = ""
                End If
                If Pollutant2 = Pollutant1 Then
                    Pollutant2 = ""
                End If
                If Pollutant3 = Pollutant1 Then
                    Pollutant3 = ""
                End If

                If Pollutant1.Length > 5 Then
                    Pollutant1 = Mid(Pollutant1, 1, 5)
                End If
                len = Pollutant1.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant1 = Pollutant1 & " "
                    Next
                End If
                If Pollutant2.Length > 5 Then
                    Pollutant2 = Mid(Pollutant2, 1, 5)
                End If
                len = Pollutant2.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant2 = Pollutant2 & " "
                    Next
                End If
                If Pollutant3.Length > 5 Then
                    Pollutant1 = Mid(Pollutant3, 1, 5)
                End If
                len = Pollutant3.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant3 = Pollutant3 & " "
                    Next
                End If
                If IsDBNull(dr.Item("LinkingEvent")) Then
                    LinkedEvent = ""
                Else
                    LinkedEvent = dr.Item("LinkingEvent")
                    len = LinkedEvent.Length
                    If len < 3 Then
                        For i = len To 3
                            LinkedEvent = LinkedEvent & " "
                        Next
                    Else
                        LinkedEvent = Mid(LinkedEvent, 1, 3)
                    End If
                End If

                Select Case ActionType
                    Case "04"   'Day Zero 
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "04                      " & DayZero & "010000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                       " & Pollutant1 & Pollutant2 & Pollutant3 & "                      " & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "164" & ActionNumber & KeyActionNumber & "                      " & HPV & "                                   " & UpdateCode & vbCrLf
                        If LinkedEvent <> "" Then
                            BatchText = BatchText & _
                            AIRSNumber & "163" & LinkedEvent & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                        End If
                    Case "VZ" 'Non HPV
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "VZ                      " & DayZero & "010000000" & UserAFSCode & "              N" & UpdateCode & _
                            vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                       " & Pollutant1 & Pollutant2 & Pollutant3 & "                      " & UpdateCode & _
                            vbCrLf
                        If LinkedEvent <> "" Then
                            BatchText = BatchText & _
                            AIRSNumber & "163" & LinkedEvent & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                        End If
                    Case "56"   'NOV Sent 
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "56                      " & NOVSent & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "AW"   'NFA Letter Sent
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AW                      " & NFALetter & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "57"   'CO Proposed
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "57                      " & COProposed & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "X1"   'CO Executed
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "X1                      " & COExecuted & "01" & PenaltyAmount & UserAFSCode & "              N" & UpdateCode & _
                            vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "AS"   'CO Resolved
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AS                      " & COResolved & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "Z4"   'Stipulated Penalties
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "Z4                      " & StipulatedDate & "01" & StipulatedPenalty & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "60"   'AO to AG
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "60                      " & AOExecuted & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "64"   'Civil Court
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "64                      " & CivilCourt & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "XX"   'AO Resolved
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AS                      " & AOResolved & "010000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                End Select

            End While
            dr.Close()

            SQL = "Select  " & _
            "" & DBNameSpace & ".afssscpenforcementrecords.strUpDateStatus,  " & _
            "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,   " & _
            "strStaffResponsible,   " & _
            "to_Char(datDiscoveryDate, 'YYMMDD') as DiscoveryDate,   " & _
            "to_char(datDayZero, 'YYMMDD') as DayZero,   " & _
            "to_char(datEnforcementFinalized, 'YYMMDD') as AchievedDate,   " & _
            "to_char(datNOVSent, 'YYMMDD') as NOVSent,   " & _
            "to_char(datNFALetterSent, 'YYMMDD') as NFALetterSent,   " & _
            "to_char(datCOProposed, 'YYMMDD') as COProposed,   " & _
            "to_char(datCOExecuted, 'YYMMDD') as COExecuted,   " & _
            "to_Char(datCOResolved, 'YYMMDD') as COResolved,   " & _
            "to_char(datAOExecuted, 'YYMMDD') as AOExecuted,   " & _
            "to_char(datAOAppealed, 'YYMMDD') as AOAppealed,   " & _
            "to_char(datAOResolved, 'YYMMDD') as AOResolved,   " & _
            "to_char(SSCPEnforcement.datModifingDate, 'YYMMDD') as StipulatedDate,   " & _
            "strCOPenaltyAmount,   " & _
            "" & DBNameSpace & ".SSCPENforcementStipulated.strStipulatedPenalty,   " & _
            "" & DBNameSpace & ".APBHeaderData.strAIRSNumber, strAIRProgramCodes,   " & _
            "" & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber,   " & _
            "strAFSKeyActionNumber, " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber,   " & _
            "case   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSKeyActionNumber then '04'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSNOVSentNumber then '56'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSNOVResolvedNumber then 'AW'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSCOProposedNumber then '57'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSCOExecutedNumber then 'X1'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSCOResolvedNumber then 'AS'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSStipulatedPenaltyNumber then 'Z4'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSAOtoAGNumber then '60'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSCivilCourtNumber then '64'   " & _
            "when " & DBNameSpace & ".afssscpenforcementrecords.strAFSActionNumber = strAFSAOResolvedNumber then 'AS'   " & _
            "Else 'ERROR'    " & _
            "End as ActionType,   " & _
            "strPollutants, strHPV,  " & _
            "" & DBNameSpace & ".afsismprecords.strafsactionnumber as LinkingEvent  " & _
            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords,   " & _
            "" & DBNameSpace & ".SSCPEnforcementItems, " & DBNameSpace & ".SSCPEnforcement,   " & _
            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPENforcementStipulated,   " & _
            "" & DBNameSpace & ".SSCPItemMaster,  " & _
            "" & DBNameSpace & ".sscptestreports,  " & _
            "" & DBNameSpace & ".AFSISMPRecords  " & _
            "where " & DBNameSpace & ".afssscpenforcementrecords.strUpdateStatus <> 'N'   " & _
            "and " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber = " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber   " & _
            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber   " & _
            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber   " & _
            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " & DBNameSpace & ".SSCPENforcementStipulated.strEnforcementNumber (+)   " & _
            "and " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber (+)  " & _
            "and " & DBNameSpace & ".SSCPEnforcementItems.strTrackingNumber = " & DBNameSpace & ".SSCPTestReports.strTrackingNumber (+) " & _
            "and " & DBNameSpace & ".sscptestReports.strReferenceNumber  = " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber  (+) " & _
            "and strEventType = '03' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = Mid(dr.Item("strAIRSNumber"), 3)
                If IsDBNull(dr.Item("strUpDatestatus")) Then
                    UpdateCode = "A"
                Else
                    UpdateCode = dr.Item("strUpDateStatus")
                End If
                AIRProgramCodes = ""
                If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                    AIRProgramCodes = "0"
                Else
                    If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "0"
                    End If
                    'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                    '    AIRProgramCodes = AIRProgramCodes & "1"
                    'End If
                    If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "3"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "4"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "6"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "7"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "8"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "9"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "F"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "A"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "I"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "M"
                    End If
                    If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                        AIRProgramCodes = AIRProgramCodes & "V"
                    End If
                    If AIRProgramCodes = "" Then
                        AIRProgramCodes = "0"
                    End If
                End If
                If AIRProgramCodes.Length > 6 Then
                    AIRProgramCodes = Mid(AIRProgramCodes, 1, 6)
                End If
                len = AIRProgramCodes.Length
                If len <> 6 Then
                    For i = len To 5
                        AIRProgramCodes = AIRProgramCodes & " "
                    Next
                End If
                UserAFSCode = "G36"
                If IsDBNull(dr.Item("ActionType")) Then
                    ActionType = "XX"
                Else
                    ActionType = dr.Item("ActionType")
                End If
                If IsDBNull(dr.Item("strHPV")) Then
                    HPV = "NOV"
                Else
                    HPV = dr.Item("strHPV")
                End If
                If ActionType = "04" Then
                    If HPV = "NOV" Then
                        ActionType = "VZ"
                    Else
                        ActionType = ActionType
                    End If
                End If
                If IsDBNull(dr.Item("DiscoveryDate")) Then
                    DiscoveryDate = Format(Date.Today, "yyMMdd")
                Else
                    DiscoveryDate = dr.Item("DiscoveryDate")
                End If
                If IsDBNull(dr.Item("DayZero")) Then
                    DayZero = Format(Date.Today, "yyMMdd")
                Else
                    DayZero = dr.Item("DayZero")
                End If
                If IsDBNull(dr.Item("NOVSent")) Then
                    NOVSent = Format(Date.Today, "yyMMdd")
                Else
                    NOVSent = dr.Item("NOVSent")
                End If
                If IsDBNull(dr.Item("NFALetterSent")) Then
                    NFALetter = Format(Date.Today, "yyMMdd")
                Else
                    NFALetter = dr.Item("NFALetterSent")
                End If
                If IsDBNull(dr.Item("COProposed")) Then
                    COProposed = Format(Date.Today, "yyMMdd")
                Else
                    COProposed = dr.Item("COProposed")
                End If
                If IsDBNull(dr.Item("COExecuted")) Then
                    COExecuted = Format(Date.Today, "yyMMdd")
                Else
                    COExecuted = dr.Item("COExecuted")
                End If
                If IsDBNull(dr.Item("COResolved")) Then
                    COResolved = Format(Date.Today, "yyMMdd")
                Else
                    COResolved = dr.Item("COResolved")
                End If
                If IsDBNull(dr.Item("AOExecuted")) Then
                    AOExecuted = Format(Date.Today, "yyMMdd")
                Else
                    AOExecuted = dr.Item("AOExecuted")
                End If
                If IsDBNull(dr.Item("AOAppealed")) Then
                    CivilCourt = Format(Date.Today, "yyMMdd")
                Else
                    CivilCourt = dr.Item("AOAppealed")
                End If
                If IsDBNull(dr.Item("AOResolved")) Then
                    AOResolved = Format(Date.Today, "yyMMdd")
                Else
                    AOResolved = dr.Item("AOResolved")
                End If
                If IsDBNull(dr.Item("StipulatedDate")) Then
                    StipulatedDate = Format(Date.Today, "yyMMdd")
                Else
                    StipulatedDate = dr.Item("StipulatedDate")
                End If
                If IsDBNull(dr.Item("strCOPenaltyAmount")) Then
                    PenaltyAmount = "0"
                Else
                    PenaltyAmount = Replace(dr.Item("strCOPenaltyAmount"), "$", "")
                    PenaltyAmount = Replace(PenaltyAmount, ",", "")
                    If PenaltyAmount.Contains(".") Then
                        PenaltyAmount = Mid(PenaltyAmount, 1, (PenaltyAmount.IndexOf(".")))
                    End If
                End If
                If PenaltyAmount.Length > 7 Then
                    PenaltyAmount = CSng(PenaltyAmount)
                End If
                len = PenaltyAmount.Length
                If PenaltyAmount.Length <> 7 Then
                    For i = len To 6
                        PenaltyAmount = "0" & PenaltyAmount
                    Next
                End If
                If IsDBNull(dr.Item("strStipulatedPenalty")) Then
                    StipulatedPenalty = "0"
                Else
                    StipulatedPenalty = Replace(dr.Item("strStipulatedPenalty"), "$", "")
                End If
                If StipulatedPenalty.Contains(".") Then
                    StipulatedPenalty = Mid(StipulatedPenalty, 1, (StipulatedPenalty.IndexOf(".")))
                End If
                If StipulatedPenalty.Length > 7 Then
                    StipulatedPenalty = CSng(StipulatedPenalty)
                End If
                len = StipulatedPenalty.Length
                If StipulatedPenalty.Length <> 7 Then
                    For i = len To 6
                        StipulatedPenalty = "0" & StipulatedPenalty
                    Next
                End If
                If IsDBNull(dr.Item("strTrackingNumber")) Then
                    TrackingNumber = ""
                Else
                    TrackingNumber = dr.Item("strTrackingNumber")
                End If
                If IsDBNull(dr.Item("strAFSActionNumber")) Then
                    ActionNumber = ""
                Else
                    ActionNumber = dr.Item("strAFSActionNumber")
                End If
                If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                    KeyActionNumber = ""
                Else
                    KeyActionNumber = dr.Item("strAFSKeyActionNumber")
                End If
                If IsDBNull(dr.Item("strPollutants")) Then
                    Pollutants = "0OT,"
                Else
                    Pollutants = dr.Item("strPollutants")
                End If

                Pollutant1 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                If Pollutants <> "" Then
                    Pollutant2 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                    Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                    If Pollutants <> "" Then
                        Pollutant3 = Mid(Pollutants, 2, (InStr(Pollutants, ",", CompareMethod.Text) - 2))
                        Pollutants = Mid(Pollutants, (InStr(Pollutants, ",", CompareMethod.Text) + 1))
                    Else
                        Pollutant3 = ""
                    End If
                Else
                    Pollutant2 = ""
                    Pollutant3 = ""
                End If
                If Pollutant2 = Pollutant1 Then
                    Pollutant2 = ""
                End If
                If Pollutant3 = Pollutant1 Then
                    Pollutant3 = ""
                End If

                If Pollutant1.Length > 5 Then
                    Pollutant1 = Mid(Pollutant1, 1, 5)
                End If
                len = Pollutant1.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant1 = Pollutant1 & " "
                    Next
                End If
                If Pollutant2.Length > 5 Then
                    Pollutant2 = Mid(Pollutant2, 1, 5)
                End If
                len = Pollutant2.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant2 = Pollutant2 & " "
                    Next
                End If
                If Pollutant3.Length > 5 Then
                    Pollutant1 = Mid(Pollutant3, 1, 5)
                End If
                len = Pollutant3.Length
                If len <> 5 Then
                    For i = len To 4
                        Pollutant3 = Pollutant3 & " "
                    Next
                End If
                If IsDBNull(dr.Item("LinkingEvent")) Then
                    LinkedEvent = ""
                Else
                    LinkedEvent = dr.Item("LinkingEvent")
                    len = LinkedEvent.Length
                    If len < 3 Then
                        For i = len To 3
                            LinkedEvent = LinkedEvent & " "
                        Next
                    Else
                        LinkedEvent = Mid(LinkedEvent, 1, 3)
                    End If
                End If

                Select Case ActionType
                    Case "04"   'Day Zero 
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "04                      " & DayZero & "010000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                       " & Pollutant1 & Pollutant2 & Pollutant3 & "                      " & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "164" & ActionNumber & KeyActionNumber & "                      " & HPV & "                                   " & UpdateCode & _
                           vbCrLf
                        If LinkedEvent <> "" Then
                            BatchText = BatchText & _
                            AIRSNumber & "163" & LinkedEvent & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                        End If
                    Case "VZ" 'Non HPV
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "VZ                      " & DayZero & "010000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                       " & Pollutant1 & Pollutant2 & Pollutant3 & "                      " & UpdateCode & _
                           vbCrLf 
                        If LinkedEvent <> "" Then
                            BatchText = BatchText & _
                            AIRSNumber & "163" & LinkedEvent & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                        End If
                    Case "56"   'NOV Sent 
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "56                      " & NOVSent & "  0000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "AW"   'NFA Letter Sent
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AW                      " & NFALetter & "  0000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "57"   'CO Proposed
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "57                      " & COProposed & "  0000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "X1"   'CO Executed
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "X1                      " & COExecuted & "01" & PenaltyAmount & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "AS"   'CO Resolved
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AS                      " & COResolved & "  0000000" & UserAFSCode & "              N" & UpdateCode & vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & vbCrLf
                    Case "Z4"   'Stipulated Penalties
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "Z4                      " & StipulatedDate & "01" & StipulatedPenalty & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "60"   'AO to AG
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "60                      " & AOExecuted & "  0000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "64"   'Civil Court
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "64                      " & CivilCourt & "  0000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                    Case "XX"   'AO Resolved
                        BatchText = BatchText & _
                        AIRSNumber & "161" & ActionNumber & AIRProgramCodes & "AS                      " & AOResolved & "010000000" & UserAFSCode & "              N" & UpdateCode & _
                           vbCrLf & _
                        AIRSNumber & "163" & ActionNumber & KeyActionNumber & "                                                            " & UpdateCode & _
                           vbCrLf
                End Select
            End While
            dr.Close()

            SQL = "Update " & DBNameSpace & ".AFSSSCPEnforcementRecords set " & _
            "strUpDateStatus = 'N' " & _
            "where strUPDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         

    End Sub
    Sub ISMPActions()
        Dim BatchText As String = ""
        Dim len As Integer
        Dim i As Integer
        Dim AIRSNumber As String = ""
        Dim ActionNumber As String = ""
        Dim AirProgramCodes As String = ""
        Dim ActionType As String = ""
        Dim ResultsCode As String = ""
        Dim DateAchieved As String = ""
        Dim Pollutant As String = ""
        Dim Staff As String = ""
        Dim UpdateStatus As String = ""
        Dim ReferenceNumber As String = ""
        Dim CommentLine As String = ""

        SQL = "Select " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber, " & _
        "strAfsActionNumber, substr(" & DBNameSpace & ".ISMPMaster.strAIRSNumber, 3) as AIRSNumber,  " & _
        "strAIRProgramCodes,  " & _
        "case  " & _
        "	when strWitnessingEngineer = '0' then 'TR'  " & _
        "	Else '23' " & _
        "END as ActionType,  " & _
        "case  " & _
        "	WHEN strComplianceStatus = '01' then 'N/A' " & _
        "	when strComplianceStatus = '02' then 'PP' " & _
        "	when strComplianceStatus = '03' then 'PP'  " & _
        "	when strComplianceStatus = '04' then 'N/A'  " & _
        "	when strComplianceStatus = '05' then 'FF'  " & _
        "End as ResultsCode,  " & _
        "to_char(datTestDateEnd, 'YYMMDD') as DateAchieved, " & _
        "strReviewingEngineer, strUpdateStatus, strPollutant, " & _
        "mmoCommentArea, strafscode  " & _
        "from " & DBNameSpace & ".AFSISMPRecords, " & DBNameSpace & ".ISMPMaster, " & _
        "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".APBHeaderData, " & _
        "" & DBNameSpace & ".LookUPPollutants  " & _
        "where " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber  " & _
        "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber  " & _
        "and " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSnumber " & _
        "and " & DBNameSpace & ".LookUPPollutants.strPollutantcode = " & DBNameSpace & ".ISMPReportInformation.strPollutant " & _
        "and strUpdateStatus <> 'N'"

        Try
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                AIRSNumber = dr.Item("AIRSNumber")
                ActionNumber = dr.Item("strAFSActionNumber")
                ActionType = dr.Item("ActionType")
                ResultsCode = dr.Item("resultsCode")
               
                DateAchieved = dr.Item("DateAchieved")
                AirProgramCodes = ""

                If Mid(dr.Item("strAIRProgramCodes"), 1, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "0"
                End If
                'If Mid(dr.Item("strAIRProgramCodes"), 2, 1) = 1 Then
                '    AirProgramCodes = AirProgramCodes & "1"
                'End If
                If Mid(dr.Item("strAIRProgramCodes"), 3, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "3"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 4, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "4"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 5, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "6"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 6, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "7"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 7, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "8"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 8, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "9"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 9, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "F"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 10, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "A"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 11, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "I"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 12, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "M"
                End If
                If Mid(dr.Item("strAIRProgramCodes"), 13, 1) = 1 Then
                    AirProgramCodes = AirProgramCodes & "V"
                End If
                Staff = "GM8"
                UpdateStatus = dr.Item("strUpdateStatus")

                If AirProgramCodes.Length > 6 Then
                    AirProgramCodes = Mid(AirProgramCodes, 1, 6)
                End If
                If AirProgramCodes = "" Then
                    AirProgramCodes = "0"
                End If
                If AirProgramCodes.Length <> 6 Then
                    len = AirProgramCodes.Length
                    For i = len To 5
                        AirProgramCodes = AirProgramCodes & " "
                    Next
                End If

                len = ActionType.Length
                For i = len To 23
                    ActionType = ActionType & " "
                Next
              
                len = Staff.Length
                For i = len To 4
                    Staff = Staff & " "
                Next
                If IsDBNull(dr.Item("strafscode")) Then
                    Pollutant = "     "
                Else
                    If dr.Item("strafscode") = True Then
                        If IsDBNull(dr.Item("strPollutant")) Then
                            Pollutant = "     "
                        Else
                            Pollutant = dr.Item("strPOllutant")
                        End If
                    End If
                End If

                len = Pollutant.Length
                For i = len To 12
                    Pollutant = Pollutant & " "
                Next
                If IsDBNull(dr.Item("strReferenceNumber")) Then
                    ReferenceNumber = ""
                Else
                    ReferenceNumber = dr.Item("strReferenceNumber")
                End If

                CommentLine = "GA EPD #:" & ReferenceNumber
                CommentLine = Mid(CommentLine, 1, 55)

                len = CommentLine.Length
                For i = len To 54
                    CommentLine = CommentLine & " "
                Next

                Select Case resultscode
                    Case "PP"
                        BatchText = BatchText & AIRSNumber & "161" & ActionNumber & AirProgramCodes & _
                        ActionType & DateAchieved & "PP       " & Staff & Pollutant & UpdateStatus & vbCrLf & _
                        AIRSNumber & "171  " & ActionNumber & "001C" & CommentLine & "  " & UpdateStatus & vbCrLf
                    Case "FF"
                        BatchText = BatchText & AIRSNumber & "161" & ActionNumber & AirProgramCodes & _
                        ActionType & DateAchieved & "FF       " & Staff & Pollutant & UpdateStatus & vbCrLf & _
                        AIRSNumber & "171  " & ActionNumber & "001C" & CommentLine & "  " & UpdateStatus & vbCrLf
                    Case Else

                End Select

                'BatchText = BatchText & AIRSNumber & "161" & ActionNumber & AirProgramCodes & _
                'ActionType & DateAchieved & Staff & Pollutant & UpdateStatus & vbCrLf & _
                'AIRSNumber & "171  " & ActionNumber & "001C" & CommentLine & "  " & UpdateStatus & vbCrLf

            End While

            SQL = "Update " & DBNameSpace & ".AFSISMPRecords set " & _
            "strUpDateStatus = 'N' " & _
            "where strUPDateStatus <> 'N' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

            txtAFSBatchFile.Text = txtAFSBatchFile.Text & BatchText

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         

    End Sub
    Sub FindRegion(ByVal Region As String, ByVal AIRSNumber As String)
        Try
            
            If Len(AIRSNumber) = 12 And IsNumeric(AIRSNumber) Then
                SQL = "Select (" & DBNameSpace & ".LookUPDistricts.strDistrictcode|| '-'||strDistrictName) as District " & _
                "from " & DBNameSpace & ".LookUPDistricts, " & DBNameSpace & ".LookUPDistrictInformation " & _
                "where " & DBNameSpace & ".LookUPDistricts.strDistrictCode = " & DBNameSpace & ".LookUPDistrictInformation.strDistrictCode " & _
                "and strDistrictCounty = '" & Mid(AIRSNumber, 5, 3) & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                recExist = dr.Read

                If recExist Then
                    Region = dr.Item("District")
                Else
                    Region = "WARNING"
                End If
            Else
                Region = "WARNING"
            End If

            txtCDSRegionCode.Text = Region

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
       
        End Try
         

    End Sub
    Sub CreateNewFacility()
        Dim AIRSNumber As String = ""
        Dim FacilityName As String = ""
        Dim FacilityStreet As String = ""
        Dim FacilityCity As String = ""
        Dim FacilityZipCode As String = ""
        Dim FacilityLongitude As String = ""
        Dim FacilityLatitude As String = ""
        Dim MailingStreet As String = ""
        Dim MailingCity As String = ""
        Dim MailingState As String = ""
        Dim MailingZipCode As String = ""
        Dim OperatingStatus As String = ""
        Dim Classification As String = ""
        Dim AirProgramCode As String = ""
        Dim SICCode As String = ""
        Dim DistrictOffice As String = ""
        Dim PlantDesc As String = ""
        Dim ContactFirstName As String = ""
        Dim ContactLastName As String = ""
        Dim ContactPrefix As String = ""
        Dim ContactSuffix As String = ""
        Dim ContactTitle As String = ""
        Dim ContactPhoneNumber As String = ""

        Try
            
            txtCDSAIRSNumber.BackColor = Color.White
            txtCDSFacilityName.BackColor = Color.White

            If txtCDSAIRSNumber.Text.Length = 12 Then
                AIRSNumber = txtCDSAIRSNumber.Text

                SQL = "Select strAIRSNumber " & _
                "from " & DBNameSpace & ".APBMasterAIRS " & _
                "where strAIRSNumber = '" & AIRSNumber & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = False Then
                    If txtCDSFacilityName.Text <> "" Then
                        FacilityName = txtCDSFacilityName.Text
                        If txtCDSStreetAddress.Text <> "" Then
                            FacilityStreet = txtCDSStreetAddress.Text
                        Else
                            FacilityStreet = "N/A"
                        End If
                        If txtCDSCity.Text <> "" Then
                            FacilityCity = txtCDSCity.Text
                        Else
                            FacilityCity = "N/A"
                        End If
                        If mtbCDSZipCode.Text <> "" Then
                            FacilityZipCode = mtbCDSZipCode.Text
                        Else
                            FacilityZipCode = "00000"
                        End If
                        If mtbFacilityLongitude.Text <> "" Then
                            FacilityLongitude = mtbFacilityLongitude.Text
                        Else
                            FacilityLongitude = "00.000000"
                        End If
                        If mtbFacilityLatitude.Text <> "" Then
                            FacilityLatitude = mtbFacilityLatitude.Text
                        Else
                            FacilityLatitude = "-00.000000"
                        End If
                        If cboCDSOperationalStatus.Items.Contains(cboCDSOperationalStatus.Text) Then
                            OperatingStatus = Mid(cboCDSOperationalStatus.Text, 1, 1)
                        Else
                            OperatingStatus = "O"
                        End If
                        If cboCDSClassCode.Items.Contains(cboCDSClassCode.Text) Then
                            Classification = Mid(cboCDSClassCode.Text, 1, (InStr(1, cboCDSClassCode.Text, "-", CompareMethod.Text)) - 2)
                        Else
                            Classification = "C"
                        End If

                        AirProgramCode = "000000000000000"

                        If chbCDS_1.Checked = True Then
                            AirProgramCode = "1" & Mid(AirProgramCode, 2)
                        End If
                        If chbCDS_2.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 1) & "1" & Mid(AirProgramCode, 3)
                        End If
                        If chbCDS_3.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 2) & "1" & Mid(AirProgramCode, 4)
                        End If
                        If chbCDS_4.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 3) & "1" & Mid(AirProgramCode, 5)
                        End If
                        If chbCDS_5.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 4) & "1" & Mid(AirProgramCode, 6)
                        End If
                        If chbCDS_6.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 5) & "1" & Mid(AirProgramCode, 7)
                        End If
                        If chbCDS_7.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 6) & "1" & Mid(AirProgramCode, 8)
                        End If
                        If chbCDS_8.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 7) & "1" & Mid(AirProgramCode, 9)
                        End If
                        If chbCDS_9.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 8) & "1" & Mid(AirProgramCode, 10)
                        End If
                        If chbCDS_10.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 9) & "1" & Mid(AirProgramCode, 11)
                        End If
                        If chbCDS_11.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 10) & "1" & Mid(AirProgramCode, 12)
                        End If
                        If chbCDS_12.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 11) & "1" & Mid(AirProgramCode, 13)
                        End If
                        If chbCDS_13.Checked = True Then
                            AirProgramCode = Mid(AirProgramCode, 1, 12) & "1" & Mid(AirProgramCode, 14)
                        End If
                        If AirProgramCode.Length <> 15 Then
                            AirProgramCode = "100000000000000"
                        Else
                            AirProgramCode = AirProgramCode
                        End If
                        If mtbCDSSICCode.Text <> "" Then
                            SICCode = mtbCDSSICCode.Text
                        Else
                            SICCode = "0000"
                        End If
                        If txtCDSRegionCode.Text <> "" Then
                            DistrictOffice = Mid(txtCDSRegionCode.Text, 1, 1)
                        Else
                            DistrictOffice = "A"
                        End If
                        If txtFacilityDescription.Text <> "" Then
                            PlantDesc = txtFacilityDescription.Text
                        Else
                            PlantDesc = "N/A"
                        End If
                        If txtContactSocialTitle.Text <> "" Then
                            ContactPrefix = Replace(txtContactSocialTitle.Text, "'", "''")
                        Else
                            ContactPrefix = ""
                        End If
                        If txtContactPedigree.Text <> "" Then
                            ContactSuffix = Replace(txtContactPedigree.Text, "'", "''")
                        Else
                            ContactSuffix = ""
                        End If
                        If txtContactFirstName.Text <> "" Then
                            ContactFirstName = Replace(txtContactFirstName.Text, "'", "''")
                        Else
                            ContactFirstName = "N/A"
                        End If
                        If txtContactLastName.Text <> "" Then
                            ContactLastName = Replace(txtContactLastName.Text, "'", "''")
                        Else
                            ContactLastName = "N/A"
                        End If
                        If txtContactTitle.Text <> "" Then
                            ContactTitle = txtContactTitle.Text
                        Else
                            ContactTitle = "N/A"
                        End If
                        If mtbContactPhoneNumber.Text <> "" Then
                            ContactPhoneNumber = Replace(Replace(Replace(Replace(mtbContactPhoneNumber.Text, "(", ""), ")", ""), " ", ""), "-", "")
                        Else
                            ContactPhoneNumber = "0000000000"
                        End If
                        If mtbContactNumberExtension.Text <> "" Then
                            ContactPhoneNumber = ContactPhoneNumber & mtbContactNumberExtension.Text
                        End If
                        If txtMailingAddress.Text <> "" Then
                            MailingStreet = txtMailingAddress.Text
                        Else
                            MailingStreet = "N/A"
                        End If
                        If txtMailingCity.Text <> "" Then
                            MailingCity = txtMailingCity.Text
                        Else
                            MailingCity = "N/A"
                        End If
                        If txtMailingState.Text <> "" Then
                            MailingState = txtMailingState.Text
                        Else
                            MailingState = "GA"
                        End If
                        If mtbMailingZipCode.Text <> "" Then
                            MailingZipCode = mtbMailingZipCode.Text
                        Else
                            MailingZipCode = "00000"
                        End If

                        SQL = "Insert into " & DBNameSpace & ".APBMasterAIRS " & _
                        "(strAIRSNumber, strModifingPerson, " & _
                        "datModifingDate) " & _
                        "values " & _
                        "('" & AIRSNumber & "', '" & UserGCode & "', " & _
                        "'" & OracleDate & "') "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()

                        SQL = "Insert into " & DBNameSpace & ".APBFacilityInformation " & _
                        "(strAIRSNumber, strFacilityName, " & _
                        "strFacilityStreet1, strFacilityStreet2, " & _
                        "strFacilityCity, strFacilityState, " & _
                        "strFacilityZipCode, strModifingPerson, " & _
                        "datModifingDate, numFacilityLongitude, " & _
                        "numFacilityLatitude, strHorizontalCollectionCode, " & _
                        "strHorizontalAccuracyMeasure, strHorizontalReferenceCode) " & _
                        "values " & _
                        "('" & AIRSNumber & "', '" & Replace(FacilityName, "'", "''") & "', " & _
                        "'" & Replace(FacilityStreet, "'", "''") & "', 'N/A', " & _
                        "'" & Replace(FacilityCity, "'", "''") & "', 'GA', " & _
                        "'" & FacilityZipCode & "', '" & UserGCode & "', " & _
                        "'" & OracleDate & "', " & FacilityLongitude & ", " & _
                        "" & FacilityLatitude & ", '007', " & _
                        "'25', '002') "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()

                        Dim AttainmentStatus As String = ""

                        SQL = "select " & _
                        "strNonAttainment " & _
                        "from " & DBNameSpace & ".LookUpCountyInformation " & _
                        "where strCountyCode = '" & Mid(AIRSNumber, 5, 3) & "' "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strNonAttainment")) Then
                                AttainmentStatus = "00000"
                            Else
                                AttainmentStatus = dr.Item("strNonAttainment")
                            End If
                        End While
                        dr.Close()


                        SQL = "Insert into " & DBNameSpace & ".APBHeaderData " & _
                        "(strAIRSNumber, strOperationalStatus, " & _
                        "strClass, " & _
                        "strAIRProgramCodes, strSICCode, " & _
                        "strFEINumber, strModifingPerson, " & _
                        "datModifingDate, datStartUpDate, " & _
                        "datShutDownDate, strComments, " & _
                        "strPlantDescription, strAttainmentStatus) " & _
                        "values " & _
                        "('" & AIRSNumber & "', '" & OperatingStatus & "', " & _
                        "'" & Classification & "', " & _
                        "'" & AirProgramCode & "', '" & SICCode & "', " & _
                        "'N/A', '" & UserGCode & "', " & _
                        "'" & OracleDate & "', '', '', " & _
                        "'From ISMP Data Management Tool, by " & UserName & "', " & _
                        "'" & Replace(PlantDesc, "'", "''") & "', '" & AttainmentStatus & "') "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If

                        dr = cmd.ExecuteReader
                        dr.Close()

                        SQL = "Insert into " & DBNameSpace & ".APBSupplamentalData " & _
                        "(strAIRSNumber, datSSCPTestReportDue, " & _
                        "strModifingPerson, DatModifingDate, " & _
                        "strDistrictOffice, strCMSMember, " & _
                        "strAFSActionNumber) " & _
                        "values " & _
                         "('" & AIRSNumber & "', '', " & _
                         "'" & UserGCode & "', '" & OracleDate & "', " & _
                         "'" & DistrictOffice & "', '', " & _
                         "'001' ) "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If

                        dr = cmd.ExecuteReader
                        dr.Close()

                        SQL = "insert into " & DBNameSpace & ".APBContactInformation " & _
                        "(strContactKey, strAIRSNumber, strKey, " & _
                        "strContactFirstName, strContactLastName, " & _
                        "strContactPrefix, strContactSuffix, " & _
                        "strContactTitle, strContactCompanyName, " & _
                        "strContactPhoneNumber1, strContactPhoneNumber2, " & _
                        "strContactFaxNumber, strContactEmail, " & _
                        "strContactAddress1, strContactAddress2, " & _
                        "strContactCity, strContactState, " & _
                        "strContactZipCode, strModifingPerson, " & _
                        "datModifingDate) " & _
                        "values " & _
                        "('" & AIRSNumber & "30', '" & AIRSNumber & "', '30', " & _
                        "'" & Replace(ContactFirstName, "'", "''") & "', '" & Replace(ContactLastName, "'", "''") & "', " & _
                        "'" & ContactPrefix & "', '" & ContactSuffix & "', " & _
                        "'" & Replace(ContactTitle, "'", "''") & "', 'N/A', " & _
                        "'" & ContactPhoneNumber & "', 'N/A', " & _
                        "'N/A', 'N/A', " & _
                        "'" & Replace(MailingStreet, "'", "''") & "', 'N/A', " & _
                        "'" & Replace(MailingCity, "'", "''") & "', '" & MailingState & "', " & _
                        "'" & MailingZipCode & "', '" & UserGCode & "', " & _
                        "'" & OracleDate & "') "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If

                        dr = cmd.ExecuteReader
                        dr.Close()

                        If chbCDS_1.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "0', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_2.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "1', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_3.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "3', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_4.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "4', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_5.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "6', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_6.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "7', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_7.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "8', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_8.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "9', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_9.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "F', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_10.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "A', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_11.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "I', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_12.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "M', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If
                        If chbCDS_13.Checked = True Then
                            SQL = "Insert into " & DBNameSpace & ".APBAirProgramPollutants " & _
                            "(strAIRSNumber, strAIRPollutantKey, " & _
                            "strPollutantKey, strComplianceStatus, " & _
                            "strModifingPerson, datModifingDate) " & _
                            "values " & _
                            "('" & AIRSNumber & "', '" & AIRSNumber & "V', " & _
                            "'OT', 'C', " & _
                            "'" & UserGCode & "', '" & OracleDate & "') "

                            cmd = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If

                            dr = cmd.ExecuteReader
                            dr.Close()
                        End If

                        SQL = "Insert into " & DBNameSpace & ".SSCPDistrictResponsible " & _
                        "values " & _
                        "('" & AIRSNumber & "', 'False', " & _
                        "'001', sysdate) "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()

                        'SQL = "insert into " & DBNameSpace & ".SSCPFacilityAssignment " & _
                        '"values " & _
                        '"('" & AIRSNumber & "', 'K', '9', '" & UserGCode & "', sysdate) "

                        SQL = "Insert into " & DBNameSpace & ".SSCPInspectionsRequired " & _
                        "(numKey, strAIRsnumber, intyear) " & _
                        "values " & _
                        "((select max(numKey) + 1 from " & DBNameSpace & ".SSCPInspectionsRequired), " & _
                        "'" & AIRSNumber & "', '" & Now.Year.ToString & "') "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()

                        MsgBox("Facility Added to Integrated Air Information Platform", MsgBoxStyle.Information, "AFS Tools")

                    Else
                        MsgBox("A Facility Name must be provided at this time.", MsgBoxStyle.Information, "AFS Tools")
                        txtCDSFacilityName.BackColor = Color.PeachPuff
                    End If
                Else
                    MsgBox("This AIRS Number already exists in the platform.", MsgBoxStyle.Information, "AFS Tools")
                End If
            Else
                MsgBox("The AIRS Number must be 12 characters long." & vbCrLf & "Beginning with '0413'", MsgBoxStyle.Information, "AFS Tools")
                txtCDSAIRSNumber.BackColor = Color.PeachPuff
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
#Region "Clears"
    Sub ClearCreateFacility()
        Try
            
            txtCDSAIRSNumber.Text = "0413"
            txtCDSFacilityName.Text = ""
            txtCDSStreetAddress.Clear()
            txtCDSCity.Clear()
            mtbCDSZipCode.Clear()
            mtbFacilityLongitude.Clear()
            mtbFacilityLatitude.Clear()
            txtMailingAddress.Clear()
            txtMailingCity.Clear()
            txtMailingState.Text = "GA"
            mtbMailingZipCode.Clear()
            cboCDSOperationalStatus.Text = ""
            mtbCDSSICCode.Clear()
            cboCDSClassCode.Text = ""
            chbCDS_1.Checked = False
            chbCDS_2.Checked = False
            chbCDS_3.Checked = False
            chbCDS_4.Checked = False
            chbCDS_5.Checked = False
            chbCDS_6.Checked = False
            chbCDS_7.Checked = False
            chbCDS_8.Checked = False
            chbCDS_9.Checked = False
            chbCDS_10.Checked = False
            chbCDS_11.Checked = False
            chbCDS_12.Checked = False
            chbCDS_13.Checked = False
            txtFacilityDescription.Clear()
            txtContactFirstName.Clear()
            txtContactLastName.Clear()
            txtContactSocialTitle.Clear()
            txtContactPedigree.Clear()
            txtContactTitle.Clear()
            mtbContactPhoneNumber.Clear()
            mtbContactNumberExtension.Clear()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub

#End Region
    Sub RunTitleVRenewalReport()
        Dim ApplicationNumber As String
        Dim AIRSNumber As String
        Dim FacilityName As String
        Dim PermitNumber As String
        Dim DateIssued As String
        Dim EffectiveDate As String
        Dim temp As String

        Try
            
            Startdate = DTPTitleVRenewalStart.Text
            EndDate = DTPTitleVRenewalEnd.Text

            Startdate = Format(CDate(Startdate).AddMonths(-51), "dd-MMM-yyyy")
            EndDate = Format(CDate(EndDate).AddMonths(-51), "dd-MMM-yyyy")


            'EndDate = CDate(EndDate).AddMonths(-50)
            'EndDate = CDate(EndDate).Month & "-01-" & CDate(EndDate).Year
            'EndDate = Format(CDate(EndDate), "dd-MMM-yyyy")

            lblStartDate.Text = Startdate
            lblEndDate.Text = EndDate

            clbTitleVRenewals.Items.Clear()

            temp = "App #  -  Airs #   - Facility Name " & vbTab & vbTab & vbTab & vbTab & vbTab & " (     Permit Number    ) " & vbTab & "Issued Date" & vbTab & "Effective Date"
            If clbTitleVRenewals.Items.Contains(temp) Then
            Else
                clbTitleVRenewals.Items.Add(temp)
            End If

            SQL = "select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "substr(" & DBNameSpace & ".APBFacilityInformation.strAIRSnumber, 5) as AIRSNumber,  " & _
            "" & DBNameSpace & ".APBFacilityInformation.strFacilityName,  " & _
            "(substr(strPermitNumber, 1, 4)|| '-' || substr(strPermitNumber, 5, 3)  " & _
            "   || '-' || substr(strPermitNumber, 8, 4)|| '-' ||substr(strPermitNumber, 12, 1)  " & _
            "     || '-' ||substr(strPermitNumber, 13,2) || '-' ||substr(strPermitNumber, 15)) as PermitNumber,  " & _
            "to_char(datPermitIssued, 'dd-Mon-yyyy') as PermitIssued, " & _
            "to_char(datEffective, 'dd-Mon-yyyy') as EffectiveDate  " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster,  " & _
            "" & DBNameSpace & ".SSPPApplicationData, " & DBNameSpace & ".SSPPApplicationTracking,  " & _
            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".APBFacilityInformation  " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber  " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber  " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strAIRSnumber = " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber  " & _
            "and strPermitNumber Like '%V__0'  " & _
            "and " & DBNameSpace & ".APBHeaderData.strOperationalStatus <> 'X'  " & _
            "and substr(" & DBNameSpace & ".apbheaderdata.strairprogramcodes, 13, 1) = '1' " & _
            "and (datPermitIssued between '" & Startdate & "' and '" & EndDate & "' " & _
            "   or datEffective between '" & Startdate & "' and '" & EndDate & "') " & _
            "and (strApplicationType = '14' or strApplicationType = '16' or strApplicationType = '27') "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strApplicationNumber")) Then
                    ApplicationNumber = ""
                Else
                    ApplicationNumber = dr.Item("strApplicationNumber")
                End If
                If IsDBNull(dr.Item("AIRSNumber")) Then
                    AIRSNumber = ""
                Else
                    AIRSNumber = dr.Item("AIRSNumber")
                End If
                If IsDBNull(dr.Item("strFacilityName")) Then
                    FacilityName = "N/A"
                Else
                    FacilityName = dr.Item("strFacilityName")
                End If
                If IsDBNull(dr.Item("PermitNumber")) Then
                    PermitNumber = "PermitNumber"
                Else
                    PermitNumber = dr.Item("PermitNumber")
                End If
                If IsDBNull(dr.Item("PermitIssued")) Then
                    DateIssued = "N/A"
                Else
                    DateIssued = dr.Item("PermitIssued")
                End If
                If IsDBNull(dr.Item("EffectiveDate")) Then
                    EffectiveDate = "N/A"
                Else
                    EffectiveDate = dr.Item("EffectiveDate")
                End If

                If AIRSNumber <> "" Then
                    temp = ApplicationNumber & " - " & AIRSNumber & " - " & FacilityName
                    Select Case temp.Length
                        Case 10 To 24
                            temp = temp & vbTab & vbTab & vbTab & vbTab & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 25 To 32
                            temp = temp & vbTab & vbTab & vbTab & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 33 To 39
                            temp = temp & vbTab & vbTab & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 40 To 45
                            temp = temp & vbTab & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 46 To 52
                            temp = temp & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 53 To 59
                            temp = temp & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 60 To 66
                            temp = temp & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case 67 To 100
                            temp = temp & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                        Case Else
                            temp = temp & vbTab & vbTab & vbTab & vbTab & vbTab & " ( " & PermitNumber & " ) " & vbTab & DateIssued & vbTab & EffectiveDate
                    End Select

                    If clbTitleVRenewals.Items.Contains(temp) Then
                    Else
                        clbTitleVRenewals.Items.Add(temp)
                        clbTitleVRenewals.SetItemChecked(clbTitleVRenewals.Items.IndexOf(temp), True)
                    End If

                End If

                txtRenewalCount.Text = clbTitleVRenewals.Items.Count - 1

            End While
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub LoadErrorLog()
        Try
            
            SQL = "Select " & _
            "strErrorNumber, " & _
            "(strLastName||', '||strFirstName) as ErrorUser,  " & _
            "strErrorLocation, strErrorMessage,  " & _
            "to_char(datErrorDate, 'DD-Mon-YYYY') as ErrorDate,  " & _
            "strSolution  " & _
            "from " & DBNameSpace & ".IAIPErrorLog, " & DBNameSpace & ".EPDUserProfiles  " & _
            "where " & DBNameSpace & ".IAIPErrorLog.strUser = " & DBNameSpace & ".EPDUserProfiles.numUserID "

            If rdbViewAllErrors.Checked = True Then
                SQL = SQL
            End If
            If rdbViewResolvedErrors.Checked = True Then
                SQL = SQL & " and strSolution IS NOT NUll "
            End If
            If rdbViewUnresolvedErrors.Checked = True Then
                SQL = SQL & " and strSolution IS NULL "
            End If

            If SQL <> "" Then
                dsErrorLog = New DataSet
                daErrorLog = New OracleDataAdapter(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                daErrorLog.Fill(dsErrorLog, "ErrorLog")
                dgrErrorList.DataSource = dsErrorLog
                dgrErrorList.DataMember = "ErrorLog"

                txtErrorCount.Text = dsErrorLog.Tables(0).Rows.Count.ToString

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Sub LoadWegErrorLog()
        Try
            

            SQL = "Select " & _
            "strIPAddress, strAgent, strPage, " & _
            "strTime, " & _
            "strDetails, numError, " & _
            "strSolution " & _
            "from " & DBNameSpace & ".LogErrors "


            SQL = "select numError, " & _
            "strIPAddress, strUserEmail, " & _
            "strErrorPage, dateTimeStamp, " & _
            "strErrorMsg, strSolution " & _
            "From " & DBNameSpace & ".OLAPERRORLog "

            If rdbAllWebErrors.Checked = True Then
                SQL = SQL
            End If
            If rdbResolvedWebErrors.Checked = True Then
                SQL = SQL & " where strSolution IS NOT NULL "
            End If
            If rdbUnresolvedWebErrors.Checked = True Then
                SQL = SQL & " where strSolution IS NULL "
            End If

            If SQL <> "" Then
                dsWebErrorLog = New DataSet
                daWebErrorLog = New OracleDataAdapter(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                daWebErrorLog.Fill(dsWebErrorLog, "WebErrorLog")
                dgrWebErrorList.DataSource = dsWebErrorLog
                dgrWebErrorList.DataMember = "WebErrorLog"

                txtWebErrorCount.Text = dsWebErrorLog.Tables(0).Rows.Count.ToString

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Sub LoadWebPublishingFacilityInformation()
        Try
            Dim FacilityName As String = ""
            Dim Street As String = ""
            Dim City As String = ""
            Dim State As String = ""
            Dim ZipCode As String = ""

            If txtWebPublisherApplicationNumber.Text <> "" Then
                SQL = "Select " & _
                "strFacilityName, strFacilityStreet1, " & _
                "strFacilityCity, strFacilityState, " & _
                "strFacilityZipCode " & _
                "from " & DBNameSpace & ".SSPPApplicationData " & _
                "Where strApplicationNumber = '" & txtWebPublisherApplicationNumber.Text & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = True Then
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        FacilityName = ""
                    Else
                        FacilityName = dr.Item("strFacilityName")
                    End If
                    If IsDBNull(dr.Item("strFacilityStreet1")) Then
                        Street = ""
                    Else
                        Street = dr.Item("strFacilityStreet1")
                    End If
                    If IsDBNull(dr.Item("strFacilityCity")) Then
                        City = ""
                    Else
                        City = dr.Item("strFacilityCity")
                    End If
                    If IsDBNull(dr.Item("strFacilityState")) Then
                        State = ""
                    Else
                        State = dr.Item("strFacilityState")
                    End If
                    If IsDBNull(dr.Item("strFacilityZipCode")) Then
                        ZipCode = ""
                    Else
                        ZipCode = dr.Item("strFacilityZipCode")
                    End If
                End If
                dr.Close()

                txtFacilityInformation.Text = FacilityName & vbCrLf & _
                Street & vbCrLf & _
                City & " " & State & ", " & ZipCode

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub PreviewAppReceivedEmail()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim Staff As String = ""
            Dim Unit As String = ""
            Dim temp As String = ""

            clbTitleVEmailList.Items.Clear()

            SQL = "Select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "strFacilityName, strFacilityCity, " & _
            "strApplicationTypeDesc, " & _
            "(strLastName||', '||strFirstName) as StaffResponsible, " & _
            "strUnitDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".EPDUserProfiles, " & _
            "" & DBNameSpace & ".LookUpEPDUnits " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
            "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
            "and (strAppReceivedNotification is Null or strAppReceivedNotification = 'False') " & _
            "and (strApplicationType = '19'  or strApplicationType = '20' or strApplicationType = '21' " & _
            "or strApplicationType = '22') " & _
            "order by strFacilityName, strAPplicationNumber DESC "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strApplicationNumber")) Then
                    AppNumber = ""
                Else
                    AppNumber = dr.Item("strApplicationNumber")
                End If
                If IsDBNull(dr.Item("strFacilityName")) Then
                    FacName = ""
                Else
                    FacName = dr.Item("strFacilityName")
                End If
                If IsDBNull(dr.Item("strFacilityCity")) Then
                    FacCity = ""
                Else
                    FacCity = dr.Item("strFacilityCity")
                End If
                If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                    AppType = ""
                Else
                    AppType = dr.Item("strApplicationTypeDesc")
                End If
                If IsDBNull(dr.Item("StaffResponsible")) Then
                    Staff = ""
                Else
                    Staff = dr.Item("StaffResponsible")
                End If
                If IsDBNull(dr.Item("strUnitDesc")) Then
                    Unit = ""
                Else
                    Unit = dr.Item("strUnitDesc")
                End If

                temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                Select Case temp.Length
                    Case Is < 40
                        temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 40 To 49
                        temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 50 To 51
                        temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case Else
                        temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                End Select

                If clbTitleVEmailList.Items.Contains(temp) = False Then
                    clbTitleVEmailList.Items.Add(temp)
                    clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                End If

            End While
            dr.Close()

            txtEmailType.Text = "AppReceived"

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Sub GenerateAppReceivedEmail()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with 40 CFR 70.7(e)(2),(3), and (4) and 70.8(a)(1) and (b)(1), you are hereby notified that " & _
                "Georgia EPD has received an application for the modification of an existing Part 70 permit for the " & _
                "following source(s): " & vbCrLf & vbCrLf

                SQL = "Select " & _
                "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber,  " & _
                "strFacilityName, strFacilityCity,  " & _
                "strApplicationTypeDesc,  " & _
                "strCountyName  " & _
                "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".LookUpCountyInformation   " & _
                "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                "and substr(strAIRSNumber, 5, 3) = strCountyCode  "

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strAppReceivedNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))
                    SQLLine = SQLLine & " " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' or "
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine = "And ( " & Mid(SQLLine, 1, (SQLLine.Length - 3)) & " ) "
                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL = SQL & SQLLine & " order by strFacilityName "
                SQL2 = SQL2 & SQLLine2

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    If IsDBNull(dr.Item("strApplicationNumber")) Then
                        AppNumber = ""
                    Else
                        AppNumber = dr.Item("strApplicationNumber")
                    End If
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        FacName = ""
                    Else
                        FacName = dr.Item("strFacilityName")
                    End If
                    If IsDBNull(dr.Item("strFacilityCity")) Then
                        FacCity = ""
                    Else
                        FacCity = dr.Item("strFacilityCity")
                    End If
                    If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                        AppType = ""
                    Else
                        AppType = dr.Item("strApplicationTypeDesc")
                    End If
                    If IsDBNull(dr.Item("strCountyName")) Then
                        County = ""
                    Else
                        County = dr.Item("strCountyName")
                    End If
                    Select Case AppType
                        Case "MAWO"
                            AppType = "Minor modification without construction"
                        Case "MAW"
                            AppType = "Minor modification with construction"
                        Case "SAWO"
                            AppType = "Significant modification without construction"
                        Case "SAW"
                            AppType = "Significant modification with construction"
                        Case Else
                            AppType = ""
                    End Select

                    txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                    FacCity & " (" & County & " County), GA" & vbCrLf & _
                    "TV-" & AppNumber & "/" & AppType & vbCrLf & vbCrLf
                End While
                dr.Close()

                txtEmailLetter.Text = txtEmailLetter.Text & "Please reply to acknowledge receipt of this notification. " & _
                "Any questions regarding this permit application may be directed to: " & vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Sub PreviewDraftOnWeb()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim Staff As String = ""
            Dim Unit As String = ""
            Dim temp As String = ""
            Dim LinkedApps As String = ""
            Dim MasterApp As String = ""

            clbTitleVEmailList.Items.Clear()

            SQL = "Select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "strFacilityName, strFacilityCity, " & _
            "strApplicationTypeDesc, " & _
            "(strLastName||', '||strFirstName) as StaffResponsible, " & _
            "strUnitDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationTracking, " & _
            "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
            "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
            "and (strDraftOnWebNotification is Null or strDraftOnWebNotification = 'False') " & _
            "and (strApplicationType = '14'  or strApplicationType = '16' or strApplicationType = '21' " & _
            "or strApplicationType = '22') " & _
            "and strPNReady = 'True' " & _
            "and datDraftOnWeb is Not Null " & _
            "order by strFacilityName, strAPplicationNumber DESC "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strApplicationNumber")) Then
                    AppNumber = ""
                Else
                    AppNumber = dr.Item("strApplicationNumber")
                    LinkedApps = LinkedApps & dr.Item("strApplicationNumber") & ","
                End If
                If IsDBNull(dr.Item("strFacilityName")) Then
                    FacName = ""
                Else
                    FacName = dr.Item("strFacilityName")
                End If
                If IsDBNull(dr.Item("strFacilityCity")) Then
                    FacCity = ""
                Else
                    FacCity = dr.Item("strFacilityCity")
                End If
                If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                    AppType = ""
                Else
                    AppType = dr.Item("strApplicationTypeDesc")
                End If
                If IsDBNull(dr.Item("StaffResponsible")) Then
                    Staff = ""
                Else
                    Staff = dr.Item("StaffResponsible")
                End If
                If IsDBNull(dr.Item("strUnitDesc")) Then
                    Unit = ""
                Else
                    Unit = dr.Item("strUnitDesc")
                End If

                temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                Select Case temp.Length
                    Case Is < 40
                        temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 40 To 49
                        temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 50 To 51
                        temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case Else
                        temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                End Select

                If clbTitleVEmailList.Items.Contains(temp) = False Then
                    clbTitleVEmailList.Items.Add(temp)
                    clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                End If

            End While
            dr.Close()

            Do While LinkedApps <> ""
                MasterApp = Mid(LinkedApps, 1, (InStr(LinkedApps, ",", CompareMethod.Text) - 1))
                SQL = "select " & _
                "strMasterApplication " & _
                "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                "where strApplicationNumber = '" & MasterApp & "' "

                temp = ""
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    temp = dr.Item("strMasterApplication")
                End While
                dr.Close()

                If temp <> "" Then
                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber,  " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc,  " & _
                    "(strLastName||', '||strFirstName) as StaffResponsible,  " & _
                    "strUnitDesc  " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationLinking, " & _
                    "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits  " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode   " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
                    "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                    "and " & DBNameSpace & ".SSPPApplicationLinking.strMasterApplication = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If
                    End While
                End If

                LinkedApps = Replace(LinkedApps, (MasterApp & ","), "")
            Loop

            txtEmailType.Text = "DraftOnWeb"

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub GenerateDraftOnWebEmail()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim AppLine As String = ""
            Dim LinkedApp As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with Georgia's Title V Implementation Agreement, attached are the public notices for the " & _
                "draft/proposed permits and amendments for the following sources: " & vbCrLf & vbCrLf

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strDraftOnWebNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))

                    SQL = "Select strMasterApplication " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        LinkedApp = dr.Item("strMasterApplication")
                    Else
                        LinkedApp = ""
                    End If
                    dr.Close()

                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc, " & _
                    "strCountyName " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpCountyInformation, " & DBNameSpace & ".LookUpApplicationTypes " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                    "and substr(strAIRSNumber, 5, 3) = strCountyCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strCountyName")) Then
                            County = ""
                        Else
                            County = dr.Item("strCountyName")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        Select Case AppType
                            Case "TV-Initial"
                                AppType = "Initial"
                            Case "TV-Renewal"
                                AppType = "Renewal"
                            Case "SAWO"
                                AppType = "Significant modification without construction"
                            Case "SAW"
                                AppType = "Significant modification with construction"
                            Case "Acid Rain"
                                AppType = "Acid Rain"
                            Case "502(b)10"
                                AppType = "502(b)10"
                            Case "MAWO"
                                AppType = "Minor modification without construction"
                            Case "MAW"
                                AppType = "Minor modification with construction"
                            Case "AA"
                                AppType = "Administrative Amendment"
                            Case Else
                                AppType = AppType
                        End Select
                    End While
                    dr.Close()

                    If LinkedApp = "" Then
                        AppLine = "TV-" & AppNumber & "/" & AppType
                    Else
                        AppLine = ""

                        SQL = "select " & _
                        "" & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber, " & _
                        "strApplicationTypeDesc " & _
                        "from " & DBNameSpace & ".SSPPApplicationLinking, " & DBNameSpace & ".SSPPApplicationMaster, " & _
                        "" & DBNameSpace & ".LookUpApplicationTypes " & _
                        "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                        "and strMasterApplication = '" & LinkedApp & "' "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strApplicationNumber")) Then
                                AppNumber = ""
                            Else
                                AppNumber = dr.Item("strApplicationNumber")
                            End If
                            If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                                AppType = ""
                            Else
                                AppType = dr.Item("strApplicationTypeDesc")
                            End If
                            Select Case AppType
                                Case "TV-Initial"
                                    AppType = "Initial"
                                Case "TV-Renewal"
                                    AppType = "Renewal"
                                Case "SAWO"
                                    AppType = "Significant modification without construction"
                                Case "SAW"
                                    AppType = "Significant modification with construction"
                                Case "Acid Rain"
                                    AppType = "Acid Rain"
                                Case "502(b)10"
                                    AppType = "502(b)10"
                                Case "MAWO"
                                    AppType = "Minor modification without construction"
                                Case "MAW"
                                    AppType = "Minor modification with construction"
                                Case "AA"
                                    AppType = "Administrative Amendment"
                                Case Else
                                    AppType = AppType
                            End Select
                            AppLine = AppLine & "TV-" & AppNumber & "/" & AppType & ", "
                        End While
                        dr.Close()
                        AppLine = Mid(AppLine, 1, (AppLine.Length - 2))
                    End If

                    If txtEmailLetter.Text.Contains(AppLine) Then
                    Else
                        txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                        FacCity & " (" & County & " County), GA" & vbCrLf & _
                        AppLine & vbCrLf & vbCrLf
                    End If
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL2 = SQL2 & SQLLine2

                txtEmailLetter.Text = txtEmailLetter.Text & "The public notices are to be published by each facility in a newspaper of general " & _
                "circulation in the area where the facility is located within 14/30 days following their receipt of the draft permit and/or " & _
                "amendment and public notice. A 30-day comment period will follow the public notification. " & vbCrLf & vbCrLf & _
                "The draft permit, permit review narrative and in most cases the permit application will be available from the " & _
                "Georgia EPD - Air Protection Branch Title V Draft permit web page located at: " & vbCrLf & vbCrLf & _
                "http://www.georgiaair.org/airpermit/html/permits/draft.html" & vbCrLf & vbCrLf & _
                "The public comment deadline is posted on the Title V web page. " & vbCrLf & vbCrLf & _
                "Please reply to acknowledge receipt of this notification. Any questions regarding the draft permits and " & _
                "amendments may be directed to: " & vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub GenerateDraftOnWebState()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim AppLine As String = ""
            Dim LinkedApp As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with 40 CFR 70.8(b)(1), attached are the public notices for the draft/proposed permits and " & _
                "amendments for the following sources: " & vbCrLf & vbCrLf

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strDraftOnWebNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))

                    SQL = "Select strMasterApplication " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        LinkedApp = dr.Item("strMasterApplication")
                    Else
                        LinkedApp = ""
                    End If
                    dr.Close()

                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc, " & _
                    "strCountyName " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpCountyInformation, " & DBNameSpace & ".LookUpApplicationTypes " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                    "and substr(strAIRSNumber, 5, 3) = strCountyCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strCountyName")) Then
                            County = ""
                        Else
                            County = dr.Item("strCountyName")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        Select Case AppType
                            Case "TV-Initial"
                                AppType = "Initial"
                            Case "TV-Renewal"
                                AppType = "Renewal"
                            Case "SAWO"
                                AppType = "Significant modification without construction"
                            Case "SAW"
                                AppType = "Significant modification with construction"
                            Case "Acid Rain"
                                AppType = "Acid Rain"
                            Case "502(b)10"
                                AppType = "502(b)10"
                            Case "MAWO"
                                AppType = "Minor modification without construction"
                            Case "MAW"
                                AppType = "Minor modification with construction"
                            Case "AA"
                                AppType = "Administrative Amendment"
                            Case Else
                                AppType = AppType
                        End Select
                    End While
                    dr.Close()

                    If LinkedApp = "" Then
                        AppLine = "TV-" & AppNumber & "/" & AppType
                    Else
                        AppLine = ""

                        SQL = "select " & _
                        "" & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber, " & _
                        "strApplicationTypeDesc " & _
                        "from " & DBNameSpace & ".SSPPApplicationLinking, " & DBNameSpace & ".SSPPApplicationMaster, " & _
                        "" & DBNameSpace & ".LookUpApplicationTypes " & _
                        "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                        "and strMasterApplication = '" & LinkedApp & "' "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strApplicationNumber")) Then
                                AppNumber = ""
                            Else
                                AppNumber = dr.Item("strApplicationNumber")
                            End If
                            If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                                AppType = ""
                            Else
                                AppType = dr.Item("strApplicationTypeDesc")
                            End If
                            Select Case AppType
                                Case "TV-Initial"
                                    AppType = "Initial"
                                Case "TV-Renewal"
                                    AppType = "Renewal"
                                Case "SAWO"
                                    AppType = "Significant modification without construction"
                                Case "SAW"
                                    AppType = "Significant modification with construction"
                                Case "Acid Rain"
                                    AppType = "Acid Rain"
                                Case "502(b)10"
                                    AppType = "502(b)10"
                                Case "MAWO"
                                    AppType = "Minor modification without construction"
                                Case "MAW"
                                    AppType = "Minor modification with construction"
                                Case "AA"
                                    AppType = "Administrative Amendment"
                                Case Else
                                    AppType = AppType
                            End Select
                            AppLine = AppLine & "TV-" & AppNumber & "/" & AppType & ", "
                        End While
                        dr.Close()
                        AppLine = Mid(AppLine, 1, (AppLine.Length - 2))
                    End If

                    If txtEmailLetter.Text.Contains(AppLine) Then
                    Else
                        txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                        FacCity & " (" & County & " County), GA" & vbCrLf & _
                        AppLine & vbCrLf & vbCrLf
                    End If
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL2 = SQL2 & SQLLine2

                txtEmailLetter.Text = txtEmailLetter.Text & "The public notices are to be published by each facility in a newspaper of general " & _
                "circulation in the area where the facility is located within 14/30 days following their receipt of the draft permit and/or " & _
                "amendment and public notice. A 30-day comment period will follow the public notification. " & vbCrLf & vbCrLf & _
                "The draft permit, permit review narrative and in most cases the permit application will be available from the " & _
                "Georgia EPD - Air Protection Branch Title V Draft permit web page located at: " & vbCrLf & vbCrLf & _
                "http://www.georgiaair.org/airpermit/html/permits/draft.html" & vbCrLf & vbCrLf & _
                "The public comment deadline is posted on the Title V web page. " & vbCrLf & vbCrLf & _
                "Please reply to acknowledge receipt of this notification. Any questions regarding the draft permits and " & _
                "amendments may be directed to: " & vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Sub PreviewMinorModOnWeb()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim Staff As String = ""
            Dim Unit As String = ""
            Dim temp As String = ""
            Dim LinkedApps As String = ""
            Dim MasterApp As String = ""

            clbTitleVEmailList.Items.Clear()

            'This is the old code that was changed on May 13, 2009 
            SQL = "Select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "strFacilityName, strFacilityCity, " & _
            "strApplicationTypeDesc, " & _
            "(strLastName||', '||strFirstName) as StaffResponsible, " & _
            "strUnitDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".EPDUserProfiles, " & _
            "" & DBNameSpace & ".LookUpEPDUnits " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
            "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
            "and (strDraftOnWebNotification is Null or strDraftOnWebNotification = 'False') " & _
            "and (strApplicationType = '19'  or strApplicationType = '20') " & _
            "order by strFacilityName, strApplicationNumber DESC "


            SQL = "Select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "strFacilityName, strFacilityCity, " & _
            "strApplicationTypeDesc, " & _
            "(strLastName||', '||strFirstName) as StaffResponsible, " & _
            "strUnitDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".EPDUserProfiles, " & _
            "" & DBNameSpace & ".LookUpEPDUnits, " & DBNameSpace & ".SSPPApplicationTracking " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
            "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
            "and datEPAStatesNotified is not Null " & _
            "and (strDraftOnWebNotification is Null or strDraftOnWebNotification = 'False') " & _
            "and (strApplicationType = '19'  or strApplicationType = '20') " & _
            "order by strFacilityName, strApplicationNumber DESC "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strApplicationNumber")) Then
                    AppNumber = ""
                Else
                    AppNumber = dr.Item("strApplicationNumber")
                    LinkedApps = LinkedApps & dr.Item("strApplicationNumber") & ","
                End If
                If IsDBNull(dr.Item("strFacilityName")) Then
                    FacName = ""
                Else
                    FacName = dr.Item("strFacilityName")
                End If
                If IsDBNull(dr.Item("strFacilityCity")) Then
                    FacCity = ""
                Else
                    FacCity = dr.Item("strFacilityCity")
                End If
                If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                    AppType = ""
                Else
                    AppType = dr.Item("strApplicationTypeDesc")
                End If
                If IsDBNull(dr.Item("StaffResponsible")) Then
                    Staff = ""
                Else
                    Staff = dr.Item("StaffResponsible")
                End If
                If IsDBNull(dr.Item("strUnitDesc")) Then
                    Unit = ""
                Else
                    Unit = dr.Item("strUnitDesc")
                End If

                temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                Select Case temp.Length
                    Case Is < 40
                        temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 40 To 49
                        temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 50 To 51
                        temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case Else
                        temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                End Select

                If clbTitleVEmailList.Items.Contains(temp) = False Then
                    clbTitleVEmailList.Items.Add(temp)
                    clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                End If

            End While
            dr.Close()

            Do While LinkedApps <> ""
                MasterApp = Mid(LinkedApps, 1, (InStr(LinkedApps, ",", CompareMethod.Text) - 1))
                SQL = "select " & _
                "strMasterApplication " & _
                "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                "where strApplicationNumber = '" & MasterApp & "' "

                temp = ""
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    temp = dr.Item("strMasterApplication")
                End While
                dr.Close()

                If temp <> "" Then
                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber,  " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc,  " & _
                    "(strLastName||', '||strFirstName) as StaffResponsible,  " & _
                    "strUnitDesc  " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationLinking, " & _
                    "" & DBNameSpace & ".EPDuserProfiles, " & DBNameSpace & ".LookUPEPDunits " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode   " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID  " & _
                    "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                    "and " & DBNameSpace & ".SSPPApplicationLinking.strMasterApplication = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If
                    End While
                End If

                LinkedApps = Replace(LinkedApps, (MasterApp & ","), "")
            Loop


            txtEmailType.Text = "MinorOnWeb"

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Sub GenerateMinorOnWebEmail()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim AppLine As String = ""
            Dim LinkedApp As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with Georgia's Title V Implementation Agreement, attached is the proposed Part " & _
                "70 permit modification and permit amendment narrative for the following: " & vbCrLf & vbCrLf

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strDraftOnWebNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))

                    SQL = "Select strMasterApplication " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        LinkedApp = dr.Item("strMasterApplication")
                    Else
                        LinkedApp = ""
                    End If
                    dr.Close()

                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc, " & _
                    "strCountyName " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpCountyInformation, " & DBNameSpace & ".LookUpApplicationTypes " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                    "and substr(strAIRSNumber, 5, 3) = strCountyCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strCountyName")) Then
                            County = ""
                        Else
                            County = dr.Item("strCountyName")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        Select Case AppType
                            Case "TV-Initial"
                                AppType = "Initial"
                            Case "TV-Renewal"
                                AppType = "Renewal"
                            Case "SAWO"
                                AppType = "Significant modification without construction"
                            Case "SAW"
                                AppType = "Significant modification with construction"
                            Case "Acid Rain"
                                AppType = "Acid Rain"
                            Case "502(b)10"
                                AppType = "502(b)10"
                            Case "MAWO"
                                AppType = "Minor modification without construction"
                            Case "MAW"
                                AppType = "Minor modification with construction"
                            Case "AA"
                                AppType = "Administrative Amendment"
                            Case Else
                                AppType = AppType
                        End Select
                    End While
                    dr.Close()

                    If LinkedApp = "" Then
                        AppLine = "TV-" & AppNumber & "/" & AppType
                    Else
                        AppLine = ""

                        SQL = "select " & _
                        "" & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber, " & _
                        "strApplicationTypeDesc " & _
                        "from " & DBNameSpace & ".SSPPApplicationLinking, " & DBNameSpace & ".SSPPApplicationMaster, " & _
                        "" & DBNameSpace & ".LookUpApplicationTypes " & _
                        "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                        "and strMasterApplication = '" & LinkedApp & "' "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strApplicationNumber")) Then
                                AppNumber = ""
                            Else
                                AppNumber = dr.Item("strApplicationNumber")
                            End If
                            If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                                AppType = ""
                            Else
                                AppType = dr.Item("strApplicationTypeDesc")
                            End If
                            Select Case AppType
                                Case "TV-Initial"
                                    AppType = "Initial"
                                Case "TV-Renewal"
                                    AppType = "Renewal"
                                Case "SAWO"
                                    AppType = "Significant modification without construction"
                                Case "SAW"
                                    AppType = "Significant modification with construction"
                                Case "Acid Rain"
                                    AppType = "Acid Rain"
                                Case "502(b)10"
                                    AppType = "502(b)10"
                                Case "MAWO"
                                    AppType = "Minor modification without construction"
                                Case "MAW"
                                    AppType = "Minor modification with construction"
                                Case "AA"
                                    AppType = "Administrative Amendment"
                                Case Else
                                    AppType = AppType
                            End Select
                            AppLine = AppLine & "TV-" & AppNumber & "/" & AppType & ", "
                        End While
                        dr.Close()
                        AppLine = Mid(AppLine, 1, (AppLine.Length - 2))
                    End If

                    If txtEmailLetter.Text.Contains(AppLine) Then
                    Else
                        txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                        FacCity & " (" & County & " County), GA" & vbCrLf & _
                        AppLine & vbCrLf & vbCrLf
                    End If
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL2 = SQL2 & SQLLine2

                txtEmailLetter.Text = txtEmailLetter.Text & "EPA's review of the proposed minor amendment extends from 45 days following the date of this " & _
                "message. Please reply to acknowledge receipt of this notification. Any questions regarding this " & _
                "proposed permit amendment may be directed to: " & _
                vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Sub GenerateMinorOnWebState()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim AppLine As String = ""
            Dim LinkedApp As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with 40 CFR 70.8(b)(1), attached is the proposed Part 70 permit modification and  " & _
                "permit amendment narrative for the following source: " & vbCrLf & vbCrLf

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strDraftOnWebNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))

                    SQL = "Select strMasterApplication " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        LinkedApp = dr.Item("strMasterApplication")
                    Else
                        LinkedApp = ""
                    End If
                    dr.Close()

                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc, " & _
                    "strCountyName " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpCountyInformation, " & DBNameSpace & ".LookUpApplicationTypes " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                    "and substr(strAIRSNumber, 5, 3) = strCountyCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strCountyName")) Then
                            County = ""
                        Else
                            County = dr.Item("strCountyName")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        Select Case AppType
                            Case "TV-Initial"
                                AppType = "Initial"
                            Case "TV-Renewal"
                                AppType = "Renewal"
                            Case "SAWO"
                                AppType = "Significant modification without construction"
                            Case "SAW"
                                AppType = "Significant modification with construction"
                            Case "Acid Rain"
                                AppType = "Acid Rain"
                            Case "502(b)10"
                                AppType = "502(b)10"
                            Case "MAWO"
                                AppType = "Minor modification without construction"
                            Case "MAW"
                                AppType = "Minor modification with construction"
                            Case "AA"
                                AppType = "Administrative Amendment"
                            Case Else
                                AppType = AppType
                        End Select
                    End While
                    dr.Close()

                    If LinkedApp = "" Then
                        AppLine = "TV-" & AppNumber & "/" & AppType
                    Else
                        AppLine = ""

                        SQL = "select " & _
                        "" & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber, " & _
                        "strApplicationTypeDesc " & _
                        "from " & DBNameSpace & ".SSPPApplicationLinking, " & DBNameSpace & ".SSPPApplicationMaster, " & _
                        "" & DBNameSpace & ".LookUpApplicationTypes " & _
                        "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                        "and strMasterApplication = '" & LinkedApp & "' "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strApplicationNumber")) Then
                                AppNumber = ""
                            Else
                                AppNumber = dr.Item("strApplicationNumber")
                            End If
                            If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                                AppType = ""
                            Else
                                AppType = dr.Item("strApplicationTypeDesc")
                            End If
                            Select Case AppType
                                Case "TV-Initial"
                                    AppType = "Initial"
                                Case "TV-Renewal"
                                    AppType = "Renewal"
                                Case "SAWO"
                                    AppType = "Significant modification without construction"
                                Case "SAW"
                                    AppType = "Significant modification with construction"
                                Case "Acid Rain"
                                    AppType = "Acid Rain"
                                Case "502(b)10"
                                    AppType = "502(b)10"
                                Case "MAWO"
                                    AppType = "Minor modification without construction"
                                Case "MAW"
                                    AppType = "Minor modification with construction"
                                Case "AA"
                                    AppType = "Administrative Amendment"
                                Case Else
                                    AppType = AppType
                            End Select
                            AppLine = AppLine & "TV-" & AppNumber & "/" & AppType & ", "
                        End While
                        dr.Close()
                        AppLine = Mid(AppLine, 1, (AppLine.Length - 2))
                    End If

                    If txtEmailLetter.Text.Contains(AppLine) Then
                    Else
                        txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                        FacCity & " (" & County & " County), GA" & vbCrLf & _
                        AppLine & vbCrLf & vbCrLf
                    End If
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL2 = SQL2 & SQLLine2

                txtEmailLetter.Text = txtEmailLetter.Text & "Please reply to acknowledge receipt of this notification. Any questions regarding this proposed " & _
                "permit amendment may be directed to: " & vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Sub PreviewFinalOnWeb()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim Staff As String = ""
            Dim Unit As String = ""
            Dim temp As String = ""
            Dim LinkedApps As String = ""
            Dim MasterApp As String = ""

            clbTitleVEmailList.Items.Clear()

            SQL = "Select " & _
            "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
            "strFacilityName, strFacilityCity, " & _
            "strApplicationTypeDesc, " & _
            "(strLastName||', '||strFirstName) as StaffResponsible, " & _
            "strUnitDesc " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
            "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationTracking, " & _
            "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
            "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber " & _
            "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDuserProfiles.numUserID " & _
            "and " & DBNameSpace & ".EPDuserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
            "and (strFinalOnWebNotification is Null or strFinalOnWebNotification = 'False') " & _
            "and (strApplicationType = '14'  or strApplicationType = '16' " & _
            "or strApplicationType = '19' or strApplicationType = '20' " & _
            "or strApplicationType = '21' or strApplicationType = '22' " & _
            "or strApplicationType = '26' or strApplicationType = '15' " & _
            "or strApplicationType = '2') " & _
            "and DatFinalOnWeb is Not Null " & _
            "order by strFacilityName, strAPplicationNumber DESC "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr.Item("strApplicationNumber")) Then
                    AppNumber = ""
                Else
                    AppNumber = dr.Item("strApplicationNumber")
                    LinkedApps = LinkedApps & dr.Item("strApplicationNumber") & ","
                End If
                If IsDBNull(dr.Item("strFacilityName")) Then
                    FacName = ""
                Else
                    FacName = dr.Item("strFacilityName")
                End If
                If IsDBNull(dr.Item("strFacilityCity")) Then
                    FacCity = ""
                Else
                    FacCity = dr.Item("strFacilityCity")
                End If
                If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                    AppType = ""
                Else
                    AppType = dr.Item("strApplicationTypeDesc")
                End If
                If IsDBNull(dr.Item("StaffResponsible")) Then
                    Staff = ""
                Else
                    Staff = dr.Item("StaffResponsible")
                End If
                If IsDBNull(dr.Item("strUnitDesc")) Then
                    Unit = ""
                Else
                    Unit = dr.Item("strUnitDesc")
                End If

                temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                Select Case temp.Length
                    Case Is < 40
                        temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 40 To 49
                        temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case 50 To 51
                        temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                    Case Else
                        temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                End Select

                If clbTitleVEmailList.Items.Contains(temp) = False Then
                    clbTitleVEmailList.Items.Add(temp)
                    clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                End If

            End While
            dr.Close()

            Do While LinkedApps <> ""
                MasterApp = Mid(LinkedApps, 1, (InStr(LinkedApps, ",", CompareMethod.Text) - 1))
                SQL = "select " & _
                "strMasterApplication " & _
                "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                "where strApplicationNumber = '" & MasterApp & "' "

                temp = ""
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    temp = dr.Item("strMasterApplication")
                End While
                dr.Close()

                If temp <> "" Then
                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber,  " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strApplicationTypeDesc,  " & _
                    "(strLastName||', '||strFirstName) as StaffResponsible,  " & _
                    "strUnitDesc  " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationLinking, " & _
                    "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits  " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode   " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDuserPRofiles.numUserID  " & _
                    "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDunits.numUnitCode (+) " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                    "and " & DBNameSpace & ".SSPPApplicationLinking.strMasterApplication = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If
                    End While
                End If

                LinkedApps = Replace(LinkedApps, (MasterApp & ","), "")
            Loop

            txtEmailType.Text = "FinalOnWeb"

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Sub GenerateFinalOnWeb()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""
            Dim County As String = ""
            Dim PermitNumber As String = ""
            Dim DateIssued As String = ""
            Dim AppLine As String = ""
            Dim LinkedApp As String = ""
            Dim SQLLine As String = ""
            Dim SQLLine2 As String = ""
            Dim temp As String = ""
            Dim strObject As Object

            If clbTitleVEmailList.Items.Count > 0 Then
                txtEmailLetter.Text = "In accordance with condition V.A.1.a of Georgia's Title V Agreement, the final Part 70 " & _
                "Permits were issued to the following sources:" & vbCrLf & vbCrLf

                SQL2 = "Update " & DBNameSpace & ".SSPPApplicationData set " & _
                "strFinalOnWebNotification = 'True' where "

                For Each strObject In clbTitleVEmailList.CheckedItems
                    temp = strObject
                    temp = Mid(temp, 1, (InStr(temp, " -", CompareMethod.Text) - 1))

                    SQL = "Select strMasterApplication " & _
                    "from " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "where strApplicationNumber = '" & temp & "' "
                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        LinkedApp = dr.Item("strMasterApplication")
                    Else
                        LinkedApp = ""
                    End If
                    dr.Close()

                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity,  " & _
                    "strCountyName, strPermitNumber,  " & _
                    "datPermitIssued, datEffective, " & _
                    "strApplicationTypeDesc " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData,  " & _
                    "" & DBNameSpace & ".LookUpCountyInformation, " & DBNameSpace & ".LookUpApplicationTypes, " & _
                    "" & DBNameSpace & ".SSPPApplicationTracking " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode  " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber (+) " & _
                    "and substr(strAIRSNumber, 5, 3) = strCountyCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & temp & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strCountyName")) Then
                            County = ""
                        Else
                            County = dr.Item("strCountyName")
                        End If
                        If IsDBNull(dr.Item("strPermitNumber")) Then
                            PermitNumber = "Permit - N/A"
                        Else
                            PermitNumber = dr.Item("strPermitNumber")
                            PermitNumber = "Permit " & Mid(PermitNumber, 1, 4) & "-" & Mid(PermitNumber, 5, 3) & "-" & Mid(PermitNumber, 8, 4) & _
                            "-" & Mid(PermitNumber, 12, 1) & "-" & Mid(PermitNumber, 13, 2) & "-" & Mid(PermitNumber, 15)
                        End If
                        If IsDBNull(dr.Item("datPermitIssued")) Then
                            If IsDBNull(dr.Item("datEffective")) Then
                                DateIssued = ""
                            Else
                                DateIssued = "Effective: " & dr.Item("datEffective")
                            End If
                        Else
                            DateIssued = "Effective: " & dr.Item("datPermitIssued")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        Select Case AppType
                            Case "TV-Initial"
                                AppType = "Initial"
                            Case "TV-Renewal"
                                AppType = "Renewal"
                            Case "SAWO"
                                AppType = "Significant modification without construction"
                            Case "SAW"
                                AppType = "Significant modification with construction"
                            Case "Acid Rain"
                                AppType = "Acid Rain"
                            Case "502(b)10"
                                AppType = "502(b)10"
                            Case "MAWO"
                                AppType = "Minor modification without construction"
                            Case "MAW"
                                AppType = "Minor modification with construction"
                            Case "AA"
                                AppType = "Administrative Amendment"
                            Case Else
                                AppType = AppType
                        End Select
                    End While
                    dr.Close()

                    If LinkedApp = "" Then
                        AppLine = "TV-" & AppNumber & "/" & AppType
                    Else
                        AppLine = ""

                        SQL = "select " & _
                        "" & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber, " & _
                        "strApplicationTypeDesc " & _
                        "from " & DBNameSpace & ".SSPPApplicationLinking, " & DBNameSpace & ".SSPPApplicationMaster, " & _
                        "" & DBNameSpace & ".LookUpApplicationTypes " & _
                        "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationLinking.strApplicationNumber " & _
                        "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                        "and strMasterApplication = '" & LinkedApp & "' "
                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            If IsDBNull(dr.Item("strApplicationNumber")) Then
                                AppNumber = ""
                            Else
                                AppNumber = dr.Item("strApplicationNumber")
                            End If
                            If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                                AppType = ""
                            Else
                                AppType = dr.Item("strApplicationTypeDesc")
                            End If
                            Select Case AppType
                                Case "TV-Initial"
                                    AppType = "Initial"
                                Case "TV-Renewal"
                                    AppType = "Renewal"
                                Case "SAWO"
                                    AppType = "Significant modification without construction"
                                Case "SAW"
                                    AppType = "Significant modification with construction"
                                Case "Acid Rain"
                                    AppType = "Acid Rain"
                                Case "502(b)10"
                                    AppType = "502(b)10"
                                Case "MAWO"
                                    AppType = "Minor modification without construction"
                                Case "MAW"
                                    AppType = "Minor modification with construction"
                                Case "AA"
                                    AppType = "Administrative Amendment"
                                Case Else
                                    AppType = AppType
                            End Select
                            AppLine = AppLine & "TV-" & AppNumber & "/" & AppType & ", "
                        End While
                        dr.Close()
                        AppLine = Mid(AppLine, 1, (AppLine.Length - 2))
                    End If

                    If txtEmailLetter.Text.Contains(AppLine) Then
                    Else
                        txtEmailLetter.Text = txtEmailLetter.Text & FacName & vbCrLf & _
                        FacCity & " (" & County & " County), GA" & vbCrLf & _
                        AppLine & vbCrLf & _
                        PermitNumber & vbCrLf & DateIssued & vbCrLf & vbCrLf
                    End If
                    SQLLine2 = SQLLine2 & " " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & temp & "' or "
                Next

                SQLLine2 = Mid(SQLLine2, 1, (SQLLine2.Length - 3))
                SQL2 = SQL2 & SQLLine2

                txtEmailLetter.Text = txtEmailLetter.Text & "The final permit, permit review narrative and in most cases the " & _
                "permit application will be available from the Georgia Air Permit Search Engine web page located at: " & _
                vbCrLf & vbCrLf & _
                "http://airpermit.dnr.state.ga.us/gaairpermits/" & vbCrLf & vbCrLf & _
                "Please reply to acknowledge receipt of this notification. Any questions regarding the final permits " & _
                "may be directed to: " & vbCrLf & vbCrLf & _
                "Eric Cornwell " & vbCrLf & "Program Manager" & vbCrLf & _
                "Stationary Source Permitting Program " & vbCrLf & _
                "404/363-7020"

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            Else
                txtEmailLetter.Clear()
                MsgBox("Click Preview button first.", MsgBoxStyle.Information, "Title V Emails.")
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Sub AddAppToList()
        Try
            Dim AppNumber As String = ""
            Dim FacName As String = ""
            Dim FacCity As String = ""
            Dim AppType As String = ""

            Dim Staff As String = ""
            Dim Unit As String = ""

            Dim temp As String = ""

            Select Case txtEmailType.Text
                Case "AppReceived"
                    SQL = "Select " & _
                   "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                   "strFacilityName, strFacilityCity, " & _
                   "strApplicationTypeDesc, " & _
                   "(strLastName||', '||strFirstName) as StaffResponsible, " & _
                   "strUnitDesc " & _
                   "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
                   "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationTracking, " & _
                   "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
                   "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
                   "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & txtApplicationNumberToAdd.Text & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If

                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If
                    Else
                        MsgBox("Unable to add this Applition to list.", MsgBoxStyle.Information, "Data Management Tools")
                    End If
                    dr.Close()
                Case "DraftOnWeb"
                    SQL = "Select " & _
                   "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                   "strFacilityName, strFacilityCity, " & _
                   "strApplicationTypeDesc, " & _
                   "(strLastName||', '||strFirstName) as StaffResponsible, " & _
                   "strUnitDesc " & _
                   "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
                   "" & DBNameSpace & ".LookUpApplicationTypes, " & DBNameSpace & ".SSPPApplicationTracking, " & _
                   "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
                   "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationTracking.strApplicationNumber " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
                   "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & txtApplicationNumberToAdd.Text & "' "


                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If

                    Else
                        MsgBox("Unable to add this Applition to list.", MsgBoxStyle.Information, "Data Management Tools")
                    End If
                    dr.Close()
                Case "MinorOnWeb"
                    SQL = "Select " & _
                   "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                   "strFacilityName, strFacilityCity, " & _
                   "strApplicationTypeDesc, " & _
                   "(strLastName||', '||strFirstName) as StaffResponsible, " & _
                   "strUnitDesc " & _
                   "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
                   "" & DBNameSpace & ".LookUpApplicationTypes,  " & _
                   "" & DBNameSpace & ".EPDUserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
                   "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDuserProfiles.numUserID " & _
                   "and " & DBNameSpace & ".EPDuserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                   "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & txtApplicationNumberToAdd.Text & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If

                    Else
                        MsgBox("Unable to add this Applition to list.", MsgBoxStyle.Information, "Data Management Tools")
                    End If
                    dr.Close()
                Case "FinalOnWeb"
                    SQL = "Select " & _
                    "" & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber, " & _
                    "strFacilityName, strFacilityCity, " & _
                    "strApplicationTypeDesc, " & _
                    "(strLastName||', '||strFirstName) as StaffResponsible, " & _
                    "strUnitDesc " & _
                    "from " & DBNameSpace & ".SSPPApplicationMaster, " & DBNameSpace & ".SSPPApplicationData, " & _
                    "" & DBNameSpace & ".LookUpApplicationTypes, " & _
                    "" & DBNameSpace & ".EPDuserProfiles, " & DBNameSpace & ".LookUpEPDUnits " & _
                    "where " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationType = " & DBNameSpace & ".LookUpApplicationTypes.strApplicationTypeCode " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strStaffResponsible = " & DBNameSpace & ".EPDuserProfiles.numUserID " & _
                    "and " & DBNameSpace & ".EPDUserProfiles.numUnit = " & DBNameSpace & ".LookUpEPDUnits.numUnitCode (+) " & _
                    "and " & DBNameSpace & ".SSPPApplicationMaster.strApplicationNumber = '" & txtApplicationNumberToAdd.Text & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("strApplicationNumber")) Then
                            AppNumber = ""
                        Else
                            AppNumber = dr.Item("strApplicationNumber")
                        End If
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            FacName = ""
                        Else
                            FacName = dr.Item("strFacilityName")
                        End If
                        If IsDBNull(dr.Item("strFacilityCity")) Then
                            FacCity = ""
                        Else
                            FacCity = dr.Item("strFacilityCity")
                        End If
                        If IsDBNull(dr.Item("strApplicationTypeDesc")) Then
                            AppType = ""
                        Else
                            AppType = dr.Item("strApplicationTypeDesc")
                        End If
                        If IsDBNull(dr.Item("StaffResponsible")) Then
                            Staff = ""
                        Else
                            Staff = dr.Item("StaffResponsible")
                        End If
                        If IsDBNull(dr.Item("strUnitDesc")) Then
                            Unit = ""
                        Else
                            Unit = dr.Item("strUnitDesc")
                        End If

                        temp = AppNumber & " - " & FacName & " - (" & FacCity & ") - " & AppType

                        Select Case temp.Length
                            Case Is < 40
                                temp = temp & vbTab & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 40 To 49
                                temp = temp & vbTab & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case 50 To 51
                                temp = temp & vbTab & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                            Case Else
                                temp = temp & vbTab & "Staff Responsible:  " & Staff & "     -     Staff Unit: " & Unit
                        End Select

                        If clbTitleVEmailList.Items.Contains(temp) = False Then
                            clbTitleVEmailList.Items.Add(temp)
                            clbTitleVEmailList.SetItemChecked(clbTitleVEmailList.Items.IndexOf(temp), True)
                        End If
                    Else
                        MsgBox("Unable to add this Applition to list.", MsgBoxStyle.Information, "Data Management Tools")
                    End If
                    dr.Close()
            End Select

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub

#End Region
    Private Sub DEVDataManagementTools_Closing(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles MyBase.Closing
        Try
            
            If NavigationScreen Is Nothing Then
                NavigationScreen = New IAIPNavigation
            End If
            NavigationScreen.Show()

            ISMPDMU = Nothing

            Me.Dispose()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnViewApplication_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnViewApplication.Click
        Try
            
            If txtWebPublisherApplicationNumber.Text <> "" Then
                If PermitTrackingLog Is Nothing Then
                    PermitTrackingLog = Nothing
                    If PermitTrackingLog Is Nothing Then PermitTrackingLog = New SSPPApplicationTrackingLog
                    PermitTrackingLog.Show()
                Else
                    PermitTrackingLog.Show()
                End If
                PermitTrackingLog.txtApplicationNumber.Clear()
                PermitTrackingLog.txtApplicationNumber.Text = txtWebPublisherApplicationNumber.Text
                PermitTrackingLog.LoadApplication()
                PermitTrackingLog.BringToFront()
                PermitTrackingLog.Location = New System.Drawing.Point(DefaultX + 25, DefaultY)
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnReloadGrid_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnReloadGrid.Click
        Try
            
            LoadWebPublisherDataGrid("Load")
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub dgrWebPublisher_MouseUp(ByVal sender As System.Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles dgrWebPublisher.MouseUp
        Dim hti As DataGrid.HitTestInfo = dgrWebPublisher.HitTest(e.X, e.Y)
        Try
            
            If hti.Type = DataGrid.HitTestType.Cell Then
                If IsDBNull(dgrWebPublisher(hti.Row, 0)) Then
                Else
                    txtWebPublisherApplicationNumber.Text = dgrWebPublisher(hti.Row, 0)
                    If txtWebPublisherApplicationNumber.Text <> "" Then
                        LoadWebPublisherApplicationData()
                        LoadWebPublishingFacilityInformation()
                    End If
                End If
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub txtWebPublisherApplicationNumber_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtWebPublisherApplicationNumber.TextChanged
        Try
            
            'If txtWebPublisherApplicationNumber.Text <> "" Then
            '    LoadWebPublisherApplicationData()
            'End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub

#Region "Checkbox Changes"
    Private Sub chbNotifiedAppReceived_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chbNotifiedAppReceived.CheckedChanged
        Try
            
            If chbNotifiedAppReceived.Checked = True Then
                DTPNotifiedAppReceived.Visible = True
            Else
                DTPNotifiedAppReceived.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub chbDraftOnWeb_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbDraftOnWeb.CheckedChanged
        Try
            
            If chbDraftOnWeb.Checked = True Then
                DTPDraftOnWeb.Visible = True
            Else
                DTPDraftOnWeb.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub

    Private Sub chbPNExpires_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbPNExpires.CheckedChanged
        Try
            
            If chbPNExpires.Checked = True Then
                DTPPNExpires.Visible = True
            Else
                DTPPNExpires.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
    Private Sub chbEPAandStatesNotified_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbEPAandStatesNotified.CheckedChanged
        Try
            
            If chbEPAandStatesNotified.Checked = True Then
                DTPEPAStatesNotified.Visible = True
            Else
                DTPEPAStatesNotified.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub chbFinalOnWeb_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbFinalOnWeb.CheckedChanged
        Try
            
            If chbFinalOnWeb.Checked = True Then
                DTPFinalOnWeb.Visible = True
            Else
                DTPFinalOnWeb.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub chbEPANotifiedPermitOnWeb_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbEPANotifiedPermitOnWeb.CheckedChanged
        Try
            
            If chbEPANotifiedPermitOnWeb.Checked = True Then
                DTPEPANotifiedPermitOnWeb.Visible = True
            Else
                DTPEPANotifiedPermitOnWeb.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub chbEffectiveDateOfPermit_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbEffectiveDateOfPermit.CheckedChanged
        Try
            
            If chbEffectiveDateOfPermit.Checked = True Then
                DTPEffectiveDateofPermit.Visible = True
            Else
                DTPEffectiveDateofPermit.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
    Private Sub chbExperationDate_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chbExpirationDate.CheckedChanged
        Try
            
            If chbExpirationDate.Checked = True Then
                DTPExperationDate.Visible = True
            Else
                DTPExperationDate.Visible = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub

#End Region
    Private Sub btnSaveWebPublisher_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveWebPublisher.Click
        Try
            
            SaveWebPublisherData()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub TBDMUManagementTools_ButtonClick(ByVal sender As System.Object, ByVal e As System.Windows.Forms.ToolBarButtonClickEventArgs) Handles TBDMUManagementTools.ButtonClick
        Try
            
            Select Case TBDMUManagementTools.Buttons.IndexOf(e.Button)
                Case 0
                    Me.Close()
                Case 1
                    Me.Close()
                Case Else

            End Select
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnClear_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClear.Click
        Try
            
            chbDraftOnWeb.Checked = False
            DTPDraftOnWeb.Text = OracleDate
            chbEPAandStatesNotified.Checked = False
            DTPEPAStatesNotified.Text = OracleDate
            chbFinalOnWeb.Checked = False
            DTPFinalOnWeb.Text = OracleDate
            chbEPANotifiedPermitOnWeb.Checked = False
            DTPEPANotifiedPermitOnWeb.Text = OracleDate
            chbEffectiveDateOfPermit.Checked = False
            DTPEffectiveDateofPermit.Text = OracleDate
            txtEPATargetedComments.Clear()
            txtWebPublisherApplicationNumber.Clear()
            DTPExperationDate.Text = OracleDate
            chbExpirationDate.Checked = False
            txtFacilityInformation.Clear()
            chbNotifiedAppReceived.Checked = False
            DTPNotifiedAppReceived.Text = OracleDate
            chbPNExpires.Checked = False
            DTPPNExpires.Text = OracleDate


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub txtCDSAIRSNumber_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtCDSAIRSNumber.Leave
        Try
            
            FindRegion(txtCDSRegionCode.Text, txtCDSAIRSNumber.Text)

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnNewFacility_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnNewFacility.Click
        Try
            
            CreateNewFacility()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub llbFacilityInformation_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbFacilityInformation.LinkClicked
        Try
            
            GBFacilityInformation.Visible = True
            GBFacilityInformation.Location = New Point(224, 0)
            GBFacilityInformation.Size = New System.Drawing.Size(560, 280)
            GBMailingLocation.Visible = False
            GBHeaderData.Visible = False
            GBAirProgramCodes.Visible = False
            GBContactInformation.Visible = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub llbMailingLocation_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbMailingLocation.LinkClicked
        Try
            
            GBMailingLocation.Visible = True
            GBMailingLocation.Location = New Point(224, 0)
            GBMailingLocation.Size = New System.Drawing.Size(560, 120)
            GBFacilityInformation.Visible = False
            GBHeaderData.Visible = False
            GBAirProgramCodes.Visible = False
            GBContactInformation.Visible = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub llbHeaderData_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbHeaderData.LinkClicked
        Try
            
            GBHeaderData.Visible = True
            GBHeaderData.Location = New Point(224, 0)
            GBHeaderData.Size = New System.Drawing.Size(560, 152)
            GBMailingLocation.Visible = False
            GBFacilityInformation.Visible = False
            GBAirProgramCodes.Visible = False
            GBContactInformation.Visible = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Private Sub llbAirProgramCodes_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbAirProgramCodes.LinkClicked
        Try
            
            GBAirProgramCodes.Visible = True
            GBAirProgramCodes.Location = New Point(224, 0)
            GBAirProgramCodes.Size = New System.Drawing.Size(560, 120)
            GBMailingLocation.Visible = False
            GBHeaderData.Visible = False
            GBFacilityInformation.Visible = False
            GBContactInformation.Visible = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub llbContactInformation_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbContactInformation.LinkClicked
        Try
            
            GBContactInformation.Visible = True
            GBContactInformation.Location = New Point(224, 0)
            GBContactInformation.Size = New System.Drawing.Size(560, 157)
            GBMailingLocation.Visible = False
            GBHeaderData.Visible = False
            GBAirProgramCodes.Visible = False
            GBFacilityInformation.Visible = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub txtCDSAIRSNumber_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtCDSAIRSNumber.TextChanged
        Try
            
            If txtCDSAIRSNumber.Text.Length = 12 Then
                btnNewFacility.Enabled = True
                txtCDSAIRSNumber.BackColor = Color.White

                GBFacilityInformation.Visible = True
                GBFacilityInformation.Location = New Point(224, 0)
                GBFacilityInformation.Size = New System.Drawing.Size(560, 280)
                GBMailingLocation.Visible = False
                GBHeaderData.Visible = False
                GBAirProgramCodes.Visible = False
                GBContactInformation.Visible = False

                llbFacilityInformation.Enabled = True
                llbMailingLocation.Enabled = True
                llbHeaderData.Enabled = True
                llbAirProgramCodes.Enabled = True
                llbContactInformation.Enabled = True

            Else
                btnNewFacility.Enabled = False
                txtCDSAIRSNumber.BackColor = Color.PeachPuff

                llbFacilityInformation.Enabled = False
                llbMailingLocation.Enabled = False
                llbHeaderData.Enabled = False
                llbAirProgramCodes.Enabled = False
                llbContactInformation.Enabled = False
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub txtCDSStreetAddress_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtCDSStreetAddress.TextChanged
        Try
            
            txtMailingAddress.Text = txtCDSStreetAddress.Text
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub txtCDSCity_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtCDSCity.TextChanged
        Try
            
            txtMailingCity.Text = txtCDSCity.Text
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnGenerateBatchFile_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGenerateBatchFile.Click
        Try
            
            GenerateBatchFile()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnClearAFSFileGenerator_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClearAFSFileGenerator.Click
        Try
            
            txtAFSBatchFile.Clear()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub btnClearAddNewFacility_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClearAddNewFacility.Click
        Try
            
            ClearCreateFacility()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub MmiBack_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MmiBack.Click
        Try
            
            Me.Close()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnSearchForApplication_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSearchForApplication.Click
        Try
            

            LoadWebPublisherApplicationData()
            LoadWebPublishingFacilityInformation()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub

#Region "Web Application Users"
    Private Sub btnActivateEmail_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnActivateEmail.Click
        Try
            LoadComboBoxesEmail()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub

#End Region
#Region "Mahesh Code for Web App Users"
    Function LoadComboBoxes() As DataTable
        Dim dtairs As New DataTable
        Dim drDSRow As DataRow
        Dim drNewRow As DataRow
        Dim SQL As String

        Try
            

            SQL = "Select DISTINCT substr(strairsnumber, 5) as strairsnumber, " _
            + "strfacilityname " _
            + "from " & DBNameSpace & ".APBFacilityInformation " _
            + "Order by strAIRSNumber "

            ds = New DataSet
            da = New OracleDataAdapter(SQL, conn)

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            da.Fill(ds, "facilityInfo")

            dtairs.Columns.Add("strairsnumber", GetType(System.String))
            dtAIRS.Columns.Add("strfacilityname", GetType(System.String))

            drNewRow = dtAIRS.NewRow()
            drNewRow("strfacilityname") = " "
            drNewRow("strairsnumber") = " "
            dtAIRS.Rows.Add(drNewRow)

            For Each drDSRow In ds.Tables("facilityInfo").Rows()
                drNewRow = dtAIRS.NewRow()
                drNewRow("strairsnumber") = drDSRow("strairsnumber")
                drNewRow("strfacilityname") = drDSRow("strfacilityname")
                dtAIRS.Rows.Add(drNewRow)
            Next

            Return dtairs

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            Return Nothing
        Finally
           
        End Try
         
    End Function
    Sub LoadComboBoxesEmail()
        Dim dtAIRS As New DataTable
        Dim drDSRow As DataRow
        Dim drNewRow As DataRow

        Dim SQL As String

        Try
            

            SQL = "Select numuserid, struseremail " _
            + "from " & DBNameSpace & ".OlapUserLogin " _
            + "Order by struseremail "

            ds = New DataSet
            da = New OracleDataAdapter(SQL, conn)

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            da.Fill(ds, "UserEmail")

            dtAIRS.Columns.Add("numuserid", GetType(System.String))
            dtAIRS.Columns.Add("struseremail", GetType(System.String))

            drNewRow = dtAIRS.NewRow()
            drNewRow("numuserid") = " "
            drNewRow("struseremail") = " "
            dtAIRS.Rows.Add(drNewRow)

            For Each drDSRow In ds.Tables("UserEmail").Rows()
                drNewRow = dtAIRS.NewRow()
                drNewRow("numuserid") = drDSRow("numuserid")
                drNewRow("struseremail") = drDSRow("struseremail")
                dtAIRS.Rows.Add(drNewRow)
            Next
            Dim temp As String

            temp = dtAIRS.Rows.Count

            With cboUserEmail
                .DataSource = dtAIRS
                .DisplayMember = "struseremail"
                .ValueMember = "numuserid"
                .SelectedIndex = 0
            End With

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Sub FormatDataGridForWorkEntry()
        Try
            
            'Formatting our DataGrid
            Dim objGrid As New DataGridTableStyle
            Dim objtextcol As New DataGridTextBoxColumn
            Dim objbooleancol As New DataGridBoolColumn

            dgrUsers.TableStyles.Clear()
            'objGrid.AlternatingBackColor = Color.WhiteSmoke
            objGrid.MappingName = "tblFacilityUser"
            objGrid.RowHeadersVisible = False
            objGrid.AllowSorting = True

            'Formatting our DataGrid 0
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "ID"
            objtextcol.HeaderText = "ID"
            objtextcol.Width = 1
            objtextcol.ReadOnly = True
            objGrid.GridColumnStyles.Add(objtextcol)

            'Formatting our DataGrid 1
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "Email"
            objtextcol.HeaderText = "Email Address"
            objtextcol.ReadOnly = True
            objtextcol.Width = 300
            objGrid.GridColumnStyles.Add(objtextcol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intAdminAccess"
            objbooleancol.HeaderText = "Admin Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intFeeAccess"
            objbooleancol.HeaderText = "Fee Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intEIAccess"
            objbooleancol.HeaderText = "EI Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intESAccess"
            objbooleancol.HeaderText = "ES Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            'Applying the above formating 
            'dgrUsers.TableStyles.Clear()
            dgrUsers.TableStyles.Add(objGrid)

            'Setting the DataGrid Caption, which defines the table title
            dgrUsers.CaptionText = "Current Users for " & lblFacilityName.Text
            dgrUsers.ColumnHeadersVisible = True

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         

    End Sub
    Sub FormatDataGridForWorkEnTryEmail()
        Try
            
            'Formatting our DataGrid
            Dim objGrid As New DataGridTableStyle
            Dim objtextcol As New DataGridTextBoxColumn
            Dim objbooleancol As New DataGridBoolColumn

            dgrFacilities.TableStyles.Clear()
            'objGrid.AlternatingBackColor = Color.WhiteSmoke
            objGrid.MappingName = "tblUserFacility"
            objGrid.RowHeadersVisible = False
            objGrid.AllowSorting = True

            'Formatting our DataGrid 0
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strairsnumber"
            objtextcol.HeaderText = "Airs Number"
            objtextcol.Width = 110
            objtextcol.ReadOnly = True
            objGrid.GridColumnStyles.Add(objtextcol)

            'Formatting our DataGrid 1
            objtextcol = New DataGridTextBoxColumn
            objtextcol.MappingName = "strfacilityname"
            objtextcol.HeaderText = "Facility Name"
            objtextcol.ReadOnly = True
            objtextcol.Width = 220
            objGrid.GridColumnStyles.Add(objtextcol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intAdminAccess"
            objbooleancol.HeaderText = "Admin Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intFeeAccess"
            objbooleancol.HeaderText = "Fee Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intEIAccess"
            objbooleancol.HeaderText = "EI Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            objbooleancol = New DataGridBoolColumn
            objbooleancol.MappingName = "intESAccess"
            objbooleancol.HeaderText = "ES Access"
            objbooleancol.ReadOnly = False
            objbooleancol.Width = 100
            objbooleancol.FalseValue = "False"
            objbooleancol.TrueValue = "True"
            'objbooleancol.AllowNull = False 'For a two-state checkbox
            objGrid.GridColumnStyles.Add(objbooleancol)

            'Applying the above formating 
            'dgrUsers.TableStyles.Clear()
            dgrFacilities.TableStyles.Add(objGrid)

            'Setting the DataGrid Caption, which defines the table title
            dgrFacilities.CaptionText = "Current Facilities for " & txtWebUserEmail.Text
            dgrFacilities.ColumnHeadersVisible = True

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Private Sub lblViewFacility_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewFacility.LinkClicked
        Try
            LoadDataGridFacility(cboUserEmail.Text)
            LoadUserInfo(cboUserEmail.Text)
            FormatDataGridForWorkEnTryEmail()

            If txtWebUserID.Text = "" Then
                pnlUserInfo.Visible = False
                pnlUserFacility.Visible = False
            Else
                pnlUserInfo.Visible = True
                pnlUserFacility.Visible = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Sub LoadDataGrid()
        Dim SQL As String = ""
        Try
            
            dsWorkEntry = New DataSet
            If Not dsWorkEntry.Tables("tblFacilityUser") Is Nothing Then
                dsWorkEntry.Tables("tblFacilityUser").Clear()
                dsWorkEntry.Tables.Remove("tblFacilityUser")
                dsWorkEntry.AcceptChanges()
            End If

            SQL = "SELECT " & DBNameSpace & ".OlapUserAccess.NumUserID as ID, " & DBNameSpace & ".OlapUserLogin.numuserid, " & _
                    "" & DBNameSpace & ".OlapUserLogin.strUserEmail as Email, " & _
                    "Case When intAdminAccess = 0 Then 'False' When intAdminAccess = 1 Then 'True' End as intAdminAccess, " & _
                    "Case When intFeeAccess = 0 Then 'False' When intFeeAccess = 1 Then 'True' End as intFeeAccess, " & _
                    "Case When intEIAccess = 0 Then 'False' When intEIAccess = 1 Then 'True' End as intEIAccess, " & _
                    "Case When intESAccess = 0 Then 'False' When intESAccess = 1 Then 'True' End as intESAccess " & _
                    "FROM " & DBNameSpace & ".OlapUserAccess, " & DBNameSpace & ".OlapUserLogin " & _
                    "WHERE " & DBNameSpace & ".OLAPUserAccess.NumUserId = " & DBNameSpace & ".OlapUserLogin.NumUserID " & _
                    "AND " & DBNameSpace & ".OlapUserAccess.strAirsNumber = '0413" & airsno & "' order by email"

            daWorkEnTry = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            daWorkEnTry.Fill(dsWorkEntry, "tblFacilityUser")

            dgrUsers.DataSource = dsWorkEntry
            dgrUsers.DataMember = "tblFacilityUser"

            cboUsers.DataSource = dsWorkEntry.Tables("tblFacilityUser")
            cboUsers.DisplayMember = "Email"
            cboUsers.ValueMember = "ID"

            'USER_ this little section removes the Append Row from
            ' the end of the datagrid
            Dim cm As CurrencyManager = Me.BindingContext(Me.dgrUsers.DataSource, Me.dgrUsers.DataMember)

            Dim dv As DataView = cm.List
            dv.AllowNew = False
            'End remove append Row


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Sub LoadDataGridFacility(ByVal EmailLoc As String)
        Dim SQL As String = ""
        Try
            dsWorkEntry = New DataSet
            If Not dsWorkEntry.Tables("tblUserFacility") Is Nothing Then
                dsWorkEntry.Tables("tblUserFacility").Clear()
                dsWorkEntry.Tables.Remove("tblUserFacility")
                dsWorkEntry.AcceptChanges()
            End If

            SQL = "SELECT strairsnumber, strfacilityname, " & _
                    "Case When intAdminAccess = 0 Then 'False' When intAdminAccess = 1 Then 'True' End as intAdminAccess, " & _
                    "Case When intFeeAccess = 0 Then 'False' When intFeeAccess = 1 Then 'True' End as intFeeAccess, " & _
                    "Case When intEIAccess = 0 Then 'False' When intEIAccess = 1 Then 'True' End as intEIAccess, " & _
                    "Case When intESAccess = 0 Then 'False' When intESAccess = 1 Then 'True' End as intESAccess " & _
                    "FROM " & DBNameSpace & ".OlapUserAccess, " & DBNameSpace & ".OLAPUserLogIn  " & _
                    "WHERE " & DBNameSpace & ".OlapUserAccess.numUserId = " & DBNameSpace & ".OLAPUserLogIn.numUserId " & _
                    "and  strUserEmail = upper('" & EmailLoc & "') " & _
                    "order by strfacilityname"

            daWorkEnTry = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            daWorkEnTry.Fill(dsWorkEntry, "tblUserFacility")

            dgrFacilities.DataSource = dsWorkEntry
            dgrFacilities.DataMember = "tblUserFacility"

            cboFacilityToDelete.DataSource = dsWorkEntry.Tables("tblUserFacility")
            cboFacilityToDelete.DisplayMember = "strfacilityname"
            cboFacilityToDelete.ValueMember = "strairsnumber"

            'USER_ this little section removes the Append Row from
            ' the end of the datagrid
            Dim cm As CurrencyManager = Me.BindingContext(Me.dgrFacilities.DataSource, Me.dgrFacilities.DataMember)

            Dim dv As DataView = cm.List
            dv.AllowNew = False
            'End remove append Row

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Sub LoadUserInfo(ByVal UserData As String)
        Try
            SQL = "Select " & _
            "" & DBNameSpace & ".OLAPUserProfile.numUserID, " & _
            "strfirstname, strlastname, " & _
            "strtitle, strcompanyname, " & _
            "straddress, strcity, " & _
            "strstate, strzip, " & _
            "strphonenumber, strfaxnumber, " & _
            "datLastLogIn, strConfirm, " & _
            "strUserEmail " & _
            "from " & DBNameSpace & ".OlapUserProfile, " & DBNameSpace & ".OLAPUserLogIn " & _
            "where " & DBNameSpace & ".OLAPUserProfile.numUserID = " & DBNameSpace & ".OLAPUserLogIn.numuserid " & _
            "and strUserEmail = upper('" & UserData & "') "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = True Then
                If IsDBNull(dr.Item("numUserID")) Then
                    txtWebUserID.Clear()
                Else
                    txtWebUserID.Text = dr.Item("numUserID")
                End If
                If IsDBNull(dr.Item("strfirstname")) Then
                    txtEditFirstName.Clear()
                Else
                    lblFName.Text = "First Name: " & dr.Item("strfirstname")
                    txtEditFirstName.Text = dr.Item("strFirstName")
                End If
                If IsDBNull(dr.Item("strlastname")) Then
                    txtEditLastName.Clear()
                Else
                    lblLName.Text = "Last Name: " & dr.Item("strlastname")
                    txtEditLastName.Text = dr.Item("strLastName")
                End If
                If IsDBNull(dr.Item("strtitle")) Then
                    txtEditTitle.Clear()
                Else
                    lblTitle.Text = "Title: " & dr.Item("strtitle")
                    txtEditTitle.Text = dr.Item("strTitle")
                End If
                If IsDBNull(dr.Item("strcompanyname")) Then
                    txtEditCompany.Clear()
                Else
                    lblCoName.Text = "Company Name: " & dr.Item("strcompanyname")
                    txtEditCompany.Text = dr.Item("strCompanyName")
                End If
                If IsDBNull(dr.Item("straddress")) Then
                    txtEditAddress.Clear()
                Else
                    lblAddress.Text = dr.Item("straddress")
                    txtEditAddress.Text = dr.Item("strAddress")
                End If
                If IsDBNull(dr.Item("strcity")) Then
                    txtEditCity.Clear()
                    mtbEditState.Clear()
                    mtbEditZipCode.Clear()
                Else
                    lblCityStateZip.Text = dr.Item("strcity") & ", " & dr.Item("strstate") & " " & dr.Item("strzip")
                    txtEditCity.Text = dr.Item("strCity")
                    mtbEditState.Text = dr.Item("strState")
                    mtbEditZipCode.Text = dr.Item("strZip")
                End If
                If IsDBNull(dr.Item("strphonenumber")) Then
                    mtbEditPhoneNumber.Clear()
                Else
                    lblPhoneNo.Text = "Phone Number: " & dr.Item("strphonenumber")
                    mtbEditPhoneNumber.Text = dr.Item("strPhoneNumber")
                End If
                If IsDBNull(dr.Item("strfaxnumber")) Then
                    mtbEditFaxNumber.Clear()
                Else
                    lblFaxNo.Text = "Fax Number: " & dr.Item("strfaxnumber")
                    mtbEditFaxNumber.Text = dr.Item("strFaxNumber")
                End If
                If IsDBNull(dr.Item("strConfirm")) Then
                    lblConfirmDate.Text = ""
                Else
                    lblConfirmDate.Text = "Date User Email Confirmed: " & dr.Item("strConfirm")
                End If
                If IsDBNull(dr.Item("datLastLogIn")) Then
                    lblLastLogIn.Text = ""
                Else
                    lblLastLogIn.Text = "Date User Last Logged In: " & dr.Item("datLastLogIn")
                End If
                If IsDBNull(dr.Item("strUserEmail")) Then
                    txtEditEmail.Text = ""
                Else
                    txtEditEmail.Text = dr.Item("strUserEmail")
                End If
            Else
                txtWebUserID.Clear()
                txtEditFirstName.Clear()
                txtEditLastName.Clear()
                txtEditTitle.Clear()
                txtEditCompany.Clear()
                txtEditAddress.Clear()
                txtEditCity.Clear()
                mtbEditState.Clear()
                mtbEditZipCode.Clear()
                mtbEditPhoneNumber.Clear()
                mtbEditFaxNumber.Clear()
                lblLastLogIn.Text = ""
                lblConfirmDate.Text = ""
                txtEditEmail.Clear()
            End If

            txtEditUserPassword.Clear()
            txtEditFirstName.Visible = False
            txtEditLastName.Visible = False
            txtEditTitle.Visible = False
            txtEditCompany.Visible = False
            txtEditAddress.Visible = False
            txtEditCity.Visible = False
            mtbEditState.Visible = False
            mtbEditZipCode.Visible = False
            mtbEditPhoneNumber.Visible = False
            mtbEditFaxNumber.Visible = False
            btnSaveEditedData.Visible = False
            txtEditUserPassword.Visible = False
            btnChangeEmailAddress.Visible = False
            txtEditEmail.Visible = False
            btnUpdatePassword.Visible = False
            gbSmokeSchoolRegistration.Visible = False

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub Back()
        Try
            
            Me.Hide()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnUpdate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUpdate.Click
        Try
            Dim dt As DataTable
            Dim userId As Integer
            Dim adminaccess As Boolean
            Dim feeaccess As Boolean
            Dim eiaccess As Boolean
            Dim esaccess As Boolean

            dt = dsWorkEntry.Tables("tblFacilityUser").GetChanges
            If dt Is Nothing Then
            Else
                Dim Row As DataRow
                Dim intColumn As Integer
                For Each Row In dt.Rows
                    Select Case Row.RowState
                        'Case DataRowState.Added
                        '    blnDataChanged = True
                        'Case DataRowState.Deleted
                        '    blnDataChanged = True
                        Case DataRowState.Modified
                            For intColumn = 3 To 6
                                If Not IsDBNull(Row(intColumn, DataRowVersion.Original)) And Not IsDBNull(Row(intColumn, DataRowVersion.Current)) Then
                                    If Row(intColumn, DataRowVersion.Original) <> Row(intColumn, DataRowVersion.Current) Then
                                        userId = Row(0, DataRowVersion.Original)
                                        adminaccess = Row(3, DataRowVersion.Current)
                                        feeaccess = Row(4, DataRowVersion.Current)
                                        eiaccess = Row(5, DataRowVersion.Current)
                                        esaccess = Row(6, DataRowVersion.Current)
                                        UpdateRecords(userId, adminaccess, feeaccess, eiaccess, esaccess)
                                        'Exit For
                                    End If
                                End If
                            Next

                    End Select
                Next
            End If
            MsgBox("The records have been updated", MsgBoxStyle.Information, "Update Success!")
            LoadDataGrid()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
    Private Sub UpdateRecords(ByVal userid As Object, ByVal adminaccess As Object, ByVal feeaccess As Object, ByVal eiaccess As Object, ByVal esaccess As Object)

        Dim admin, fee, ei, es As Integer
        If adminaccess = True Then
            admin = 1
        Else
            admin = 0
        End If
        If feeaccess = True Then
            fee = 1
        Else
            fee = 0
        End If
        If eiaccess = True Then
            ei = 1
        Else
            ei = 0
        End If
        If esaccess = True Then
            es = 1
        Else
            es = 0
        End If

        Try
            Dim updateString As String = "UPDATE " & DBNameSpace & ".OlapUserAccess " & _
                      "SET intadminaccess = '" & admin & "', " & _
                      "intFeeAccess = '" & fee & "', " & _
                      "intEIAccess = '" & ei & "', " & _
                      "intESAccess = '" & es & "' " & _
                      "WHERE numUserID = '" & userid & "' " & _
                      "and strAirsNumber = '0413" & airsno & "' "

            Dim cmd As New OracleCommand(updateString, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            cmd.ExecuteNonQuery()
          
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
    Private Sub UpdateRecordsEmail(ByVal airsnumber As Object, ByVal adminaccess As Object, ByVal feeaccess As Object, ByVal eiaccess As Object, ByVal esaccess As Object)

        Dim admin, fee, ei, es As Integer
        If adminaccess = True Then
            admin = 1
        Else
            admin = 0
        End If
        If feeaccess = True Then
            fee = 1
        Else
            fee = 0
        End If
        If eiaccess = True Then
            ei = 1
        Else
            ei = 0
        End If
        If esaccess = True Then
            es = 1
        Else
            es = 0
        End If

        Try
            Dim updateString As String = "UPDATE " & DBNameSpace & ".OlapUserAccess " & _
                      "SET intadminaccess = '" & admin & "', " & _
                      "intFeeAccess = '" & fee & "', " & _
                      "intEIAccess = '" & ei & "', " & _
                      "intESAccess = '" & es & "' " & _
                      "WHERE numUserID = '" & txtWebUserID.Text & "' " & _
                      "and strAirsNumber = '" & airsnumber & "' "

            Dim cmd As New OracleCommand(updateString, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            cmd.ExecuteNonQuery()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
    Private Sub btnAddFacilitytoUser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAddFacilitytoUser.Click
        Try
            If txtWebUserID.Text <> "" And mtbFacilityToAdd.Text <> "" Then
                Dim InsertString As String = "Insert into " & DBNameSpace & ".OlapUserAccess " & _
                "(numUserId, strAirsNumber, strFacilityName) values( " & _
                "'" & txtWebUserID.Text & "', '0413" & mtbFacilityToAdd.Text & "', " & _
                "(select strFacilityName from " & DBNameSpace & ".APBFacilityInformation where strAIRSnumber = '0413" & mtbFacilityToAdd.Text & "')) "

                Dim cmd As New OracleCommand(InsertString, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                cmd.ExecuteNonQuery()

                dgrFacilities.Refresh()
                MsgBox("The facility has beed added to this user", MsgBoxStyle.Information, "Insert Success!")
                LoadDataGridFacility(txtWebUserEmail.Text)

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnDeleteFacilityUser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDeleteFacilityUser.Click
        Try
            If txtWebUserID.Text <> "" And cboFacilityToDelete.Text <> "" Then
                Dim deleteString As String = "DELETE " & DBNameSpace & ".OlapUserAccess " & _
                "WHERE numUserID = '" & txtWebUserID.Text & "' " & _
                "and strAirsNumber = '" & cboFacilityToDelete.SelectedValue & "' "

                Dim cmd As New OracleCommand(deleteString, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                cmd.ExecuteNonQuery()

                MsgBox("The facility has been removed for this user", MsgBoxStyle.Information, "Facility Removed!")
                LoadDataGridFacility(txtWebUserEmail.Text)
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnAddUser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAddUser.Click
        Try
            Dim userID As Integer
            Dim sql As String = "Select numUserId from " & DBNameSpace & ".olapuserlogin " & _
            "where struseremail = '" & Replace(UCase(txtEmail.Text), "'", "''") & "' "
            Dim cmd As New OracleCommand
            Dim dr As OracleDataReader
            Dim recexist As Boolean

            cmd = New OracleCommand(sql, conn)

            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            recexist = dr.Read

            If recexist = True Then 'Email address is registered
                userID = dr.Item("numUserId")
                Dim InsertString As String = "Insert into " & DBNameSpace & ".OlapUserAccess " & _
                "(numUserId, strAirsNumber, strFacilityName) values( " & _
                "'" & userID & "', '0413" & airsno & "', '" & Replace(lblFacilityName.Text, "'", "''") & "') "

                Dim cmd1 As New OracleCommand(InsertString, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                cmd1.ExecuteNonQuery()

                dgrUsers.Refresh()
                MsgBox("The User has beed added to this facility", MsgBoxStyle.Information, "Insert Success!")
                LoadDataGrid()
            Else 'email address not registered
                MsgBox("This Email Address is not registered", MsgBoxStyle.OkOnly, "Insert Failed!")
            End If

            If dr.IsClosed = False Then dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnDelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDelete.Click
        Try
            Dim deleteString As String = "DELETE " & DBNameSpace & ".OlapUserAccess " & _
                                "WHERE numUserID = '" & cboUsers.SelectedValue & "' " & _
                                "and strAirsNumber = '0413" & airsno & "' "

            Dim cmd As New OracleCommand(deleteString, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            cmd.ExecuteNonQuery()
           
            MsgBox("The User has been removed for this facility", MsgBoxStyle.Information, "User Removed!")
            LoadDataGrid()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnActivateUser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnActivateUser.Click
        Try
            SQL = "Select strUserEmail " & _
            "from " & DBNameSpace & ".OlapUserLogIn " & _
            "where strUserEmail = '" & Replace(UCase(txtEmailAddress.Text), "'", "''") & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                Dim updateString As String = "UPDATE " & DBNameSpace & ".OlapUserLogin " & _
                          "SET strconfirm = to_char(sysdate, 'yyyy/mm/dd hh:mi:ss') " & _
                          "WHERE struseremail = '" & Replace(UCase(txtEmailAddress.Text), "'", "''") & "' "
                cmd = New OracleCommand(updateString, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                cmd.ExecuteNonQuery()
               
                MsgBox("The account has been activated", MsgBoxStyle.Information, "Activated!")
            Else
                MsgBox("This user does not exist.", MsgBoxStyle.Exclamation, "Activate failed!")
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
  
  
    Private Sub btnUpdateUser_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUpdateUser.Click
        Dim airsnumber As String = ""
        Dim adminaccess As Boolean
        Dim feeaccess As Boolean
        Dim eiaccess As Boolean
        Dim esaccess As Boolean
        Try
            If txtWebUserID.Text <> "" Then
                Dim dt As DataTable
                dt = dsWorkEntry.Tables("tblUserFacility").GetChanges
                If dt Is Nothing Then
                Else
                    Dim Row As DataRow
                    Dim intColumn As Integer
                    For Each Row In dt.Rows
                        Select Case Row.RowState
                            'Case DataRowState.Added
                            '    blnDataChanged = True
                            'Case DataRowState.Deleted
                            '    blnDataChanged = True
                            Case DataRowState.Modified
                                For intColumn = 2 To 5
                                    If Not IsDBNull(Row(intColumn, DataRowVersion.Original)) And Not IsDBNull(Row(intColumn, DataRowVersion.Current)) Then
                                        If Row(intColumn, DataRowVersion.Original) <> Row(intColumn, DataRowVersion.Current) Then
                                            airsnumber = Row(0, DataRowVersion.Original)
                                            adminaccess = Row(2, DataRowVersion.Current)
                                            feeaccess = Row(3, DataRowVersion.Current)
                                            eiaccess = Row(4, DataRowVersion.Current)
                                            esaccess = Row(5, DataRowVersion.Current)
                                            UpdateRecordsEmail(airsnumber, adminaccess, feeaccess, eiaccess, esaccess)
                                            'Exit For
                                        End If
                                    End If
                                Next
                        End Select
                    Next
                End If
                MsgBox("The records have been updated", MsgBoxStyle.Information, "Update Success!")
                LoadDataGrid()
            End If
        Catch ex As Exception
            ErrorReport(airsnumber & vbCrLf & adminaccess & vbCrLf & feeaccess & vbCrLf & eiaccess & vbCrLf & esaccess & vbCrLf & _
                         ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
#End Region
#Region "Fee Password Reset"
    Private Sub SetPassword_Closing(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles MyBase.Closing
        Try
            
            If NavigationScreen Is Nothing Then
                NavigationScreen = New IAIPNavigation
            End If
            NavigationScreen.Show()
            Me.Dispose()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub

#End Region

    Private Sub txtWebPublisherApplicationNumber_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtWebPublisherApplicationNumber.Leave
        Try
            
            If txtWebPublisherApplicationNumber.Text <> "" Then
                LoadWebPublisherApplicationData()
                LoadWebPublishingFacilityInformation()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Private Sub txtWebPublisherApplicationNumber_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles txtWebPublisherApplicationNumber.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                If txtWebPublisherApplicationNumber.Text <> "" Then
                    LoadWebPublisherApplicationData()
                End If
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnRunTitleVReport_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRunTitleVReport.Click
        Try
            
            RunTitleVRenewalReport()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Private Sub btnPrintRenewalLetters_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrintRenewalLetters.Click
        Try
            
            Dim SQLLine As String = "*"
            Dim temp As String = ""

            If Me.txtRenewalCount.Text <> "" And txtRenewalCount.Text <> "0" Then
                PrintOut = Nothing
                If PrintOut Is Nothing Then PrintOut = New IAIPPrintOut
                PrintOut.txtPrintType.Text = "TitleVRenewal"
                PrintOut.txtSQLLine.Text = SQLLine
                PrintOut.txtStartDate.Text = Startdate
                PrintOut.txtEndDate.Text = EndDate
                PrintOut.Show()
                PrintOut.Location = New System.Drawing.Point(DefaultX + 25, DefaultY)
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnFilterErrors_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnFilterErrors.Click
        Try
            
            LoadErrorLog()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub dgrErrorList_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles dgrErrorList.MouseUp
        Dim hti As DataGrid.HitTestInfo = dgrErrorList.HitTest(e.X, e.Y)
        Try
            
            If hti.Type = DataGrid.HitTestType.Cell Then
                If IsDBNull(dgrErrorList(hti.Row, 0)) Then
                    txtErrorNumber.Text = ""
                Else
                    txtErrorNumber.Text = dgrErrorList(hti.Row, 0)
                End If

                If txtErrorNumber.Text <> "" Then
                    SQL = "Select " & _
                    "strErrorNumber, " & _
                    "(strLastName||', '||strFirstName) as ErrorUser,  " & _
                    "strErrorLocation, strErrorMessage,  " & _
                    "to_char(datErrorDate, 'DD-Mon-YYYY') as ErrorDate,  " & _
                    "strSolution  " & _
                    "from " & DBNameSpace & ".IAIPErrorLog, " & DBNameSpace & ".EPDUserProfiles  " & _
                    "where " & DBNameSpace & ".IAIPErrorLog.strUser = " & DBNameSpace & ".EPDUserProfiles.numUserID " & _
                    "and strErrorNumber = '" & txtErrorNumber.Text & "' "
                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("ErrorUser")) Then
                            txtErrorUser.Text = ""
                        Else
                            txtErrorUser.Text = dr.Item("ErrorUser")
                        End If
                        If IsDBNull(dr.Item("strErrorLocation")) Then
                            txtErrorLocation.Text = ""
                        Else
                            txtErrorLocation.Text = dr.Item("strErrorLocation")
                        End If
                        If IsDBNull(dr.Item("ErrorDate")) Then
                            txtErrorDate.Text = ""
                        Else
                            txtErrorDate.Text = dr.Item("ErrorDate")
                        End If
                        If IsDBNull(dr.Item("strSolution")) Then
                            txtErrorSolution.Text = ""
                        Else
                            txtErrorSolution.Text = dr.Item("strSolution")
                        End If
                        If IsDBNull(dr.Item("strErrorMessage")) Then
                            txtErrorMessage.Text = ""
                        Else
                            txtErrorMessage.Text = dr.Item("strErrorMessage")
                        End If
                    End If
                End If
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnSaveError_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveError.Click
        Try
            

            Dim ErrorSolution As String = ""
            If txtErrorSolution.Text <> "" Then
                ErrorSolution = Mid(txtErrorSolution.Text, 1, 4000)
            End If
            If txtErrorNumber.Text <> "" Then
                SQL = "Update " & DBNameSpace & ".IAIPErrorLog set " & _
                "strSolution = '" & Replace(ErrorSolution, "'", "''") & "' " & _
                "where strErrornumber = '" & txtErrorNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                dr.Read()
                dr.Close()

                MsgBox("Solution Saved", MsgBoxStyle.Information, "Date Management Tools")
            Else
                MsgBox("Select an error", MsgBoxStyle.Exclamation, "Data Management Tools")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub btnFilterWebErrors_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnFilterWebErrors.Click
        Try
            
            LoadWegErrorLog()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub dgrWebErrorList_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles dgrWebErrorList.MouseUp
        Dim hti As DataGrid.HitTestInfo = dgrWebErrorList.HitTest(e.X, e.Y)
        Try
            
            If hti.Type = DataGrid.HitTestType.Cell Then
                If IsDBNull(dgrWebErrorList(hti.Row, 0)) Then
                    txtWebErrorNumber.Text = ""
                Else
                    txtWebErrorNumber.Text = dgrWebErrorList(hti.Row, 0)
                End If

                If txtWebErrorNumber.Text <> "" Then
                    SQL = "Select " & _
                    "strIPAddress, strAgent, strPage, " & _
                    "strTime, strDetails, numError, " & _
                    "strSolution " & _
                    "from " & DBNameSpace & ".LogErrors " & _
                    "where NumError = " & txtWebErrorNumber.Text & " "
                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    If recExist = True Then
                        If IsDBNull(dr.Item("strIPAddress")) Then
                            txtIPAddress.Text = ""
                        Else
                            txtIPAddress.Text = dr.Item("strIPAddress")
                        End If
                        If IsDBNull(dr.Item("strAgent")) Then
                            txtWebErrorUser.Text = ""
                        Else
                            txtWebErrorUser.Text = dr.Item("strAgent")
                        End If
                        If IsDBNull(dr.Item("strPage")) Then
                            txtWebErrorLocation.Text = ""
                        Else
                            txtWebErrorLocation.Text = dr.Item("strPage")
                        End If
                        If IsDBNull(dr.Item("strTime")) Then
                            txtWebErrorDate.Text = ""
                        Else
                            txtWebErrorDate.Text = dr.Item("strTime")
                        End If
                        If IsDBNull(dr.Item("strDetails")) Then
                            txtWebErrorMessage.Text = ""
                        Else
                            txtWebErrorMessage.Text = dr.Item("strDetails")
                        End If
                        If IsDBNull(dr.Item("strSolution")) Then
                            txtWebErrorSolution.Text = ""
                        Else
                            txtWebErrorSolution.Text = dr.Item("strSolution")
                        End If
                    End If
                End If
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnSaveWebErrorSolution_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveWebErrorSolution.Click
        Try
            

            Dim ErrorSolution As String = ""
            If txtWebErrorSolution.Text <> "" Then
                ErrorSolution = Mid(txtWebErrorSolution.Text, 1, 4000)
            End If
            If txtErrorNumber.Text <> "" Then
                SQL = "Update " & DBNameSpace & ".LogErrors set " & _
                "strSolution = '" & Replace(ErrorSolution, "'", "''") & "' " & _
                "where numError = '" & txtWebErrorNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                dr.Read()
                dr.Close()

                MsgBox("Solution Saved", MsgBoxStyle.Information, "Date Management Tools")
            Else
                MsgBox("Select an error", MsgBoxStyle.Exclamation, "Data Management Tools")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnPreviewESNReceived_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPreviewESNReceived.Click
        Try
            

            PreviewAppReceivedEmail()

            txtApplicationCount.Text = clbTitleVEmailList.Items.Count

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnPreviewESNReceived_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnPreviewESNReceived.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                PreviewAppReceivedEmail()

                txtApplicationCount.Text = clbTitleVEmailList.Items.Count

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnPreviewDraftOnWeb_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPreviewDraftOnWeb.Click
        Try
            

            PreviewDraftOnWeb()

            txtApplicationCount.Text = clbTitleVEmailList.Items.Count

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnPreviewDraftOnWeb_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnPreviewDraftOnWeb.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                PreviewDraftOnWeb()

                txtApplicationCount.Text = clbTitleVEmailList.Items.Count
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnPreviewMinorMod_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPreviewMinorMod.Click
        Try
            

            PreviewMinorModOnWeb()

            txtApplicationCount.Text = clbTitleVEmailList.Items.Count

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnPreviewMinorMod_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnPreviewMinorMod.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                PreviewMinorModOnWeb()

                txtApplicationCount.Text = clbTitleVEmailList.Items.Count

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnPreviewFinalOnWeb_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPreviewFinalOnWeb.Click
        Try
            

            PreviewFinalOnWeb()

            txtApplicationCount.Text = clbTitleVEmailList.Items.Count

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
         
    End Sub
    Private Sub btnPreviewFinalOnWeb_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnPreviewFinalOnWeb.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                PreviewFinalOnWeb()

                txtApplicationCount.Text = clbTitleVEmailList.Items.Count
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnEmailESNReceived_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEmailESNReceived.Click
        Try
            

            GenerateAppReceivedEmail()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnEmailESNReceived_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnEmailESNReceived.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                GenerateAppReceivedEmail()

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnEmailDraftOnWeb_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEmailDraftOnWeb.Click
        Try
            

            GenerateDraftOnWebEmail()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnEmailDraftOnWeb_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnEmailDraftOnWeb.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                GenerateDraftOnWebEmail()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        
        End Try
         
    End Sub
    Private Sub btnEmailDraftOnWebState_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEmailDraftOnWebState.Click
        Try

            GenerateDraftOnWebState()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnEmailDraftOnWebState_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnEmailDraftOnWebState.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                GenerateDraftOnWebState()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnMinorModOnWebEPD_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnMinorModOnWebEPD.Click
        Try
            

            GenerateMinorOnWebEmail()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnMinorModOnWebEPD_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnMinorModOnWebEPD.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                GenerateMinorOnWebEmail()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnMinorModOnWebState_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnMinorModOnWebState.Click
        Try
            

            GenerateMinorOnWebState()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnMinorModOnWebState_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnMinorModOnWebState.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                GenerateMinorOnWebState()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnEmailFinalOnWeb_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEmailFinalOnWeb.Click
        Try

            GenerateFinalOnWeb()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnEmailFinalOnWeb_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles btnEmailFinalOnWeb.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then

                GenerateFinalOnWeb()

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub btnEditFacilityLatLong_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEditFacilityLatLong.Click
        Try
            
            Dim Latitude As String
            Dim Longitude As String

            If txtLatLongFacilityInformation.Text <> "" And txtLatLongAIRSNumber.Text <> "" Then
                If txtEditFacilityLatitude.Text <> "" Then
                    If IsNumeric(txtEditFacilityLatitude.Text) Then
                        Latitude = Replace(txtEditFacilityLatitude.Text, "-", "")
                    Else
                        Latitude = "00.0000"
                    End If
                Else
                    Latitude = "00.00000"
                End If
                If txtEditFacilityLongitude.Text <> "" Then
                    If IsNumeric(txtEditFacilityLongitude.Text) Then
                        Longitude = Replace(txtEditFacilityLongitude.Text, "-", "")
                    Else
                        Longitude = "00.0000"
                    End If
                Else
                    Longitude = "00.00000"
                End If

                SQL = "Update " & DBNameSpace & ".APBFacilityInformation set " & _
                "numFacilityLongitude = " & Longitude & ", " & _
                "numFacilityLatitude = " & Latitude & " " & _
                "where strAIRSNumber = '0413" & txtLatLongAIRSNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                dr.Close()

                MsgBox("Done", MsgBoxStyle.Information, "ISMP Data Management Tools")
            Else
                MsgBox("The AIRS # does not appear in the system." & vbCrLf & _
                        "If this is incorrect please contact the system administrator", MsgBoxStyle.Information, "ISMP Data Management Tools")
            End If



        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Private Sub btnClearLatLongEdit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClearLatLongEdit.Click
        Try
            

            txtLatLongAIRSNumber.Clear()
            txtLatLongFacilityInformation.Clear()
            txtEditFacilityLatitude.Clear()
            txtEditFacilityLongitude.Clear()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Private Sub txtLatLongAIRSNumber_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles txtLatLongAIRSNumber.TextChanged
        Try
            

            If txtLatLongAIRSNumber.Text <> "" And txtLatLongAIRSNumber.Text.Length = 8 Then
                SQL = "Select " & _
                "strFacilityName, strFacilityStreet1, " & _
                 "strFacilityCity, strFacilityZipCode, " & _
                 "numFacilityLongitude, numFacilityLatitude, " & _
                 "strCountyName " & _
                 "from " & DBNameSpace & ".APBFacilityInformation, " & DBNameSpace & ".LookUpCountyInformation " & _
                 "where substr(" & DBNameSpace & ".APBFacilityInformation.strAIRSNumber, 5, 3) = " & DBNameSpace & ".LookUpCountyInformation.strCountyCode " & _
                 "and " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber = '0413" & txtLatLongAIRSNumber.Text & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = True Then
                    txtLatLongFacilityInformation.Text = ""
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & vbCrLf
                    Else
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & dr.Item("strFacilityName") & vbCrLf
                    End If
                    If IsDBNull(dr.Item("strFacilityStreet1")) Then
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & vbCrLf
                    Else
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & dr.Item("strFacilityStreet1") & vbCrLf
                    End If
                    If IsDBNull(dr.Item("strFacilityCity")) Then
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text
                    Else
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & dr.Item("strFacilityCity") & " GA, "
                    End If
                    If IsDBNull(dr.Item("strFacilityZipCode")) Then
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & vbCrLf & vbCrLf
                    Else
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & dr.Item("strFacilityZipCode") & vbCrLf & vbCrLf
                    End If
                    If IsDBNull(dr.Item("strCountyName")) Then
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & "County - "
                    Else
                        txtLatLongFacilityInformation.Text = txtLatLongFacilityInformation.Text & "County - " & dr.Item("strCountyName")
                    End If
                    If IsDBNull(dr.Item("numFacilityLongitude")) Then
                        txtEditFacilityLongitude.Text = ""
                    Else
                        txtEditFacilityLongitude.Text = dr.Item("numFacilityLongitude")
                    End If
                    If IsDBNull(dr.Item("numFacilityLatitude")) Then
                        txtEditFacilityLatitude.Text = ""
                    Else
                        txtEditFacilityLatitude.Text = dr.Item("numFacilityLatitude")
                    End If
                Else
                    txtLatLongFacilityInformation.Text = ""
                End If
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnAddApplicationToList_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAddApplicationToList.Click
        Try

            AddAppToList()

            txtApplicationCount.Text = clbTitleVEmailList.Items.Count

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub txtApplicationNumberToAdd_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles txtApplicationNumberToAdd.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                AddAppToList()

                txtApplicationCount.Text = clbTitleVEmailList.Items.Count
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub txtEmailLetter_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles txtEmailLetter.KeyPress
        Try
            
            If e.KeyChar = Microsoft.VisualBasic.ChrW(1) Then
                txtEmailLetter.SelectAll()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         
    End Sub
    Private Sub btnPrintSingleTitleVRenewal_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrintSingleTitleVRenewal.Click
        Try
            
            Dim SQLLine As String = "*"
            Dim temp As String = ""

            If txtTitleVSingleLetter.Text <> "" Then
                SQLLine = txtTitleVSingleLetter.Text
            Else
                SQLLine = "*"
            End If

            If (Me.txtRenewalCount.Text <> "" And txtRenewalCount.Text <> "0") Or txtTitleVSingleLetter.Text <> "" Then
                PrintOut = Nothing
                If PrintOut Is Nothing Then PrintOut = New IAIPPrintOut
                PrintOut.txtPrintType.Text = "TitleVRenewal"
                PrintOut.txtSQLLine.Text = SQLLine
                PrintOut.txtStartDate.Text = "01-Jan-1990"
                PrintOut.txtEndDate.Text = "01-Jan-2099"
                PrintOut.Show()
                PrintOut.Location = New System.Drawing.Point(DefaultX + 25, DefaultY)
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
    Private Sub llbViewEITools_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbViewEITools.LinkClicked
        Try
            If txtAirsNumber.Text <> "" Then
                SQL = "Select strFacilityName " & _
                "from " & DBNameSpace & ".APBFacilityInformation " & _
                "where strAIRSNumber = '0413" & txtAirsNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        txtFacilityNameEITool.Text = ""
                    Else
                        txtFacilityNameEITool.Text = dr.Item("strFacilityName")
                    End If
                End While
                dr.Close()
                If txtFacilityNameEITool.Text <> "" Then
                    loadCboEIYear()
                    loadEIEnrollmentYear()
                Else
                    cboEIYear.Items.Clear()
                    cboEIYear.Text = ""
                    cboEIEnrollmentYear.Items.Clear()
                     cboEIEnrollmentYear.Text = ""
                End If
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub btnGetData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGetData.Click
        Try
            If txtAirsNumber.Text <> "" Then
                SQL = "Select * from " & DBNameSpace & ".eiSI where strStateFacilityIdentifier = '" & txtAirsNumber.Text & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = True Then
                    SQL = "Select " & _
                    "distinct(EIEM.strInventoryYear),  " & _
                    "case  " & _
                    "when COTable.TotalEmissions is Null then  0 " & _
                    "else COTable.TotalEmissions " & _
                    "End CO,  " & _
                    "case  " & _
                    "when LeadTable.TotalEmissions is Null then 0 " & _
                    "else LeadTable. TotalEmissions " & _
                    "END Lead,   " & _
                    "case  " & _
                    "when NH3Table.TotalEmissions is Null then 0 " & _
                    "else NH3Table.TotalEmissions  " & _
                    "END NH3,   " & _
                    "case  " & _
                    "When NOXTable.TotalEmissions is Null then 0 " & _
                    "else NOXTable.TotalEmissions  " & _
                    "END NOX,  " & _
                    "case  " & _
                    "when PMTable.TotalEmissions is null then 0  " & _
                    "else PMTable.TotalEmissions  " & _
                    "end PM,   " & _
                    "case  " & _
                    "when PM10Table.TotalEmissions is NUll then 0  " & _
                    "else PM10Table.TotalEmissions  " & _
                    "end PM10,  " & _
                    "case  " & _
                    "when PM25Table.TotalEmissions is null then 0  " & _
                    "else PM25Table.TotalEmissions  " & _
                    "end PM25,  " & _
                    "case  " & _
                    "when SO2Table.TotalEmissions is NUll then 0  " & _
                    "else SO2Table.TotalEmissions  " & _
                    "End SO2,  " & _
                    "case  " & _
                    "when VOCTable.TotalEmissions is Null then 0  " & _
                    "else VOCTable.TotalEmissions  " & _
                    "end VOC,  " & _
                    "case  " & _
                    "when PMFILTable.TotalEmissions is Null then 0  " & _
                    "else PMFILTable.TotalEmissions  " & _
                    "end PMFIL " & _
                    "from " & DBNameSpace & ".EIEM,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'CO'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) COTable,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = '7439921'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) LeadTable,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'NH3'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) NH3Table,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'NOX'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) NOXTable,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'PM-PRI'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) PMTable,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'PM10-PMI'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) PM10Table,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'PM25-PMI'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) PM25Table,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'SO2'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) SO2Table,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'VOC'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) VOCTable,  " & _
                    "(Select  " & _
                    "" & DBNameSpace & ".EIEM.strPollutantCode as PollutantCode,   " & _
                    "sum(" & DBNameSpace & ".EIEM.dblEmissionNumericValue) as TotalEmissions,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear,  " & _
                    "strStateFacilityIdentifier  " & _
                    "from " & DBNameSpace & ".EIEM   " & _
                    "where " & DBNameSpace & ".EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "'  " & _
                    "and strPollutantCode = 'PM-FIL'  " & _
                    "group by " & DBNameSpace & ".EIEM.strPollutantCode,  " & _
                    "" & DBNameSpace & ".EIEM.strInventoryYear, strStateFacilityIdentifier) PMFILTable " & _
                    "where EIEM.strInventoryYear = COTable.strInventoryYear (+)   " & _
                    "and EIEM.strInventoryYear = LeadTable.strInventoryYear (+)   " & _
                    "and EIEM.strInventoryYear = NH3Table.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = NOXTable.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = PMTable.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = PM10Table.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = PM25Table.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = SO2Table.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = VOCTable.strInventoryYear  (+)  " & _
                    "and EIEM.strInventoryYear = PMFILTable.strInventoryYear  (+) " & _
                    "and EIEM.strStateFacilityIdentifier = '" & txtAirsNumber.Text & "' " & _
                    "order by EIEM.strInventoryYear DESC "

                    ds = New DataSet
                    da = New OracleDataAdapter(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    da.Fill(ds, "EM")
                    dgvEIData.DataSource = ds
                    dgvEIData.DataMember = "EM"
                  

                    dgvEIData.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                    dgvEIData.ReadOnly = True
                    dgvEIData.AllowUserToOrderColumns = True
                    dgvEIData.AllowUserToOrderColumns = True
                    dgvEIData.RowHeadersVisible = False
                    dgvEIData.Columns("strInventoryYear").HeaderText = "Year"
                    dgvEIData.Columns("strInventoryYear").DisplayIndex = 0
                    dgvEIData.Columns("strInventoryYear").Width = 50
                    dgvEIData.Columns("CO").HeaderText = "CO"
                    dgvEIData.Columns("CO").DisplayIndex = 1
                    dgvEIData.Columns("CO").Width = 50
                    dgvEIData.Columns("LEAD").HeaderText = "LEAD"
                    dgvEIData.Columns("LEAD").DisplayIndex = 2
                    dgvEIData.Columns("LEAD").Width = 50
                    dgvEIData.Columns("NH3").HeaderText = "NH3"
                    dgvEIData.Columns("NH3").DisplayIndex = 3
                    dgvEIData.Columns("NH3").Width = 50
                    dgvEIData.Columns("NOX").HeaderText = "NOX"
                    dgvEIData.Columns("NOX").DisplayIndex = 4
                    dgvEIData.Columns("NOX").Width = 50
                    dgvEIData.Columns("PM").HeaderText = "PM"
                    dgvEIData.Columns("PM").DisplayIndex = 5
                    dgvEIData.Columns("PM").Width = 50
                    dgvEIData.Columns("PM10").HeaderText = "PM-10"
                    dgvEIData.Columns("PM10").DisplayIndex = 6
                    dgvEIData.Columns("PM10").Width = 50
                    dgvEIData.Columns("PM25").HeaderText = "PM-2.5"
                    dgvEIData.Columns("PM25").DisplayIndex = 7
                    dgvEIData.Columns("PM25").Width = 50
                    dgvEIData.Columns("SO2").HeaderText = "SO2"
                    dgvEIData.Columns("SO2").DisplayIndex = 8
                    dgvEIData.Columns("SO2").Width = 50
                    dgvEIData.Columns("VOC").HeaderText = "VOC"
                    dgvEIData.Columns("VOC").DisplayIndex = 9
                    dgvEIData.Columns("VOC").Width = 50
                    dgvEIData.Columns("PMFIL").HeaderText = "PM-FIL"
                    dgvEIData.Columns("PMFIL").DisplayIndex = 10
                    dgvEIData.Columns("PMFIL").Width = 50
                Else
                    MsgBox("There is no data available", MsgBoxStyle.OkOnly, "No EI data for this year, choose another year")
                End If

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
         
    End Sub
    Private Sub btnExcel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExcel.Click
        Try
            ExporttoExcel()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
         
    End Sub
    Sub ExporttoExcel()
        Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
        'Dim ExcelDoc As Microsoft.Office.Interop.Excel.Workbook
        'Dim ExcelApp As New Excel.Application
        Dim i As Integer
        Dim j As Integer

        Try

            If ExcelApp.Visible = False Then
                ExcelApp.Visible = True
            End If
            If dgvEIData.RowCount <> 0 Then
                With ExcelApp
                    .SheetsInNewWorkbook = 1
                    .Workbooks.Add()
                    .Worksheets(1).Select()


                    For i = 0 To dgvEIData.ColumnCount - 1
                        .Cells(1, i + 1) = dgvEIData.Columns(i).HeaderText.ToString
                    Next

                    For i = 0 To dgvEIData.ColumnCount - 1
                        For j = 0 To dgvEIData.RowCount - 2
                            .Cells(j + 2, i + 1).numberformat = "@"
                            .Cells(j + 2, i + 1).value = dgvEIData.Item(i, j).Value.ToString
                        Next
                    Next

                End With

                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

        Catch ex As Exception
            If ex.ToString.Contains("RPC_E_CALL_REJECTED") Then
                MsgBox("Error in exporting data." & vbCrLf & "Please run the export again.")
            Else
                ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            End If
        Finally
         
        End Try
         

    End Sub
    Private Sub btnExportEIExport_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExportEIExport.Click
        Try
            If txtAirsNumber.Text <> "" And Me.cboEIYear.Text <> "" Then
                BindDataGridSI()
                BindDataGridEU()
                BindDataGridER()
                BindDataGridEP()
                BindDataGridEM()
                export2Excel()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
#Region " Bind Data Grid View Routines "

    Private Sub BindDataGridSI()

        Try

            Dim SQL As String
            Dim AirsNumber As String = "0413" & txtAirsNumber.Text
            Dim inventoryYear As String = cboEIYear.SelectedItem
            Dim airsYear As String
            Dim dr As OracleDataReader
            ds = New DataSet

            airsYear = AirsNumber & inventoryYear

            SQL = "select strFacilityName, " & _
                            "strLocationAddress, " & _
                            "strCity, " & _
                            "strState, " & _
                            "strZipCode, " & _
                            "strCounty, " & _
                            "dblXCoordinate, " & _
                            "dblYCoordinate, " & _
                            "strHorizontalCollectionCode, " & _
                            "(Select STRHORIZCOLLECTIONMETHODDESC " & _
                               "from " & DBNameSpace & ".EILOOKUPHORIZCOLMETHOD " & _
                               "where " & DBNameSpace & ".EISI.STRHORIZONTALCOLLECTIONCODE = " & _
                               "" & DBNameSpace & ".EILOOKUPHORIZCOLMETHOD.STRHORIZCOLLECTIONMETHODCODE) as HMCdesc, " & _
                            "strHorizontalReferenceCode, " & _
                            "strHorizontalAccuracyMeasure, " & _
                            "(Select STRHORIZONTALREFERENCEDESC " & _
                               "from " & DBNameSpace & ".EILOOKUPHORIZREFDATUM " & _
                               "where " & DBNameSpace & ".EISI.STRHORIZONTALREFERENCECODE = " & _
                               "" & DBNameSpace & ".EILOOKUPHORIZREFDATUM.STRHORIZONTALREFERENCEDATUM) as HDRCdesc, " & _
                            "strContactPrefix, " & _
                            "strContactFirstName, " & _
                            "strContactLastName, " & _
                            "strContactTitle, " & _
                            "strContactEmail, " & _
                            "strContactPhoneNumber1, " & _
                            "strContactPhoneNumber2, " & _
                            "strContactFaxNumber, " & _
                            "strContactCompanyName, " & _
                            "strContactAddress1, " & _
                            "strContactCity, " & _
                            "strContactState, " & _
                            "strContactZipCode, " & _
                            "strSiteDescription, " & _
                            "strSICPrimary, " & _
                            "strNAICSPrimary " & _
                     "from " & DBNameSpace & ".eiSI where strAirsYear = '" & airsYear & "'"

            Dim cmd As New OracleCommand(SQL, conn)
            cmd.CommandType = CommandType.Text

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            dr = cmd.ExecuteReader

            dgvSI.Rows.Clear()
            dgvSI.Columns.Clear()

            dgvSI.Columns.Add("strFacilityName", "Facility")
            dgvSI.Columns.Add("strLocationAddress", "Facility Location")
            dgvSI.Columns.Add("strCity", "City")
            dgvSI.Columns.Add("strState", "State")
            dgvSI.Columns.Add("strZipCode", "Zip Code")
            dgvSI.Columns.Add("strCounty", "County")
            dgvSI.Columns.Add("dblXCoordinate", "Longitude")
            dgvSI.Columns.Add("dblYCoordinate", "Latitude")
            dgvSI.Columns.Add("strHorizontalCollectionCode", "Horizontal Collection Code")
            dgvSI.Columns.Add("HMCdesc", "Horizontal Collection Desc")
            dgvSI.Columns.Add("strHorizontalAccuracyMeasure", "Horizontal Accuracy Measure")
            dgvSI.Columns.Add("strHorizontalReferenceCode", "Horizontal Datum Reference Code")
            dgvSI.Columns.Add("HDRCdesc", "Horizontal Datum Reference Desc")
            dgvSI.Columns.Add("strContactPrefix", "Contact Prefix")
            dgvSI.Columns.Add("strContactFirstName", "Contact First Name")
            dgvSI.Columns.Add("strContactLastName", "Contact Last Name")
            dgvSI.Columns.Add("strContactTitle", "Contact Title")
            dgvSI.Columns.Add("strContactEmail", "Contact Email")
            dgvSI.Columns.Add("strContactPhoneNumber1", "Contact Phone Number")
            dgvSI.Columns.Add("strContactPhoneNumber2", "Contact Phone Other")
            dgvSI.Columns.Add("strContactFaxNumber", "Contact Fax Number")
            dgvSI.Columns.Add("strContactCompanyName", "Contact Company Name")
            dgvSI.Columns.Add("strContactAddress1", "Contact Address")
            dgvSI.Columns.Add("strContactCity", "Contact City")
            dgvSI.Columns.Add("strContactState", "Contact State")
            dgvSI.Columns.Add("strContactZipCode", "Contact Zip Code")
            dgvSI.Columns.Add("strSiteDescription", "Site Description")
            dgvSI.Columns.Add("strSICPrimary", "SIC Primary")
            dgvSI.Columns.Add("strNAICSPrimary", "NAICS Primary")

            dgvSI.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells
            dgvSI.RowHeadersVisible = False

            While dr.Read
                'Get row data as an object array
                'objCells(2) means col[0], col[1], col[2]
                'which returns the first colums in the table
                Dim objCells(29) As Object
                dr.GetValues(objCells)
                dgvSI.Rows.Add(objCells)
            End While

        Catch ex As Exception
            MsgBox(ex.ToString)
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub BindDataGridEU()

        Try

            Dim SQL As String
            Dim AirsNumber As String = "0413" & txtAirsNumber.Text
            Dim inventoryYear As String = cboEIYear.SelectedItem
            Dim airsYear As String
            Dim dr As OracleDataReader
            ds = New DataSet

            airsYear = AirsNumber & inventoryYear

            SQL = "select strEmissionUnitID, " & _
                         "sngDesignCapacity, " & _
                         "strDesignCapUnitNum, " & _
                         "(Select STRUNITDESCRIPTION " & _
                               "from " & DBNameSpace & ".EILOOKUPUNITCODES " & _
                               "where " & DBNameSpace & ".EIEU.strDesignCapUnitNum = " & _
                               "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as numDesc, " & _
                         "strDesignCapUnitDenom, " & _
                         "(Select STRUNITDESCRIPTION " & _
                               "from " & DBNameSpace & ".EILOOKUPUNITCODES " & _
                               "where " & DBNameSpace & ".EIEU.strDesignCapUnitDenom = " & _
                               "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as denomDesc, " & _
                         "sngMaxNameplateCapacity, " & _
                         "strEmissionUnitDesc " & _
                    "from " & DBNameSpace & ".eiEU where strAirsYear = '" & airsYear & "'"

            Dim cmd As New OracleCommand(SQL, conn)
            cmd.CommandType = CommandType.Text

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            dr = cmd.ExecuteReader

            dgvEU.Rows.Clear()
            dgvEU.Columns.Clear()

            dgvEU.Columns.Add("strEmissionUnitID", "Emission Unit ID")
            dgvEU.Columns.Add("sngDesignCapacity", "Design Capacity")
            dgvEU.Columns.Add("strDesignCapUnitNum", "Design Capacity Unit Numerator")
            dgvEU.Columns.Add("numDesc", "Design Capacity Unit Numerator Desc")
            dgvEU.Columns.Add("strDesignCapUnitDenom", "Design Capacity Unit Denominator")
            dgvEU.Columns.Add("denomDesc", "Design Capacity Unit Denominator Desc")
            dgvEU.Columns.Add("sngMaxNameplateCapacity", "Max Name plate Capacity")
            dgvEU.Columns.Add("strEmissionUnitDesc", "Emission Unit Desc")

            dgvEU.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells
            dgvEU.RowHeadersVisible = False

            While dr.Read
                'Get row data as an object array
                'objCells(2) means col[0], col[1], col[2]
                'which returns the first colums in the table
                Dim objCells(8) As Object
                dr.GetValues(objCells)
                dgvEU.Rows.Add(objCells)
            End While

        Catch ex As Exception
            MsgBox(ex.ToString)
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub BindDataGridER()

        Try

            Dim SQL As String
            Dim AirsNumber As String = "0413" & txtAirsNumber.Text
            Dim inventoryYear As String = cboEIYear.SelectedItem
            Dim airsYear As String
            Dim dr As OracleDataReader
            ds = New DataSet

            airsYear = AirsNumber & inventoryYear

            SQL = "select strEmissionReleasePointID, " & _
                            "strEmissionReleaseType, " & _
                            "(Select STREMISSIONTYPEDESC " & _
                               "from " & DBNameSpace & ".EILOOKUPEMISSIONTYPES " & _
                               "where " & DBNameSpace & ".EIER.STREMISSIONRELEASETYPE = " & _
                               "" & DBNameSpace & ".EILOOKUPEMISSIONTYPES.STREMISSIONTYPECODE) as stackType, " & _
                            "sngStackHeight, " & _
                            "sngStackDiameter, " & _
                            "sngExitGasTemperature, " & _
                            "sngExitGasVelocity, " & _
                            "sngExitGasFlowRate, " & _
                            "dblXCoordinate, " & _
                            "dblYCoordinate, " & _
                            "strEmissionReleasePtDesc, " & _
                            "strHorizontalCollectionCode, " & _
                            "(Select STRHORIZCOLLECTIONMETHODDESC " & _
                               "from " & DBNameSpace & ".EILOOKUPHORIZCOLMETHOD " & _
                               "where " & DBNameSpace & ".EIER.STRHORIZONTALCOLLECTIONCODE = " & _
                               "" & DBNameSpace & ".EILOOKUPHORIZCOLMETHOD.STRHORIZCOLLECTIONMETHODCODE) as HMCdesc, " & _
                            "strHorizontalAccuracyMeasure, " & _
                            "strHorizontalReferenceCode, " & _
                            "(Select STRHORIZONTALREFERENCEDESC " & _
                               "from " & DBNameSpace & ".EILOOKUPHORIZREFDATUM " & _
                               "where " & DBNameSpace & ".EIER.STRHORIZONTALREFERENCECODE = " & _
                               "" & DBNameSpace & ".EILOOKUPHORIZREFDATUM.STRHORIZONTALREFERENCEDATUM) as HDRCdesc " & _
                            "from " & DBNameSpace & ".eiER where strAirsYear = '" & airsYear & "'"

            Dim cmd As New OracleCommand(SQL, conn)
            cmd.CommandType = CommandType.Text

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            dr = cmd.ExecuteReader

            dgvER.Rows.Clear()
            dgvER.Columns.Clear()

            dgvER.Columns.Add("strEmissionReleasePointID", "Emission Release Point ID")
            dgvER.Columns.Add("strEmissionReleaseType", "Emission Release Type")
            dgvER.Columns.Add("stackType", "Stack Type")
            dgvER.Columns.Add("sngStackHeight", "Stack Height")
            dgvER.Columns.Add("sngStackDiameter", "Stack Diameter")
            dgvER.Columns.Add("sngExitGasTemperature", "Exit Gas Temperature")
            dgvER.Columns.Add("sngExitGasVelocity", "Exit Gas Velocity")
            dgvER.Columns.Add("sngExitGasFlowRate", "Exit Gas Flow Rate")
            dgvER.Columns.Add("dblXCoordinate", "Longitude")
            dgvER.Columns.Add("dblYCoordinate", "Latitude")
            dgvER.Columns.Add("strEmissionReleasePtDesc", "Emission Release Point Desc")
            dgvER.Columns.Add("strHorizontalCollectionCode", "Horizontal Collection Code")
            dgvER.Columns.Add("HMCdesc", "Horizontal Collection Code Desc")
            dgvER.Columns.Add("strHorizontalAccuracyMeasure", "Horizontal Accuracy Measure")
            dgvER.Columns.Add("strHorizontalReferenceCode", "Horizontal Datum Reference Code")
            dgvER.Columns.Add("HDRCdesc", "Horizontal Datum Reference Code Desc")

            dgvER.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells
            dgvER.RowHeadersVisible = False

            While dr.Read
                'Get row data as an object array
                'objCells(2) means col[0], col[1], col[2]
                'which returns the first colums in the table
                Dim objCells(5) As Object
                dr.GetValues(objCells)
                dgvER.Rows.Add(objCells)
            End While

        Catch ex As Exception
            MsgBox(ex.ToString)
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub BindDataGridEP()

        Try

            Dim SQL As String
            Dim AirsNumber As String = "0413" & txtAirsNumber.Text
            Dim inventoryYear As String = cboEIYear.SelectedItem
            Dim airsYear As String
            Dim dr As OracleDataReader
            ds = New DataSet

            airsYear = AirsNumber & inventoryYear

            SQL = "select strSCC, " & _
                            "strEmissionProcessDescription, " & _
                            "strEmissionUnitID, " & _
                            "strEmissionReleasePointID, " & _
                            "strProcessID, " & _
                            "intWinterThroughputPCT, " & _
                            "intSpringThroughputPCT, " & _
                            "intSummerThroughputPCT, " & _
                            "intFallThroughputPCT, " & _
                            "intAnnualAvgDaysPerWeek, " & _
                            "intAnnualAvgWeeksPerYear, " & _
                            "intAnnualAvgHoursPerDay, " & _
                            "intAnnualAvgHoursPerYear, " & _
                            "sngHeatContent, " & _
                            "sngSulfurContent, " & _
                            "sngAshContent, " & _
                            "sngDailySummerProcessTPut, " & _
                            "strDailySummerProcessTPutNum, " & _
                            "(Select STRUNITDESCRIPTION " & _
                               "from " & DBNameSpace & ".EILOOKUPUNITCODES " & _
                               "where " & DBNameSpace & ".EIEP.strDailySummerProcessTPutNum = " & _
                               "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as DailySummerTputNumDesc, " & _
                            "sngActualThroughput, " & _
                            "strThroughputUnitNumerator, " & _
                            "(Select STRUNITDESCRIPTION " & _
                               "from " & DBNameSpace & ".EILOOKUPUNITCODES " & _
                               "where " & DBNameSpace & ".EIEP.strThroughputUnitNumerator = " & _
                               "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as TputNumDesc, " & _
                            "strStartTime " & _
                       "from " & DBNameSpace & ".eiEP " & _
                      "where strAirsYear = '" & airsYear & "'"

            Dim cmd As New OracleCommand(SQL, conn)
            cmd.CommandType = CommandType.Text

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            dr = cmd.ExecuteReader

            dgvEP.Rows.Clear()
            dgvEP.Columns.Clear()

            dgvEP.Columns.Add("strSCC", "SCC")
            dgvEP.Columns.Add("strEmissionProcessDescription", "Emission Process Description")
            dgvEP.Columns.Add("strEmissionUnitID", "Emission Unit ID")
            dgvEP.Columns.Add("strEmissionReleasePointID", "Emission Release Point ID")
            dgvEP.Columns.Add("strProcessID", "Process ID")
            dgvEP.Columns.Add("intWinterThroughputPCT", "Winter Throughput Percent")
            dgvEP.Columns.Add("intSpringThroughputPCT", "Spring Throughput Percent")
            dgvEP.Columns.Add("intSummerThroughputPCT", "Summer Throughput Percent")
            dgvEP.Columns.Add("intFallThroughputPCT", "Fall Throughput Percent")
            dgvEP.Columns.Add("intAnnualAvgDaysPerWeek", "Annual Average Days Per Week")
            dgvEP.Columns.Add("intAnnualAvgWeeksPerYear", "Annual Average Weeks Per Year")
            dgvEP.Columns.Add("intAnnualAvgHoursPerDay", "Annual Average Hours Per Day")
            dgvEP.Columns.Add("intAnnualAvgHoursPerYear", "Annual Average Hours Per Year")
            dgvEP.Columns.Add("sngHeatContent", "Heat Content")
            dgvEP.Columns.Add("sngSulfurContent", "Sulfur Content")
            dgvEP.Columns.Add("sngAshContent", "Ash Content")
            dgvEP.Columns.Add("sngDailySummerProcessTPut", "Daily Summer Process Throughput")
            dgvEP.Columns.Add("strDailySummerProcessTPutNum", "Daily Summer Process Throughput Numerator")
            dgvEP.Columns.Add("DailySummerTputNumDesc", "Daily Summer Process Throughput Numerator Desc")
            dgvEP.Columns.Add("sngActualThroughput", "Actual Throughput")
            dgvEP.Columns.Add("strThroughputUnitNumerator", "Actual Throughput Unit Numerator")
            dgvEP.Columns.Add("TputNumDesc", "Actual Throughput Unit Numerator Desc")
            dgvEP.Columns.Add("strStartTime", "Start Time")


            dgvEP.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells
            dgvEP.RowHeadersVisible = False

            While dr.Read
                'Get row data as an object array
                'objCells(2) means col[0], col[1], col[2]
                'which returns the first colums in the table
                Dim objCells(5) As Object
                dr.GetValues(objCells)
                dgvEP.Rows.Add(objCells)
            End While

        Catch ex As Exception
            MsgBox(ex.ToString)
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub BindDataGridEM()

        Try

            Dim SQL As String
            Dim AirsNumber As String = "0413" & txtAirsNumber.Text
            Dim inventoryYear As String = cboEIYear.SelectedItem
            Dim airsYear As String
            Dim dr As OracleDataReader
            ds = New DataSet

            airsYear = AirsNumber & inventoryYear

            SQL = "select STREMISSIONUNITID, "
            SQL += "STREMISSIONRELEASEPOINTID, "
            SQL += "STRPROCESSID, "
            SQL += "strPollutantCode, "
            SQL += "(Select STRPOLLUTANTDESC "
            SQL += "from " & DBNameSpace & ".EILOOKUPPOLLUTANTCODES "
            SQL += "where " & DBNameSpace & ".EIEM.STRPOLLUTANTCODE = "
            SQL += "" & DBNameSpace & ".EILOOKUPPOLLUTANTCODES.STRPOLLUTANTCODE) as pollutantDesc, "
            SQL += "DBLEMISSIONNUMERICVALUE, "
            SQL += "STREMISSIONUNITNUMERATOR, "
            SQL += "(Select STRUNITDESCRIPTION "
            SQL += "from " & DBNameSpace & ".EILOOKUPUNITCODES "
            SQL += "where " & DBNameSpace & ".EIEM.STREMISSIONUNITNUMERATOR = "
            SQL += "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as EMISSIONUNITNUMERATORDesc, "
            SQL += "sngFactorNumericValue, "
            SQL += "strFactorUnitNumerator, "
            SQL += "(Select STRUNITDESCRIPTION "
            SQL += "from " & DBNameSpace & ".EILOOKUPUNITCODES "
            SQL += "where " & DBNameSpace & ".EIEM.strFactorUnitNumerator = "
            SQL += "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as FactorUnitNumeratorDesc, "
            SQL += "strFactorUnitDenominator, "
            SQL += "(Select STRUNITDESCRIPTION "
            SQL += "from " & DBNameSpace & ".EILOOKUPUNITCODES "
            SQL += "where " & DBNameSpace & ".EIEM.strFactorUnitDenominator = "
            SQL += "" & DBNameSpace & ".EILOOKUPUNITCODES.STRUNITCODE) as FactorUnitDenominatorDesc, "
            SQL += "strEmissionCalculationMetCode, "
            SQL += "(Select STREMISSIONCALCMETHODDESC "
            SQL += "from " & DBNameSpace & ".EILOOKUPEMISSIONCALCMETHOD "
            SQL += "where " & DBNameSpace & ".EIEM.strEmissionCalculationMetCode = "
            SQL += "" & DBNameSpace & ".EILOOKUPEMISSIONCALCMETHOD.STREMISSIONCALCMETHODCODE) as EMISSIONCALCMETHODDESC, "
            SQL += "strControlStatus, "
            SQL += "strControlSystemDescription, "
            SQL += "strPrimaryDeviceTypeCode, "
            SQL += "(Select STRCONTROLDEVICEDesc "
            SQL += "from " & DBNameSpace & ".EILOOKUPCONTROLDEVICE "
            SQL += "where " & DBNameSpace & ".EIEM.strPrimaryDeviceTypeCode = "
            SQL += "" & DBNameSpace & ".EILOOKUPCONTROLDEVICE.STRCONTROLDEVICECODE) as PrimaryDeviceTypeDesc, "
            SQL += "sngPrimaryPCTControlEffic, "
            SQL += "strSecondaryDeviceTypeCode, "
            SQL += "(Select STRCONTROLDEVICEDesc "
            SQL += "from " & DBNameSpace & ".EILOOKUPCONTROLDEVICE "
            SQL += "where " & DBNameSpace & ".EIEM.strSecondaryDeviceTypeCode = "
            SQL += "" & DBNameSpace & ".EILOOKUPCONTROLDEVICE.STRCONTROLDEVICECODE) as SecondaryDeviceTypeDesc, "
            SQL += "sngPCTCaptureEfficiency, "
            SQL += "sngTotalCaptureControlEffic "
            SQL += "from " & DBNameSpace & ".eiEM "
            SQL += "where strAirsYear = '" & airsYear & "'"

            'SQL = "Select * from " & DBNameSpace & ".eiEM where strAirsYear = '" & airsYear & "'"

            Dim cmd As New OracleCommand(SQL, conn)
            cmd.CommandType = CommandType.Text

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            dr = cmd.ExecuteReader

            dgvEM.Rows.Clear()
            dgvEM.Columns.Clear()

            dgvEM.Columns.Add("STREMISSIONUNITID", "EMISSION UNIT ID")
            dgvEM.Columns.Add("STREMISSIONRELEASEPOINTID", "EMISSION RELEASE POINT ID")
            dgvEM.Columns.Add("STRPROCESSID", "PROCESS ID")
            dgvEM.Columns.Add("strPollutantCode", "Pollutant Code")
            dgvEM.Columns.Add("pollutantDesc", "pollutant Desc")
            dgvEM.Columns.Add("DBLEMISSIONNUMERICVALUE", "EMISSION NUMERIC VALUE")
            dgvEM.Columns.Add("STREMISSIONUNITNUMERATOR", "EMISSION UNIT NUMERATOR")
            dgvEM.Columns.Add("EMISSIONUNITNUMERATORDesc", "EMISSION UNIT NUMERATOR Desc")
            dgvEM.Columns.Add("sngFactorNumericValue", "Factor Numeric Value")
            dgvEM.Columns.Add("strFactorUnitNumerator", "Factor Unit Numerator")
            dgvEM.Columns.Add("FactorUnitNumeratorDesc", "Factor Unit Numerator Desc")
            dgvEM.Columns.Add("strFactorUnitDenominator", "Factor Unit Denominator")
            dgvEM.Columns.Add("FactorUnitDenominatorDesc", "Factor Unit Denominator Desc")
            dgvEM.Columns.Add("strEmissionCalculationMetCode", "Emission Calculation Method Code")
            dgvEM.Columns.Add("EMISSIONCALCMETHODDESC", "Emission Calculation Method Code Desc")
            dgvEM.Columns.Add("strControlStatus", "Control Status")
            dgvEM.Columns.Add("strControlSystemDescription", "Control System Description")
            dgvEM.Columns.Add("strPrimaryDeviceTypeCode", "Primary Device Type Code")
            dgvEM.Columns.Add("PrimaryDeviceTypeDesc", "Primary Device Type Code Desc")
            dgvEM.Columns.Add("sngPrimaryPCTControlEffic", "Primary Percentage Control Efficiency")
            dgvEM.Columns.Add("strSecondaryDeviceTypeCode", "Secondary Device Type Code")
            dgvEM.Columns.Add("SecondaryDeviceTypeDesc", "Secondary Device Type Code Desc")
            dgvEM.Columns.Add("sngPCTCaptureEfficiency", "Percent Capture Efficiency")
            dgvEM.Columns.Add("sngTotalCaptureControlEffic", "Total Capture Control Efficiency")



            dgvEM.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.DisplayedCells
            dgvEM.RowHeadersVisible = False

            While dr.Read
                'Get row data as an object array
                'objCells(2) means col[0], col[1], col[2]
                'which returns the first colums in the table
                Dim objCells(5) As Object
                dr.GetValues(objCells)
                dgvEM.Rows.Add(objCells)
            End While

        Catch ex As Exception
            MsgBox(ex.ToString)
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally


        End Try

    End Sub

#End Region
    Private Sub export2Excel()
        Try
            exportSI()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
    Private Sub exportSI()
        Try
            Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
            'Dim ExcelDoc As Microsoft.Office.Interop.Excel.Workbook
            'Dim ExcelApp As Excel.Application = New Excel.ApplicationClass
            Dim col, row As Integer
            Dim x As String
            Dim y As String
            Dim a As Integer
            Dim b As Integer
            Dim c As Integer
            Dim d As Integer
            Dim startRow As Integer = 1

            

            If ExcelApp.Visible = False Then
                ExcelApp.Visible = True
            End If

            'load SI data into Excel
            If dgvSI.RowCount <> 0 Then

                ExcelApp.SheetsInNewWorkbook = 1
                ExcelApp.Workbooks.Add()


                ExcelApp.Cells(startRow, 1).value = "Facility Information"

                'For displaying the column name in the the excel file.
                '29 columns in SI 
                'cells(x,y) x=row  y=col
                For col = 0 To dgvSI.ColumnCount - 1
                    y = dgvSI.Columns(col).HeaderText.ToString
                    ExcelApp.Cells(startRow + 1, col + 1).value = y
                Next

                For row = 0 To 0
                    For col = 0 To dgvSI.ColumnCount - 1
                        If IsDBNull(dgvSI.Item(col, row).Value.ToString) Then
                            x = ""
                        Else
                            x = dgvSI.Item(col, row).Value.ToString
                        End If
                        'x = dgvSI.Item(col, row).Value.ToString
                        ExcelApp.Cells(startRow + 2, col + 1).value = x
                    Next
                Next
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

            txtRow.Text = startRow + 3

            'load EU data into Excel
            If dgvEU.RowCount <> 0 Then

                startRow = CInt(txtRow.Text) + 2

                ExcelApp.Cells(startRow, 1).value = "Emission Units"

                startRow = startRow + 1

                'For displaying the column name in the the excel file.
                For col = 0 To dgvEU.ColumnCount - 1
                    y = dgvEU.Columns(col).HeaderText.ToString
                    ExcelApp.Cells(startRow, col + 1).value = y
                Next

                a = dgvEU.ColumnCount - 1
                b = dgvEU.RowCount - 1

                'For col = 0 To dgvEU.RowCount - 1
                '    For row = 0 To dgvEU.ColumnCount - 1
                startRow = startRow + 1
                d = dgvEU.RowCount - 2
                For row = 0 To d

                    c = dgvEU.ColumnCount - 1
                    For col = 0 To c
                        If IsDBNull(dgvEU.Item(col, row).Value.ToString) Then
                            x = ""
                        Else
                            x = dgvEU.Item(col, row).Value.ToString
                        End If
                        'x = dgvEU.Item(col, row).Value.ToString
                        ExcelApp.Cells(startRow, col + 1).value = x

                    Next
                    startRow = startRow + 1
                Next
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

            txtRow.Text = startRow + 2

            'load ER data into Excel
            If dgvER.RowCount <> 0 Then

                startRow = CInt(txtRow.Text)

                ExcelApp.Cells(startRow, 1).value = "Stacks"

                startRow = startRow + 1

                'For displaying the column name in the the excel file.
                For col = 0 To dgvER.ColumnCount - 1
                    y = dgvER.Columns(col).HeaderText.ToString
                    ExcelApp.Cells(startRow, col + 1).value = y
                Next

                a = dgvER.ColumnCount - 1
                b = dgvER.RowCount - 1

                startRow = startRow + 1
                d = dgvER.RowCount - 2
                For row = 0 To d

                    c = dgvER.ColumnCount - 1
                    x = ""
                    For col = 0 To c
                        'If IsDBNull(dgvER.Item(col, row).Value.ToString) Then
                        If IsDBNull(dgvER.Item(col, row).Value) Then
                        Else
                            'x = dgvER.Item(col, row).Value.ToString
                            x = dgvER.Item(col, row).Value
                        End If

                        ExcelApp.Cells(startRow, col + 1).value = x

                    Next
                    startRow = startRow + 1
                Next

                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

            txtRow.Text = startRow + 2

            'load EP data into Excel
            If dgvEP.RowCount <> 0 Then

                startRow = CInt(txtRow.Text)

                ExcelApp.Cells(startRow, 1).value = "Processes"

                startRow = startRow + 1

                'For displaying the column name in the the excel file.
                For col = 0 To dgvEP.ColumnCount - 1
                    y = dgvEP.Columns(col).HeaderText.ToString
                    ExcelApp.Cells(startRow, col + 1).value = y
                Next

                a = dgvEP.ColumnCount - 1
                b = dgvEP.RowCount - 1

                startRow = startRow + 1
                d = dgvEP.RowCount - 2
                For row = 0 To d

                    c = dgvEP.ColumnCount - 1
                    x = ""
                    For col = 0 To c
                        'If IsDBNull(dgvEP.Item(col, row).Value.ToString) Then
                        If IsDBNull(dgvEP.Item(col, row).Value) Then
                        Else
                            'x = dgvEP.Item(col, row).Value.ToString
                            x = dgvEP.Item(col, row).Value
                        End If

                        ExcelApp.Cells(startRow, col + 1).value = x

                    Next
                    startRow = startRow + 1
                Next
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

            txtRow.Text = startRow + 2

            'load EM data into Excel
            If dgvEM.RowCount <> 0 Then

                startRow = CInt(txtRow.Text)

                ExcelApp.Cells(startRow, 1).value = "Pollutants and Control Equipment"

                startRow = startRow + 1

                'For displaying the column name in the the excel file.
                For col = 0 To dgvEM.ColumnCount - 1
                    y = dgvEM.Columns(col).HeaderText.ToString
                    ExcelApp.Cells(startRow, col + 1).value = y
                Next

                a = dgvEM.ColumnCount - 1
                b = dgvEM.RowCount - 1

                startRow = startRow + 1
                d = dgvEM.RowCount - 2
                For row = 0 To d

                    c = dgvEM.ColumnCount - 1
                    x = ""
                    For col = 0 To c
                        'If IsDBNull(dgvEM.Item(col, row).Value.ToString) Then
                        If IsDBNull(dgvEM.Item(col, row).Value) Then
                        Else
                            'x = dgvEM.Item(col, row).Value.ToString
                            x = dgvEM.Item(col, row).Value
                        End If

                        ExcelApp.Cells(startRow, col + 1).value = x

                    Next
                    startRow = startRow + 1
                Next

                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

        Catch ex As Exception
            If ex.ToString.Contains("RPC_E_CALL_REJECTED") Then
                MsgBox("Error in exporting data." & vbCrLf & "Please run the export again.")
            Else
                MsgBox(ex.ToString)
                ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            End If
        Finally
             
        End Try

    End Sub
    Sub loadCboEIYear()
        Try
            cboEIYear.Items.Clear()

            SQL = "select distinct(strInventoryYear)  as EIYear " & _
            "from " & DBNameSpace & ".EISI " & _
            "where strStateFacilityIdentifier = '" & txtAirsNumber.Text & "' " & _
            "order by EIYear desc "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                cboEIYear.Items.Add(dr.Item("EIYear"))
            End While
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
         

    End Sub
    Private Sub mtbCDSZipCode_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles mtbCDSZipCode.TextChanged
        Try

            mtbMailingZipCode.Text = mtbCDSZipCode.Text

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
    End Sub
    Private Sub btnDeleteAIRSNumber_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDeleteAIRSNumber.Click
        Try

            If Me.txtDeleteAIRSNumber.Text <> "" And txtDeleteAIRSNumber.Text.Length = 8 Then
                SQL = "delete " & DBNameSpace & ".afsairpollutantdata where strAIRSNumber = '0413" & txtDeleteAIRSNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                "values " & _
                "(" & _
                "(select " & _
                "case when max(numCounter) is null then 1 " & _
                "else max(numCounter) + 1 " & _
                "end numCounter " & _
                "from " & DBNameSpace & ".AFSDeletions), " & _
                "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                "'" & OracleDate & "', '', " & _
                "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".afsfacilitydata where strAirsnumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".apbairprogrampollutants where strAIRSNumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".hb_apbairprogrampollutants where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".apbcontactinformation where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".apbheaderdata where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".HB_APBHeaderData where strAIRSNumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".HB_APBFacilityInformation where strAIRSNumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".APBFacilityInformation where strAIRSNumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".apbsupplamentaldata where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                'SQL = "Delete " & DBNameSpace & ".SSCPFacilityAssignment where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "' "
                SQL = "Delete " & DBNameSpace & ".SSCPInspectionsRequired where strAIRsnumber = '0413" & txtDeleteAIRSNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "Delete " & DBNameSpace & ".SSCPDistrictResponsible where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL = "delete " & DBNameSpace & ".apbmasterairs where strairsnumber = '0413" & txtDeleteAIRSNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                SQL2 = "Insert into " & DBNameSpace & ".AFSDeletions " & _
                         "values " & _
                         "(" & _
                         "(select " & _
                         "case when max(numCounter) is null then 1 " & _
                         "else max(numCounter) + 1 " & _
                         "end numCounter " & _
                         "from " & DBNameSpace & ".AFSDeletions), " & _
                         "'0413" & txtDeleteAIRSNumber.Text & "', " & _
                         "'" & Replace(SQL, "'", "''") & "', 'True', " & _
                         "'" & OracleDate & "', '', " & _
                         "'') "

                cmd = New OracleCommand(SQL2, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
    End Sub
#Region "ES Tool"

    Private Sub btnView_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnView.Click
        Try
            runcount()
            lblYear.Text = cboYear.SelectedItem
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
         
    End Sub
    Private Sub runcount()
        Dim Nonresponsecount As Integer
        Dim ESMailoutCount As Integer
        Dim MailOutOptInCount As Integer
        Dim mailoutOptOutCount As Integer
        Dim ResponseCount As Integer
        Dim TotaloptinCount As Integer
        Dim TotaloptoutCount As Integer
        Dim TotalinincomplianceCount As Integer
        Dim TotaloutofcomplianceCount As Integer
        Dim extracount As Integer
        '  Dim extracount2 As Integer
        Dim extraOptincount As Integer
        Dim extraOptOutCount As Integer
        Dim TotalResponsecount As Integer
        Dim year As Integer = CInt(cboYear.SelectedItem)
        txtESYear.Text = cboYear.SelectedItem
        Dim ESYear As String = txtESYear.Text

        Dim removedFacilitiescount As Integer
        Dim mailoutNonresponderscount As Integer
        Dim extraNonresponderscount As Integer


        Dim intESyear As Integer = CInt(ESYear)
        Dim deadline As String = "15-Jun-" & year + 1

        Try
            Try
                SQL = "select count(*) as ESMailoutCount " & _
                "from " & DBNameSpace & ".esmailout, " & DBNameSpace & ".ESSCHEMA " & _
                "where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
                "and " & DBNameSpace & ".esmailout.STRESYEAR = '" & ESYear & "'"

                cmd = New OracleCommand(SQL, conn)
                           If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtESMailOutCount.Text = dr.Item(ESMailoutCount)
                End While
                dr.Close()

                SQL = "select count(*) as ResponseCount " & _
                "from " & DBNameSpace & ".esmailout, " & DBNameSpace & ".ESSCHEMA " & _
                "where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
                "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT is not NULL " & _
                "and " & DBNameSpace & ".esmailout.STRESYEAR = '" & ESYear & "'"

                cmd = New OracleCommand(SQL, conn)
                           If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtResponseCount.Text = dr.Item(ResponseCount)
                End While
                dr.Close()

                SQL = "select count(*) as TotaloptinCount " & _
                "from " & DBNameSpace & ".ESSchema " & _
                "where " & DBNameSpace & ".ESSchema.intESYEAR = '" & intESyear & "'" & _
                " and " & DBNameSpace & ".ESSchema.strOptOut = 'NO'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                While dr.Read()
                    txtTotalOptInCount.Text = dr.Item(TotaloptinCount)
                End While
                dr.Close()

                SQL = "select count(*) as TotaloptOutCount " & _
                "from " & DBNameSpace & ".ESSchema " & _
                "where " & DBNameSpace & ".ESSchema.intESYEAR = '" & intESyear & "' " & _
                "and " & DBNameSpace & ".ESSchema.strOptOut = 'YES'"

                cmd = New OracleCommand(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If

                dr = cmd.ExecuteReader
                While dr.Read()
                    txtTotalOptOutCount.Text = dr.Item(TotaloptoutCount)
                End While
                dr.Close()

                SQL = "select count(*) as TotalinincomplianceCount " & _
                "from " & DBNameSpace & ".ESSchema " & _
                "where " & DBNameSpace & ".ESSchema.intESYEAR = '" & intESyear & "'" & _
                " and to_date(" & DBNameSpace & ".ESSchema.STRDATEFIRSTCONFIRM) < = '" & deadline & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtTotalincompliance.Text = dr.Item(TotalinincomplianceCount)
                End While
                dr.Close()

                SQL = "select count(*) as TotaloutofcomplianceCount " & _
                "from " & DBNameSpace & ".ESSchema " & _
                "where " & DBNameSpace & ".ESSchema.intESYEAR = '" & intESyear & "'" & _
                " and to_date(" & DBNameSpace & ".ESSchema.STRDATEFIRSTCONFIRM) > '" & deadline & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtTotaloutofcompliance.Text = dr.Item(TotaloutofcomplianceCount)
                End While
                dr.Close()

                SQL = "select count(*) as MailOutOptInCount " & _
                "from " & DBNameSpace & ".ESSchema, " & DBNameSpace & ".ESMailout " & _
                "where " & DBNameSpace & ".ESMAILOUT.strESYEAR = '" & ESYear & "' " & _
                " and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
                " and " & DBNameSpace & ".ESSchema.strOptOut = 'NO'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtMailoutOptin.Text = dr.Item(MailOutOptInCount)
                End While
                dr.Close()

                SQL = "select count(*) as MailOutOptOutCount " & _
                "from " & DBNameSpace & ".ESSchema, " & DBNameSpace & ".ESMailout " & _
                "where " & DBNameSpace & ".ESMAILOUT.strESYEAR = '" & ESYear & "'" & _
                " and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
                " and " & DBNameSpace & ".ESSchema.strOptOut = 'YES'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtMailOutOptOut.Text = dr.Item(mailoutOptOutCount)
                End While
                dr.Close()

            Catch ex As Exception
                MsgBox("That Prefix is not in the db" + vbCrLf + ex.ToString())
            End Try


            SQL = "select count(*) as Nonresponsecount " & _
             "from " & DBNameSpace & ".ESSCHEMA " & _
             "where " & DBNameSpace & ".ESSCHEMA.intESYEAR = '" & ESYear & "'" & _
             " and " & DBNameSpace & ".ESSchema.strOptOut is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read()
                txtNonResponseCount.Text = dr.Item(Nonresponsecount)
            End While
            dr.Close()

            SQL = "select count(*) as removedFacilitiescount " & _
          "from " & DBNameSpace & ".ESSchema , " & DBNameSpace & ".esmailout " & _
          "where " & DBNameSpace & ".esMailOut.STRESYEAR = '" & ESYear & "'" & _
            "and " & DBNameSpace & ".esmailout.STRAIRSYEAR = " & DBNameSpace & ".ESSchema.STRAIRSYEAR(+) " & _
          " and " & DBNameSpace & ".ESSchema.STRAIRSYEAR is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read()
                txtESremovedFacilities.Text = dr.Item(removedFacilitiescount)
            End While
            dr.Close()

            SQL = "select count(*) as extraNonresponderscount " & _
           "from " & DBNameSpace & ".ESSchema " & _
           " where  not exists (select * from " & DBNameSpace & ".ESMAILOUT " & _
                " where " & DBNameSpace & ".ESSchema.STRAIRSNUMBER = " & DBNameSpace & ".ESMAILOUT.STRAIRSNUMBER" & _
                " and ESSchema.INTESYEAR = ESMAILOUT.strESYEAR) " & _
                " and " & DBNameSpace & ".ESSchema.INTESYEAR = '" & ESYear & "' " & _
                " and " & DBNameSpace & ".ESSchema.STROPTOUT is null"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read()
                txtESextranonresponder.Text = dr.Item(extraNonresponderscount)
            End While
            dr.Close()

            SQL = "select count(*) as mailoutNonresponderscount " & _
          "from  " & DBNameSpace & ".esmailout, " & DBNameSpace & ".ESSchema " & _
            "where " & DBNameSpace & ".esmailout.strESYEAR = '" & ESYear & "' " & _
            "and " & DBNameSpace & ".esmailout.STRAIRSYEAR = " & DBNameSpace & ".ESSchema.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".ESSchema.strOptOut is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read()
                txtESmailoutNonResponder.Text = dr.Item(mailoutNonresponderscount)
            End While
            dr.Close()

            SQL = "select count(*) as ExtraCount " & _
            "from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA" & _
            " Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".esschema.INTESYEAR= '" & intESyear & "' " & _
            "AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read()
                txtESextraResponders.Text = dr.Item(extracount)
                txtextraResponse.Text = dr.Item(extracount)
            End While
            dr.Close()

            '   SQL = "select count(*) as ExtraCount2 " & _
            '"from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR AS SchemaAIRS, " & _
            '"" & DBNameSpace & ".ESMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            '"From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA" & _
            '" Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            '"AND " & DBNameSpace & ".esschema.INTESYEAR= '" & intESyear & "' " & _
            '"AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            '"dt_NotInMailout, " & _
            '"" & DBNameSpace & ".ESSCHEMA " & _
            '"Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            '"AND MailoutAIRS is NULL"

            '   cmd = New OracleCommand(SQL, conn)
            '   If conn.State = ConnectionState.Closed Then
            '       conn.Open()
            '   End If
            '   dr = cmd.ExecuteReader

            '   While dr.Read()
            '       txtESextraResponders.Text = dr.Item(extracount2)
            '   End While
            '   dr.Close()

            SQL = "select count(*) as ExtraOptinCount " & _
            "from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".esschema.INTESYEAR= '" & intESyear & "' " & _
            "AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT='NO'"

            cmd = New OracleCommand(SQL, conn)

            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read()
                txtExtraOptin.Text = dr.Item(extraOptincount)
            End While
            dr.Close()

            SQL = "select count(*) as ExtraOptOUTCount " & _
            "from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".esschema.INTESYEAR= '" & intESyear & "' " & _
            "AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT='YES'"

            cmd = New OracleCommand(SQL, conn)

            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read()
                txtExtraOptout.Text = dr.Item(extraOptOutCount)
            End While
            dr.Close()

            SQL = "select count(*) as TotalResponsecount " & _
            "from " & DBNameSpace & ".ESSchema " & _
            "where " & DBNameSpace & ".ESSchema.intESYEAR = '" & intESyear & "'" & _
            " and " & DBNameSpace & ".ESSchema.strOptOut is not NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read()
                txtTotalResponse.Text = dr.Item(TotalResponsecount)
            End While
            dr.Close()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
             
        End Try

    End Sub
    Private Sub findESMailOut()
        Dim AirsNo As String = txtESAIRSNo2.Text
        Dim ESyear As String = txtESYear.Text

        Try
            SQL = "SELECT * " & _
                  "from " & DBNameSpace & ".esMailOut " & _
                  "where STRAIRSNUMBER = '" & AirsNo & "' " & _
                  "and STRESYEAR = '" & ESyear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr("STRFACILITYNAME")) Then
                    txtESFacilityName.Text = ""
                Else
                    txtESFacilityName.Text = dr("STRFACILITYNAME")
                End If
                If IsDBNull(dr("STRCONTACTPREFIX")) Then
                    txtESprefix.Text = ""
                Else
                    txtESprefix.Text = dr("STRCONTACTPREFIX")
                End If
                If IsDBNull(dr("STRCONTACTFIRSTNAME")) Then
                    txtESFirstName.Text = ""
                Else
                    txtESFirstName.Text = dr("STRCONTACTFIRSTNAME")
                End If
                If IsDBNull(dr("STRCONTACTLASTNAME")) Then
                    txtESLastName.Text = ""
                Else
                    txtESLastName.Text = dr("STRCONTACTLASTNAME")
                End If
                If IsDBNull(dr("STRCONTACTCOMPANYNAME")) Then
                    txtEScompanyName.Text = ""
                Else
                    txtEScompanyName.Text = dr("STRCONTACTCOMPANYNAME")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS1")) Then
                    txtcontactAddress1.Text = ""
                Else
                    txtcontactAddress1.Text = dr("STRCONTACTADDRESS1")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS2")) Then
                    txtcontactAddress2.Text = ""
                Else
                    txtcontactAddress2.Text = dr("STRCONTACTADDRESS2")
                End If
                If IsDBNull(dr("STRCONTACTCITY")) Then
                    txtcontactCity.Text = ""
                Else
                    txtcontactCity.Text = dr("STRCONTACTCITY")
                End If
                If IsDBNull(dr("STRCONTACTSTATE")) Then
                    txtcontactState.Text = ""
                Else
                    txtcontactState.Text = dr("STRCONTACTSTATE")
                End If
                If IsDBNull(dr("STRCONTACTZIPCODE")) Then
                    txtcontactZipCode.Text = ""
                Else
                    txtcontactZipCode.Text = dr("STRCONTACTZIPCODE")
                End If
                If IsDBNull(dr("STRCONTACTEMAIL")) Then
                    txtcontactEmail.Text = ""
                Else
                    txtcontactEmail.Text = dr("STRCONTACTEMAIL")
                End If
            End While

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
             
        End Try

    End Sub
    Private Sub findESData()
        Dim AirsNo As String = txtESAirsNo.Text
        Dim ESyear As String = cboYear.SelectedItem
        Dim intESyear As Integer = CInt(ESyear)
        Try

            SQL = "SELECT * " & _
            "from " & DBNameSpace & ".esschema " & _
            "where STRAIRSNUMBER = '" & AirsNo & "' " & _
            "and INTESYEAR = '" & intESyear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr("STRAIRSNUMBER")) Then
                    txtESAirsNo.Text = ""
                Else
                    txtESAirsNo.Text = dr("STRAIRSNUMBER")
                End If
                If IsDBNull(dr("STRFACILITYNAME")) Then
                    txtFACILITYNAME.Text = ""
                Else
                    txtFACILITYNAME.Text = dr("STRFACILITYNAME")
                End If
                If IsDBNull(dr("STRFACILITYADDRESS")) Then
                    txtFACILITYADDRESS.Text = ""
                Else
                    txtFACILITYADDRESS.Text = dr("STRFACILITYADDRESS")
                End If
                If IsDBNull(dr("STRFACILITYCITY")) Then
                    txtFACILITYCITY.Text = ""
                Else
                    txtFACILITYCITY.Text = dr("STRFACILITYCITY")
                End If
                If IsDBNull(dr("STRFACILITYSTATE")) Then
                    txtFACILITYSTATE.Text = ""
                Else
                    txtFACILITYSTATE.Text = dr("STRFACILITYSTATE")
                End If
                If IsDBNull(dr("STRFACILITYZIP")) Then
                    txtFACILITYZIP.Text = ""
                Else
                    txtFACILITYZIP.Text = dr("STRFACILITYZIP")
                End If
                If IsDBNull(dr("STRCOUNTY")) Then
                    txtCOUNTY.Text = ""
                Else
                    txtCOUNTY.Text = dr("STRCOUNTY")
                End If
                If IsDBNull(dr("DBLXCOORDINATE")) Then
                    txtXCOORDINATE.Text = ""
                Else
                    txtXCOORDINATE.Text = dr("DBLXCOORDINATE")
                End If
                If IsDBNull(dr("DBLYCOORDINATE")) Then
                    txtYCOORDINATE.Text = ""
                Else
                    txtYCOORDINATE.Text = dr("DBLYCOORDINATE")
                End If
                If IsDBNull(dr("STRHORIZONTALCOLLECTIONCODE")) Then
                    txtHORIZONTALCOLLECTIONCODE.Text = ""
                Else
                    txtHORIZONTALCOLLECTIONCODE.Text = dr("STRHORIZONTALCOLLECTIONCODE")
                End If
                If IsDBNull(dr("STRHORIZONTALACCURACYMEASURE")) Then
                    txtHORIZONTALACCURACYMEASURE.Text = ""
                Else
                    txtHORIZONTALACCURACYMEASURE.Text = dr("STRHORIZONTALACCURACYMEASURE")
                End If
                If IsDBNull(dr("STRHORIZONTALREFERENCECODE")) Then
                    txtHORIZONTALREFERENCECODE.Text = ""
                Else
                    txtHORIZONTALREFERENCECODE.Text = dr("STRHORIZONTALREFERENCECODE")
                End If
                If IsDBNull(dr("STRCONTACTCOMPANY")) Then
                    txtCompany.Text = ""
                Else
                    txtCompany.Text = dr("STRCONTACTCOMPANY")
                End If
                If IsDBNull(dr("STRCONTACTTITLE")) Then
                    txtTitle.Text = ""
                Else
                    txtTitle.Text = dr("STRCONTACTTITLE")
                End If
                If IsDBNull(dr("STRCONTACTPHONENUMBER")) Then
                    txtPhone.Text = ""
                Else
                    txtPhone.Text = dr("STRCONTACTPHONENUMBER")
                End If
                If IsDBNull(dr("STRCONTACTFAXNUMBER")) Then
                    txtFax.Text = ""
                Else
                    txtFax.Text = dr("STRCONTACTFAXNUMBER")
                End If
                If IsDBNull(dr("STRCONTACTFIRSTNAME")) Then
                    txtESContactFirstName.Text = ""
                Else
                    txtESContactFirstName.Text = dr("STRCONTACTFIRSTNAME")
                End If
                If IsDBNull(dr("STRCONTACTLASTNAME")) Then
                    txtESContactLastName.Text = ""
                Else
                    txtESContactLastName.Text = dr("STRCONTACTLASTNAME")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS1")) Then
                    txtAddress1.Text = ""
                Else
                    txtAddress1.Text = dr("STRCONTACTADDRESS1")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS2")) Then
                    txtAddress2.Text = ""
                Else
                    txtAddress2.Text = dr("STRCONTACTADDRESS2")
                End If
                If IsDBNull(dr("STRCONTACTCITY")) Then
                    txtCity.Text = ""
                Else
                    txtCity.Text = dr("STRCONTACTCITY")
                End If
                If IsDBNull(dr("STRCONTACTSTATE")) Then
                    txtState.Text = ""
                Else
                    txtState.Text = dr("STRCONTACTSTATE")
                End If
                If IsDBNull(dr("STRCONTACTZIP")) Then
                    txtZip.Text = ""
                Else
                    txtZip.Text = dr("STRCONTACTZIP")
                End If
                If IsDBNull(dr("STRCONTACTEMAIL")) Then
                    txtESEmail.Text = ""
                Else
                    txtESEmail.Text = dr("STRCONTACTEMAIL")
                End If
                If IsDBNull(dr("DBLVOCEMISSION")) Then
                    txtVOCEmission.Text = ""
                Else
                    txtVOCEmission.Text = dr("DBLVOCEMISSION")
                    If txtVOCEmission.Text = "-1" Then
                        txtVOCEmission.Text = "No Value"
                    End If
                End If
                If IsDBNull(dr("DBLNOXEMISSION")) Then
                    txtNOXEmission.Text = ""
                Else
                    txtNOXEmission.Text = dr("DBLNOXEMISSION")
                    If txtNOXEmission.Text = "-1" Then
                        txtNOXEmission.Text = "No Value"
                    End If
                End If
                If IsDBNull(dr("STRCONFIRMATIONNBR")) Then
                    txtConfirmationNbr.Text = ""
                    txtConfirmationNumber.Text = ""
                Else
                    txtConfirmationNbr.Text = dr("STRCONFIRMATIONNBR")
                    txtConfirmationNumber.Text = dr("STRCONFIRMATIONNBR")
                End If
                If IsDBNull(dr("STRDATEFIRSTCONFIRM")) Then
                    txtFirstConfirmedDate.Text = ""
                Else
                    txtFirstConfirmedDate.Text = dr("STRDATEFIRSTCONFIRM")
                End If
            End While

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
             
        End Try

    End Sub
    Sub ExportEStoExcel()
        Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
        'Dim ExcelDoc As Microsoft.Office.Interop.Excel.Workbook
        'Dim ExcelApp As New Excel.Application
        Dim i As Integer
        Dim j As Integer

        Try
            If dgvESDataCount.RowCount <> 0 Then
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
                With ExcelApp
                    .SheetsInNewWorkbook = 1
                    .Workbooks.Add()
                    .Worksheets(1).Select()

                    For i = 0 To dgvESDataCount.ColumnCount - 1
                        .Cells(1, i + 1) = dgvESDataCount.Columns(i).HeaderText.ToString
                    Next

                    For i = 0 To dgvESDataCount.ColumnCount - 1
                        'For j = 0 To dgvESDataCount.RowCount - 2
                        For j = 0 To dgvESDataCount.RowCount - 1
                            .Cells(j + 2, i + 1).numberformat = "@"
                            .Cells(j + 2, i + 1).value = dgvESDataCount.Item(i, j).Value.ToString
                        Next
                    Next

                End With
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

        Catch ex As Exception
            If ex.ToString.Contains("RPC_E_CALL_REJECTED") Then
                MsgBox("Error in exporting data." & vbCrLf & "Please run the export again.")
            Else
                ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            End If
        Finally
          
             
        End Try

    End Sub
    Private Sub dgvESDataCount_MouseUp1(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles dgvESDataCount.MouseUp
        Dim hti As DataGridView.HitTestInfo = dgvESDataCount.HitTest(e.X, e.Y)

        Try
            'If dgvESDataCount.Columns(1).HeaderText <> "Facility Name" Then
            If dgvESDataCount.ColumnCount > 2 Then
                If dgvESDataCount.RowCount > 0 And hti.RowIndex <> -1 Then
                    If dgvESDataCount.Columns(0).HeaderText = "Airs No." Then
                        If IsDBNull(dgvESDataCount(0, hti.RowIndex).Value) Then

                        Else
                            ClearMailOut()
                            txtESAIRSNo2.Text = dgvESDataCount(0, hti.RowIndex).Value
                            txtESFacilityName.Text = dgvESDataCount(1, hti.RowIndex).Value
                            findESMailOut()
                        End If
                    Else
                        If dgvESDataCount.Columns(0).HeaderText = "Airs No." Then
                            If IsDBNull(dgvESDataCount(0, hti.RowIndex).Value) Then
                                txtESAIRSNo2.Text = dgvESDataCount(0, hti.RowIndex).Value
                                txtESFacilityName.Text = dgvESDataCount(1, hti.RowIndex).Value
                            Else
                                ClearMailOut()
                                findESMailOut()
                                txtESAIRSNo2.Text = dgvESDataCount(0, hti.RowIndex).Value
                            End If
                        End If
                    End If
                    If dgvESDataCount.Columns(3).HeaderText = "Confirmation Number" Then
                        If IsDBNull(dgvESDataCount(3, hti.RowIndex).Value) Then
                            txtESAirsNo.Text = dgvESDataCount(0, hti.RowIndex).Value
                            txtFACILITYNAME.Text = dgvESDataCount(1, hti.RowIndex).Value
                        Else
                            ClearMailOut()
                            txtESAirsNo.Text = dgvESDataCount(0, hti.RowIndex).Value
                            txtFACILITYNAME.Text = dgvESDataCount(1, hti.RowIndex).Value
                            txtConfirmationNumber.Text = dgvESDataCount(3, hti.RowIndex).Value
                            findESData()
                        End If
                    Else
                        If dgvESDataCount.Columns(3).HeaderText = "Confirmation Number" Then
                            If IsDBNull(dgvESDataCount(3, hti.RowIndex).Value) Then
                                txtESAirsNo.Text = dgvESDataCount(0, hti.RowIndex).Value
                                txtFACILITYNAME.Text = dgvESDataCount(1, hti.RowIndex).Value
                            Else
                                ClearMailOut()
                                txtESAirsNo.Text = dgvESDataCount(0, hti.RowIndex).Value
                                txtFACILITYNAME.Text = dgvESDataCount(1, hti.RowIndex).Value
                                findESData()
                                txtConfirmationNumber.Text = dgvESDataCount(3, hti.RowIndex).Value
                            End If
                        End If
                    End If
                End If
            Else
                ClearMailOut()
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally


        End Try

    End Sub
    Private Sub lblViewMailOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewMailOut.LinkClicked
        txtESYear.Text = cboYear.SelectedItem

        Try
            
            Dim year As String = txtESYear.Text

            SQL = "SELECT STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYname, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".esMailOut " & _
            "where STRESYEAR = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvESDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvESDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
             
        End Try

    End Sub
    Private Sub lblViewOptin_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewTotalOptin.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.DBLVOCEMISSION, " & _
           "" & DBNameSpace & ".esSchema.DBLNOXEMISSION, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from " & DBNameSpace & ".esSchema, " & DBNameSpace & ".esmailout " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STROPTOUT = 'NO'" & _
            "and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
          
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("DBLVOCEMISSION").HeaderText = "VOC Emmissions"
            dgvESDataCount.Columns("DBLVOCEMISSION").DisplayIndex = 3
            dgvESDataCount.Columns("DBLNOXEMISSION").HeaderText = "NOX Emmissions"
            dgvESDataCount.Columns("DBLNOXEMISSION").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 5

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try


    End Sub
    Private Sub lblViewOptOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewTotalOptOut.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from " & DBNameSpace & ".esSchema, " & DBNameSpace & ".esmailout  " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "and " & DBNameSpace & ".esSchema.STROPTOUT = 'YES'" & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewOutofcompliance_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewOutofcompliance.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)
            Dim deadline As String = "15-Jun-2007"
            deadline = "15-Jun-" & txtESYear.Text + 1

            SQL = "SELECT airbranch.esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STROPTOUT, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTCOMPANY, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTADDRESS1, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTCITY, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTSTATE, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTZIP, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTPHONENUMBER " & _
            "from " & DBNameSpace & ".esSchema " & _
            "where intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM is not NULL " & _
            "and to_date(" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM) > '" & deadline & "' " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
          
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STROPTOUT").HeaderText = "OptOut Status"
            dgvESDataCount.Columns("STROPTOUT").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTCOMPANY").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANY").DisplayIndex = 6
            dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Street Address"
            dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 7
            dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 8
            dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 9
            dgvESDataCount.Columns("STRCONTACTZIP").HeaderText = "Zip"
            dgvESDataCount.Columns("STRCONTACTZIP").DisplayIndex = 10
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 11
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").HeaderText = "Phone No."
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").DisplayIndex = 12

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewINCompliance_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewINCompliance.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)
            Dim deadline As String = "15-Jun-" & intYear + 1

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from " & DBNameSpace & ".esSchema " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
             "and " & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM is not NULL " & _
            "and to_date(" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM) <= '" & deadline & "' " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "Date First Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewESMailOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewESMailOut.LinkClicked
        Try
            
            Dim year As String = txtESYear.Text
            txtESYear.Text = cboYear.SelectedItem


            SQL = "SELECT esMailOut.STRAIRSNUMBER, " & _
            "esMailOut.STRFACILITYNAME, " & _
            "esMailOut.STRCONTACTFIRSTNAME, " & _
            "esMailOut.STRCONTACTLASTNAME, " & _
            "esMailOut.STRCONTACTCOMPANYname, " & _
            "esMailOut.STRCONTACTADDRESS1, " & _
            "esMailOut.STRCONTACTCITY, " & _
            "esMailOut.STRCONTACTSTATE, " & _
            "esMailOut.STRCONTACTZIPCODE, " & _
            "esMailOut.STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".esMailOut " & _
            "where STRESYEAR = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
          
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvESDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvESDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub lblViewESData_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewESData.LinkClicked
        Dim year As Integer = CInt(cboYear.SelectedItem)
        Try

            dsES = New DataSet

            SQL = "SELECT esSchema.STRAIRSNUMBER, " & _
            "esSchema.STRFACILITYNAME, " & _
            "case " & _
            "when DBLVOCEMISSION= '-1' then 'No Value' " & _
            "else to_char(DBLVOCEMISSION) " & _
            "end DBLVOCEMISSION, " & _
            "esSchema.STRCONFIRMATIONNBR, " & _
            "case " & _
            "when DBLNOXEMISSION = '-1' then 'No Value' " & _
            "else to_char(DBLNOXEMISSION) " & _
            "end DBLNOXEMISSION, " & _
            "esSchema.STRDATEFIRSTCONFIRM " & _
            "from " & DBNameSpace & ".esSchema " & _
            "where esSchema.intESyear = '" & year & "' " & _
            "order by esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
          
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("DBLVOCEMISSION").HeaderText = "VOC Emissions"
            dgvESDataCount.Columns("DBLVOCEMISSION").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3
            dgvESDataCount.Columns("DBLNOXEMISSION").HeaderText = "NOX Emissions"
            dgvESDataCount.Columns("DBLNOXEMISSION").DisplayIndex = 4
             dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 5

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
    Private Sub lblViewNonResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewNonResponse.LinkClicked
        Try
            
            Dim year As String = txtESYear.Text

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME " & _
            "from " & DBNameSpace & ".esMailOut, " & DBNameSpace & ".ESSCHEMA " & _
            "where " & DBNameSpace & ".esSchema.INTESYEAR = '" & year & "'" & _
            "and " & DBNameSpace & ".esSchema.strOPTOUT is NULL " & _
            "and " & DBNameSpace & ".esmailout.STRAIRSYEAR = " & DBNameSpace & ".ESSchema.STRAIRSYEAR(+) " & _
            "order by " & DBNameSpace & ".esMailOut.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
            
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

            ' clearESData()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblextraResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblextraResponse.LinkClicked
        Try
            
            Dim year As String = txtESYear.Text
            Dim intyear As Integer = Int(year)

            SQL = "SELECT dt_NotInMailout.SchemaAIRS, " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTCOMPANY, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTPHONENUMBER " & _
            "from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER AS SchemaAIRS, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRAIRSNUMBER AS MailoutAIRS" & _
            " From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA" & _
            " Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "AND INTESYEAR=  '" & intyear & "' " & _
            "AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
            
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANY").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANY").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").HeaderText = "Phone No."
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").DisplayIndex = 6

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString
         
            'clearESData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub lblViewOptIn_LinkClicked_1(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewOptIn.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from " & DBNameSpace & ".esSchema, " & DBNameSpace & ".esmailout " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STROPTOUT = 'NO'" & _
            "and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM is not NULL " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewOptOut_LinkClicked_1(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewOptOut.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from " & DBNameSpace & ".esSchema, " & DBNameSpace & ".esmailout " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STROPTOUT = 'YES'" & _
            " and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM is not NULL " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewExtraOptOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewExtraOptOut.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from (select " & DBNameSpace & ".esSchema.strairsyear as SchemaAIRS, " & _
            "" & DBNameSpace & ".esmailout.strairsyear as MailoutAIRS " & _
            "From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "and " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            "and MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT='YES'"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
          
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 1
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 0
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewExtraOptIn_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewExtraOptIn.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRDATEFIRSTCONFIRM, " & _
            "" & DBNameSpace & ".esSchema.STRCONFIRMATIONNBR " & _
            "from (select " & DBNameSpace & ".esSchema.strairsyear as SchemaAIRS, " & _
            "" & DBNameSpace & ".esmailout.strairsyear as MailoutAIRS " & _
            "From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "and " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR = SchemaAIRS " & _
            "and MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".ESSCHEMA.STROPTOUT='NO'"


            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").HeaderText = "First Date Confirmed"
            dgvESDataCount.Columns("STRDATEFIRSTCONFIRM").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").HeaderText = "Confirmation Number"
            dgvESDataCount.Columns("STRCONFIRMATIONNBR").DisplayIndex = 3

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
    Private Sub lblViewTotalResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewTotalResponse.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try
            
            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTCOMPANY, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTPHONENUMBER " & _
            "from " & DBNameSpace & ".esSchema " & _
            "where " & DBNameSpace & ".esSchema.intESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STROPTOUT is not NULL " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"
           
            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANY").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANY").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").HeaderText = "Phone Number"
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").DisplayIndex = 6

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

            clearESData()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try

    End Sub
    Private Sub AddESMailOut()
        Dim AirsNo As String = txtESAIRSNo2.Text
        Dim ESYear As String = txtESYear.Text
        Dim airsYear As String = AirsNo & ESYear
        Dim dr As OracleDataReader
        Dim ESFacilityName As String = txtESFacilityName.Text
        Dim ESPrefix As String = txtESprefix.Text
        Dim ESFirstName As String = txtESFirstName.Text
        Dim ESLastName As String = txtESLastName.Text
        Dim ESCompanyName As String = txtEScompanyName.Text
        Dim ESContactAddress1 As String = txtcontactAddress1.Text
        Dim ESContactAddress2 As String = txtcontactAddress2.Text
        Dim ESContactCity As String = txtcontactCity.Text
        Dim EScontactState As String = txtcontactState.Text
        Dim ESContactZip As String = txtcontactZipCode.Text
        Dim ESContactEmail As String = txtcontactEmail.Text

        Try
            SQL = "Insert into " & DBNameSpace & ".ESMailOut(STRAIRSYEAR, " & _
            "STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STRCONTACTPREFIX, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYNAME, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTADDRESS2, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRESYEAR, " & _
            "STRCONTACTEMAIL) " & _
            "values (" & _
            "'" & Replace(airsYear, "'", "''") & "', " & _
            "'" & Replace(AirsNo, "'", "''") & "', " & _
            "'" & Replace(ESFacilityName, "'", "''") & "', " & _
            "'" & Replace(ESPrefix, "'", "''") & "', " & _
            "'" & Replace(ESFirstName, "'", "''") & "', " & _
            "'" & Replace(ESLastName, "'", "''") & "', " & _
            "'" & Replace(ESCompanyName, "'", "''") & "', " & _
            "'" & Replace(ESContactAddress1, "'", "''") & "', " & _
            "'" & Replace(ESContactAddress2, "'", "''") & "', " & _
            "'" & Replace(ESContactCity, "'", "''") & "', " & _
            "'" & Replace(EScontactState, "'", "''") & "', " & _
            "'" & Replace(ESContactZip, "'", "''") & "', " & _
            "'" & Replace(ESYear, "'", "''") & "', " & _
            "'" & Replace(ESContactEmail, "'", "''") & "' " & _
            " )"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub SaveESMailOut()
        Dim AirsNo As String = txtESAIRSNo2.Text
        Dim ESFacilityName As String = txtESFacilityName.Text
        Dim ESPrefix As String = txtESprefix.Text
        Dim ESFirstName As String = txtESFirstName.Text
        Dim ESLastName As String = txtESLastName.Text
        Dim ESCompanyName As String = txtEScompanyName.Text
        Dim ESContactAddress1 As String = txtcontactAddress1.Text
        Dim ESContactAddress2 As String = txtcontactAddress2.Text
        Dim ESYear As String = txtESYear.Text
        Dim ESContactCity As String = txtcontactCity.Text
        Dim EScontactState As String = txtcontactState.Text
        Dim ESContactZip As String = txtcontactZipCode.Text
        Dim ESContactEmail As String = txtcontactEmail.Text
        Dim airsYear As String = AirsNo & ESYear

        Try
            SQL = "Select strAIRSYear " & _
            "from " & DBNameSpace & ".EsMailOut " & _
            "where STRAIRSYEAR = '" & airsYear & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = True Then
                SQL = "update " & DBNameSpace & ".ESMailOut set " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTPREFIX = '" & ESPrefix & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTFIRSTNAME = '" & ESFirstName & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTLASTNAME = '" & ESLastName & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTCOMPANYNAME = '" & ESCompanyName & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTADDRESS1 = '" & ESContactAddress1 & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTADDRESS2 = '" & ESContactAddress2 & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTCITY = '" & ESContactCity & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTSTATE = '" & EScontactState & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTZIPCODE = '" & ESContactZip & "', " & _
                "" & DBNameSpace & ".ESMailOut.STRCONTACTEMAIL = '" & ESContactEmail & "'" & _
                "where ESMailOut.STRAIRSNUMBER = '" & AirsNo & "' "

                MsgBox("your info is updated!")

            Else
                SQL = "Insert into " & DBNameSpace & ".ESMailOut " & _
                "(STRAIRSYEAR, " & _
                "STRAIRSNUMBER, " & _
                "STRFACILITYNAME, " & _
                "STRCONTACTPREFIX, " & _
                "STRCONTACTFIRSTNAME, " & _
                "STRCONTACTLASTNAME, " & _
                "STRCONTACTCOMPANYNAME, " & _
                "STRCONTACTADDRESS1, " & _
                "STRCONTACTADDRESS2, " & _
                "STRCONTACTCITY, " & _
                "STRCONTACTSTATE, " & _
                "STRCONTACTZIPCODE, " & _
                "STRESYEAR, " & _
                "STRCONTACTEMAIL) " & _
                "values (" & _
                "'" & Replace(airsYear, "'", "''") & "', " & _
                "'" & Replace(AirsNo, "'", "''") & "', " & _
                "'" & Replace(ESFacilityName, "'", "''") & "', " & _
                "'" & Replace(ESPrefix, "'", "''") & "', " & _
                "'" & Replace(ESFirstName, "'", "''") & "', " & _
                "'" & Replace(ESLastName, "'", "''") & "', " & _
                "'" & Replace(ESCompanyName, "'", "''") & "', " & _
                "'" & Replace(ESContactAddress1, "'", "''") & "', " & _
                "'" & Replace(ESContactAddress2, "'", "''") & "', " & _
                "'" & Replace(ESContactCity, "'", "''") & "', " & _
                "'" & Replace(EScontactState, "'", "''") & "', " & _
                "'" & Replace(ESContactZip, "'", "''") & "', " & _
                "'" & Replace(ESYear, "'", "''") & "', " & _
                "'" & Replace(ESContactEmail, "'", "''") & "' " & _
                " )"

                MsgBox("your info is added!")

            End If

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub DeleteESMailOut()
        Dim AirsNo As String = txtESAIRSNo2.Text
        Dim ESyear As String = txtESYear.Text

        Try
            SQL = "delete from " & DBNameSpace & ".ESMailOut " & _
            "where " & DBNameSpace & ".ESMailOut.STRAIRSNUMBER = '" & AirsNo & "' " & _
            "and " & DBNameSpace & ".ESMailOut.STRESYEAR = '" & ESyear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub ClearMailOut()
        Try
            txtESAIRSNo2.Text = ""
            txtESFacilityName.Text = ""
            txtESprefix.Text = ""
            txtESFirstName.Text = ""
            txtESLastName.Text = ""
            txtEScompanyName.Text = ""
            txtcontactAddress1.Text = ""
            txtcontactAddress2.Text = ""
            txtcontactCity.Text = ""
            txtcontactState.Text = ""
            txtcontactZipCode.Text = ""
            txtcontactEmail.Text = ""
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
    End Sub
    Private Sub clearESData()
        Try
            txtESAirsNo.Text = ""
            txtFACILITYNAME.Text = ""
            txtFACILITYADDRESS.Text = ""
            txtFACILITYCITY.Text = ""
            txtFACILITYSTATE.Text = ""
            txtFACILITYZIP.Text = ""
            txtCOUNTY.Text = ""
            txtXCOORDINATE.Text = ""
            txtYCOORDINATE.Text = ""
            txtHORIZONTALCOLLECTIONCODE.Text = ""
            txtHORIZONTALACCURACYMEASURE.Text = ""
            txtHORIZONTALREFERENCECODE.Text = ""
            txtCompany.Text = ""
            txtTitle.Text = ""
            txtPhone.Text = ""
            txtFax.Text = ""
            txtContactFirstName.Text = ""
            txtContactLastName.Text = ""
            txtAddress1.Text = ""
            txtAddress2.Text = ""
            txtCity.Text = ""
            txtState.Text = ""
            txtZip.Text = ""
            txtEmail.Text = ""
            txtVOCEmission.Text = ""
            txtNOXEmission.Text = ""
            txtConfirmationNbr.Text = ""
            txtFirstConfirmedDate.Text = ""
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub UpdateESData()
        Dim ConfirmationNumber As String = txtConfirmationNumber.Text
        Dim ConfirmationNbr As String = txtConfirmationNbr.Text
        Dim dr As OracleDataReader
        Dim ESFacilityName As String = txtESFacilityName.Text
        Dim ESFacilityAddress As String = txtFACILITYADDRESS.Text
        Dim ESFacilityCity As String = txtFACILITYCITY.Text
        Dim ESFacilityState As String = txtFACILITYSTATE.Text
        Dim ESFacilityZip As String = txtFACILITYZIP.Text
        Dim ESFacilityCounty As String = txtCOUNTY.Text
        Dim XCOORDINATE As String = txtXCOORDINATE.Text
        Dim YCOORDINATE As String = txtYCOORDINATE.Text
        Dim HORIZONTALCOLLECTIONCODE As String = txtHORIZONTALCOLLECTIONCODE.Text
        Dim HORIZONTALACCURACYMEASURE As String = txtHORIZONTALACCURACYMEASURE.Text
        Dim HORIZONTALREFERENCECODE As String = txtHORIZONTALREFERENCECODE.Text
        Dim ESPrefix As String = txtESprefix.Text
        Dim ESContactPhoneNo As String = txtPhone.Text
        Dim ESContactFaxNo As String = txtFax.Text
        Dim ESFirstName As String = txtContactFirstName.Text
        Dim ESLastName As String = txtContactLastName.Text
        Dim ESCompanyName As String = txtCompany.Text
        Dim ESContactAddress1 As String = txtAddress1.Text
        Dim ESContactAddress2 As String = txtAddress2.Text
        Dim ESContactCity As String = txtCity.Text
        Dim EScontactState As String = txtState.Text
        Dim ESContactZip As String = txtZip.Text
        Dim ESContactEmail As String = txtEmail.Text
        Dim VOCEmission As String = txtVOCEmission.Text
        Dim NOXEmission As String = txtNOXEmission.Text
        Dim FirstDateConfimed As String = txtFirstConfirmedDate.Text

        Try
            SQL = "update " & DBNameSpace & ".esSchema " & _
            "set STRFACILITYADDRESS = '" & ESFacilityAddress & "', " & _
            "STRFACILITYCITY = '" & ESFacilityCity & "', " & _
            "STRFACILITYSTATE = '" & ESFacilityState & "', " & _
            "STRFACILITYZIP = '" & ESFacilityZip & "', " & _
            "STRCOUNTY = '" & ESFacilityCounty & "', " & _
            "DBLXCOORDINATE = '" & XCOORDINATE & "', " & _
            "DBLYCOORDINATE = '" & YCOORDINATE & "', " & _
            "STRHORIZONTALCOLLECTIONCODE = '" & HORIZONTALCOLLECTIONCODE & "', " & _
            "STRHORIZONTALACCURACYMEASURE = '" & HORIZONTALACCURACYMEASURE & "', " & _
            "STRHORIZONTALREFERENCECODE = '" & HORIZONTALREFERENCECODE & "', " & _
            "STRCONTACTFIRSTNAME = '" & ESFirstName & "', " & _
            "STRCONTACTLASTNAME = '" & ESLastName & "', " & _
            "STRCONTACTPREFIX = '" & ESPrefix & "', " & _
            "STRCONTACTCOMPANY = '" & ESCompanyName & "', " & _
            "STRCONTACTADDRESS1 = '" & ESContactAddress1 & "', " & _
            "STRCONTACTADDRESS2 = '" & ESContactAddress2 & "', " & _
            "STRCONTACTCITY = '" & ESContactCity & "', " & _
            "STRCONTACTSTATE = '" & EScontactState & "', " & _
            "STRCONTACTZIP = '" & ESContactZip & "', " & _
            "STRCONTACTPHONENUMBER = '" & ESContactPhoneNo & "', " & _
            "STRCONTACTFAXNUMBER = '" & ESContactFaxNo & "', " & _
            "STRCONTACTEMAIL = '" & ESContactEmail & "', " & _
            "DBLVOCEMISSION = '" & VOCEmission & "', " & _
            "DBLNOXEMISSION = '" & NOXEmission & "', " & _
            "STRCONFIRMATIONNBR = '" & ESContactZip & "', " & _
            "sTRDATEFIRSTCONFIRM = '" & FirstDateConfimed & "'" & _
            "where strConfirmationNbr = '" & ConfirmationNbr & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub btnSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSave.Click
        Try
            SaveESMailOut()
            MsgBox("The info has been saved!")
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
              
        End Try
    End Sub
    Private Sub btnoutofcomplianceExport_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnoutofcomplianceExport.Click
        Try
            ExportEStoExcel()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub btnExporttoExcel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExporttoExcel.Click
        Try
            ExportEStoExcel()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub btnESUpdate_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnESUpdate.Click
        Try
            UpdateESData()
            MsgBox("The info has been updated!")
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub btnESDelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnESDelete.Click
        Try
            DeleteESMailOut()
            ClearMailOut()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
        MsgBox("The info has been deleted!")
    End Sub
    Private Sub btnPrint_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPrint.Click
        Try
            If txtFACILITYNAME.Text = "" Then
                MsgBox("You must select a Facility from the data grid view")
            Else
                PrintOut = Nothing
                If PrintOut Is Nothing Then PrintOut = New IAIPPrintOut
                PrintOut.txtPrintType.Text = "ES Print Out"
                PrintOut.txtSQLLine.Text = Me.txtConfirmationNumber.Text
                PrintOut.Show()
                PrintOut.Location = New System.Drawing.Point(DefaultX + 25, DefaultY)
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub GenerateESMailOut()
        Dim airsNumber As String
        Dim airsYear As String
        Dim FACILITYNAME As String = " "
        Dim CONTACTCOMPANYNAME As String = " "
        Dim CONTACTADDRESS1 As String = " "
        Dim CONTACTADDRESS2 As String = " "
        Dim CONTACTCITY As String = " "
        Dim CONTACTSTATE As String = " "
        Dim CONTACTZIPCODE As String = " "
        Dim CONTACTFIRSTNAME As String = " "
        Dim CONTACTLASTNAME As String = " "
        Dim CONTACTEMAIL As String = " "
        Dim ESYear As String = cboMailoutYear.SelectedItem
        Dim OperationalStatus As String = " "
        Dim FacilityClass As String = " "

        Try



            SQL = "Select strAirsNumber " & _
            "FROM " & DBNameSpace & ".ESmailOut " & _
            "where strESyear = '" & ESYear & "'"


            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If

            cmd = New OracleCommand(SQL, conn)
            dr = cmd.ExecuteReader

            recExist = dr.Read

            dr.Close()

            If recExist = True Then
                MsgBox("That year is already being used." & vbCrLf & "If you want to use that year," & vbCrLf & "you must first delete that year from the database.")
            Else
                If cboMailoutYear.Text <> "" Then
                    If cboMailoutYear.Text.Length = 4 Then
                        SQL = "Select dt_EScontact.STRairsnumber, " & DBNameSpace & ".APBFacilityinformation.STRFACILITYNAME, " & _
                        "" & DBNameSpace & ".APBHEADERDATA.stroperationalstatus, " & DBNameSpace & ".APBHEADERDATA.STRCLASS, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRContactLastName " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRContactLastName " & _
                        "Else 'N/A' " & _
                        "END) STRContactLastName, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRContactfirstName " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRContactfirstName " & _
                        "Else 'N/A' " & _
                        "END) STRContactfirstName, " & _
                        "(Case " & _
                        "When dt_esContact.STRKEY='42' THEN dt_esContact.STRContactCompanyName " & _
                        "When dt_esContact.STRKEY Is Null THEN dt_PermitContact.STRContactCompanyName " & _
                        "END) STRContactCompanyName, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRContactEmail " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRContactEmail " & _
                        "END) STRContactEmail, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRCONTACTPREFIX " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTPREFIX " & _
                        "END) strCONTACTPREFIX, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRCONTACTADDRESS1 " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTADDRESS1 " & _
                        "END) STRCONTACTADDRESS1, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRCONTACTCITY " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTCITY " & _
                        "END) STRCONTACTCITY, " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRCONTACTSTATE " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTSTATE " & _
                        "END) STRCONTACTSTATE,  " & _
                        "(Case " & _
                        "When dt_ESContact.STRKEY='42' THEN dt_ESContact.STRCONTACTZIPCODE " & _
                        "When dt_ESContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTZIPCODE " & _
                        "END) STRCONTACTZIPCODE " & _
                        "From " & _
                        "(Select DISTINCT dt_eslist.STRAIRSNUMBER, dt_contact.STRKEY,  " & _
                        "dt_Contact.STRCONTACTLASTNAME, dt_Contact.STRCONTACTFIRSTNAME, " & _
                        "dt_Contact.STRContactCompanyName, dt_Contact.STRContactEmail,  " & _
                        "dt_Contact.STRCONTACTPREFIX, dt_Contact.STRCONTACTADDRESS1, dt_Contact.STRCONTACTCITY,  " & _
                        "dt_Contact.STRCONTACTSTATE, dt_Contact.STRCONTACTZIPCODE " & _
                        "FROM " & _
                        "(Select * FROM " & DBNameSpace & ".APBHEADERDATA " & _
                        "where (stroperationalstatus = 'O' OR stroperationalstatus = 'P' oR stroperationalstatus = 'C') AND  " & _
                        "(STRCLASS = 'A')   " & _
                        "AND (" & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER Like '____121%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____013%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____015%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____045%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____057%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____063%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____067%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____077%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____089%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____097%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____113%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____117%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____135%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____139%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____151%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____217%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____223%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____247%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____255%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____297%') " & _
                        " ) dt_ESList,      " & _
                        "(Select * From " & DBNameSpace & ".APBCONTACTINFORMATION where STRKEY=42) dt_Contact " & _
                        "Where dt_ESList.STRAIRSNUMBEr = dt_Contact.STRAIRSNUMBER (+)) dt_ESContact, " & _
                        "(Select DISTINCT dt_eslist.STRAIRSNUMBER, dt_contact.STRKEY,  " & _
                        "dt_Contact.STRCONTACTLASTNAME, dt_Contact.STRCONTACTFIRSTNAME, " & _
                        "dt_Contact.STRContactCompanyName, dt_Contact.STRContactEmail, dt_Contact.STRCONTACTPREFIX,  " & _
                        "dt_Contact.STRCONTACTADDRESS1, dt_Contact.strcontactcity, dt_Contact.STRCONTACTSTATE, dt_Contact.STRCONTACTZIPCODE " & _
                        "FROM " & _
                        "(Select * FROM " & DBNameSpace & ".APBHEADERDATA " & _
                        "where (stroperationalstatus = 'O' OR stroperationalstatus = 'P' oR stroperationalstatus = 'C') AND  " & _
                        "(STRCLASS = 'A')   " & _
                        "AND (" & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER Like '____121%'    " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____013%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____015%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____045%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____057%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____063%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____067%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____077%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____089%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____097%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____113%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____117%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____135%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____139%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____151%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____217%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____223%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____247%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____255%' " & _
                        "or " & DBNameSpace & ".apbheaderdata.STRAIRSNUMBER like '____297%') " & _
                        ")dt_ESList,  " & _
                        "(Select * From " & DBNameSpace & ".APBCONTACTINFORMATION where STRKEY=30) dt_Contact " & _
                        "Where dt_ESList.STRAIRSNUMBEr = dt_Contact.STRAIRSNUMBER (+)) dt_PermitContact, " & _
                        "" & DBNameSpace & ".APBFACILITYINFORMATION, " & _
                        "" & DBNameSpace & ".APBHEADERDATA " & _
                        "Where " & DBNameSpace & ".APBFACILITYINFORMATION.STRAIRSNUMBER= dt_ESContact.STRAIRSNumber and  " & _
                        "" & DBNameSpace & ".APBHEADERDATA.STRAIRSNUMBER= dt_ESContact.STRAIRSNumber and  " & _
                        "dt_ESContact.STRAIRSNumber  = dt_PermitContact.STRAIRSNUMBER (+) "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader

                        dr.Read()
                        Do
                            airsNumber = dr("strAirsNumber")
                            airsYear = airsNumber & ESYear
                            ESYear = cboMailoutYear.SelectedItem
                            If IsDBNull(dr("STRFACILITYNAME")) Then
                                FACILITYNAME = " "
                            Else
                                FACILITYNAME = dr("STRFACILITYNAME")
                            End If
                            If IsDBNull(dr("STROPERATIONALSTATUS")) Then
                                OperationalStatus = " "
                            Else
                                OperationalStatus = dr("STROPERATIONALSTATUS")
                            End If
                            If IsDBNull(dr("STRCLASS")) Then
                                FacilityClass = " "
                            Else
                                FacilityClass = dr("STRCLASS")
                            End If
                            If IsDBNull(dr("STRCONTACTCOMPANYNAME")) Then
                                CONTACTCOMPANYNAME = " "
                            Else
                                CONTACTCOMPANYNAME = dr("STRCONTACTCOMPANYNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTADDRESS1")) Then
                                CONTACTADDRESS1 = " "
                            Else
                                CONTACTADDRESS1 = dr("STRCONTACTADDRESS1")
                            End If
                            If IsDBNull(dr("STRCONTACTCITY")) Then
                                CONTACTCITY = " "
                            Else
                                CONTACTCITY = dr("STRCONTACTCITY")
                            End If
                            If IsDBNull(dr("STRCONTACTSTATE")) Then
                                CONTACTSTATE = " "
                            Else
                                CONTACTSTATE = dr("STRCONTACTSTATE")
                            End If
                            If IsDBNull(dr("STRCONTACTZIPCODE")) Then
                                CONTACTZIPCODE = " "
                            Else
                                CONTACTZIPCODE = dr("STRCONTACTZIPCODE")
                            End If
                            If IsDBNull(dr("STRCONTACTFIRSTNAME")) Then
                                CONTACTFIRSTNAME = " "
                            Else
                                CONTACTFIRSTNAME = dr("STRCONTACTFIRSTNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTLASTNAME")) Then
                                CONTACTLASTNAME = " "
                            Else
                                CONTACTLASTNAME = dr("STRCONTACTLASTNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTEMAIL")) Then
                                CONTACTEMAIL = " "
                            Else
                                CONTACTEMAIL = dr("STRCONTACTEMAIL")
                            End If

                            SQL2 = "insert into " & DBNameSpace & ".ESmailOut " & _
                            "(strAirsYear, " & _
                            "strAirsNumber, " & _
                            "STRFACILITYNAME, " & _
                            "STROPERATIONALSTATUS, " & _
                            "STRCLASS, " & _
                            "STRCONTACTCOMPANYNAME, " & _
                            "STRCONTACTADDRESS1, " & _
                            "STRCONTACTCITY, " & _
                            "STRCONTACTSTATE, " & _
                            "STRCONTACTZIPCODE, " & _
                            "STRCONTACTFIRSTNAME, " & _
                            "STRCONTACTLASTNAME, " & _
                            "STRCONTACTEMAIL, " & _
                            "strESYear) " & _
                            "values " & _
                            "('" & airsYear & "', " & _
                            "'" & airsNumber & "', " & _
                            "'" & Replace(FACILITYNAME, "'", "''") & "', " & _
                            "'" & Replace(OperationalStatus, "'", "''") & "', " & _
                            "'" & Replace(FacilityClass, "'", "''") & "', " & _
                             "'" & Replace(Replace(CONTACTCOMPANYNAME, "'", "''"), "N/A", " ") & "', " & _
                            "'" & Replace(Replace(CONTACTADDRESS1, "'", "''"), "N/A", " ") & "', " & _
                            "'" & Replace(Replace(CONTACTCITY, "'", "''"), "N/A", " ") & "', " & _
                            "'" & CONTACTSTATE & "', " & _
                            "'" & Replace(CONTACTZIPCODE, "N/A", " ") & "', " & _
                            "'" & Replace(Replace(CONTACTFIRSTNAME, "'", "''"), "N/A", " ") & "', " & _
                            "'" & Replace(Replace(CONTACTLASTNAME, "'", "''"), "N/A", " ") & "', " & _
                            "'" & Replace(Replace(CONTACTEMAIL, "'", "''"), "N/A", " ") & "', " & _
                            "'" & ESYear & "')"

                            Dim cmd2 As New OracleCommand(SQL2, conn)
                            'If conn.State = ConnectionState.Closed Then
                            '    conn.Open()
                            'End If
                            cmd2.CommandType = CommandType.Text

                            dr2 = cmd2.ExecuteReader
                            'dr2.Close()
                        Loop While dr.Read


                    End If


                    Dim year As String = cboMailoutYear.SelectedItem

                    SQL = "SELECT STRAIRSNUMBER, " & _
                    "STRFACILITYNAME, " & _
                    "STROPERATIONALSTATUS, " & _
                    "STRCLASS, " & _
                    "STRCONTACTFIRSTNAME, " & _
                    "STRCONTACTLASTNAME, " & _
                    "STRCONTACTCOMPANYname, " & _
                    "STRCONTACTADDRESS1, " & _
                    "STRCONTACTCITY, " & _
                    "STRCONTACTSTATE, " & _
                    "STRCONTACTZIPCODE, " & _
                    "STRCONTACTEMAIL " & _
                    "from " & DBNameSpace & ".esMailOut " & _
                    "where STRESYEAR = '" & year & "' " & _
                    "order by STRFACILITYNAME"

                    dsViewCount = New DataSet
                    daViewCount = New OracleDataAdapter(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    daViewCount.Fill(dsViewCount, "ViewCount")
                    dgvESDataCount.DataSource = dsViewCount
                    dgvESDataCount.DataMember = "ViewCount"

                    dgvESDataCount.RowHeadersVisible = False
                    dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                    dgvESDataCount.AllowUserToResizeColumns = True
                    dgvESDataCount.AllowUserToAddRows = False
                    dgvESDataCount.AllowUserToDeleteRows = False
                    dgvESDataCount.AllowUserToOrderColumns = True
                    dgvESDataCount.AllowUserToResizeRows = True

                    dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
                    dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
                    dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
                    dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
                    dgvESDataCount.Columns("STROPERATIONALSTATUS").HeaderText = "Operational Status"
                    dgvESDataCount.Columns("STROPERATIONALSTATUS").DisplayIndex = 2
                    dgvESDataCount.Columns("STRCLASS").HeaderText = "Facility Class"
                    dgvESDataCount.Columns("STRCLASS").DisplayIndex = 3
                    dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
                    dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 4
                    dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
                    dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 5
                    dgvESDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
                    dgvESDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 6
                    dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
                    dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 7
                    dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
                    dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 8
                    dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
                    dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 9
                    dgvESDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
                    dgvESDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 10
                    dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
                    dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 11

                    txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

                End If
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub deleteESmailOutbyYear()
        Dim ESyear As String = cboMailoutYear.SelectedItem

        Try


            If ESyear = "Select a Mailout Year & Click Below" Then
                MsgBox("You must select a Mailout Year")
            Else
                SQL = "delete from " & DBNameSpace & ".ESmailout " & _
                "where strESyear = '" & ESyear & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
                MsgBox("ES mail out is deleted!")

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub btnGenMailOut_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGenMailOut.Click
        Try
            GenerateESMailOut()
            cboMailoutYear.Items.Clear()
            loadMailOutYear()
            cboMailoutYear.Text = ""
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnDelMailOut_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDelMailOut.Click
        Try
            deleteESmailOutbyYear()
            cboMailoutYear.Items.Clear()
            loadMailOutYear()
            cboMailoutYear.Text = ""
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewselectedyearMailoutList_LinkClicked_1(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewselectedyearMailoutList.LinkClicked

        Try
            Dim year As String = cboMailoutYear.SelectedItem

            SQL = "SELECT STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STROPERATIONALSTATUS, " & _
            "STRCLASS, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYNAME, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".esMailOut " & _
            "where STRESYEAR = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"

            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STROPERATIONALSTATUS").HeaderText = "Operational Status"
            dgvESDataCount.Columns("STROPERATIONALSTATUS").DisplayIndex = 2
            dgvESDataCount.Columns("STRCLASS").HeaderText = "Facility Class"
            dgvESDataCount.Columns("STRCLASS").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 6
            dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 7
            dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 8
            dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 9
            dgvESDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvESDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 10
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 11

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
#End Region
#Region "EI Tool"
    Private Sub loadEIYear()

        Dim SQL As String
        Dim year As String
        Try
            SQL = "Select distinct STRINVENTORYYEAR " & _
            "from " & DBNameSpace & ".EISI " & _
            "order by STRINVENTORYYEAR desc "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                year = dr("STRINVENTORYYEAR")
                cboEIYear2.Items.Add(year)
            End While

            cboEIYear2.SelectedIndex = 0

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
         
        End Try
    End Sub
    Private Sub loadEIType()

        Dim SQL As String
        Dim EItype As String
        Try
            SQL = "Select distinct EITHRESHOLDS.STRTYPE " & _
            "from " & DBNameSpace & ".EITHRESHOLDS " & _
            "order by STRTYPE desc "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                EItype = dr("STRTYPE")
                cboEItype.Items.Add(EItype)
                cboEIType2.Items.Add(EItype)
            End While

            cboEItype.SelectedIndex = 0
            cboEIType2.SelectedIndex = 0

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnEIView_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEIView.Click
        Try
            runEIcount()
            lblEIYear.Text = cboEIYear2.SelectedItem
            lblMailoutyear.Text = cboEIYear2.SelectedItem

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
    End Sub
    Private Sub runEIcount()
        Dim Nonresponsecount As Integer
        Dim MailoutCount As Integer
        Dim MailOutOptInCount As Integer
        Dim mailoutOptOutCount As Integer
        Dim ResponseCount As Integer
        Dim finalizedcount As Integer
        Dim inprocesscount As Integer
        Dim TotaloptinCount As Integer
        Dim TotaloptoutCount As Integer
        Dim extracount As Integer
        Dim extraOptincount As Integer
        Dim extraOptOutCount As Integer
        Dim TotalResponsecount As Integer
        Dim removedFacilitiescount As Integer
        Dim mailoutNonresponderscount As Integer
        Dim extraNonresponderscount As Integer

        Dim year As Integer = CInt(cboEIYear2.SelectedItem)
        txtEIYear.Text = cboEIYear2.SelectedItem
        Dim EIYear As String = txtEIYear.Text
        Dim deadline As String = "30-Sep-2007"
        Try
            Try

                SQL = "select count(*) as MailoutCount " & _
                "from " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
                "where " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
                "and " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtEIMailOutCount.Text = dr.Item(MailoutCount)
                End While
                dr.Close()

                SQL = "select count(*) as ResponseCount " & _
                "from " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
                "where " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
                "and " & DBNameSpace & ".EISI.STROPTOUT is not NULL " & _
                "and " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "'"

                cmd = New OracleCommand(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtEIResponseCount.Text = dr.Item(ResponseCount)
                End While
                dr.Close()

                SQL = "select count(*) as removedFacilitiescount " & _
            "from  " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "' " & _
            "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".EISI.STRAIRSYEAR is NULL"

                cmd = New OracleCommand(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtRemovedFacilities.Text = dr.Item(removedFacilitiescount)
                End While
                dr.Close()

                SQL = "select count(*) as extraNonresponderscount  " & _
                "from " & DBNameSpace & ".EISI " & _
                " where  not exists (select * from " & DBNameSpace & ".EIMAILOUT " & _
                " where " & DBNameSpace & ".EISI.STRAIRSNUMBER = " & DBNameSpace & ".EIMAILOUT.STRAIRSNUMBER" & _
                " and EISI.STRINVENTORYYEAR = EIMAILOUT.STRINVENTORYYEAR) " & _
                " and " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
                " and " & DBNameSpace & ".EISI.STROPTOUT is null"

                cmd = New OracleCommand(SQL, conn)

                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtExtraNonResponses.Text = dr.Item(extraNonresponderscount)
                End While
                dr.Close()

                SQL = "select count(*) as TotaloptinCount " & _
                "from " & DBNameSpace & ".EISI " & _
                "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "'" & _
                " and " & DBNameSpace & ".EISI.strOptOut = 'NO'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtEITotalOptInCount.Text = dr.Item(TotaloptinCount)
                End While
                dr.Close()

                SQL = "select count(*) as TotaloptOutCount " & _
                "from " & DBNameSpace & ".EISI " & _
                "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
                "and " & DBNameSpace & ".EISI.strOptOut = 'YES'"
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtEITotalOptOutCount.Text = dr.Item(TotaloptoutCount)
                End While
                dr.Close()

                SQL = "select count(*) as FinalizedCount " & _
                "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout " & _
                "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
                "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
                "and " & DBNameSpace & ".EISI.strOptOut = 'NO' " & _
                "and " & DBNameSpace & ".EISI.STRFINALIZE is not null"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtFinalized.Text = dr.Item(finalizedcount)
                End While
                dr.Close()

                SQL = "select count(*) as inprocesscount " & _
                "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout  " & _
                "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
                "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
                "and " & DBNameSpace & ".EISI.strOptOut = 'NO' " & _
                "and " & DBNameSpace & ".EISI.STRFINALIZE is null"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read()
                    txtinProgress.Text = dr.Item(inprocesscount)
                End While
                dr.Close()

                SQL = "select count(*) as MailOutOptInCount " & _
                "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout " & _
                "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "' " & _
                "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
                "and " & DBNameSpace & ".EISI.strOptOut = 'NO'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtEIMailoutOptin.Text = dr.Item(MailOutOptInCount)
                End While
                dr.Close()

                SQL = "select count(*) as MailOutOptOutCount " & _
                "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout " & _
                "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "' " & _
                "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
                "and " & DBNameSpace & ".EISI.strOptOut = 'YES'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader

                While dr.Read()
                    txtEIMailoutOptOut.Text = dr.Item(mailoutOptOutCount)
                End While
                dr.Close()

            Catch ex As Exception
                MsgBox("That Prefix is not in the db" + vbCrLf + ex.ToString())
            End Try

            SQL = "select count(*) as mailoutNonresponderscount " & _
            "from  " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & EIYear & "' " & _
            "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".EISI.strOptOut is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read()
                txtMailoutNonReaponses.Text = dr.Item(mailoutNonresponderscount)
            End While
            dr.Close()

            SQL = "select count(*) as Nonresponsecount " & _
         "from  " & DBNameSpace & ".EISI " & _
         "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
         "and " & DBNameSpace & ".EISI.strOptOut is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read()
                txtEINonResponseCount.Text = dr.Item(Nonresponsecount)
            End While
            dr.Close()

            SQL = "select count(*) as ExtraCount " & _
            "from (Select " & DBNameSpace & ".EISI.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".eImailout.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI  " & _
            "Where " & DBNameSpace & ".eImailout.STRAIRSYEAR (+) = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".EISI.STRINVENTORYYEAR= '" & EIYear & "' " & _
            "AND " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read()
                txtEIextraResponse.Text = dr.Item(extracount)
                txtEIextraResponse2.Text = dr.Item(extracount)
            End While
            dr.Close()

            SQL = "select count(*) as ExtraOptinCount " & _
            "from (Select " & DBNameSpace & ".EISI.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".EIMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".EIMailout, " & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".EISI.STRINVENTORYYEAR= '" & EIYear & "' " & _
            "AND " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT='NO'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read()
                txtEIExtraOptin.Text = dr.Item(extraOptincount)
            End While
            dr.Close()

            SQL = "select count(*) as ExtraOptOUTCount " & _
            "from (Select " & DBNameSpace & ".EISI.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".EIMAILOUT.STRAIRSYear AS MailoutAIRS " & _
            "From " & DBNameSpace & ".EiMailout, " & DBNameSpace & ".EISI " & _
            " Where " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".EISI.STRINVENTORYYEAR= '" & EIYear & "' " & _
            "AND " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT='YES'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read()
                txtEIExtraOptOut.Text = dr.Item(extraOptOutCount)
            End While
            dr.Close()

            SQL = "select count(*) as TotalResponsecount " & _
            "from " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & EIYear & "' " & _
            "and EISI.strOptOut is not NULL"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read()
                txtEITotalResponse.Text = dr.Item(TotalResponsecount)
            End While
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub findEIMailOut()
        Dim SQL As String
        Dim AirsNo As String = txtEIAirsNo.Text
        Dim dr As OracleDataReader
        Dim EIyear As String = txtEIYear.Text

        Try
            SQL = "SELECT * " & _
            "from " & DBNameSpace & ".eIMailOut " & _
            "where STRAIRSNUMBER = '" & AirsNo & "' " & _
            "and STRINVENTORYYEAR = '" & EIyear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            While dr.Read
                If IsDBNull(dr("STRFACILITYNAME")) Then
                    txtEIFacilityName.Text = ""
                Else
                    txtEIFacilityName.Text = dr("STRFACILITYNAME")
                End If

                If IsDBNull(dr("STRCONTACTPREFIX")) Then
                    txtEIprefix.Text = ""
                Else
                    txtEIprefix.Text = dr("STRCONTACTPREFIX")
                End If
                If IsDBNull(dr("STRCONTACTFIRSTNAME")) Then
                    txtEIFirstName.Text = ""
                Else
                    txtEIFirstName.Text = dr("STRCONTACTFIRSTNAME")
                End If
                If IsDBNull(dr("STRCONTACTLASTNAME")) Then
                    txtEILastName.Text = ""
                Else
                    txtEILastName.Text = dr("STRCONTACTLASTNAME")
                End If
                If IsDBNull(dr("STRCONTACTCOMPANYNAME")) Then
                    txtEIcompanyName.Text = ""
                Else
                    txtEIcompanyName.Text = dr("STRCONTACTCOMPANYNAME")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS1")) Then
                    txtEIcontactAddress1.Text = ""
                Else
                    txtEIcontactAddress1.Text = dr("STRCONTACTADDRESS1")
                End If
                If IsDBNull(dr("STRCONTACTADDRESS2")) Then
                    txtEIcontactAddress2.Text = ""
                Else
                    txtEIcontactAddress2.Text = dr("STRCONTACTADDRESS2")
                End If
                If IsDBNull(dr("STRCONTACTCITY")) Then
                    txtEIcontactCity.Text = ""
                Else
                    txtEIcontactCity.Text = dr("STRCONTACTCITY")
                End If
                If IsDBNull(dr("STRCONTACTSTATE")) Then
                    txtEIcontactState.Text = ""
                Else
                    txtEIcontactState.Text = dr("STRCONTACTSTATE")
                End If
                If IsDBNull(dr("STRCONTACTZIPCODE")) Then
                    txtEIcontactZipCode.Text = ""
                Else
                    txtEIcontactZipCode.Text = dr("STRCONTACTZIPCODE")
                End If
                If IsDBNull(dr("STRCONTACTEMAIL")) Then
                    txtEIcontactEmail.Text = ""
                Else
                    txtEIcontactEmail.Text = dr("STRCONTACTEMAIL")
                End If
            End While

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
           
        End Try
    End Sub
    Private Sub clearEIMailout()
        Try
            txtEIAirsNo.Text = ""
            txtEIFacilityName.Text = ""
            txtEIprefix.Text = ""
            txtEIFirstName.Text = ""
            txtEILastName.Text = ""
            txtEIcompanyName.Text = ""
            txtEIcontactAddress1.Text = ""
            txtEIcontactAddress2.Text = ""
            txtEIcontactCity.Text = ""
            txtEIcontactState.Text = ""
            txtEIcontactZipCode.Text = ""
            txtEIcontactEmail.Text = ""

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblViewMailOutEI_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewMailOutEI.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYname, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".eIMailOut " & _
            "where STRinventoryYEAR = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
         
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvEIDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvEIDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvEIDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString
            ' txtEIMailOutCount.Text = txtEIRecordNumber.Text

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
    Private Sub lblViewEINonResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEINonResponse.LinkClicked
        Try
            
            Dim year As String = txtEIYear.Text()

            SQL = "SELECT " & DBNameSpace & ".eiMailOut.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".eiMailOut.STRFACILITYNAME " & _
            "from  " & DBNameSpace & ".EISI,  " & DBNameSpace & ".eiMailOut " & _
            "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.strOptOut is NULL" & _
            " order by " & DBNameSpace & ".eiMailOut.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString
            ' clearEIData()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEIOptIn_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEIOptIn.LinkClicked
        txtEIYear.Text = cboEIYear2.SelectedItem
        Try
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT airbranch.EISI.STRAIRSNUMBER, " & _
            "airbranch.EISI.STRFACILITYNAME, " & _
            "airbranch.EISI.STRFINALIZE, " & _
            "airbranch.EISI.STRCONFIRMATIONNUMBER " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout " & _
            "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'NO'" & _
            "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".EISI.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRFINALIZE").HeaderText = "Finalized Date"
            dgvEIDataCount.Columns("STRFINALIZE").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNUMBER").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNUMBER").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEIOptOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEIOptOut.LinkClicked
        txtEIYear.Text = cboEIYear2.SelectedItem
        Try
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRFINALIZE, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNUMBER " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eImailout " & _
            "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'YES'" & _
            "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".EISI.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
           
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRFINALIZE").HeaderText = "Finalized Date"
            dgvEIDataCount.Columns("STRFINALIZE").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNUMBER").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNUMBER").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblextraEIResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblextraEIResponse.LinkClicked
        Try
            
            Dim year As String = txtEIYear.Text


            SQL = "SELECT dt_NotInMailout.SchemaAIRS, " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTCOMPANYNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTPHONENUMBER1 " & _
            "from (Select " & DBNameSpace & ".EISI.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".EIMailout.STRAIRSYEAR AS MailoutAIRS" & _
            " From " & DBNameSpace & ".EIMailout, " & DBNameSpace & ".EISI" & _
            " Where " & DBNameSpace & ".EIMailout.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".EISI.STRINVENTORYYEAR=  '" & year & "' " & _
            "AND " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").HeaderText = "Phone No."
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").DisplayIndex = 6

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString


            'clearEIData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEIExtraOptIn_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEIExtraOptIn.LinkClicked
        txtEIYear.Text = cboEIYear2.SelectedItem
        Try
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.strfinalize, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNumber " & _
            "from (select " & DBNameSpace & ".EISI.strairsyear as SchemaAIRS, " & _
            "" & DBNameSpace & ".eImailout.strairsyear as MailoutAIRS " & _
            "From " & DBNameSpace & ".EIMailout, " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".eImailout.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "and " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "and MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT='NO'"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("strfinalize").HeaderText = "Finalize Date"
            dgvEIDataCount.Columns("strfinalize").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEIExtraOptOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEIExtraOptOut.LinkClicked
        txtEIYear.Text = cboEIYear2.SelectedItem
        Try
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.strfinalize, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNumber " & _
            "from (select " & DBNameSpace & ".EISI.strairsyear as SchemaAIRS, " & _
            "" & DBNameSpace & ".eImailout.strairsyear as MailoutAIRS " & _
            "From " & DBNameSpace & ".EIMailout, " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".eImailout.STRAIRSYEAR (+) = " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "and " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "and MailoutAIRS is NULL " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT='YES'"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"

            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("strfinalize").HeaderText = "Finalize Date"
            dgvEIDataCount.Columns("strfinalize").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEITotalResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEITotalResponse.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem

            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTCOMPANYname, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTPHONENUMBER1 " & _
            "from " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".EISI.strinventoryYear = '" & year & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT is not NULL " & _
            "order by " & DBNameSpace & ".EISI.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
       
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").HeaderText = "Phone Number"
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").DisplayIndex = 6

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

            'clearEIData()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEITotalOptin_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEITotalOptin.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem

            
            Dim year As String = txtEIYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRfinalize, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNumber " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eimailout " & _
            "where " & DBNameSpace & ".EISI.strinventoryyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'NO'" & _
            "and " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".eisi.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
           
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRfinalize").HeaderText = "Finalize Date"
            dgvEIDataCount.Columns("STRfinalize").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblViewEITotalOptOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEITotalOptOut.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem

            
            Dim year As String = txtEIYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRfinalize, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNumber " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eimailout " & _
            "where " & DBNameSpace & ".EISI.strinventoryyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'YES'" & _
            "and " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".eisi.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRfinalize").HeaderText = "Finalize Date"
            dgvEIDataCount.Columns("STRfinalize").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").DisplayIndex = 3

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
    End Sub
    Private Sub lblViewEIMailOut_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEIMailOut.LinkClicked
        Try
            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYname, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".eIMailOut " & _
            "where strinventoryyear = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
           
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvEIDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvEIDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvEIDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
          
        End Try
    End Sub
    Private Sub dgvEIDataCount_MouseUp1(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles dgvEIDataCount.MouseUp
        Dim hti As DataGridView.HitTestInfo = dgvEIDataCount.HitTest(e.X, e.Y)

        Try
            ' If dgvEIDataCount.Columns(2).HeaderText <> "Transaction Date" Then
            If dgvEIDataCount.ColumnCount > 2 Then
                If dgvEIDataCount.RowCount > 0 And hti.RowIndex <> -1 Then
                    If dgvEIDataCount.Columns(0).HeaderText = "Airs No." Then
                        If IsDBNull(dgvEIDataCount(0, hti.RowIndex).Value) Then

                        Else
                            clearEIMailout()
                            txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                            txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value
                            findEIMailOut()
                        End If
                    Else
                        If dgvEIDataCount.Columns(0).HeaderText = "Airs No." Then
                            If IsDBNull(dgvEIDataCount(0, hti.RowIndex).Value) Then
                                txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                                txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value

                            Else
                                clearEIMailout()
                                findEIMailOut()
                                txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value

                            End If
                        End If
                    End If
                    If dgvEIDataCount.Columns(2).HeaderText = "Transaction Date" Then
                        If IsDBNull(dgvEIDataCount(3, hti.RowIndex).Value) Then
                            txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                            txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value

                        Else
                            clearEIMailout()
                            findEIMailOut()
                            txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                            txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value

                        End If
                    Else
                        If dgvEIDataCount.Columns(2).HeaderText = "Transaction Date" Then
                            If IsDBNull(dgvEIDataCount(3, hti.RowIndex).Value) Then
                                txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                                txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value

                            Else
                                clearEIMailout()
                                findEIMailOut()
                                txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                                txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value

                            End If
                        End If
                    End If

                End If
            Else
                clearEIMailout()
                findEIMailOut()
                txtEIAirsNo.Text = dgvEIDataCount(0, hti.RowIndex).Value
                txtEIFacilityName.Text = dgvEIDataCount(1, hti.RowIndex).Value
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub loadEIMailOutYear()
        'Load MailOut Year dropdown boxes
        Dim year As Integer
        Dim SQL As String
        Try
            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            SQL = "Select distinct STRINVENTORYYEAR " & _
                      "from " & DBNameSpace & ".EIMAILOUT  " & _
                      "order by STRINVENTORYYEAR desc"
            Dim cmd As New OracleCommand(SQL, conn)

            Dim dr As OracleDataReader = cmd.ExecuteReader()
            dr.Read()
            year = dr("STRINVENTORYYEAR") + 1
            cboEIMailoutYear.Items.Add(year)
            Do
                year = dr("STRINVENTORYYEAR")
                cboEIMailoutYear.Items.Add(year)
            Loop While dr.Read
            cboEIMailoutYear.SelectedIndex = 0
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub
    Private Sub loadEIEnrollmentYear()
        'Load MailOut Year dropdown boxes
        Dim year As Integer
        Dim SQL As String
        Try
            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            SQL = "Select distinct STRINVENTORYYEAR " & _
                      "from " & DBNameSpace & ".EIMAILOUT  " & _
                      "order by STRINVENTORYYEAR desc"
            Dim cmd As New OracleCommand(SQL, conn)

            Dim dr As OracleDataReader = cmd.ExecuteReader()
            dr.Read()
            Do
                year = dr("STRINVENTORYYEAR")
                cboEIEnrollmentYear.Items.Add(year)
            Loop While dr.Read
            cboEIEnrollmentYear.SelectedIndex = 0
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub

    Private Sub loadESEnrollmentYear()
        'Load MailOut Year dropdown boxes
        Dim year As Integer
        Dim SQL As String
        Try
            If conn.State = ConnectionState.Open Then
            Else
                conn.Open()
            End If

            SQL = "Select distinct ESMAILOUT.STRESYEAR " & _
                      "from " & DBNameSpace & ".ESMAILOUT  " & _
                      "order by STRESYEAR desc"
            Dim cmd As New OracleCommand(SQL, conn)

            Dim dr As OracleDataReader = cmd.ExecuteReader()
            dr.Read()
            Do
                year = dr("STRESYEAR")
                cboESYear.Items.Add(year)
            Loop While dr.Read
            ' cboESYear.SelectedIndex = 0
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try

    End Sub

   

    Private Sub btnGenerateEIMailOut_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnGenerateEIMailOut.Click
        Try
            GenerateEIMailOut()
            cboEIMailoutYear.Items.Clear()
            loadEIMailOutYear()
            cboEIMailoutYear.Text = ""



        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Sub GenerateEIMailOut()
        Dim airsNumber As String
        Dim airsYear As String
        Dim FACILITYNAME As String = " "
        Dim CONTACTCOMPANYNAME As String = " "
        Dim CONTACTADDRESS1 As String = " "
        Dim CONTACTADDRESS2 As String = " "
        Dim CONTACTCITY As String = " "
        Dim CONTACTSTATE As String = " "
        Dim CONTACTZIPCODE As String = " "
        Dim CONTACTFIRSTNAME As String = " "
        Dim CONTACTLASTNAME As String = " "
        Dim CONTACTEMAIL As String = " "
        Dim EIYear As String = cboEIMailoutYear.SelectedItem

        Dim OperationalStatus As String = " "
        Dim FacilityClass As String = " "

        Try
            

            If EIYear = "Select a Mailout Year & Click Below" Then
                MsgBox("You must select a Mailout Year")
            Else
                SQL = "Select strAirsNumber " & _
                "FROM " & DBNameSpace & ".EImailOut " & _
                "where STRINVENTORYYEAR = '" & EIYear & "'"
            End If
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                MsgBox("That year is already being used." & vbCrLf & "If you want to use that year," & vbCrLf & "you must first delete that year from the database.")
            Else
                If cboEIMailoutYear.Text <> "" Then
                    If cboEIMailoutYear.Text.Length = 4 Then
                        SQL = "Select dt_EIcontact.STRairsnumber, " & DBNameSpace & ".APBFacilityinformation.STRFACILITYNAME, " & _
                        "" & DBNameSpace & ".APBHEADERDATA.stroperationalstatus, " & DBNameSpace & ".APBHEADERDATA.STRCLASS, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRContactLastName " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRContactLastName " & _
                        "Else '' " & _
                        "END) STRContactLastName, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRContactfirstName " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRContactfirstName " & _
                        "Else '' " & _
                        "END) STRContactfirstName, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRContactCompanyName " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRContactCompanyName " & _
                        "END) STRContactCompanyName, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRContactEmail " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRContactEmail " & _
                        "END) STRContactEmail, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRCONTACTPREFIX " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTPREFIX " & _
                        "END) strCONTACTPREFIX, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRCONTACTADDRESS1 " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTADDRESS1 " & _
                        "END) STRCONTACTADDRESS1, " & _
                        "(Case " & _
                        "When dt_EIContact.STRKEY='41' THEN dt_EIContact.STRCONTACTCITY " & _
                        "When dt_EIContact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTCITY " & _
                        "END) STRCONTACTCITY, " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRCONTACTSTATE " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTSTATE " & _
                        "END) STRCONTACTSTATE,  " & _
                        "(Case " & _
                        "When dt_EIcontact.STRKEY='41' THEN dt_EIcontact.STRCONTACTZIPCODE " & _
                        "When dt_EIcontact.STRKEY Is Null THEN dt_PermitContact.STRCONTACTZIPCODE " & _
                        "END) STRCONTACTZIPCODE " & _
                        "From " & _
                        "(Select DISTINCT dt_eIlist.STRAIRSNUMBER, dt_contact.STRKEY,  " & _
                        "dt_Contact.STRCONTACTLASTNAME, dt_Contact.STRCONTACTFIRSTNAME, " & _
                        "dt_Contact.STRContactCompanyName, dt_Contact.STRContactEmail,  " & _
                        "dt_Contact.STRCONTACTPREFIX, dt_Contact.STRCONTACTADDRESS1, dt_Contact.STRCONTACTCITY,  " & _
                        "dt_Contact.STRCONTACTSTATE, dt_Contact.STRCONTACTZIPCODE " & _
                        "FROM " & _
                        "(Select * FROM " & DBNameSpace & ".APBHEADERDATA " & _
                        "where (stroperationalstatus = 'O' OR stroperationalstatus = 'P' oR stroperationalstatus = 'C') AND  " & _
                        "(STRCLASS = 'A')   " & _
                        ") dt_EIList,      " & _
                        "(Select * From " & DBNameSpace & ".APBCONTACTINFORMATION where STRKEY=41) dt_Contact " & _
                        "Where dt_EIList.STRAIRSNUMBEr = dt_Contact.STRAIRSNUMBER (+)) dt_EIContact, " & _
                        "(Select DISTINCT dt_eIlist.STRAIRSNUMBER, dt_contact.STRKEY,  " & _
                        "dt_Contact.STRCONTACTLASTNAME, dt_Contact.STRCONTACTFIRSTNAME, " & _
                        "dt_Contact.STRContactCompanyName, dt_Contact.STRContactEmail, dt_Contact.STRCONTACTPREFIX,  " & _
                        "dt_Contact.STRCONTACTADDRESS1, dt_Contact.strcontactcity, dt_Contact.STRCONTACTSTATE, dt_Contact.STRCONTACTZIPCODE " & _
                        "FROM " & _
                        "(Select * FROM " & DBNameSpace & ".APBHEADERDATA " & _
                        "where (stroperationalstatus = 'O' OR stroperationalstatus = 'P' oR stroperationalstatus = 'C') AND  " & _
                        "(STRCLASS = 'A')   " & _
                        ") dt_EIList,      " & _
                        "(Select * From " & DBNameSpace & ".APBCONTACTINFORMATION where STRKEY=30) dt_Contact " & _
                        "Where dt_EIList.STRAIRSNUMBEr = dt_Contact.STRAIRSNUMBER (+)) dt_PermitContact, " & _
                        "" & DBNameSpace & ".APBFACILITYINFORMATION, " & _
                        "" & DBNameSpace & ".APBHEADERDATA " & _
                        "Where " & DBNameSpace & ".APBFACILITYINFORMATION.STRAIRSNUMBER= dt_EIContact.STRAIRSNumber and  " & _
                        "" & DBNameSpace & ".APBHEADERDATA.STRAIRSNUMBER= dt_EIContact.STRAIRSNumber and  " & _
                        "dt_EIContact.STRAIRSNumber  = dt_PermitContact.STRAIRSNUMBER (+) "

                        cmd = New OracleCommand(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        While dr.Read
                            airsNumber = dr("strAirsNumber")
                            airsYear = airsNumber & EIYear
                            EIYear = cboEIMailoutYear.SelectedItem
                            If IsDBNull(dr("STRFACILITYNAME")) Then
                                FACILITYNAME = " "
                            Else
                                FACILITYNAME = dr("STRFACILITYNAME")
                            End If
                            If IsDBNull(dr("STROPERATIONALSTATUS")) Then
                                OperationalStatus = " "
                            Else
                                OperationalStatus = dr("STROPERATIONALSTATUS")
                            End If
                            If IsDBNull(dr("STRCLASS")) Then
                                FacilityClass = " "
                            Else
                                FacilityClass = dr("STRCLASS")
                            End If
                            If IsDBNull(dr("STRCONTACTCOMPANYNAME")) Then
                                CONTACTCOMPANYNAME = " "
                            Else
                                CONTACTCOMPANYNAME = dr("STRCONTACTCOMPANYNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTADDRESS1")) Then
                                CONTACTADDRESS1 = " "
                            Else
                                CONTACTADDRESS1 = dr("STRCONTACTADDRESS1")
                            End If

                            If IsDBNull(dr("STRCONTACTCITY")) Then
                                CONTACTCITY = " "
                            Else
                                CONTACTCITY = dr("STRCONTACTCITY")
                            End If
                            If IsDBNull(dr("STRCONTACTSTATE")) Then
                                CONTACTSTATE = " "
                            Else
                                CONTACTSTATE = dr("STRCONTACTSTATE")
                            End If
                            If IsDBNull(dr("STRCONTACTZIPCODE")) Then
                                CONTACTZIPCODE = " "
                            Else
                                CONTACTZIPCODE = dr("STRCONTACTZIPCODE")
                            End If
                            If IsDBNull(dr("STRCONTACTFIRSTNAME")) Then
                                CONTACTFIRSTNAME = " "
                            Else
                                CONTACTFIRSTNAME = dr("STRCONTACTFIRSTNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTLASTNAME")) Then
                                CONTACTLASTNAME = " "
                            Else
                                CONTACTLASTNAME = dr("STRCONTACTLASTNAME")
                            End If
                            If IsDBNull(dr("STRCONTACTEMAIL")) Then
                                CONTACTEMAIL = " "
                            Else
                                CONTACTEMAIL = dr("STRCONTACTEMAIL")
                            End If

                            SQL2 = "insert into " & DBNameSpace & ".EImailOut " & _
                           "(strAirsYear, " & _
                           "strAirsNumber, " & _
                           "STRFACILITYNAME, " & _
                           "STROPERATIONALSTATUS, " & _
                           "STRCLASS, " & _
                           "STRCONTACTCOMPANYNAME, " & _
                           "STRCONTACTADDRESS1, " & _
                           "STRCONTACTCITY, " & _
                           "STRCONTACTSTATE, " & _
                           "STRCONTACTZIPCODE, " & _
                           "STRCONTACTFIRSTNAME, " & _
                           "STRCONTACTLASTNAME, " & _
                           "STRCONTACTEMAIL, " & _
                           "STRINVENTORYYEAR) " & _
                           "values " & _
                           "('" & airsYear & "', " & _
                           "'" & airsNumber & "', " & _
                           "'" & Replace(FACILITYNAME, "'", "''") & "', " & _
                             "'" & Replace(OperationalStatus, "'", "''") & "', " & _
                           "'" & Replace(FacilityClass, "'", "''") & "', " & _
                           "'" & Replace(Replace(CONTACTCOMPANYNAME, "'", "''"), "N/A", " ") & "', " & _
                           "'" & Replace(Replace(CONTACTADDRESS1, "'", "''"), "N/A", " ") & "', " & _
                           "'" & Replace(Replace(CONTACTCITY, "'", "''"), "N/A", " ") & "', " & _
                           "'" & CONTACTSTATE & "', " & _
                           "'" & Replace(CONTACTZIPCODE, "N/A", " ") & "', " & _
                           "'" & Replace(Replace(CONTACTFIRSTNAME, "'", "''"), "N/A", " ") & "', " & _
                           "'" & Replace(Replace(CONTACTLASTNAME, "'", "''"), "N/A", " ") & "', " & _
                           "'" & Replace(Replace(CONTACTEMAIL, "'", "''"), "N/A", " ") & "', " & _
                           "'" & EIYear & "')"

                            cmd2 = New OracleCommand(SQL2, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If
                            dr2 = cmd2.ExecuteReader
                            dr2.Close()
                        End While
                    End If

                    
                    Dim year As String = cboEIMailoutYear.SelectedItem

                    SQL = "SELECT STRAIRSNUMBER, " & _
                    "STRFACILITYNAME, " & _
                    "STROPERATIONALSTATUS, " & _
                    "STRCLASS, " & _
                    "STRCONTACTFIRSTNAME, " & _
                    "STRCONTACTLASTNAME, " & _
                    "STRCONTACTCOMPANYname, " & _
                    "STRCONTACTADDRESS1, " & _
                    "STRCONTACTCITY, " & _
                    "STRCONTACTSTATE, " & _
                    "STRCONTACTZIPCODE, " & _
                    "STRCONTACTEMAIL " & _
                    "from " & DBNameSpace & ".eIMailOut " & _
                    "where STRINVENTORYYEAR = '" & year & "' " & _
                    "order by STRFACILITYNAME"

                    dsViewCount = New DataSet
                    daViewCount = New OracleDataAdapter(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    daViewCount.Fill(dsViewCount, "ViewCount")
                    dgvEIDataCount.DataSource = dsViewCount
                    dgvEIDataCount.DataMember = "ViewCount"
                    dgvEIDataCount.RowHeadersVisible = False
                    dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                    dgvEIDataCount.AllowUserToResizeColumns = True
                    dgvEIDataCount.AllowUserToAddRows = False
                    dgvEIDataCount.AllowUserToDeleteRows = False
                    dgvEIDataCount.AllowUserToOrderColumns = True
                    dgvEIDataCount.AllowUserToResizeRows = True

                    dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
                    dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
                    dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
                    dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
                    dgvEIDataCount.Columns("STROPERATIONALSTATUS").HeaderText = "Operational Status"
                    dgvEIDataCount.Columns("STROPERATIONALSTATUS").DisplayIndex = 2
                    dgvEIDataCount.Columns("STRCLASS").HeaderText = "Facility Class"
                    dgvEIDataCount.Columns("STRCLASS").DisplayIndex = 3
                    dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
                    dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 4
                    dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
                    dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 5
                    dgvEIDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
                    dgvEIDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 6
                    dgvEIDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
                    dgvEIDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 7
                    dgvEIDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
                    dgvEIDataCount.Columns("STRCONTACTCITY").DisplayIndex = 8
                    dgvEIDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
                    dgvEIDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 9
                    dgvEIDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
                    dgvEIDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 10
                    dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
                    dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 11

                    txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

                End If
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
    Private Sub btnDeleteEIMailOut_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDeleteEIMailOut.Click
        Try
            deleteEImailOutbyYear()
            cboEIMailoutYear.Items.Clear()
            loadEIMailOutYear()
            cboEIMailoutYear.Text = ""
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
    End Sub
    Private Sub deleteEImailOutbyYear()
        Dim EIyear As String = cboEIMailoutYear.SelectedItem

        Try

            

            If EIyear = "Select a Mailout Year & Click Below" Then
                MsgBox("You must select a Mailout Year", MsgBoxStyle.Information, "EIMailout")
            Else
                SQL = "delete from " & DBNameSpace & ".EImailout " & _
                "where " & DBNameSpace & ".EImailout.STRINVENTORYYEAR = '" & EIyear & "'"

                MsgBox("EI mail out is deleted!")

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try

    End Sub
    Private Sub BtnEIExportExcel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnEIExportExcel.Click
        Try
            ExportEItoExcel()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Sub ExportEItoExcel()
        Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
        'Dim ExcelDoc As Microsoft.Office.Interop.Excel.Workbook
        'Dim ExcelApp As New Excel.Application
        Dim i As Integer
        Dim j As Integer

        Try
            If dgvEIDataCount.RowCount <> 0 Then
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
                With ExcelApp
                    .SheetsInNewWorkbook = 1
                    .Workbooks.Add()
                    .Worksheets(1).Select()


                    For i = 0 To dgvEIDataCount.ColumnCount - 1
                        .Cells(1, i + 1) = dgvEIDataCount.Columns(i).HeaderText.ToString
                    Next

                    For i = 0 To dgvEIDataCount.ColumnCount - 1
                        For j = 0 To dgvEIDataCount.RowCount - 1
                            .Cells(j + 2, i + 1).numberformat = "@"
                            .Cells(j + 2, i + 1).value = dgvEIDataCount.Item(i, j).Value.ToString
                        Next
                    Next

                End With
                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

        Catch ex As Exception
            If ex.ToString.Contains("RPC_E_CALL_REJECTED") Then
                MsgBox("Error in exporting data." & vbCrLf & "Please run the export again.")
            Else
                ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            End If
        Finally
             
        End Try
    End Sub
    Private Sub btnEISave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEISave.Click
        Try
            If txtEIFirstName.Text = "" Or txtEILastName.Text = "" Or txtEIcompanyName.Text = "" Or txtEIcontactAddress1.Text = "" Or txtEIcontactCity.Text = "" Or txtEIcontactState.Text = "" Or txtEIcontactZipCode.Text = "" Or txtEIcontactEmail.Text = "" Then
                MsgBox("Please enter required info.")

            Else
                SaveEIMailOut()
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
              
        End Try
    End Sub
    Private Sub SaveEIMailOut()
        Dim SQL As String
        Dim AirsNo As String = txtEIAirsNo.Text
        Dim EIYear As String = txtEIYear.Text
        Dim airsYear As String = AirsNo & EIYear
        Dim EIFacilityName As String = txtEIFacilityName.Text
        Dim EIPrefix As String = txtEIprefix.Text
        Dim EIFirstName As String = txtEIFirstName.Text

        Dim EILastName As String = txtEILastName.Text
        Dim EICompanyName As String = txtEIcompanyName.Text
        Dim EIContactAddress1 As String = txtEIcontactAddress1.Text
        Dim EIContactAddress2 As String = txtEIcontactAddress2.Text

        Dim EIContactCity As String = txtEIcontactCity.Text
        Dim EIcontactState As String = txtEIcontactState.Text
        Dim EIContactZip As String = txtEIcontactZipCode.Text
        Dim EIContactEmail As String = txtEIcontactEmail.Text

        Try
            SQL = "Select strAIRSYear " & _
                  "from " & DBNameSpace & ".EIMailout " & _
                  "where STRAIRSYEAR = '" & airsYear & "' "
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read


            If recExist = True Then
                SQL = "update " & DBNameSpace & ".EIMailOut set " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTPREFIX = '" & EIPrefix & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTFIRSTNAME = '" & EIFirstName & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTLASTNAME = '" & EILastName & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTCOMPANYNAME = '" & EICompanyName & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTADDRESS1 = '" & EIContactAddress1 & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTADDRESS2 = '" & EIContactAddress2 & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTCITY = '" & EIContactCity & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTSTATE = '" & EIcontactState & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTZIPCODE = '" & EIContactZip & "', " & _
                "" & DBNameSpace & ".EIMailOut.STRCONTACTEMAIL = '" & EIContactEmail & "'" & _
                "where " & DBNameSpace & ".EIMailOut.STRAIRSYEAR = '" & airsYear & "' "
                MsgBox("your info is updated")
            Else

                SQL = "Insert into " & DBNameSpace & ".EIMailOut" & _
                "(" & DBNameSpace & ".EIMailOut.STRAIRSYEAR, " & _
              "" & DBNameSpace & ".EIMailOut.STRAIRSNUMBER, " & _
              "" & DBNameSpace & ".EIMailOut.STRFACILITYNAME, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTPREFIX, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTFIRSTNAME, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTLASTNAME, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTCOMPANYNAME, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTADDRESS1, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTADDRESS2, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTCITY, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTSTATE, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTZIPCODE, " & _
              "" & DBNameSpace & ".EIMailOut.STRINVENTORYYEAR, " & _
              "" & DBNameSpace & ".EIMailOut.STRCONTACTEMAIL) " & _
                "values (" & _
                "'" & Replace(airsYear, "'", "''") & "', " & _
                "'" & Replace(AirsNo, "'", "''") & "', " & _
                "'" & Replace(EIFacilityName, "'", "''") & "', " & _
                "'" & Replace(EIPrefix, "'", "''") & "', " & _
                "'" & Replace(EIFirstName, "'", "''") & "', " & _
                "'" & Replace(EILastName, "'", "''") & "', " & _
                "'" & Replace(EICompanyName, "'", "''") & "', " & _
                "'" & Replace(EIContactAddress1, "'", "''") & "', " & _
                "'" & Replace(EIContactAddress2, "'", "''") & "', " & _
                "'" & Replace(EIContactCity, "'", "''") & "', " & _
                "'" & Replace(EIcontactState, "'", "''") & "', " & _
                "'" & Replace(EIContactZip, "'", "''") & "', " & _
                "'" & Replace(EIYear, "'", "''") & "', " & _
                "'" & Replace(EIContactEmail, "'", "''") & "' " & _
                " )"

                MsgBox("your info is added!")
            End If

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub btnEIDelete_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEIDelete.Click
        Try
            deleteEImailout()
            MsgBox("The info has been deleted!", MsgBoxStyle.Information, "EIMailout")
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
              
        End Try
    End Sub
    Private Sub deleteEImailout()
        Dim SQL As String
        Dim AirsNo As String = txtEIAirsNo.Text
        Dim dr As OracleDataReader

        Dim EIyear As String = txtEIYear.Text

        Try
            SQL = "delete from " & DBNameSpace & ".EIMailOut " & _
          "where " & DBNameSpace & ".EIMailOut.STRAIRSNUMBER = '" & AirsNo & "' " & _
          " and " & DBNameSpace & ".EIMailOut.STRINVENTORYYEAR = '" & EIyear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
             
        End Try
    End Sub
    Private Sub lblviewFinalized_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewFinalized.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem

            
            Dim year As String = txtEIYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "case " & _
            "when substr(strFinalize, 2, 1) = '-' then '0'||substr(strFinalize, 1, 10) " & _
            "else substr(strFinalize, 1,11) " & _
            "end Finalize, " & _
            "" & DBNameSpace & ".EISI.STRfinalize, " & _
            "" & DBNameSpace & ".EISI.STRQADONE, " & _
            "" & DBNameSpace & ".EISI.STRCONFIRMATIONNumber " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eimailout " & _
            "where " & DBNameSpace & ".EISI.strinventoryyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'NO' " & _
            "and " & DBNameSpace & ".EISI.strfinalize is not NULL " & _
            "and " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR (+)" & _
            "order by " & DBNameSpace & ".eisi.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
           
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("Finalize").HeaderText = "Finalize Date"
            dgvEIDataCount.Columns("Finalize").DisplayIndex = 2
            dgvEIDataCount.Columns("Finalize").DefaultCellStyle.Format = "dd-MMM-yyyy"

            dgvEIDataCount.Columns("STRQADONE").HeaderText = "QA Done Date"
            dgvEIDataCount.Columns("STRQADONE").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").HeaderText = "Confirmation Number"
            dgvEIDataCount.Columns("STRCONFIRMATIONNumber").DisplayIndex = 4

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
            
        End Try
    End Sub
    Private Sub lblviewInprocess_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewInprocess.LinkClicked
        Try
            txtEIYear.Text = cboEIYear2.SelectedItem

            
            Dim year As String = txtEIYear.Text

            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRDATELASTLOGIN " & _
            "from " & DBNameSpace & ".EISI, " & DBNameSpace & ".eimailout " & _
            "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & year & "'" & _
            "and " & DBNameSpace & ".EISI.STROPTOUT = 'NO' " & _
            "and " & DBNameSpace & ".EISI.strfinalize is NULL " & _
            "and " & DBNameSpace & ".EIMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "order by " & DBNameSpace & ".eisi.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
          
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRDATELASTLOGIN").HeaderText = "Last Login Date"
            dgvEIDataCount.Columns("STRDATELASTLOGIN").DisplayIndex = 2


            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
               
        End Try
    End Sub
    Private Sub lblEIviewselectedyearMailOutlist_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblEIviewselectedyearMailOutlist.LinkClicked
        
        Try
            Dim year As String = cboEIMailoutYear.SelectedItem

            SQL = "SELECT STRAIRSNUMBER, " & _
            "STRFACILITYNAME, " & _
            "STROPERATIONALSTATUS, " & _
            "STRCLASS, " & _
            "STRCONTACTFIRSTNAME, " & _
            "STRCONTACTLASTNAME, " & _
            "STRCONTACTCOMPANYname, " & _
            "STRCONTACTADDRESS1, " & _
            "STRCONTACTCITY, " & _
            "STRCONTACTSTATE, " & _
            "STRCONTACTZIPCODE, " & _
            "STRCONTACTEMAIL " & _
            "from " & DBNameSpace & ".eIMailOut " & _
            "where STRINVENTORYYEAR = '" & year & "' " & _
            "order by STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"
         
            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STROPERATIONALSTATUS").HeaderText = "Operational Status"
            dgvEIDataCount.Columns("STROPERATIONALSTATUS").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCLASS").HeaderText = "Facility Class"
            dgvEIDataCount.Columns("STRCLASS").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYname").DisplayIndex = 6
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Address"
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 7
            dgvEIDataCount.Columns("STRCONTACTCITY").HeaderText = "City"
            dgvEIDataCount.Columns("STRCONTACTCITY").DisplayIndex = 8
            dgvEIDataCount.Columns("STRCONTACTSTATE").HeaderText = "State"
            dgvEIDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 9
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Zip"
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 10
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 11

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

             
        End Try

    End Sub
#End Region
#Region "Data Transfer Page"
#Region "Transfer Variables"
    Dim transferConn As OracleConnection
    Dim dsTemp As DataSet
    Dim daTemp As OracleDataAdapter
    Dim dtTemp As New DataTable
    Dim drDSRow As DataRow
    Dim temp As Object = ""
    Dim temp2 As Object = ""
    Dim temp3 As Object = ""
    Dim temp4 As Object = ""
    Dim temp5 As Object = ""
    Dim temp6 As Object = ""
    Dim temp7 As Object = ""
    Dim temp8 As Object = ""
    Dim temp9 As Object = ""
    Dim temp10 As Object = ""
    Dim temp11 As Object = ""
    Dim temp12 As Object = ""
    Dim temp13 As Object = ""
    Dim temp14 As Object = ""
    Dim temp15 As Object = ""
    Dim temp16 As Object = ""
    Dim temp17 As Object = ""
    Dim temp18 As Object = ""
    Dim temp19 As Object = ""
    Dim temp20 As Object = ""
    Dim temp21 As Object = ""
    Dim temp22 As Object = ""
    Dim temp23 As Object = ""
    Dim temp24 As Object = ""
    Dim temp25 As Object = ""
    Dim temp26 As Object = ""
    Dim temp27 As Object = ""
    Dim temp28 As Object = ""
    Dim temp29 As Object = ""
    Dim temp30 As Object = ""
    Dim temp31 As Object = ""
    Dim temp32 As Object = ""
    Dim temp33 As Object = ""
    Dim temp34 As Object = ""
    Dim temp35 As Object = ""
    Dim temp36 As Object = ""
    Dim temp37 As Object = ""
    Dim temp38 As Object = ""
    Dim temp39 As Object = ""
    Dim temp40 As Object = ""
    Dim temp41 As Object = ""
    Dim temp42 As Object = ""
    Dim temp43 As Object = ""
    Dim temp44 As Object = ""
    Dim temp45 As Object = ""
    Dim temp46 As Object = ""
    Dim temp47 As Object = ""
    Dim temp48 As Object = ""
    Dim temp49 As Object = ""
    Dim temp50 As Object = ""
    Dim temp51 As Object = ""
    Dim temp52 As Object = ""
    Dim temp53 As Object = ""
    Dim temp54 As Object = ""
    Dim temp55 As Object = ""
    Dim temp56 As Object = ""
    Dim temp57 As Object = ""
    Dim temp58 As Object = ""
    Dim temp59 As Object = ""
    Dim temp60 As Object = ""
    Dim temp61 As Object = ""
    Dim temp62 As Object = ""
    Dim temp63 As Object = ""
    Dim temp64 As Object = ""
    Dim temp65 As Object = ""
    Dim temp66 As Object = ""
    Dim temp67 As Object = ""

#End Region
    Private Sub chbAllTables_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chbAllTables.CheckedChanged
        Try
            If chbAllTables.Checked = True Then
                pnlLookUpTables.Enabled = False
                pnlHeaderTables.Enabled = False
                pnlISMPTables.Enabled = False
                pnlSBEAPTables.Enabled = False
                pnlSSCPTables.Enabled = False
                pnlSSPPTables.Enabled = False
                pnlAFSTables.Enabled = False
                pnlMiscTables.Enabled = False

                chbAllLookUpTables.Checked = False
                chbAllHeaderTables.Checked = False
                chbAllISMPTables.Checked = False
                chbAllSBEAPTables.Checked = False
                chbAllSSCPTables.Checked = False
                chbAllSSPPTables.Checked = False
                chbAllAFSTables.Checked = False

                ClearLookUpTables()
                ClearAPBTables()
                ClearISMPTables()
                ClearSBEAPTables()
                ClearSSCPTables()
                ClearSSPPTables()
                ClearAFSTables()
            Else
                pnlLookUpTables.Enabled = True
                pnlHeaderTables.Enabled = True
                pnlISMPTables.Enabled = True
                pnlSBEAPTables.Enabled = True
                pnlSSCPTables.Enabled = True
                pnlSSPPTables.Enabled = True
                pnlAFSTables.Enabled = True
                pnlMiscTables.Enabled = True
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllLookUpTables_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chbAllLookUpTables.CheckedChanged
        Try
            If chbAllLookUpTables.Checked = True Then
                chbLookUpAPBManagement.Enabled = False
                chbLookUpApplicationType.Enabled = False
                chbLookUpComplianceActivities.Enabled = False
                chbLookUpComplianceStatus.Enabled = False
                chbLookUpComplianceUnits.Enabled = False
                chbLookUpCountyInformation.Enabled = False
                chbLookUpDistrictInformation.Enabled = False
                chbLookUpDistrictOffice.Enabled = False
                chbLookUpDistricts.Enabled = False
                chbLookUpEPDBranches.Enabled = False
                chbLookUpEPDPrograms.Enabled = False
                chbLookUpEPDUnits.Enabled = False
                chbLookUpHPVViolations.Enabled = False
                chbLookUpIAIPAccounts.Enabled = False
                chbLookUpIAIPForms.Enabled = False
                chbLookUpISMPComplianceStatus.Enabled = False
                chbLookUpISMPMethods.Enabled = False
                chbLookUpMonitoringUnits.Enabled = False
                chbLookUpNonAttainment.Enabled = False
                chbLookUpPermittingUnits.Enabled = False
                chbLookUpPermitTypes.Enabled = False
                chbLookUpPollutants.Enabled = False
                chbLookUpSBEAPCaseWork.Enabled = False
                chbLookUpSICCodes.Enabled = False
                chbLookUpSSCPNotifications.Enabled = False
                chbLookUpStates.Enabled = False
                chbLookUpSubPart60.Enabled = False
                chbLookUpSubPart61.Enabled = False
                chbLookUpSubPart63.Enabled = False
                chbLookUpSubPartSIP.Enabled = False
                chbLookUpTestingFirms.Enabled = False
                chbLookUpUnits.Enabled = False
                ClearLookUpTables()
            Else
                chbLookUpAPBManagement.Enabled = True
                chbLookUpApplicationType.Enabled = True
                chbLookUpComplianceActivities.Enabled = True
                chbLookUpComplianceStatus.Enabled = True
                chbLookUpComplianceUnits.Enabled = True
                chbLookUpCountyInformation.Enabled = True
                chbLookUpDistrictInformation.Enabled = True
                chbLookUpDistrictOffice.Enabled = True
                chbLookUpDistricts.Enabled = True
                chbLookUpEPDBranches.Enabled = True
                chbLookUpEPDPrograms.Enabled = True
                chbLookUpEPDUnits.Enabled = True
                chbLookUpHPVViolations.Enabled = True
                chbLookUpIAIPAccounts.Enabled = True
                chbLookUpIAIPForms.Enabled = True
                chbLookUpISMPComplianceStatus.Enabled = True
                chbLookUpISMPMethods.Enabled = True
                chbLookUpMonitoringUnits.Enabled = True
                chbLookUpNonAttainment.Enabled = True
                chbLookUpPermittingUnits.Enabled = True
                chbLookUpPermitTypes.Enabled = True
                chbLookUpPollutants.Enabled = True
                chbLookUpSBEAPCaseWork.Enabled = True
                chbLookUpSICCodes.Enabled = True
                chbLookUpSSCPNotifications.Enabled = True
                chbLookUpStates.Enabled = True
                chbLookUpSubPart60.Enabled = True
                chbLookUpSubPart61.Enabled = True
                chbLookUpSubPart63.Enabled = True
                chbLookUpSubPartSIP.Enabled = True
                chbLookUpTestingFirms.Enabled = True
                chbLookUpUnits.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Sub ClearLookUpTables()
        Try
            chbLookUpAPBManagement.Checked = False
            chbLookUpApplicationType.Checked = False
            chbLookUpComplianceActivities.Checked = False
            chbLookUpComplianceStatus.Checked = False
            chbLookUpComplianceUnits.Checked = False
            chbLookUpCountyInformation.Checked = False
            chbLookUpDistrictInformation.Checked = False
            chbLookUpDistrictOffice.Checked = False
            chbLookUpDistricts.Checked = False
            chbLookUpEPDBranches.Checked = False
            chbLookUpEPDPrograms.Checked = False
            chbLookUpEPDUnits.Checked = False
            chbLookUpHPVViolations.Checked = False
            chbLookUpIAIPAccounts.Checked = False
            chbLookUpIAIPForms.Checked = False
            chbLookUpISMPComplianceStatus.Checked = False
            chbLookUpISMPMethods.Checked = False
            chbLookUpMonitoringUnits.Checked = False
            chbLookUpNonAttainment.Checked = False
            chbLookUpPermittingUnits.Checked = False
            chbLookUpPermitTypes.Checked = False
            chbLookUpPollutants.Checked = False
            chbLookUpSBEAPCaseWork.Checked = False
            chbLookUpSICCodes.Checked = False
            chbLookUpSSCPNotifications.Checked = False
            chbLookUpStates.Checked = False
            chbLookUpSubPart60.Checked = False
            chbLookUpSubPart61.Checked = False
            chbLookUpSubPart63.Checked = False
            chbLookUpSubPartSIP.Checked = False
            chbLookUpTestingFirms.Checked = False
            chbLookUpUnits.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllHeaderTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllHeaderTables.CheckedChanged
        Try
            If chbAllHeaderTables.Checked = True Then
                chbAPBAirProgramPollutants.Enabled = False
                chbAPBContactInformation.Enabled = False
                chbAPBFacilityInformation.Enabled = False
                chbAPBHeaderData.Enabled = False
                chbAPBMasterAIRS.Enabled = False
                chbAPBMasterAPP.Enabled = False
                chbAPBPermits.Enabled = False
                chbAPBSubPartData.Enabled = False
                chbAPBSupplamentalData.Enabled = False
                chbAPPMaster.Enabled = False
                chbHBAPBAirProgramPollutants.Enabled = False
                chbHBAPBFacilityInformation.Enabled = False
                chbHBAPBHeaderData.Enabled = False
                ClearAPBTables()
            Else
                chbAPBAirProgramPollutants.Enabled = True
                chbAPBContactInformation.Enabled = True
                chbAPBFacilityInformation.Enabled = True
                chbAPBHeaderData.Enabled = True
                chbAPBMasterAIRS.Enabled = True
                chbAPBMasterAPP.Enabled = True
                chbAPBPermits.Enabled = True
                chbAPBSubPartData.Enabled = True
                chbAPBSupplamentalData.Enabled = True
                chbAPPMaster.Enabled = True
                chbHBAPBAirProgramPollutants.Enabled = True
                chbHBAPBFacilityInformation.Enabled = True
                chbHBAPBHeaderData.Enabled = True
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearAPBTables()
        Try
            chbAPBAirProgramPollutants.Checked = False
            chbAPBContactInformation.Checked = False
            chbAPBFacilityInformation.Checked = False
            chbAPBHeaderData.Checked = False
            chbAPBMasterAIRS.Checked = False
            chbAPBMasterAPP.Checked = False
            chbAPBPermits.Checked = False
            chbAPBSubPartData.Checked = False
            chbAPBSupplamentalData.Checked = False
            chbAPPMaster.Checked = False
            chbHBAPBAirProgramPollutants.Checked = False
            chbHBAPBFacilityInformation.Checked = False
            chbHBAPBHeaderData.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllISMPTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllISMPTables.CheckedChanged
        Try
            If chbAllISMPTables.Checked = True Then
                chbISMPDocumentTypes.Enabled = False
                chbISMPFacilityAssignment.Enabled = False
                chbISMPMaster.Enabled = False
                chbISMPReferenceNumber.Enabled = False
                chbISMPReportFlare.Enabled = False
                chbISMPReportInformation.Enabled = False
                chbISMPReportMemo.Enabled = False
                chbISMPReportOneStack.Enabled = False
                chbISMPReportOpacity.Enabled = False
                chbISMPReportPondAndGas.Enabled = False
                chbISMPReportRATA.Enabled = False
                chbISMPReportTwoStack.Enabled = False
                chbISMPReportType.Enabled = False
                chbISMPTestFirmComments.Enabled = False
                chbISMPTestLogLink.Enabled = False
                chbISMPTestLogNumber.Enabled = False
                chbISMPTestNotification.Enabled = False
                chbISMPTestNotificationLog.Enabled = False
                chbISMPTestReportAids.Enabled = False
                chbISMPReportMemo.Enabled = False
                chbISMPTestReportMemo.Enabled = False
                chbISMPWitnessingEng.Enabled = False
                ClearISMPTables()
            Else
                chbISMPDocumentTypes.Enabled = True
                chbISMPFacilityAssignment.Enabled = True
                chbISMPMaster.Enabled = True
                chbISMPReferenceNumber.Enabled = True
                chbISMPReportFlare.Enabled = True
                chbISMPReportInformation.Enabled = True
                chbISMPReportMemo.Enabled = True
                chbISMPReportOneStack.Enabled = True
                chbISMPReportOpacity.Enabled = True
                chbISMPReportPondAndGas.Enabled = True
                chbISMPReportRATA.Enabled = True
                chbISMPReportTwoStack.Enabled = True
                chbISMPReportType.Enabled = True
                chbISMPTestFirmComments.Enabled = True
                chbISMPTestLogLink.Enabled = True
                chbISMPTestLogNumber.Enabled = True
                chbISMPTestNotification.Enabled = True
                chbISMPTestNotificationLog.Enabled = True
                chbISMPTestReportAids.Enabled = True
                chbISMPReportMemo.Enabled = True
                chbISMPTestReportMemo.Enabled = True
                chbISMPWitnessingEng.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearISMPTables()
        Try
            chbISMPDocumentTypes.Checked = False
            chbISMPFacilityAssignment.Checked = False
            chbISMPMaster.Checked = False
            chbISMPReferenceNumber.Checked = False
            chbISMPReportFlare.Checked = False
            chbISMPReportInformation.Checked = False
            chbISMPReportMemo.Checked = False
            chbISMPReportOneStack.Checked = False
            chbISMPReportOpacity.Checked = False
            chbISMPReportPondAndGas.Checked = False
            chbISMPReportRATA.Checked = False
            chbISMPReportTwoStack.Checked = False
            chbISMPReportType.Checked = False
            chbISMPTestFirmComments.Checked = False
            chbISMPTestLogLink.Checked = False
            chbISMPTestLogNumber.Checked = False
            chbISMPTestNotification.Checked = False
            chbISMPTestNotificationLog.Checked = False
            chbISMPTestReportAids.Checked = False
            chbISMPReportMemo.Checked = False
            chbISMPTestReportMemo.Checked = False
            chbISMPWitnessingEng.Checked = False

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllSBEAPTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllSBEAPTables.CheckedChanged
        Try
            If chbAllSBEAPTables.Checked = True Then
                chbSBEAPCaseLog.Enabled = False
                chbSBEAPClientContacts.Enabled = False
                chbSBEAPClientData.Enabled = False
                chbSBEAPClientLink.Enabled = False
                chbSBEAPClients.Enabled = False
                chbSBEAPErrorLog.Enabled = False
                chbHBSBEAPClientData.Enabled = False
                chbHBSBEAPClients.Enabled = False
                ClearSBEAPTables()
            Else
                chbSBEAPCaseLog.Enabled = True
                chbSBEAPClientContacts.Enabled = True
                chbSBEAPClientData.Enabled = True
                chbSBEAPClientLink.Enabled = True
                chbSBEAPClients.Enabled = True
                chbSBEAPErrorLog.Enabled = True
                chbHBSBEAPClientData.Enabled = True
                chbHBSBEAPClients.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearSBEAPTables()
        Try
            chbSBEAPCaseLog.Checked = False
            chbSBEAPClientContacts.Checked = False
            chbSBEAPClientData.Checked = False
            chbSBEAPClientLink.Checked = False
            chbSBEAPClients.Checked = False
            chbSBEAPErrorLog.Checked = False
            chbHBSBEAPClientData.Checked = False
            chbHBSBEAPClients.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllSSCPTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllSSCPTables.CheckedChanged
        Try
            If chbAllSSCPTables.Checked = True Then
                chbSSCPACCS.Enabled = False
                chbSSCPACCSHistory.Enabled = False
                chbSSCPDistrictAssignment.Enabled = False
                chbSSCPDistrictResponsible.Enabled = False
                chbSSCPEnforcement.Enabled = False
                chbSSCPEnforcementAOComments.Enabled = False
                chbSSCPEnforcementCOComments.Enabled = False
                chbSSCPEnforcementItems.Enabled = False
                chbSSCPEnforcementLetter.Enabled = False
                chbSSCPEnforcementNOVComments.Enabled = False
                chbSSCPEnforcementStipulated.Enabled = False
                chbSSCPFacilityAssignment.Enabled = False
                chbSSCPFCE.Enabled = False
                chbSSCPFCEMaster.Enabled = False
                chbSSCPInspectionActivity.Enabled = False
                chbSSCPInspections.Enabled = False
                chbSSCPInspectionsRequired.Enabled = False
                chbSSCPInspectionTracking.Enabled = False
                chbSSCPItemMaster.Enabled = False
                chbSSCPNotifications.Enabled = False
                chbSSCPReports.Enabled = False
                chbSSCPReportsHistory.Enabled = False
                chbSSCPTestReports.Enabled = False
                ClearSSCPTables()
            Else
                chbSSCPACCS.Enabled = True
                chbSSCPACCSHistory.Enabled = True
                chbSSCPDistrictAssignment.Enabled = True
                chbSSCPDistrictResponsible.Enabled = True
                chbSSCPEnforcement.Enabled = True
                chbSSCPEnforcementAOComments.Enabled = True
                chbSSCPEnforcementCOComments.Enabled = True
                chbSSCPEnforcementItems.Enabled = True
                chbSSCPEnforcementLetter.Enabled = True
                chbSSCPEnforcementNOVComments.Enabled = True
                chbSSCPEnforcementStipulated.Enabled = True
                chbSSCPFacilityAssignment.Enabled = True
                chbSSCPFCE.Enabled = True
                chbSSCPFCEMaster.Enabled = True
                chbSSCPInspectionActivity.Enabled = True
                chbSSCPInspections.Enabled = True
                chbSSCPInspectionsRequired.Enabled = True
                chbSSCPInspectionTracking.Enabled = True
                chbSSCPItemMaster.Enabled = True
                chbSSCPNotifications.Enabled = True
                chbSSCPReports.Enabled = True
                chbSSCPReportsHistory.Enabled = True
                chbSSCPTestReports.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearSSCPTables()
        Try
            chbSSCPACCS.Checked = False
            chbSSCPACCSHistory.Checked = False
            chbSSCPDistrictAssignment.Checked = False
            chbSSCPDistrictResponsible.Checked = False
            chbSSCPEnforcement.Checked = False
            chbSSCPEnforcementAOComments.Checked = False
            chbSSCPEnforcementCOComments.Checked = False
            chbSSCPEnforcementItems.Checked = False
            chbSSCPEnforcementLetter.Checked = False
            chbSSCPEnforcementNOVComments.Checked = False
            chbSSCPEnforcementStipulated.Checked = False
            chbSSCPFacilityAssignment.Checked = False
            chbSSCPFCE.Checked = False
            chbSSCPFCEMaster.Checked = False
            chbSSCPInspectionActivity.Checked = False
            chbSSCPInspections.Checked = False
            chbSSCPInspectionsRequired.Checked = False
            chbSSCPInspectionTracking.Checked = False
            chbSSCPItemMaster.Checked = False
            chbSSCPNotifications.Checked = False
            chbSSCPReports.Checked = False
            chbSSCPReportsHistory.Checked = False
            chbSSCPTestReports.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllSSPPTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllSSPPTables.CheckedChanged
        Try
            If chbAllSSPPTables.Checked = True Then
                chbSSPPApplicationContact.Enabled = False
                chbSSPPApplicationData.Enabled = False
                chbSSPPApplicationInformation.Enabled = False
                chbSSPPApplicationLinking.Enabled = False
                chbSSPPApplicationMaster.Enabled = False
                chbSSPPApplicationQuality.Enabled = False
                chbSSPPApplicationTracking.Enabled = False
                chbSSPPCDS.Enabled = False
                chbSSPPPublicLetters.Enabled = False
                ClearSSPPTables()
            Else
                chbSSPPApplicationContact.Enabled = True
                chbSSPPApplicationData.Enabled = True
                chbSSPPApplicationInformation.Enabled = True
                chbSSPPApplicationLinking.Enabled = True
                chbSSPPApplicationMaster.Enabled = True
                chbSSPPApplicationQuality.Enabled = True
                chbSSPPApplicationTracking.Enabled = True
                chbSSPPCDS.Enabled = True
                chbSSPPPublicLetters.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearSSPPTables()
        Try
            chbSSPPApplicationContact.Checked = False
            chbSSPPApplicationData.Checked = False
            chbSSPPApplicationInformation.Checked = False
            chbSSPPApplicationLinking.Checked = False
            chbSSPPApplicationMaster.Checked = False
            chbSSPPApplicationQuality.Checked = False
            chbSSPPApplicationTracking.Checked = False
            chbSSPPCDS.Checked = False
            chbSSPPPublicLetters.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub chbAllAFSTables_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chbAllAFSTables.CheckedChanged
        Try
            If chbAllAFSTables.Checked = True Then
                chbAFSAirPollutantData.Enabled = False
                chbAFSBatchFiles.Enabled = False
                chbAFSFacilityData.Enabled = False
                chbAFSISMPRecords.Enabled = False
                chbAFSSSCPEnforcementRecords.Enabled = False
                chbAFSSSCPFCERecords.Enabled = False
                chbAFSSSCPRecords.Enabled = False
                chbAFSSSPPRecords.Enabled = False
                ClearAFSTables()
            Else
                chbAFSAirPollutantData.Enabled = True
                chbAFSBatchFiles.Enabled = True
                chbAFSFacilityData.Enabled = True
                chbAFSISMPRecords.Enabled = True
                chbAFSSSCPEnforcementRecords.Enabled = True
                chbAFSSSCPFCERecords.Enabled = True
                chbAFSSSCPRecords.Enabled = True
                chbAFSSSPPRecords.Enabled = True
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Sub ClearAFSTables()
        Try
            chbAFSAirPollutantData.Checked = False
            chbAFSBatchFiles.Checked = False
            chbAFSFacilityData.Checked = False
            chbAFSISMPRecords.Checked = False
            chbAFSSSCPEnforcementRecords.Checked = False
            chbAFSSSCPFCERecords.Checked = False
            chbAFSSSCPRecords.Checked = False
            chbAFSSSPPRecords.Checked = False
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnClearSelection_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnClearSelection.Click
        Try
            chbAllTables.Checked = False
            chbAllLookUpTables.Checked = False
            chbAllHeaderTables.Checked = False
            chbAllISMPTables.Checked = False
            chbAllSBEAPTables.Checked = False
            chbAllSSCPTables.Checked = False
            chbAllSSPPTables.Checked = False
            chbAllAFSTables.Checked = False

            ClearLookUpTables()
            ClearAPBTables()
            ClearISMPTables()
            ClearSBEAPTables()
            ClearSSCPTables()
            ClearSSPPTables()
            ClearAFSTables()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnTransferData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnTransferData.Click
        Try
            btnTransferData.Enabled = False
            btnClearSelection.Enabled = False
            lblTransfer.Text = "Data Transfer in Progress."

            If rdbDEVTransfer.Checked = True Then
                If Oracledll = "2.111.6.20" Then
                    transferConn = New OracleConnection("Data Source = leia.dnr.state.ga.us:1521/DEV; User ID = AirBranch; " & _
                             "Password = " & SimpleCrypt("") & ";")
                Else
                    transferConn = New OracleConnection("data Source = DEV; " & _
                                       "User ID = AIRBranch; Password = smogalert;")
                End If
            Else
                If Oracledll = "2.111.6.20" Then
                    transferConn = New OracleConnection("Data Source = leia.dnr.state.ga.us:1521/TEST; User ID = AIRBRANCH_APP_USER; " & _
                            "Password = " & SimpleCrypt("") & ";")
                Else
                    transferConn = New OracleConnection("Data Source = TEST; " & _
                                       "User ID = AIRBRANCH_APP_USER; Password = AIRAPPUSER03;")
                End If
            End If

            bgwTransfer.WorkerReportsProgress = True
            bgwTransfer.WorkerSupportsCancellation = True
            bgwTransfer.RunWorkerAsync()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub

#End Region

    Private Sub bgwTransfer_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles bgwTransfer.DoWork
        If chbAllLookUpTables.Checked = True Then
            TransferLookUpAPBManagement()
            TransferLookUpApplicationType()
            TransferLookUpComplianceActivities()
            TransferLookUpComplianceStatus()
            TransferLookUpComplinaceUnits()
            TransferLookUpCountyInformation()
            TransferLookUpDistrictInformation()
            TransferLookUpDistrictOffice()
            TransferLookUpDistricts()
            transferLookUpEPDBranches()
            TransferLookUpEPDPrograms()
            TransferLookUpEPDUnits()
            TransferLookUpHPVViolations()
            TransferLookUpIAIPAccounts()
            TransferLookUpIAIPForms()
            TransferLookUPISMPComplianceStatus()
            TransferLookUpISMPMethods()
            TransferLookUpMonitoringUnits()
            TransferLookUpNonAttainment()
            TransferLookUpPermittingUnits()
            TransferLookUpPermitType()
            TransferLookUpPollutants()
            TransferLookUpSBEAPCaseWork()
            TransferLookUpSICCodes()
            TransferLookUpSSCPNotifications()
            TransferLookUpStates()
            TransferLookUpSubPart60()
            TransferLookUpSubPart61()
            TransferLookUpSubPart63()
            TransferLookUpSubPartSIP()
            TransferLookUpTestingFirms()
            TransferLookUpUnits()
            TransferEDPUsers()
            TransferNSPSReason()
            TransferEISI()
            TransferEIEU()
            TransferEIER()
            TransferEIEP()
            TransferEIEM()
        Else
            If chbLookUpAPBManagement.Checked = True Then
                TransferLookUpAPBManagement()
            End If
            If chbLookUpApplicationType.Checked = True Then
                TransferLookUpApplicationType()
            End If
            If chbLookUpComplianceActivities.Checked = True Then
                TransferLookUpComplianceActivities()
            End If
            If chbLookUpComplianceStatus.Checked = True Then
                TransferLookUpComplianceStatus()
            End If
            If chbLookUpComplianceUnits.Checked = True Then
                TransferLookUpComplinaceUnits()
            End If
            If chbLookUpCountyInformation.Checked = True Then
                TransferLookUpCountyInformation()
            End If
            If chbLookUpDistrictInformation.Checked = True Then
                TransferLookUpDistrictInformation()
            End If
            If chbLookUpDistrictOffice.Checked = True Then
                TransferLookUpDistrictOffice()
            End If
            If chbLookUpDistricts.Checked = True Then
                TransferLookUpDistricts()
            End If
            If chbLookUpEPDBranches.Checked = True Then
                transferLookUpEPDBranches()
            End If
            If chbLookUpEPDPrograms.Checked = True Then
                TransferLookUpEPDPrograms()
            End If
            If chbLookUpEPDUnits.Checked = True Then
                TransferLookUpEPDUnits()
            End If
            If chbLookUpHPVViolations.Checked = True Then
                TransferLookUpHPVViolations()
            End If
            If chbLookUpIAIPAccounts.Checked = True Then
                TransferLookUpIAIPAccounts()
            End If
            If chbLookUpIAIPForms.Checked = True Then
                TransferLookUpIAIPForms()
            End If
            If chbLookUpISMPComplianceStatus.Checked = True Then
                TransferLookUPISMPComplianceStatus()
            End If
            If chbLookUpISMPMethods.Checked = True Then
                TransferLookUpISMPMethods()
            End If
            If chbLookUpMonitoringUnits.Checked = True Then
                TransferLookUpMonitoringUnits()
            End If
            If chbLookUpNonAttainment.Checked = True Then
                TransferLookUpNonAttainment()
            End If
            If chbLookUpPermittingUnits.Checked = True Then
                TransferLookUpPermittingUnits()
            End If
            If chbLookUpPermitTypes.Checked = True Then
                TransferLookUpPermitType()
            End If
            If chbLookUpPollutants.Checked = True Then
                TransferLookUpPollutants()
            End If
            If chbLookUpSBEAPCaseWork.Checked = True Then
                TransferLookUpSBEAPCaseWork()
            End If
            If chbLookUpSICCodes.Checked = True Then
                TransferLookUpSICCodes()
            End If
            If chbLookUpSSCPNotifications.Checked = True Then
                TransferLookUpSSCPNotifications()
            End If
            If chbLookUpStates.Checked = True Then
                TransferLookUpStates()
            End If
            If chbLookUpSubPart60.Checked = True Then
                TransferLookUpSubPart60()
            End If
            If chbLookUpSubPart61.Checked = True Then
                TransferLookUpSubPart61()
            End If
            If chbLookUpSubPart63.Checked = True Then
                TransferLookUpSubPart63()
            End If
            If chbLookUpSubPartSIP.Checked = True Then
                TransferLookUpSubPartSIP()
            End If
            If chbLookUpTestingFirms.Checked = True Then
                TransferLookUpTestingFirms()
            End If
            If chbLookUpUnits.Checked = True Then
                transferLookUpUnits()
            End If
            If chbEPDUsers.Checked = True Then
                TransferEDPUsers()
            End If
            If chbUpdateEISI.Checked = True Then
                TransferEISI()
            End If
            If chbUpdateEIEU.Checked = True Then
                TransferEIEU()
            End If
            If chbUpdateEIER.Checked = True Then
                TransferEIER()
            End If
            If chbUpdateEIEP.Checked = True Then
                TransferEIEP()
            End If
            If chbUpdateEIEM.Checked = True Then
                TransferEIEM()
            End If
            If chbFSNSPSReason.Checked = True Then
                TransferNSPSReason()
            End If
        End If
        If chbAllHeaderTables.Checked = True Then
            transferAPBAirProgramPollutants()
            TransferAPBContactInformation()
            TransferAPBFacilityInformation()
            TransferAPBHeaderData()
            TransferAPBMasterAIRS()
            TransferAPBMasterAPP()
            TransferAPBPermits()
            TransferAPBSubPartData()
            TransferAPBSupplamentalData()

            TransferAPPMaster()
            TransferHBAPBAirProgramPollutants()
            TransferHBAPBFacilityINformation()
            TransferHBAPBHeaderData()
        Else
            If chbAPBAirProgramPollutants.Checked = True Then
                transferAPBAirProgramPollutants()
            End If
            If chbAPBContactInformation.Checked = True Then
                TransferAPBContactInformation()
            End If
            If chbAPBFacilityInformation.Checked = True Then
                TransferAPBFacilityInformation()
            End If
            If chbAPBHeaderData.Checked = True Then
                TransferAPBHeaderData()
            End If
            If chbAPBMasterAIRS.Checked = True Then
                TransferAPBMasterAIRS()
            End If
            If chbAPBMasterAPP.Checked = True Then
                TransferAPBMasterAPP()
            End If
            If chbAPBPermits.Checked = True Then
                TransferAPBPermits()
            End If
            If chbAPBSubPartData.Checked = True Then
                TransferAPBSubPartData()
            End If
            If chbAPBSupplamentalData.Checked = True Then
                TransferAPBSupplamentalData()
            End If
            If chbAPPMaster.Checked = True Then
                TransferAPPMaster()
            End If
            If chbHBAPBAirProgramPollutants.Checked = True Then
                TransferHBAPBAirProgramPollutants()
            End If
            If chbHBAPBFacilityInformation.Checked = True Then
                TransferHBAPBFacilityINformation()
            End If
            If chbHBAPBHeaderData.Checked = True Then
                TransferHBAPBHeaderData()
            End If
        End If
        If chbAllISMPTables.Checked = True Then
            TransferISMPDocumentTypes()
            TransferISMPFacilityAssignment()
            TransferISMPMaster()
            TransferISMPReferenceNumber()
            TransferISMPReportFlare()
            TransferISMPReportInformation()
            TransferISMPREportMemo()
            TransferISMPReportOneStack()
            TransferISMPREportOpacity()
            TransferISMPREportPondAndGas()
            TransferISMPReportRATA()
            TransferISMPREportTwoStack()
            TransferISMPReportType()
            TransferISMPTestFirmComments()
            TransferISMPTestLogLink()
            TransferISMPTestLogNumber()
            TransferISMPTestNotification()
            TransferISMPTestNotificationLog()
            TransferISMPTestREportAids()
            TransferISMPTestREportMemo()
            TransferISMPWitnessingEng()
        Else
            If chbISMPDocumentTypes.Checked = True Then
                TransferISMPDocumentTypes()
            End If
            If chbISMPFacilityAssignment.Checked = True Then
                TransferISMPFacilityAssignment()
            End If
            If chbISMPMaster.Checked = True Then
                TransferISMPMaster()
            End If
            If chbISMPReferenceNumber.Checked = True Then
                TransferISMPReferenceNumber()
            End If
            If chbISMPReportFlare.Checked = True Then
                TransferISMPReportFlare()
            End If
            If chbISMPReportInformation.Checked = True Then
                TransferISMPReportInformation()
            End If
            If chbISMPReportMemo.Checked = True Then
                TransferISMPREportMemo()
            End If
            If chbISMPReportOneStack.Checked = True Then
                TransferISMPReportOneStack()
            End If
            If chbISMPReportOpacity.Checked = True Then
                TransferISMPREportOpacity()
            End If
            If chbISMPReportPondAndGas.Checked = True Then
                TransferISMPREportPondAndGas()
            End If
            If chbISMPReportRATA.Checked = True Then
                TransferISMPReportRATA()
            End If
            If chbISMPReportTwoStack.Checked = True Then
                TransferISMPREportTwoStack()
            End If
            If chbISMPReportType.Checked = True Then
                TransferISMPReportType()
            End If
            If chbISMPTestFirmComments.Checked = True Then
                TransferISMPTestFirmComments()
            End If
            If chbISMPTestLogLink.Checked = True Then
                TransferISMPTestLogLink()
            End If
            If chbISMPTestLogNumber.Checked = True Then
                TransferISMPTestLogNumber()
            End If
            If chbISMPTestNotification.Checked = True Then
                TransferISMPTestNotification()
            End If
            If chbISMPTestNotificationLog.Checked = True Then
                TransferISMPTestNotificationLog()
            End If
            If chbISMPTestReportAids.Checked = True Then
                TransferISMPTestREportAids()
            End If
            If chbISMPTestReportMemo.Checked = True Then
                TransferISMPTestREportMemo()
            End If
            If chbISMPWitnessingEng.Checked = True Then
                TransferISMPWitnessingEng()
            End If
        End If
        If chbAllSSCPTables.Checked = True Then
            TransferSSCPACCS()
            TransferSSCPACCSHistory()
            TransferSSCPDistrictAssignment()
            TransferSSCPDistrictResponsible()
            TransferSSCPEnforcement()
            TransferSSCPEnforcementAOComments()
            TransferSSCPEnforcementCOComments()
            TransferSSCPEnforcementItems()
            TransferSSCPEnforcementLetter()
            TransferSSCPEnforceNOVComments()
            TransferSSCPEnforcementStipulated()
            ' TransferSSCPFacilityAssignment()
            TransferSSCPFCE()
            TransferSSCPFCEMaster()
            TransferSSCPInspectionActivity()
            TransferSSCPInspections()
            TransferSSCPInspectionsRequired()
            TransferSSCPInspectionTracking()
            TransferSSCPItemMaster()
            TransferSSCPNotifications()
            TransferSSCPReports()
            TransferSSCPReportsHistory()
            TransferSSCPTestReports()
        Else
            If chbSSCPACCS.Checked = True Then
                TransferSSCPACCS()
            End If
            If chbSSCPACCSHistory.Checked = True Then
                TransferSSCPACCSHistory()
            End If
            If chbSSCPDistrictAssignment.Checked = True Then
                TransferSSCPDistrictAssignment()
            End If
            If chbSSCPDistrictResponsible.Checked = True Then
                TransferSSCPDistrictResponsible()
            End If
            If chbSSCPEnforcement.Checked = True Then
                TransferSSCPEnforcement()
            End If
            If chbSSCPEnforcementAOComments.Checked = True Then
                TransferSSCPEnforcementAOComments()
            End If
            If chbSSCPEnforcementCOComments.Checked = True Then
                TransferSSCPEnforcementCOComments()
            End If
            If chbSSCPEnforcementItems.Checked = True Then
                TransferSSCPEnforcementItems()
            End If
            If chbSSCPEnforcementLetter.Checked = True Then
                TransferSSCPEnforcementLetter()
            End If
            If chbSSCPEnforcementNOVComments.Checked = True Then
                TransferSSCPEnforceNOVComments()
            End If
            If chbSSCPEnforcementStipulated.Checked = True Then
                TransferSSCPEnforcementStipulated()
            End If
            If chbSSCPFacilityAssignment.Checked = True Then
                '  TransferSSCPFacilityAssignment()
            End If
            If chbSSCPFCE.Checked = True Then
                TransferSSCPFCE()
            End If
            If chbSSCPFCEMaster.Checked = True Then
                TransferSSCPFCEMaster()
            End If
            If chbSSCPInspectionActivity.Checked = True Then
                TransferSSCPInspectionActivity()
            End If
            If chbSSCPInspections.Checked = True Then
                TransferSSCPInspections()
            End If
            If chbSSCPInspectionsRequired.Checked = True Then
                TransferSSCPInspectionsRequired()
            End If
            If chbSSCPInspectionTracking.Checked = True Then
                TransferSSCPInspectionTracking()
            End If
            If chbSSCPNotifications.Checked = True Then
                TransferSSCPNotifications()
            End If
            If chbSSCPReports.Checked = True Then
                TransferSSCPReports()
            End If
            If chbSSCPReportsHistory.Checked = True Then
                TransferSSCPReportsHistory()
            End If
            If chbSSCPTestReports.Checked = True Then
                TransferSSCPTestReports()
            End If
        End If
        If chbAllSSPPTables.Checked = True Then
            TransferSSPPApplicationContact()
            TransferSSPPApplicationData()
            TransferSSPPApplicationInformation()
            TransferSSPPApplicationLinking()
            TransferSSPPApplicationMaster()
            TransferSSPPApplicationQuality()
            TransferSSPPApplicationTracking()
            TransferSSPPCDS()
            TransferSSPPPublicLetters()
        Else
            If chbSSPPApplicationContact.Checked = True Then
                TransferSSPPApplicationContact()
            End If
            If chbSSPPApplicationData.Checked = True Then
                TransferSSPPApplicationData()
            End If
            If chbSSPPApplicationInformation.Checked = True Then
                TransferSSPPApplicationInformation()
            End If
            If chbSSPPApplicationLinking.Checked = True Then
                TransferSSPPApplicationLinking()
            End If
            If chbSSPPApplicationMaster.Checked = True Then
                TransferSSPPApplicationMaster()
            End If
            If chbSSPPApplicationQuality.Checked = True Then
                TransferSSPPApplicationQuality()
            End If
            If chbSSPPApplicationTracking.Checked = True Then
                TransferSSPPApplicationTracking()
            End If
            If chbSSPPCDS.Checked = True Then
                TransferSSPPCDS()
            End If
            If chbSSPPPublicLetters.Checked = True Then
                TransferSSPPPublicLetters()
            End If
        End If

        If chbAllAFSTables.Checked = True Then
            TransferAFSAirPollutantDate()
            TransferAFSBatchFile()
            TransferAFSFacilityData()
            TransferAFSISMPRecords()
            TransferAFSSSCPEnforcementRecords()
            TransferAFSSSCPFCERecords()
            TransferAFSSSCPRecords()
            TransferAFSSSPPRecords()
        Else
            If chbAFSAirPollutantData.Checked = True Then
                TransferAFSAirPollutantDate()
            End If
            If chbAFSBatchFiles.Checked = True Then
                TransferAFSBatchFile()
            End If
            If chbAFSFacilityData.Checked = True Then
                TransferAFSFacilityData()
            End If
            If chbAFSISMPRecords.Checked = True Then
                TransferAFSISMPRecords()
            End If
            If chbAFSSSCPEnforcementRecords.Checked = True Then
                TransferAFSSSCPEnforcementRecords()
            End If
            If chbAFSSSCPFCERecords.Checked = True Then
                TransferAFSSSCPFCERecords()
            End If
            If chbAFSSSCPRecords.Checked = True Then
                TransferAFSSSCPRecords()
            End If
            If chbAFSSSPPRecords.Checked = True Then
                TransferAFSSSPPRecords()
            End If
        End If



    End Sub
    Sub TransferLookUpAPBManagement()
        SQL = "Select * " & _
           "from " & DBNameSpace & ".LOOKUPAPBMANAGEMENT "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        SQL = "DELETE " & DBNameSpace & ".LOOKUPAPBMANAGEMENT "
        cmd = New OracleCommand(SQL, transferConn)
        If transferConn.State = ConnectionState.Closed Then
            transferConn.Open()
        End If
        dr = cmd.ExecuteReader
        dr.Close()

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRDIRECTOR")) Then
                temp = ""
            Else
                temp = drDSRow("STRDIRECTOR")
            End If
            If IsDBNull(drDSRow("STRCOMMISSIONER")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRCOMMISSIONER")
            End If
            If IsDBNull(drDSRow("STRISMPPROGRAMMANG")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRISMPPROGRAMMANG")
            End If
            If IsDBNull(drDSRow("STRSSCPPROGRAMMANG")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRSSCPPROGRAMMANG")
            End If
            If IsDBNull(drDSRow("STRSSPPPROGRAMMANG")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRSSPPPROGRAMMANG")
            End If

            SQL = "Insert into " & DBNameSpace & ".LOOKUPAPBMANAGEMENT " & _
            "Values " & _
            "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
            "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
            "'" & Replace(temp5, "'", "''") & "') "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpApplicationType()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPAPPLICATIONTYPES "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAPPLICATIONTYPECODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRAPPLICATIONTYPECODE")
            End If
            If IsDBNull(drDSRow("STRAPPLICATIONTYPEDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAPPLICATIONTYPEDESC")
            End If
            If IsDBNull(drDSRow("STRAPPLICATIONTYPEUSED")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRAPPLICATIONTYPEUSED")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPAPPLICATIONTYPES " & _
            "WHERE STRAPPLICATIONTYPECODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPAPPLICATIONTYPES " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPAPPLICATIONTYPES SET " & _
                "STRAPPLICATIONTYPECODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRAPPLICATIONTYPEDESC = '" & Replace(temp2, "'", "''") & "', " & _
                "STRAPPLICATIONTYPEUSED = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRAPPLICATIONTYPECODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpComplianceActivities()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPCOMPLIANCEACTIVITIES "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRACTIVITYTYPE")) Then
                temp = ""
            Else
                temp = drDSRow("STRACTIVITYTYPE")
            End If
            If IsDBNull(drDSRow("STRACTIVITYNAME")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRACTIVITYNAME")
            End If
            If IsDBNull(drDSRow("STRACTIVITYDESCRIPTION")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRACTIVITYDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPCOMPLIANCEACTIVITIES " & _
            "WHERE STRACTIVITYTYPE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPCOMPLIANCEACTIVITIES " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPCOMPLIANCEACTIVITIES SET " & _
                "STRACTIVITYTYPE = '" & Replace(temp, "'", "''") & "', " & _
                "STRACTIVITYNAME = '" & Replace(temp2, "'", "''") & "', " & _
                "STRACTIVITYDESCRIPTION = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRACTIVITYTYPE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpComplianceStatus()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPCOMPLIANCESTATUS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRCOMPLIANCECODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRCOMPLIANCECODE")
            End If
            If IsDBNull(drDSRow("STRCOMPLIANCEDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRCOMPLIANCEDESC")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPCOMPLIANCESTATUS " & _
            "WHERE STRCOMPLIANCECODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPCOMPLIANCESTATUS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPCOMPLIANCESTATUS SET " & _
                "STRCOMPLIANCECODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRCOMPLIANCEDESC = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRCOMPLIANCECODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpComplinaceUnits()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPCOMPLIANCEUNITS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRCOMPLIANCEUNIT")) Then
                temp = ""
            Else
                temp = drDSRow("STRCOMPLIANCEUNIT")
            End If
            If IsDBNull(drDSRow("STRUNITTITLE")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRUNITTITLE")
            End If
            If IsDBNull(drDSRow("STRUNITMANAGER")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRUNITMANAGER")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPCOMPLIANCEUNITS " & _
            "WHERE STRCOMPLIANCEUNIT = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPCOMPLIANCEUNITS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPCOMPLIANCEUNITS SET " & _
                "STRCOMPLIANCEUNIT = '" & Replace(temp, "'", "''") & "', " & _
                "STRUNITTITLE = '" & Replace(temp2, "'", "''") & "', " & _
                "STRUNITMANAGER = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRCOMPLIANCEUNIT = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpCountyInformation()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPCOUNTYINFORMATION "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRCOUNTYCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRCOUNTYCODE")
            End If
            If IsDBNull(drDSRow("STRCOUNTYNAME")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRCOUNTYNAME")
            End If
            If IsDBNull(drDSRow("STRATTAINMENTSTATUS")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRATTAINMENTSTATUS")
            End If
            If IsDBNull(drDSRow("STRNONATTAINMENT")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRNONATTAINMENT")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPCOUNTYINFORMATION " & _
            "WHERE STRCOUNTYCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPCOUNTYINFORMATION " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPCOUNTYINFORMATION SET " & _
                "STRCOUNTYCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRCOUNTYNAME = '" & Replace(temp2, "'", "''") & "', " & _
                "STRATTAINMENTSTATUS = '" & Replace(temp3, "'", "''") & "', " & _
                "STRNONATTAINMENT = '" & Replace(temp4, "'", "''") & "' " & _
                "WHERE STRCOUNTYCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next


    End Sub
    Sub TransferLookUpDistrictInformation()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPDISTRICTINFORMATION "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRDISTRICTCOUNTY")) Then
                temp = ""
            Else
                temp = drDSRow("STRDISTRICTCOUNTY")
            End If
            If IsDBNull(drDSRow("STRDISTRICTCODE")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDISTRICTCODE")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPDISTRICTINFORMATION " & _
            "WHERE STRDISTRICTCOUNTY = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPDISTRICTINFORMATION " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPDISTRICTINFORMATION SET " & _
                "STRDISTRICTCOUNTY = '" & Replace(temp, "'", "''") & "', " & _
                "STRDISTRICTCODE = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRDISTRICTCOUNTY = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpDistrictOffice()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPDISTRICTOFFICE "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRDISTRICTCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRDISTRICTCODE")
            End If
            If IsDBNull(drDSRow("STROFFICENAME")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STROFFICENAME")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPDISTRICTOFFICE " & _
            "WHERE STRDISTRICTCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPDISTRICTOFFICE " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPDISTRICTOFFICE SET " & _
                "STRDISTRICTCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STROFFICENAME = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRDISTRICTCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpDistricts()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPDISTRICTS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRDISTRICTCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRDISTRICTCODE")
            End If
            If IsDBNull(drDSRow("STRDISTRICTNAME")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDISTRICTNAME")
            End If
            If IsDBNull(drDSRow("STRDISTRICTMANAGER")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRDISTRICTMANAGER")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPDISTRICTS " & _
            "WHERE STRDISTRICTCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPDISTRICTS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPDISTRICTS SET " & _
                "STRDISTRICTCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRDISTRICTNAME = '" & Replace(temp2, "'", "''") & "', " & _
                "STRDISTRICTMANAGER = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRDISTRICTCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpEPDBranches()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPEPDBranches "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numbranchCode")) Then
                temp = ""
            Else
                temp = drDSRow("numbranchCode")
            End If
            If IsDBNull(drDSRow("strBranchDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strBranchDESC")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPEPDBranches " & _
            "WHERE numbranchCode = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPEPDBranches " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPEPDBranches SET " & _
                "numbranchCode = '" & Replace(temp, "'", "''") & "', " & _
                "strBranchDESC = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE numbranchCode = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpEPDPrograms()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".LOOKUPEPDPrograms "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numProgramCode")) Then
                temp = ""
            Else
                temp = drDSRow("numProgramCode")
            End If
            If IsDBNull(drDSRow("strProgramDesc")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strProgramDesc")
            End If
            If IsDBNull(drDSRow("numBranchCode")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("numBranchCode")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPEPDPrograms " & _
            "WHERE numProgramCode = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPEPDPrograms " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPEPDPrograms SET " & _
                "numProgramCode = '" & Replace(temp, "'", "''") & "', " & _
                "strProgramDesc = '" & Replace(temp2, "'", "''") & "', " & _
                "numBranchCode = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE numProgramCode = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpEPDUnits()
        SQL = "Select * " & _
                    "from " & DBNameSpace & ".LookUpEPDUnits "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numUnitCode")) Then
                temp = ""
            Else
                temp = drDSRow("numUnitCode")
            End If
            If IsDBNull(drDSRow("strUnitDesc")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strUnitDesc")
            End If
            If IsDBNull(drDSRow("numProgramCode")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("numProgramCode")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LookUpEPDUnits " & _
            "WHERE numUnitCode = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LookUpEPDUnits " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LookUpEPDUnits SET " & _
                "numUnitCode = '" & Replace(temp, "'", "''") & "', " & _
                "strUnitDesc = '" & Replace(temp2, "'", "''") & "', " & _
                "numProgramCode = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE numUnitCode = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpHPVViolations()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPHPVVIOLATIONS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRHPVVIOLATIONDESC")) Then
                temp = ""
            Else
                temp = drDSRow("STRHPVVIOLATIONDESC")
            End If
            If IsDBNull(drDSRow("STRHPVCODE")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRHPVCODE")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPHPVVIOLATIONS " & _
            "WHERE STRHPVCODE = '" & Replace(temp, "'", "''") & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPHPVVIOLATIONS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPHPVVIOLATIONS SET " & _
                "STRHPVVIOLATIONDESC = '" & Replace(temp, "'", "''") & "', " & _
                "STRHPVCODE = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRHPVCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpIAIPAccounts()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LookupIAIPAccounts "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numAccountCode")) Then
                temp = ""
            Else
                temp = drDSRow("numAccountCode")
            End If
            If IsDBNull(drDSRow("strAccountDesc")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAccountDesc")
            End If
            If IsDBNull(drDSRow("numBranchCode")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("numBranchCode")
            End If
            If IsDBNull(drDSRow("numProgramCode")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("numProgramCode")
            End If
            If IsDBNull(drDSRow("numUnitCode")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("numUnitCode")
            End If
            If IsDBNull(drDSRow("strFormAccess")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strFormAccess")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LookupIAIPAccounts " & _
            "WHERE numAccountCode = '" & Replace(temp, "'", "''") & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LookupIAIPAccounts " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LookupIAIPAccounts SET " & _
                "numAccountCode = '" & Replace(temp, "'", "''") & "', " & _
                "strAccountDesc = '" & Replace(temp2, "'", "''") & "', " & _
                "numBranchCode = '" & Replace(temp3, "'", "''") & "', " & _
                "numProgramCode = '" & Replace(temp4, "'", "''") & "', " & _
                "numUnitCode = '" & Replace(temp5, "'", "''") & "', " & _
                "strFormAccess = '" & Replace(temp6, "'", "''") & "'  " & _
                "WHERE numAccountCode = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpIAIPForms()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LookUpIAIPForms "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numFormCode")) Then
                temp = ""
            Else
                temp = drDSRow("numFormCode")
            End If
            If IsDBNull(drDSRow("strForm")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strForm")
            End If
            If IsDBNull(drDSRow("strFormDesc")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strFormDesc")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LookUpIAIPForms " & _
            "WHERE numFormCode = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LookUpIAIPForms " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LookUpIAIPForms SET " & _
                "numFormCode = '" & Replace(temp, "'", "''") & "', " & _
                "strForm = '" & Replace(temp2, "'", "''") & "', " & _
                "strFormDesc = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE numFormCode = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUPISMPComplianceStatus()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".LookUpISMPComplianceStatus "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strComplianceKey")) Then
                temp = ""
            Else
                temp = drDSRow("strComplianceKey")
            End If
            If IsDBNull(drDSRow("strComplianceStatus")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strComplianceStatus")
            End If
            If IsDBNull(drDSRow("strComplianceStatement")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strComplianceStatement")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LookUpISMPComplianceStatus " & _
            "WHERE strComplianceKey = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LookUpISMPComplianceStatus " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LookUpISMPComplianceStatus SET " & _
                "strComplianceKey = '" & Replace(temp, "'", "''") & "', " & _
                "strComplianceStatus = '" & Replace(temp2, "'", "''") & "', " & _
                "strComplianceStatement = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE strComplianceKey = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpISMPMethods()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPISMPMETHODS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRMETHODCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRMETHODCODE")
            End If
            If IsDBNull(drDSRow("STRMETHODDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRMETHODDESC")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPISMPMETHODS " & _
            "WHERE STRMETHODCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPISMPMETHODS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPISMPMETHODS SET " & _
                "STRMETHODCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRMETHODDESC = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRMETHODCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpMonitoringUnits()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPMONITORINGUNITS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRMONITORINGUNIT")) Then
                temp = ""
            Else
                temp = drDSRow("STRMONITORINGUNIT")
            End If
            If IsDBNull(drDSRow("STRUNITTITLE")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRUNITTITLE")
            End If
            If IsDBNull(drDSRow("STRUNITMANAGER")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRUNITMANAGER")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPMONITORINGUNITS " & _
            "WHERE STRMONITORINGUNIT = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPMONITORINGUNITS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPMONITORINGUNITS SET " & _
                "STRMONITORINGUNIT = '" & Replace(temp, "'", "''") & "', " & _
                "STRUNITTITLE = '" & Replace(temp2, "'", "''") & "', " & _
                "STRUNITMANAGER = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRMONITORINGUNIT = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpNonAttainment()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPNONATTAINMENT "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRCOUNTYCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRCOUNTYCODE")
            End If
            If IsDBNull(drDSRow("STRATTAINMENTSTATUS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRATTAINMENTSTATUS")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPNONATTAINMENT " & _
            "WHERE STRCOUNTYCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPNONATTAINMENT " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPNONATTAINMENT SET " & _
                "STRCOUNTYCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRATTAINMENTSTATUS = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRCOUNTYCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpPermittingUnits()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPPERMITTINGUNITS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRMONITORINGUNIT")) Then
                temp = ""
            Else
                temp = drDSRow("STRMONITORINGUNIT")
            End If
            If IsDBNull(drDSRow("STRUNITTITLE")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRUNITTITLE")
            End If
            If IsDBNull(drDSRow("STRUNITMANAGER")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRUNITMANAGER")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPPERMITTINGUNITS " & _
            "WHERE STRMONITORINGUNIT = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPPERMITTINGUNITS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPPERMITTINGUNITS SET " & _
                "STRMONITORINGUNIT = '" & Replace(temp, "'", "''") & "', " & _
                "STRUNITTITLE = '" & Replace(temp2, "'", "''") & "', " & _
                "STRUNITMANAGER = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRMONITORINGUNIT = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpPermitType()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPPERMITTYPES "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRPERMITTYPECODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRPERMITTYPECODE")
            End If
            If IsDBNull(drDSRow("STRPERMITTYPEDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRPERMITTYPEDESCRIPTION")
            End If
            If IsDBNull(drDSRow("STRTYPEUSED")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRTYPEUSED")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPPERMITTYPES " & _
            "WHERE STRPERMITTYPECODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPPERMITTYPES " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPPERMITTYPES SET " & _
                "STRPERMITTYPECODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRPERMITTYPEDESCRIPTION = '" & Replace(temp2, "'", "''") & "', " & _
                "STRTYPEUSED = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRPERMITTYPECODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpPollutants()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPPOLLUTANTS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRPOLLUTANTCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRPOLLUTANTCODE")
            End If
            If IsDBNull(drDSRow("STRPOLLUTANTDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRPOLLUTANTDESCRIPTION")
            End If
            If IsDBNull(drDSRow("STRAFSCODE")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRAFSCODE")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPPOLLUTANTS " & _
            "WHERE STRPOLLUTANTCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPPOLLUTANTS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPPOLLUTANTS SET " & _
                "STRPOLLUTANTCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRPOLLUTANTDESCRIPTION = '" & Replace(temp2, "'", "''") & "', " & _
                "STRAFSCODE = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRPOLLUTANTCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpSBEAPCaseWork()

    End Sub
    Sub TransferLookUpSICCodes()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSICCODES "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSICCODE")) Then
                temp = ""
            Else
                temp = drDSRow("STRSICCODE")
            End If
            If IsDBNull(drDSRow("STRSICDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRSICDESC")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSICCODES " & _
            "WHERE STRSICCODE = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSICCODES " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSICCODES SET " & _
                "STRSICCODE = '" & Replace(temp, "'", "''") & "', " & _
                "STRSICDESC = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRSICCODE = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferLookUpSSCPNotifications()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSSCPNOTIFICATIONS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRNOTIFICATIONKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRNOTIFICATIONKEY")
            End If
            If IsDBNull(drDSRow("STRNOTIFICATIONDESC")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRNOTIFICATIONDESC")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSSCPNOTIFICATIONS " & _
            "WHERE STRNOTIFICATIONKEY = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSSCPNOTIFICATIONS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSSCPNOTIFICATIONS SET " & _
                "STRNOTIFICATIONKEY = '" & Replace(temp, "'", "''") & "', " & _
                "STRNOTIFICATIONDESC = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRNOTIFICATIONKEY = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpStates()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSTATES "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSTATE")) Then
                temp = ""
            Else
                temp = drDSRow("STRSTATE")
            End If
            If IsDBNull(drDSRow("STRABBREV")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRABBREV")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSTATES " & _
            "WHERE STRABBREV = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSTATES " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSTATES SET " & _
                "STRSTATE = '" & Replace(temp, "'", "''") & "', " & _
                "STRABBREV = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRABBREV = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpSubPart60()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSUBPART60 "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSUBPART")) Then
                temp = ""
            Else
                temp = drDSRow("STRSUBPART")
            End If
            If IsDBNull(drDSRow("STRDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSUBPART60 " & _
            "WHERE STRSUBPART = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSUBPART60 " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSUBPART60 SET " & _
                "STRSUBPART = '" & Replace(temp, "'", "''") & "', " & _
                "STRDESCRIPTION = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRSUBPART = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpSubPart61()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSUBPART61 "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSUBPART")) Then
                temp = ""
            Else
                temp = drDSRow("STRSUBPART")
            End If
            If IsDBNull(drDSRow("STRDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSUBPART61 " & _
            "WHERE STRSUBPART = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSUBPART61 " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSUBPART61 SET " & _
                "STRSUBPART = '" & Replace(temp, "'", "''") & "', " & _
                "STRDESCRIPTION = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRSUBPART = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpSubPart63()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSUBPART63 "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSUBPART")) Then
                temp = ""
            Else
                temp = drDSRow("STRSUBPART")
            End If
            If IsDBNull(drDSRow("STRDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSUBPART63 " & _
            "WHERE STRSUBPART = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSUBPART63 " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSUBPART63 SET " & _
                "STRSUBPART = '" & Replace(temp, "'", "''") & "', " & _
                "STRDESCRIPTION = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRSUBPART = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpSubPartSIP()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPSUBPARTSIP "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRSUBPART")) Then
                temp = ""
            Else
                temp = drDSRow("STRSUBPART")
            End If
            If IsDBNull(drDSRow("STRDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPSUBPARTSIP " & _
            "WHERE STRSUBPART = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPSUBPARTSIP " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPSUBPARTSIP SET " & _
                "STRSUBPART = '" & Replace(temp, "'", "''") & "', " & _
                "STRDESCRIPTION = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRSUBPART = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpTestingFirms()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPTESTINGFIRMS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRTESTINGFIRMKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRTESTINGFIRMKEY")
            End If
            If IsDBNull(drDSRow("STRTESTINGFIRM")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRTESTINGFIRM")
            End If
            If IsDBNull(drDSRow("STRFIRMADDRESS1")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRFIRMADDRESS1")
            End If
            If IsDBNull(drDSRow("STRFIRMADDRESS2")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRFIRMADDRESS2")
            End If
            If IsDBNull(drDSRow("STRFIRMCITY")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRFIRMCITY")
            End If
            If IsDBNull(drDSRow("STRFIRMSTATE")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRFIRMSTATE")
            End If
            If IsDBNull(drDSRow("STRFIRMZIPCODE")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRFIRMZIPCODE")
            End If
            If IsDBNull(drDSRow("STRFIRMPHONENUMBER1")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRFIRMPHONENUMBER1")
            End If
            If IsDBNull(drDSRow("STRFIRMPHONENUMBER2")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("STRFIRMPHONENUMBER2")
            End If
            If IsDBNull(drDSRow("STRFIRMFAX")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("STRFIRMFAX")
            End If
            If IsDBNull(drDSRow("STRFIRMEMAIL")) Then
                temp11 = "N/A"
            Else
                temp11 = drDSRow("STRFIRMEMAIL")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPTESTINGFIRMS " & _
            "WHERE STRTESTINGFIRMKEY = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPTESTINGFIRMS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPTESTINGFIRMS SET " & _
                "STRTESTINGFIRMKEY = '" & Replace(temp, "'", "''") & "', " & _
                "STRTESTINGFIRM = '" & Replace(temp2, "'", "''") & "', " & _
                "STRFIRMADDRESS1 = '" & Replace(temp3, "'", "''") & "', " & _
                "STRFIRMADDRESS2 = '" & Replace(temp4, "'", "''") & "', " & _
                "STRFIRMCITY = '" & Replace(temp5, "'", "''") & "', " & _
                "STRFIRMSTATE = '" & Replace(temp6, "'", "''") & "', " & _
                "STRFIRMZIPCODE = '" & Replace(temp7, "'", "''") & "', " & _
                "STRFIRMPHONENUMBER1 = '" & Replace(temp8, "'", "''") & "', " & _
                "STRFIRMPHONENUMBER2 = '" & Replace(temp9, "'", "''") & "', " & _
                "STRFIRMFAX = '" & Replace(temp10, "'", "''") & "', " & _
                "STRFIRMEMAIL = '" & Replace(temp11, "'", "''") & "' " & _
                "WHERE STRTESTINGFIRMKEY = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferLookUpUnits()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".LOOKUPUNITS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRUNITKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRUNITKEY")
            End If
            If IsDBNull(drDSRow("STRUNITDESCRIPTION")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRUNITDESCRIPTION")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".LOOKUPUNITS " & _
            "WHERE STRUNITKEY = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".LOOKUPUNITS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".LOOKUPUNITS SET " & _
                "STRUNITKEY = '" & Replace(temp, "'", "''") & "', " & _
                "STRUNITDESCRIPTION = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE STRUNITKEY = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferNSPSReason()
        SQL = "Select * " & _
        "From " & DBNameSpace & ".FSNSPSReason " & _
        "order by ReasonID "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("ReasonID")) Then
                temp = ""
            Else
                temp = drDSRow("ReasonID")
            End If
            If IsDBNull(drDSRow("Reason")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("Reason")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".FSNSPSReason " & _
            "WHERE ReasonID = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".FSNSPSReason " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".FSNSPSReason SET " & _
                "Reason = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE ReasonID = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferEDPUsers()
        SQL = "Select * " & _
        "From " & DBNameSpace & ".EPDUsers " & _
        "order by numUserID "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numUserID")) Then
                temp = ""
            Else
                temp = drDSRow("numUserID")
            End If
            If IsDBNull(drDSRow("strUserName")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strUserName")
            End If
            If IsDBNull(drDSRow("strPassword")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strPassword")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EPDUsers " & _
            "WHERE numUserID = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EPDUsers " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EPDUsers SET " & _
                "strUserName = '" & Replace(temp2, "'", "''") & "', " & _
                "strPassword = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE numUserID = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next

        SQL = "Select * " & _
        "From " & DBNameSpace & ".EPDUserProfiles " & _
        "order by numUserID "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("numUserID")) Then
                temp = ""
            Else
                temp = drDSRow("numUserID")
            End If
            If IsDBNull(drDSRow("strEmployeeID")) Then
                temp2 = "000"
            Else
                temp2 = drDSRow("strEmployeeID")
            End If
            If IsDBNull(drDSRow("strLastname")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strLastname")
            End If

            If IsDBNull(drDSRow("strFirstName")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strFirstName")
            End If
            If IsDBNull(drDSRow("strEmailAddress")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strEmailAddress")
            End If
            If IsDBNull(drDSRow("strPhone")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strPhone")
            End If
            If IsDBNull(drDSRow("strFax")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strFax")
            End If
            If IsDBNull(drDSRow("numBranch")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("numBranch")
            End If
            If IsDBNull(drDSRow("numProgram")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("numProgram")
            End If
            If IsDBNull(drDSRow("numUnit")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("numUnit")
            End If
            If IsDBNull(drDSRow("strOffice")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strOffice")
            End If
            If IsDBNull(drDSRow("numEmployeeStatus")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("numEmployeeStatus")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EPDUserProfiles " & _
            "WHERE numUserID = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EPDUserProfiles " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EPDUserProfiles SET " & _
                "strEmployeeID = '" & Replace(temp2, "'", "''") & "', " & _
                "strLastName = '" & Replace(temp3, "'", "''") & "', " & _
                "strFirstName = '" & Replace(temp4, "'", "''") & "', " & _
                "strEmailAddress = '" & Replace(temp5, "'", "''") & "', " & _
                "strPhone = '" & Replace(temp6, "'", "''") & "', " & _
                "strFax = '" & Replace(temp7, "'", "''") & "', " & _
                "numBranch = '" & Replace(temp8, "'", "''") & "', " & _
                "numProgram = '" & Replace(temp9, "'", "''") & "', " & _
                "numUnit = '" & Replace(temp10, "'", "''") & "', " & _
                "strOffice = '" & Replace(temp11, "'", "''") & "', " & _
                "numEmployeeStatus = '" & Replace(temp12, "'", "''") & "' " & _
                "WHERE numUserID = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next


    End Sub
    Sub TransferEISI()
        SQL = "Select * " & _
        "From " & DBNameSpace & ".EISI " & _
        "order by strAIRSYear "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strConfirmationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strConfirmationNumber")
            End If
            If IsDBNull(drDSRow("strInventoryYear")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strInventoryYear")
            End If
            If IsDBNull(drDSRow("strStateCountyFIPS")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStateCountyFIPS")
            End If
            If IsDBNull(drDSRow("strStateFacilityIdentifier")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strStateFacilityIdentifier")
            End If
            If IsDBNull(drDSRow("strStateFacilityCategory")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strStateFacilityCategory")
            End If
            If IsDBNull(drDSRow("strSICPrimary")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strSICPrimary")
            End If
            If IsDBNull(drDSRow("strNAICSPrimary")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strNAICSPrimary")
            End If
            If IsDBNull(drDSRow("strFacilityName")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strFacilityName")
            End If
            If IsDBNull(drDSRow("strSiteDescription")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strSiteDescription")
            End If
            If IsDBNull(drDSRow("strLocationAddress")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strLocationAddress")
            End If
            If IsDBNull(drDSRow("strCity")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strCity")
            End If
            If IsDBNull(drDSRow("strState")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strState")
            End If
            If IsDBNull(drDSRow("strZipCode")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strZipCode")
            End If
            If IsDBNull(drDSRow("strCounty")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strCounty")
            End If
            If IsDBNull(drDSRow("strHorizontalCollectionCode")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strHorizontalCollectionCode")
            End If
            If IsDBNull(drDSRow("strHorizontalAccuracyMeasure")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strHorizontalAccuracyMeasure")
            End If
            If IsDBNull(drDSRow("strHorizontalReferenceCode")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strHorizontalReferenceCode")
            End If
            If IsDBNull(drDSRow("dblXcoordinate")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("dblXcoordinate")
            End If
            If IsDBNull(drDSRow("dblYcoordinate")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("dblYcoordinate")
            End If
            If IsDBNull(drDSRow("strContactFirstName")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strContactFirstName")
            End If
            If IsDBNull(drDSRow("strContactLastName")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strContactLastName")
            End If
            If IsDBNull(drDSRow("strContactPrefix")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strContactPrefix")
            End If
            If IsDBNull(drDSRow("strContactSuffix")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strContactSuffix")
            End If
            If IsDBNull(drDSRow("strContactTitle")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strContactTitle")
            End If
            If IsDBNull(drDSRow("strContactCompanyName")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strContactCompanyName")
            End If
            If IsDBNull(drDSRow("strContactPhoneNumber1")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strContactPhoneNumber1")
            End If
            If IsDBNull(drDSRow("strContactPhoneNumber2")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strContactPhoneNumber2")
            End If
            If IsDBNull(drDSRow("strContactFaxNumber")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strContactFaxNumber")
            End If
            If IsDBNull(drDSRow("strContactEmail")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strContactEmail")
            End If
            If IsDBNull(drDSRow("strContactAddress1")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strContactAddress1")
            End If
            If IsDBNull(drDSRow("strContactAddress2")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strContactAddress2")
            End If
            If IsDBNull(drDSRow("strContactCity")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strContactCity")
            End If
            If IsDBNull(drDSRow("strContactState")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strContactState")
            End If
            If IsDBNull(drDSRow("strContactZipCode")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("strContactZipCode")
            End If
            If IsDBNull(drDSRow("strOptOut")) Then
                temp35 = ""
            Else
                temp35 = drDSRow("strOptOut")
            End If
            If IsDBNull(drDSRow("strUserName")) Then
                temp36 = ""
            Else
                temp36 = drDSRow("strUserName")
            End If
            If IsDBNull(drDSRow("strFinalize")) Then
                temp37 = ""
            Else
                temp37 = drDSRow("strFinalize")
            End If
            If IsDBNull(drDSRow("strValidate0")) Then
                temp38 = ""
            Else
                temp38 = drDSRow("strValidate0")
            End If
            If IsDBNull(drDSRow("strValidate1")) Then
                temp39 = ""
            Else
                temp39 = drDSRow("strValidate1")
            End If
            If IsDBNull(drDSRow("strValidate2")) Then
                temp40 = ""
            Else
                temp40 = drDSRow("strValidate2")
            End If
            If IsDBNull(drDSRow("strValidate3")) Then
                temp41 = ""
            Else
                temp41 = drDSRow("strValidate3")
            End If
            If IsDBNull(drDSRow("strDateLastLogIn")) Then
                temp42 = ""
            Else
                temp42 = drDSRow("strDateLastLogIn")
            End If
            If IsDBNull(drDSRow("strTimeLastLogIn")) Then
                temp43 = ""
            Else
                temp43 = drDSRow("strTimeLastLogIn")
            End If
            If IsDBNull(drDSRow("strAIRSYear")) Then
                temp44 = ""
            Else
                temp44 = drDSRow("strAIRSYear")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp45 = ""
            Else
                temp45 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strQAStarted")) Then
                temp46 = ""
            Else
                temp46 = drDSRow("strQAStarted")
            End If
            If IsDBNull(drDSRow("strQADone")) Then
                temp47 = ""
            Else
                temp47 = drDSRow("strQADone")
            End If
            If IsDBNull(drDSRow("strQAComments")) Then
                temp48 = ""
            Else
                temp48 = drDSRow("strQAComments")
            End If
            If IsDBNull(drDSRow("numUserID")) Then
                temp49 = ""
            Else
                temp49 = drDSRow("numUserID")
            End If
            If IsDBNull(drDSRow("strTransactionTime")) Then
                temp50 = ""
            Else
                temp50 = drDSRow("strTransactionTime")
            End If
            If IsDBNull(drDSRow("strTransactionDate")) Then
                temp51 = ""
            Else
                temp51 = drDSRow("strTransactionDate")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EISI " & _
            "WHERE strAIRSYear = '" & temp44 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EISI " & _
                "Values " & _
                "('" & Replace(temp2, "'", "''") & "', '" & Replace(temp3, "'", "''") & "', " & _
                "'" & Replace(temp4, "'", "''") & "', '" & Replace(temp5, "'", "''") & "', " & _
                "'" & Replace(temp6, "'", "''") & "', '" & Replace(temp7, "'", "''") & "', " & _
                "'" & Replace(temp8, "'", "''") & "', '" & Replace(temp9, "'", "''") & "', " & _
                "'" & Replace(temp10, "'", "''") & "', '" & Replace(temp11, "'", "''") & "', " & _
                "'" & Replace(temp12, "'", "''") & "', '" & Replace(temp13, "'", "''") & "', " & _
                "'" & Replace(temp14, "'", "''") & "', '" & Replace(temp15, "'", "''") & "', " & _
                "'" & Replace(temp16, "'", "''") & "', '" & Replace(temp17, "'", "''") & "', " & _
                "'" & Replace(temp18, "'", "''") & "', '" & Replace(temp19, "'", "''") & "', " & _
                "'" & Replace(temp20, "'", "''") & "', '" & Replace(temp21, "'", "''") & "', " & _
                "'" & Replace(temp22, "'", "''") & "', '" & Replace(temp23, "'", "''") & "', " & _
                "'" & Replace(temp24, "'", "''") & "', '" & Replace(temp25, "'", "''") & "', " & _
                "'" & Replace(temp26, "'", "''") & "', '" & Replace(temp27, "'", "''") & "', " & _
                "'" & Replace(temp28, "'", "''") & "', '" & Replace(temp29, "'", "''") & "', " & _
                "'" & Replace(temp30, "'", "''") & "', '" & Replace(temp31, "'", "''") & "', " & _
                "'" & Replace(temp32, "'", "''") & "', '" & Replace(temp33, "'", "''") & "', " & _
                "'" & Replace(temp34, "'", "''") & "', '" & Replace(temp35, "'", "''") & "', " & _
                "'" & Replace(temp36, "'", "''") & "', '" & Replace(temp37, "'", "''") & "', " & _
                "'" & Replace(temp38, "'", "''") & "', '" & Replace(temp39, "'", "''") & "', " & _
                "'" & Replace(temp40, "'", "''") & "', '" & Replace(temp41, "'", "''") & "', " & _
                "'" & Replace(temp42, "'", "''") & "', '" & Replace(temp43, "'", "''") & "', " & _
                "'" & Replace(temp44, "'", "''") & "', '" & Replace(temp45, "'", "''") & "', " & _
                "'" & Replace(temp, "'", "''") & "', '" & Replace(temp46, "'", "''") & "', " & _
                "'" & Replace(temp47, "'", "''") & "', '" & Replace(temp48, "'", "''") & "', " & _
                "'" & Replace(temp49, "'", "''") & "', '" & Replace(temp50, "'", "''") & "', " & _
                "'" & Replace(temp51, "'", "''") & "', '' ) "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EISI SET " & _
                "strInventoryYear = '" & Replace(temp2, "'", "''") & "', " & _
                "strStateCountyFIPS = '" & Replace(temp3, "'", "''") & "', " & _
                "strStateFacilityIdentifier = '" & Replace(temp4, "'", "''") & "', " & _
                "strStateFacilityCategory = '" & Replace(temp5, "'", "''") & "', " & _
                "strSICPrimary = '" & Replace(temp6, "'", "''") & "', " & _
                "strNAICSPrimary = '" & Replace(temp7, "'", "''") & "', " & _
                "strFacilityName = '" & Replace(temp8, "'", "''") & "', " & _
                "strSiteDescription = '" & Replace(temp9, "'", "''") & "', " & _
                "strLocationAddress = '" & Replace(temp10, "'", "''") & "', " & _
                "strCity = '" & Replace(temp11, "'", "''") & "', " & _
                "strState = '" & Replace(temp12, "'", "''") & "', " & _
                "strZipCode = '" & Replace(temp13, "'", "''") & "', " & _
                "strCounty = '" & Replace(temp14, "'", "''") & "', " & _
                "strHorizontalCollectionCode = '" & Replace(temp15, "'", "''") & "', " & _
                "strHorizontalAccuracyMeasure = '" & Replace(temp16, "'", "''") & "', " & _
                "strHorizontalReferenceCode = '" & Replace(temp17, "'", "''") & "', " & _
                "dblXCoordinate = '" & Replace(temp18, "'", "''") & "', " & _
                "dblYCoordinate = '" & Replace(temp19, "'", "''") & "', " & _
                "strContactFirstName = '" & Replace(temp20, "'", "''") & "', " & _
                "strContactLastName = '" & Replace(temp21, "'", "''") & "', " & _
                "strContactPrefix = '" & Replace(temp22, "'", "''") & "', " & _
                "strContactSuffix = '" & Replace(temp23, "'", "''") & "', " & _
                "strContactTitle = '" & Replace(temp24, "'", "''") & "', " & _
                "strContactCompanyName = '" & Replace(temp25, "'", "''") & "', " & _
                "strContactPhoneNumber1 = '" & Replace(temp26, "'", "''") & "', " & _
                "strContactPhoneNumber2 = '" & Replace(temp27, "'", "''") & "', " & _
                "strContactFaxNumber = '" & Replace(temp28, "'", "''") & "', " & _
                "strContactEmail = '" & Replace(temp29, "'", "''") & "', " & _
                "strContactAddress1 = '" & Replace(temp30, "'", "''") & "', " & _
                "strContactAddress2 = '" & Replace(temp31, "'", "''") & "', " & _
                "strContactCity = '" & Replace(temp32, "'", "''") & "', " & _
                "strContactState = '" & Replace(temp33, "'", "''") & "', " & _
                "strContactZipCode = '" & Replace(temp34, "'", "''") & "', " & _
                "strOptOut = '" & Replace(temp35, "'", "''") & "', " & _
                "strUserName = '" & Replace(temp36, "'", "''") & "', " & _
                "strFinalize = '" & Replace(temp37, "'", "''") & "', " & _
                "strValidate0 = '" & Replace(temp38, "'", "''") & "', " & _
                "strValidate1 = '" & Replace(temp39, "'", "''") & "', " & _
                "strValidate2 = '" & Replace(temp40, "'", "''") & "', " & _
                "strValidate3 = '" & Replace(temp41, "'", "''") & "', " & _
                "strDateLastLogIn = '" & Replace(temp42, "'", "''") & "', " & _
                "strTimeLastLogIn = '" & Replace(temp43, "'", "''") & "', " & _
                "strAIRSYear = '" & Replace(temp44, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp45, "'", "''") & "', " & _
                "strConfirmationNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strQAStarted = '" & Replace(temp46, "'", "''") & "', " & _
                "strQADone = '" & Replace(temp47, "'", "''") & "', " & _
                "strQAComments = '" & Replace(temp48, "'", "''") & "', " & _
                "numUserID = '" & Replace(temp49, "'", "''") & "', " & _
                "strTransactionTime = '" & Replace(temp50, "'", "''") & "', " & _
                "strTransactionDate = '" & Replace(temp51, "'", "''") & "' " & _
                "WHERE strAIRSYear = '" & Replace(temp44, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next

    End Sub
    Sub TransferEIEU()
        SQL = "Select * " & _
       "From " & DBNameSpace & ".EIEU " & _
       "order by strAIRSYear "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strInventoryYear")) Then
                temp = ""
            Else
                temp = drDSRow("strInventoryYear")
            End If
            If IsDBNull(drDSRow("strStateCountyFIPS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strStateCountyFIPS")
            End If
            If IsDBNull(drDSRow("strStateFacilityIdentifier")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStateFacilityIdentifier")
            End If
            If IsDBNull(drDSRow("strEmissionUnitID")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEmissionUnitID")
            End If
            If IsDBNull(drDSRow("sngDesignCapacity")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("sngDesignCapacity")
            End If
            If IsDBNull(drDSRow("strDesignCapUnitNum")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strDesignCapUnitNum")
            End If
            If IsDBNull(drDSRow("strDesignCapUnitDenom")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strDesignCapUnitDenom")
            End If
            If IsDBNull(drDSRow("sngMaxNamePlateCapacity")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("sngMaxNamePlateCapacity")
            End If
            If IsDBNull(drDSRow("strEmissionUnitDesc")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strEmissionUnitDesc")
            End If
            If IsDBNull(drDSRow("strAIRSYearEU")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAIRSYearEU")
            End If
            If IsDBNull(drDSRow("strAIRSYear")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAIRSYear")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strTransactionDate")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strTransactionDate")
            End If
            If IsDBNull(drDSRow("strDesignCapUnitNumDesc")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strDesignCapUnitNumDesc")
            End If
            If IsDBNull(drDSRow("strDesignCapUnitDenomDesc")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strDesignCapUnitDenomDesc")
            End If
            If IsDBNull(drDSRow("strYesNo")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strYesNo")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EIEU " & _
            "WHERE strAIRSYearEU = '" & temp10 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EIEU " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EIEU SET " & _
                "strInventoryYear = '" & Replace(temp, "'", "''") & "', " & _
                "strStateCountyFIPS = '" & Replace(temp2, "'", "''") & "', " & _
                "strStateFacilityIdentifier = '" & Replace(temp3, "'", "''") & "', " & _
                "strEmissionunitID = '" & Replace(temp4, "'", "''") & "', " & _
                "sngDesignCapacity = '" & Replace(temp5, "'", "''") & "', " & _
                "strDesignCapUnitNum = '" & Replace(temp6, "'", "''") & "', " & _
                "strDesignCapUnitDenom = '" & Replace(temp7, "'", "''") & "', " & _
                "sngMaxNamePlateCapacity = '" & Replace(temp8, "'", "''") & "', " & _
                "strEmissionUnitDesc = '" & Replace(temp9, "'", "''") & "', " & _
                "strAIRSYearEU = '" & Replace(temp10, "'", "''") & "', " & _
                "strAIRSYear = '" & Replace(temp11, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp12, "'", "''") & "', " & _
                "strTransactionDate = '" & Replace(temp13, "'", "''") & "', " & _
                "strDesignCapUnitNumDesc = '" & Replace(temp14, "'", "''") & "', " & _
                "strDesignCapUnitDenomDesc = '" & Replace(temp15, "'", "''") & "', " & _
                "strYesNo = '" & Replace(temp16, "'", "''") & "' " & _
                "WHERE strAIRSYearEU = '" & Replace(temp10, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next

    End Sub
    Sub TransferEIER()
        SQL = "Select * " & _
  "From " & DBNameSpace & ".EIER " & _
  "order by strAIRSYearERPointID "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strInventoryYear")) Then
                temp = ""
            Else
                temp = drDSRow("strInventoryYear")
            End If
            If IsDBNull(drDSRow("strStateCountyFIPS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strStateCountyFIPS")
            End If
            If IsDBNull(drDSRow("strStateFacilityIdentifier")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStateFacilityIdentifier")
            End If
            If IsDBNull(drDSRow("strEmissionReleasePointID")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEmissionReleasePointID")
            End If
            If IsDBNull(drDSRow("strEmissionReleaseType")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strEmissionReleaseType")
            End If
            If IsDBNull(drDSRow("sngStackHeight")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("sngStackHeight")
            End If
            If IsDBNull(drDSRow("sngStackDiameter")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("sngStackDiameter")
            End If
            If IsDBNull(drDSRow("sngExitGasTemperature")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("sngExitGasTemperature")
            End If
            If IsDBNull(drDSRow("sngExitGasVelocity")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("sngExitGasVelocity")
            End If
            If IsDBNull(drDSRow("sngExitGasFlowRate")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("sngExitGasFlowRate")
            End If
            If IsDBNull(drDSRow("dblXcoordinate")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("dblXcoordinate")
            End If
            If IsDBNull(drDSRow("dblYcoordinate")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("dblYcoordinate")
            End If
            If IsDBNull(drDSRow("strEmissionReleasePtDesc")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strEmissionReleasePtDesc")
            End If
            If IsDBNull(drDSRow("strHorizontalCollectionCode")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strHorizontalCollectionCode")
            End If
            If IsDBNull(drDSRow("strHorizontalAccuracyMeasure")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strHorizontalAccuracyMeasure")
            End If
            If IsDBNull(drDSRow("strHorizontalReferenceCode")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strHorizontalReferenceCode")
            End If
            If IsDBNull(drDSRow("strAIRSYearERPointID")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strAIRSYearERPointID")
            End If
            If IsDBNull(drDSRow("strAIRSYear")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strAIRSYear")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strTransActionDate")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strTransActionDate")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EIER " & _
            "WHERE strAIRSYearERPointID = '" & temp17 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EIER " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EIER SET " & _
                "strInventoryYear = '" & Replace(temp, "'", "''") & "', " & _
                "strStateCountyFIPS = '" & Replace(temp2, "'", "''") & "', " & _
                "strStateFacilityIdentifier = '" & Replace(temp3, "'", "''") & "', " & _
                "strEmissionReleasePointID = '" & Replace(temp4, "'", "''") & "', " & _
                "strEmissionReleaseType = '" & Replace(temp5, "'", "''") & "', " & _
                "sngStackHeight = '" & Replace(temp6, "'", "''") & "', " & _
                "sngStackDiameter = '" & Replace(temp7, "'", "''") & "', " & _
                "sngExitGasTemperature = '" & Replace(temp8, "'", "''") & "', " & _
                "sngExitGasVelocity = '" & Replace(temp9, "'", "''") & "', " & _
                "sngExitGasFlowRate = '" & Replace(temp10, "'", "''") & "', " & _
                "dblXCoordinate = '" & Replace(temp11, "'", "''") & "', " & _
                "dblYCoordinate = '" & Replace(temp12, "'", "''") & "', " & _
                "strEmissionReleasePTDesc = '" & Replace(temp13, "'", "''") & "', " & _
                "strHorizontalCollectionCode = '" & Replace(temp14, "'", "''") & "', " & _
                "strHorizontalAccuracyMeasure = '" & Replace(temp15, "'", "''") & "', " & _
                "strHorizontalReferenceCode = '" & Replace(temp16, "'", "''") & "', " & _
                "strAIRSYearERPointID = '" & Replace(temp17, "'", "''") & "', " & _
                "strAIRSYear = '" & Replace(temp18, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp19, "'", "''") & "', " & _
                "strTransActionDate = '" & Replace(temp20, "'", "''") & "' " & _
                "WHERE strAIRSYearERPointID = '" & Replace(temp17, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next
    End Sub
    Sub TransferEIEP()
        SQL = "Select * " & _
"From " & DBNameSpace & ".EIEP " & _
"order by strAIRSYearEUProcID "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strInventoryYear")) Then
                temp = ""
            Else
                temp = drDSRow("strInventoryYear")
            End If
            If IsDBNull(drDSRow("strStateCountyFIPS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strStateCountyFIPS")
            End If
            If IsDBNull(drDSRow("strStateFacilityIdentifier")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStateFacilityIdentifier")
            End If
            If IsDBNull(drDSRow("strEmissionUnitID")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEmissionUnitID")
            End If
            If IsDBNull(drDSRow("strEmissionReleasePointID")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strEmissionReleasePointID")
            End If
            If IsDBNull(drDSRow("strProcessID")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strProcessID")
            End If
            If IsDBNull(drDSRow("strSCC")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strSCC")
            End If
            If IsDBNull(drDSRow("strProcessMactCode")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strProcessMactCode")
            End If
            If IsDBNull(drDSRow("strEmissionProcessDescription")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strEmissionProcessDescription")
            End If
            If IsDBNull(drDSRow("intWinterThroughPutPCT")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("intWinterThroughPutPCT")
            End If
            If IsDBNull(drDSRow("intSpringThroughPutPCT")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("intSpringThroughPutPCT")
            End If
            If IsDBNull(drDSRow("intSummerThroughPutPCT")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("intSummerThroughputPCT")
            End If
            If IsDBNull(drDSRow("intFallThroughPutPCT")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("intFallThroughPutPCT")
            End If
            If IsDBNull(drDSRow("intAnnualAvgDaysPerWeek")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("intAnnualAvgDaysPerWeek")
            End If
            If IsDBNull(drDSRow("intAnnualAvgWeeksPerYear")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("intAnnualAvgWeeksPerYear")
            End If
            If IsDBNull(drDSRow("intAnnualAvgHoursPerDay")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("intAnnualAvgHoursPerDay")
            End If
            If IsDBNull(drDSRow("intAnnualAvgHoursPerYear")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("intAnnualAvgHoursPerYear")
            End If
            If IsDBNull(drDSRow("sngHeatContent")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("sngHeatContent")
            End If
            If IsDBNull(drDSRow("sngSulfurContent")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("sngSulfurContent")
            End If
            If IsDBNull(drDSRow("sngAshContent")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("sngAshContent")
            End If
            If IsDBNull(drDSRow("strProcessMACTComplianceStat")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strProcessMACTComplianceStat")
            End If
            If IsDBNull(drDSRow("sngDailySummerProcesstPut")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("sngDailySummerProcesstPut")
            End If
            If IsDBNull(drDSRow("strDailySummerProcesstPutNum")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strDailySummerProcesstPutNum")
            End If
            If IsDBNull(drDSRow("sngActualThroughPut")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("sngActualThroughPut")
            End If
            If IsDBNull(drDSRow("strThroughPutUnitNumerator")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strThroughPutUnitNumerator")
            End If
            If IsDBNull(drDSRow("strAIRSYearEU")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strAIRSYearEU")
            End If
            If IsDBNull(drDSRow("strAIRSYearEUProcID")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strAIRSYearEUProcID")
            End If
            If IsDBNull(drDSRow("strAIRSYear")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strAIRSYear")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strTransactionDate")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strTransactionDate")
            End If
            If IsDBNull(drDSRow("strStartTime")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strStartTime")
            End If
            If IsDBNull(drDSRow("strYesNo")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strYesNo")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EIEP " & _
            "WHERE strAIRSYearEUProcID = '" & temp27 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EIEP " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EIEP SET " & _
                "strInventoryYear = '" & Replace(temp, "'", "''") & "', " & _
                "strStateCountyFIPS = '" & Replace(temp2, "'", "''") & "', " & _
                "strStateFacilityIdentifier = '" & Replace(temp3, "'", "''") & "', " & _
                "strEmissionUnitID = '" & Replace(temp4, "'", "''") & "', " & _
                "strEmissionReleasePointID = '" & Replace(temp5, "'", "''") & "', " & _
                "strProcessID = '" & Replace(temp6, "'", "''") & "', " & _
                "strSCC = '" & Replace(temp7, "'", "''") & "', " & _
                "strProcessMACTCode = '" & Replace(temp8, "'", "''") & "', " & _
                "strEmissionProcessDescription = '" & Replace(temp9, "'", "''") & "', " & _
                "intWinterThroughPutPCT = '" & Replace(temp10, "'", "''") & "', " & _
                "intSpringThroughPutPCT = '" & Replace(temp11, "'", "''") & "', " & _
                "intSummerThroughPutPCT = '" & Replace(temp12, "'", "''") & "', " & _
                "intFallThroughPutPCT = '" & Replace(temp13, "'", "''") & "', " & _
                "intAnnualAvgDaysPerWeek = '" & Replace(temp14, "'", "''") & "', " & _
                "intAnnualAvgWeeksPerYear = '" & Replace(temp15, "'", "''") & "', " & _
                "intAnnualAvgHoursPerDay = '" & Replace(temp16, "'", "''") & "', " & _
                "intAnnualAvgHoursPerYear = '" & Replace(temp17, "'", "''") & "', " & _
                "sngHeatContent = '" & Replace(temp18, "'", "''") & "', " & _
                "sngSulfurContent = '" & Replace(temp19, "'", "''") & "', " & _
                "sngASHContent = '" & Replace(temp20, "'", "''") & "', " & _
                "strProcessMACTComplianceStat = '" & Replace(temp21, "'", "''") & "', " & _
                "sngDailySummerProcesstPut = '" & Replace(temp22, "'", "''") & "', " & _
                "strDailySummerProcesstPutNum = '" & Replace(temp23, "'", "''") & "', " & _
                "sngActualThroughPut = '" & Replace(temp24, "'", "''") & "', " & _
                "strThroughPutUnitNumerator = '" & Replace(temp25, "'", "''") & "', " & _
                "strAIRSYearEU = '" & Replace(temp26, "'", "''") & "', " & _
                "strAIRSYearEUProcID = '" & Replace(temp27, "'", "''") & "', " & _
                "strAIRSYear = '" & Replace(temp28, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp29, "'", "''") & "', " & _
                "strTransActionDate = '" & Replace(temp30, "'", "''") & "', " & _
                "strStartTime = '" & Replace(temp31, "'", "''") & "', " & _
                "strYesNo = '" & Replace(temp32, "'", "''") & "' " & _
                "WHERE strAIRSYearEUProcID = '" & Replace(temp27, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next


    End Sub
    Sub TransferEIEM()
        SQL = "Select * " & _
"From " & DBNameSpace & ".EIEM " & _
"order by strAIRSYearEUEPEM "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strInventoryYear")) Then
                temp = ""
            Else
                temp = drDSRow("strInventoryYear")
            End If
            If IsDBNull(drDSRow("strStateCountyFIPS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strStateCountyFIPS")
            End If
            If IsDBNull(drDSRow("strStateFacilityIdentifier")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStateFacilityIdentifier")
            End If
            If IsDBNull(drDSRow("strEmissionUnitID")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEmissionUnitID")
            End If
            If IsDBNull(drDSRow("strProcessID")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strProcessID")
            End If
            If IsDBNull(drDSRow("strPollutantCode")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strPollutantCode")
            End If
            If IsDBNull(drDSRow("strEmissionReleasePointID")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strEmissionReleasePointID")
            End If
            If IsDBNull(drDSRow("dblEmissionNumericValue")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("dblEmissionNumericValue")
            End If
            If IsDBNull(drDSRow("strEmissionUnitNumerator")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strEmissionUnitNumerator")
            End If
            If IsDBNull(drDSRow("strEmissionType")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strEmissionType")
            End If
            If IsDBNull(drDSRow("sngFactorNumericValue")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("sngFactorNumericValue")
            End If
            If IsDBNull(drDSRow("strFactorUnitNumerator")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strFactorUnitNumerator")
            End If
            If IsDBNull(drDSRow("strFactorUnitDenominator")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strFactorUnitDenominator")
            End If
            If IsDBNull(drDSRow("strEmissionCalculationMetCode")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strEmissionCalculationMetCode")
            End If
            If IsDBNull(drDSRow("sngRuleEffectiveNess")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("sngRuleEffectiveNess")
            End If
            If IsDBNull(drDSRow("strControlStatus")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strControlStatus")
            End If
            If IsDBNull(drDSRow("sngPrimaryPCTControlEffic")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("sngPrimaryPCTControlEffic")
            End If
            If IsDBNull(drDSRow("sngPctCaptureEfficiency")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("sngPctCaptureEfficiency")
            End If
            If IsDBNull(drDSRow("sngTotalCaptureControlEffic")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("sngTotalCaptureControlEffic")
            End If
            If IsDBNull(drDSRow("strPrimaryDeviceTypeCode")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strPrimaryDeviceTypeCode")
            End If
            If IsDBNull(drDSRow("strSecondaryDeviceTypeCode")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strSecondaryDeviceTypeCode")
            End If
            If IsDBNull(drDSRow("strControlSystemDescription")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strControlSystemDescription")
            End If
            If IsDBNull(drDSRow("strAIRSYearEUProcid")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strAIRSYearEUProcid")
            End If
            If IsDBNull(drDSRow("strAIRSYear")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strAIRSYear")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strTransactionDate")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strTransactionDate")
            End If
            If IsDBNull(drDSRow("strAIRSYearEUEPEM")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strAIRSYearEUEPEM")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".EIEM " & _
            "WHERE strAIRSYearEUEPEM = '" & temp27 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".EIEM " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                "'" & Replace(temp27, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".EIEM SET " & _
                "strInventoryYear = '" & Replace(temp, "'", "''") & "', " & _
                "strStateCountyFIPS = '" & Replace(temp2, "'", "''") & "', " & _
                "strStateFacilityIdentifier = '" & Replace(temp3, "'", "''") & "', " & _
                "strEmissionUnitID = '" & Replace(temp4, "'", "''") & "', " & _
                "strProcessID = '" & Replace(temp5, "'", "''") & "', " & _
                "strPollutantCode = '" & Replace(temp6, "'", "''") & "', " & _
                "strEmissionReleasePointID = '" & Replace(temp7, "'", "''") & "', " & _
                "dblEmissionNumericValue = '" & Replace(temp8, "'", "''") & "', " & _
                "strEmissionUnitNumerator = '" & Replace(temp9, "'", "''") & "', " & _
                "strEmissionType = '" & Replace(temp10, "'", "''") & "', " & _
                "sngFactorNumericValue = '" & Replace(temp11, "'", "''") & "', " & _
                "strFactorUnitNumerator = '" & Replace(temp12, "'", "''") & "', " & _
                "strFactorUnitDenominator = '" & Replace(temp13, "'", "''") & "', " & _
                "strEmissionCalculationMetCode = '" & Replace(temp14, "'", "''") & "', " & _
                "sngRuleEffectiveness = '" & Replace(temp15, "'", "''") & "', " & _
                "strControlStatus = '" & Replace(temp16, "'", "''") & "', " & _
                "sngPrimaryPctControlEffic = '" & Replace(temp17, "'", "''") & "', " & _
                "sngPctCaptureEfficiency = '" & Replace(temp18, "'", "''") & "', " & _
                "sngTotalCaptureControlEffic = '" & Replace(temp19, "'", "''") & "', " & _
                "strPrimaryDeviceTypeCode = '" & Replace(temp20, "'", "''") & "', " & _
                "strSecondaryDeviceTypeCode = '" & Replace(temp21, "'", "''") & "', " & _
                "strControlSystemDescription = '" & Replace(temp22, "'", "''") & "', " & _
                "strAIRSYearEUProcid = '" & Replace(temp23, "'", "''") & "', " & _
                "strAIRSYear = '" & Replace(temp24, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp25, "'", "''") & "', " & _
                "strTransactionDate = '" & Replace(temp26, "'", "''") & "', " & _
                "strAirsYearEUEPEM = '" & Replace(temp27, "'", "''") & "' " & _
                "WHERE strAIRSYearEUEPEM = '" & Replace(temp27, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()

        Next
    End Sub

    Sub TransferAPBAirProgramPollutants()
        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_airpollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_airpollutants DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_airprogrampollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_airprogrampollutants DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_HB_APBAirProgramPollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_HB_APBAirProgramPollutants DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If



        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBAIRPROGRAMPOLLUTANTS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRAIRPOLLUTANTKEY")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAIRPOLLUTANTKEY")
            End If
            If IsDBNull(drDSRow("STRPOLLUTANTKEY")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRPOLLUTANTKEY")
            End If
            If IsDBNull(drDSRow("STRCOMPLIANCESTATUS")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRCOMPLIANCESTATUS")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp6 = ""
            Else
                temp6 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STROPERATIONALSTATUS")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STROPERATIONALSTATUS")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBAIRPROGRAMPOLLUTANTS " & _
                "WHERE STRAIRPOLLUTANTKEY = '" & temp2 & "' " & _
                "AND STRPOLLUTANTKEY = '" & temp3 & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBAIRPROGRAMPOLLUTANTS " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBAIRPROGRAMPOLLUTANTS SET " & _
                    "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                    "STRAIRPOLLUTANTKEY = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRPOLLUTANTKEY = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRCOMPLIANCESTATUS = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp5, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp6, "'", "''") & "', " & _
                    "STROPERATIONALSTATUS = '" & Replace(temp7, "'", "''") & "' " & _
                    "WHERE STRAIRPOLLUTANTKEY = '" & temp2 & "' " & _
                    "AND STRPOLLUTANTKEY = '" & temp3 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_airpollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_airpollutants ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_airprogrampollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_airprogrampollutants ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
         "from user_triggers " & _
         "where trigger_name = 'tg_HB_APBAirProgramPollutants' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_HB_APBAirProgramPollutants ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

    End Sub
    Sub TransferAPBContactInformation()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBCONTACTINFORMATION "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRCONTACTKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRCONTACTKEY")
            End If
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRKEY")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRKEY")
            End If
            If IsDBNull(drDSRow("STRCONTACTFIRSTNAME")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRCONTACTFIRSTNAME")
            End If
            If IsDBNull(drDSRow("STRCONTACTLASTNAME")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRCONTACTLASTNAME")
            End If
            If IsDBNull(drDSRow("STRCONTACTPREFIX")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRCONTACTPREFIX")
            End If
            If IsDBNull(drDSRow("STRCONTACTSUFFIX")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRCONTACTSUFFIX")
            End If

            If IsDBNull(drDSRow("STRCONTACTTITLE")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRCONTACTTITLE")
            End If
            If IsDBNull(drDSRow("STRCONTACTCOMPANYNAME")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("STRCONTACTCOMPANYNAME")
            End If
            If IsDBNull(drDSRow("STRCONTACTPHONENUMBER1")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("STRCONTACTPHONENUMBER1")
            End If
            If IsDBNull(drDSRow("STRCONTACTPHONENUMBER2")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("STRCONTACTPHONENUMBER2")
            End If
            If IsDBNull(drDSRow("STRCONTACTFAXNUMBER")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("STRCONTACTFAXNUMBER")
            End If
            If IsDBNull(drDSRow("STRCONTACTEMAIL")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("STRCONTACTEMAIL")
            End If
            If IsDBNull(drDSRow("STRCONTACTADDRESS1")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("STRCONTACTADDRESS1")
            End If
            If IsDBNull(drDSRow("STRCONTACTADDRESS2")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("STRCONTACTADDRESS2")
            End If
            If IsDBNull(drDSRow("STRCONTACTCITY")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("STRCONTACTCITY")
            End If
            If IsDBNull(drDSRow("STRCONTACTSTATE")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("STRCONTACTSTATE")
            End If
            If IsDBNull(drDSRow("STRCONTACTZIPCODE")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("STRCONTACTZIPCODE")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp20 = ""
            Else
                temp20 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRCONTACTDESCRIPTION")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("STRCONTACTDESCRIPTION")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp2 & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBCONTACTINFORMATION " & _
                "WHERE STRCONTACTKEY = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBCONTACTINFORMATION " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBCONTACTINFORMATION SET " & _
                    "STRCONTACTKEY = '" & Replace(temp, "'", "''") & "', " & _
                    "STRAIRSNUMBER = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRKEY = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRCONTACTFIRSTNAME = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRCONTACTLASTNAME = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRCONTACTPREFIX = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRCONTACTSUFFIX = '" & Replace(temp7, "'", "''") & "', " & _
                    "STRCONTACTTITLE = '" & Replace(temp8, "'", "''") & "', " & _
                    "STRCONTACTCOMPANYNAME = '" & Replace(temp9, "'", "''") & "', " & _
                    "STRCONTACTPHONENUMBER1 = '" & Replace(temp10, "'", "''") & "', " & _
                    "STRCONTACTPHONENUMBER2 = '" & Replace(temp11, "'", "''") & "', " & _
                    "STRCONTACTFAXNUMBER = '" & Replace(temp12, "'", "''") & "', " & _
                    "STRCONTACTEMAIL = '" & Replace(temp13, "'", "''") & "', " & _
                    "STRCONTACTADDRESS1 = '" & Replace(temp14, "'", "''") & "', " & _
                    "STRCONTACTADDRESS2 = '" & Replace(temp15, "'", "''") & "', " & _
                    "STRCONTACTCITY = '" & Replace(temp16, "'", "''") & "', " & _
                    "STRCONTACTSTATE = '" & Replace(temp17, "'", "''") & "', " & _
                    "STRCONTACTZIPCODE = '" & Replace(temp18, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp19, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp20, "'", "''") & "', " & _
                    "STRCONTACTDESCRIPTION = '" & Replace(temp21, "'", "''") & "' " & _
                    "WHERE STRCONTACTKEY = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If

        Next

    End Sub
    Sub TransferAPBFacilityInformation()

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'TG_HB_APBFACILITYINFORMATION' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.TG_HB_APBFACILITYINFORMATION DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'TG_AFS_FACILITYINFORMATION' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.TG_AFS_FACILITYINFORMATION DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBFACILITYINFORMATION "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRFACILITYNAME")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRFACILITYNAME")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTREET1")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRFACILITYSTREET1")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTREET2")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRFACILITYSTREET2")
            End If
            If IsDBNull(drDSRow("STRFACILITYCITY")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRFACILITYCITY")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTATE")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRFACILITYSTATE")
            End If
            If IsDBNull(drDSRow("STRFACILITYZIPCODE")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRFACILITYZIPCODE")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp9 = ""
            Else
                temp9 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRCOMMENTS")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("STRCOMMENTS")
            End If
            If IsDBNull(drDSRow("STRMODIFINGLOCATION")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("STRMODIFINGLOCATION")
            End If
            If IsDBNull(drDSRow("NUMFACILITYLONGITUDE")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("NUMFACILITYLONGITUDE")
            End If
            If IsDBNull(drDSRow("NUMFACILITYLATITUDE")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("NUMFACILITYLATITUDE")
            End If
            If IsDBNull(drDSRow("STRHORIZONTALCOLLECTIONCODE")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("STRHORIZONTALCOLLECTIONCODE")
            End If
            If IsDBNull(drDSRow("STRHORIZONTALACCURACYMEASURE")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("STRHORIZONTALACCURACYMEASURE")
            End If
            If IsDBNull(drDSRow("STRHORIZONTALREFERENCECODE")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("STRHORIZONTALREFERENCECODE")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBFACILITYINFORMATION " & _
                "WHERE STRAIRSNUMBER = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBFACILITYINFORMATION " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBFACILITYINFORMATION SET " & _
                    "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                    "STRFACILITYNAME = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRFACILITYSTREET1 = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRFACILITYSTREET2 = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRFACILITYCITY = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRFACILITYSTATE = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRFACILITYZIPCODE = '" & Replace(temp7, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp8, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp9, "'", "''") & "', " & _
                    "STRCOMMENTS = '" & Replace(temp10, "'", "''") & "', " & _
                    "STRMODIFINGLOCATION = '" & Replace(temp11, "'", "''") & "', " & _
                    "NUMFACILITYLONGITUDE = '" & Replace(temp12, "'", "''") & "', " & _
                    "NUMFACILITYLATITUDE = '" & Replace(temp13, "'", "''") & "', " & _
                    "STRHORIZONTALCOLLECTIONCODE = '" & Replace(temp14, "'", "''") & "', " & _
                    "STRHORIZONTALACCURACYMEASURE = '" & Replace(temp15, "'", "''") & "', " & _
                    "STRHORIZONTALREFERENCECODE = '" & Replace(temp16, "'", "''") & "' " & _
                    "WHERE STRAIRSNUMBER = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

        SQL = "Select Status " & _
        "from user_triggers " & _
        "where trigger_name = 'TG_HB_APBFACILITYINFORMATION' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.TG_HB_APBFACILITYINFORMATION Enable"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
       "from user_triggers " & _
       "where trigger_name = 'TG_AFS_FACILITYINFORMATION' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.TG_AFS_FACILITYINFORMATION DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

    End Sub
    Sub TransferAPBHeaderData()
        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_headerdata' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_headerdata DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_hb_apbheaderData' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_hb_apbheaderData DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_air_Programcodes' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_air_Programcodes DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBHEADERDATA "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STROPERATIONALSTATUS")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STROPERATIONALSTATUS")
            End If
            If IsDBNull(drDSRow("STRCLASS")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRCLASS")
            End If
            If IsDBNull(drDSRow("STRAIRPROGRAMCODES")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRAIRPROGRAMCODES")
            End If
            If IsDBNull(drDSRow("STRSICCODE")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRSICCODE")
            End If
            If IsDBNull(drDSRow("STRFEINUMBER")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRFEINUMBER")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp8 = ""
            Else
                temp8 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("DATSTARTUPDATE")) Then
                temp9 = ""
            Else
                temp9 = Format(drDSRow("DATSTARTUPDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("DATSHUTDOWNDATE")) Then
                temp10 = ""
            Else
                temp10 = Format(drDSRow("DATSHUTDOWNDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRCOMMENTS")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("STRCOMMENTS")
            End If
            If IsDBNull(drDSRow("STRPLANTDESCRIPTION")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("STRPLANTDESCRIPTION")
            End If
            If IsDBNull(drDSRow("STRATTAINMENTSTATUS")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("STRATTAINMENTSTATUS")
            End If
            If IsDBNull(drDSRow("STRSTATEPROGRAMCODES")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("STRSTATEPROGRAMCODES")
            End If
            If IsDBNull(drDSRow("STRMODIFINGLOCATION")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("STRMODIFINGLOCATION")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBHEADERDATA " & _
                "WHERE STRAIRSNUMBER = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBHEADERDATA " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBHEADERDATA SET " & _
                    "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                    "STROPERATIONALSTATUS = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRCLASS = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRAIRPROGRAMCODES = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRSICCODE = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRFEINUMBER = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp7, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp8, "'", "''") & "', " & _
                    "DATSTARTUPDATE = '" & Replace(temp9, "'", "''") & "', " & _
                    "DATSHUTDOWNDATE = '" & Replace(temp10, "'", "''") & "', " & _
                    "STRCOMMENTS = '" & Replace(temp11, "'", "''") & "', " & _
                    "STRPLANTDESCRIPTION = '" & Replace(temp12, "'", "''") & "', " & _
                    "STRATTAINMENTSTATUS = '" & Replace(temp13, "'", "''") & "', " & _
                    "STRSTATEPROGRAMCODES = '" & Replace(temp14, "'", "''") & "', " & _
                    "STRMODIFINGLOCATION = '" & Replace(temp15, "'", "''") & "' " & _
                    "WHERE STRAIRSNUMBER = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_air_Programcodes' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_air_Programcodes ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
         "from user_triggers " & _
         "where trigger_name = 'tg_afs_headerdata' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_headerdata ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select Status " & _
         "from user_triggers " & _
         "where trigger_name = 'tg_hb_apbheaderData' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_hb_apbheaderData ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If
    End Sub
    Sub TransferAPBMasterAIRS()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBMASTERAIRS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp3 = ""
            Else
                temp3 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".APBMASTERAIRS " & _
            "WHERE STRAIRSNUMBER = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".APBMASTERAIRS " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".APBMASTERAIRS SET " & _
                "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                "STRMODIFINGPERSON = '" & Replace(temp2, "'", "''") & "', " & _
                "DATMODIFINGDATE = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE STRAIRSNUMBER = '" & temp & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferAPBMasterAPP()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".APBMasterAPP "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strVersionNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strVersionNumber")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".APBMasterAPP " & _
            "WHERE strVersionNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".APBMasterAPP " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".APBMasterAPP SET " & _
                "strVersionNumber = '" & Replace(temp, "'", "''") & "' " & _
                "WHERE strVersionNumber = '" & temp & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next

    End Sub
    Sub TransferAPBPermits()



    End Sub
    Sub TransferAPBSubPartData()

        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBSUBPARTDATA "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRSUBPARTKEY")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRSUBPARTKEY")
            End If
            If IsDBNull(drDSRow("STRSUBPART")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRSUBPART")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp5 = ""
            Else
                temp5 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBSUBPARTDATA " & _
                "WHERE STRSUBPARTKEY = '" & temp2 & "' " & _
                "AND STRSUBPART = '" & temp3 & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBSUBPARTDATA " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBSUBPARTDATA SET " & _
                    "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                    "STRSUBPARTKEY = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRSUBPART = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp4, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE STRSUBPARTKEY = '" & temp2 & "' " & _
                    "AND STRSUBPART = '" & temp3 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next


    End Sub
    Sub TransferAPBSupplamentalData()
        SQL = "Select Status " & _
          "from user_triggers " & _
          "where trigger_name = 'tg_afs_SupplamentalData' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "ENABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_SupplamentalData DISABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

        SQL = "Select * " & _
        "from " & DBNameSpace & ".APBSUPPLAMENTALDATA "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp = ""
            Else
                temp = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("DATSSCPTESTREPORTDUE")) Then
                temp2 = ""
            Else
                temp2 = Format(drDSRow("DATSSCPTESTREPORTDUE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp4 = ""
            Else
                temp4 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRDISTRICTOFFICE")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRDISTRICTOFFICE")
            End If
            If IsDBNull(drDSRow("STRCMSMEMBER")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRCMSMEMBER")
            End If
            If IsDBNull(drDSRow("STRAFSACTIONNUMBER")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRAFSACTIONNUMBER")
            End If
            If IsDBNull(drDSRow("STRFEEMAILINGSTATUS")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRFEEMAILINGSTATUS")
            End If
            If IsDBNull(drDSRow("ISBANKRUPT")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("ISBANKRUPT")
            End If
            If IsDBNull(drDSRow("STRCURRENTPERMIT")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("STRCURRENTPERMIT")
            End If
            If IsDBNull(drDSRow("DATPERMITEFFECTIVE")) Then
                temp11 = ""
            Else
                temp11 = Format(drDSRow("DATPERMITEFFECTIVE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STREPATOPSEXCLUDED")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("STREPATOPSEXCLUDED")
            End If

            SQL = "Select " & _
           "strAIRSNumber " & _
           "from " & DBNameSpace & ".APBMasterAIRS " & _
           "where strAIRSNumber = '" & temp & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then

                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".APBSUPPLAMENTALDATA " & _
                "WHERE STRAIRSNUMBER = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".APBSUPPLAMENTALDATA " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".APBSUPPLAMENTALDATA SET " & _
                    "STRAIRSNUMBER = '" & Replace(temp, "'", "''") & "', " & _
                    "DATSSCPTESTREPORTDUE = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp3, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRDISTRICTOFFICE = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRCMSMEMBER = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRAFSACTIONNUMBER = '" & Replace(temp7, "'", "''") & "', " & _
                    "STRFEEMAILINGSTATUS = '" & Replace(temp8, "'", "''") & "', " & _
                    "ISBANKRUPT = '" & Replace(temp9, "'", "''") & "', " & _
                    "STRCURRENTPERMIT = '" & Replace(temp10, "'", "''") & "', " & _
                    "DATPERMITEFFECTIVE = '" & Replace(temp11, "'", "''") & "', " & _
                    "STREPATOPSEXCLUDED = '" & Replace(temp12, "'", "''") & "' " & _
                    "WHERE STRAIRSNUMBER = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

        SQL = "Select Status " & _
                  "from user_triggers " & _
                  "where trigger_name = 'tg_afs_SupplamentalData' "
        cmd = New OracleCommand(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        dr = cmd.ExecuteReader
        While dr.Read
            If IsDBNull(dr.Item("Status")) Then
                TriggerStatus = ""
            Else
                If dr.Item("Status") = "ENABLED" Then
                    TriggerStatus = "ENABLED"
                Else
                    TriggerStatus = "DISABLED"
                End If
            End If
        End While
        dr.Close()

        If TriggerStatus = "DISABLED" Then
            SQL = "ALTER TRIGGER AIRBRANCH.tg_afs_SupplamentalData ENABLE"
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        End If

    End Sub
    Sub TransferAPPMaster()






    End Sub
    Sub TransferHBAPBAirProgramPollutants()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".HB_APBAIRPROGRAMPOLLUTANTS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        SQL = "DELETE " & DBNameSpace & ".HB_APBAIRPROGRAMPOLLUTANTS "
        cmd = New OracleCommand(SQL, transferConn)
        If transferConn.State = ConnectionState.Closed Then
            transferConn.Open()
        End If
        dr = cmd.ExecuteReader
        dr.Close()

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRKEY")
            End If
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRAIRPOLLUTANTKEY")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRAIRPOLLUTANTKEY")
            End If
            If IsDBNull(drDSRow("STRPOLLUTANTKEY")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRPOLLUTANTKEY")
            End If
            If IsDBNull(drDSRow("STRCOMPLIANCESTATUS")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRCOMPLIANCESTATUS")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp7 = ""
            Else
                temp7 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp2 & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".HB_APBAIRPROGRAMPOLLUTANTS " & _
                "WHERE STRKEY = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".HB_APBAIRPROGRAMPOLLUTANTS " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".HB_APBAIRPROGRAMPOLLUTANTS SET " & _
                    "STRKEY = '" & Replace(temp, "'", "''") & "', " & _
                    "STRAIRSNUMBER = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRAIRPOLLUTANTKEY = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRPOLLUTANTKEY = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRCOMPLIANCESTATUS = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp6, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp7, "'", "''") & "' " & _
                    "WHERE STRKEY = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

    End Sub
    Sub TransferHBAPBFacilityINformation()

        SQL = "Select * " & _
        "from " & DBNameSpace & ".HB_APBFACILITYINFORMATION "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        SQL = "DELETE " & DBNameSpace & ".HB_APBFACILITYINFORMATION "
        cmd = New OracleCommand(SQL, transferConn)
        If transferConn.State = ConnectionState.Closed Then
            transferConn.Open()
        End If
        dr = cmd.ExecuteReader
        dr.Close()

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRKEY")
            End If
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STRFACILITYNAME")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STRFACILITYNAME")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTREET1")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRFACILITYSTREET1")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTREET2")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRFACILITYSTREET2")
            End If
            If IsDBNull(drDSRow("STRFACILITYCITY")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRFACILITYCITY")
            End If
            If IsDBNull(drDSRow("STRFACILITYSTATE")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRFACILITYSTATE")
            End If
            If IsDBNull(drDSRow("STRFACILITYZIPCODE")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRFACILITYZIPCODE")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp10 = ""
            Else
                temp10 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRCOMMENTS")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("STRCOMMENTS")
            End If
            If IsDBNull(drDSRow("STRMODIFINGLOCATION")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("STRMODIFINGLOCATION")
            End If
            If IsDBNull(drDSRow("NUMFACILITYLONGITUDE")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("NUMFACILITYLONGITUDE")
            End If
            If IsDBNull(drDSRow("NUMFACILITYLATITUDE")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("NUMFACILITYLATITUDE")
            End If

            SQL = "Select " & _
           "strAIRSNumber " & _
           "from " & DBNameSpace & ".APBMasterAIRS " & _
           "where strAIRSNumber = '" & temp2 & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".HB_APBFACILITYINFORMATION " & _
                "WHERE STRKEY = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".HB_APBFACILITYINFORMATION " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".HB_APBFACILITYINFORMATION SET " & _
                    "STRKEY = '" & Replace(temp, "'", "''") & "', " & _
                    "STRAIRSNUMBER = '" & Replace(temp2, "'", "''") & "', " & _
                    "STRFACILITYNAME = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRFACILITYSTREET1 = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRFACILITYSTREET2 = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRFACILITYCITY = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRFACILITYSTATE = '" & Replace(temp7, "'", "''") & "', " & _
                    "STRFACILITYZIPCODE = '" & Replace(temp8, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp9, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp10, "'", "''") & "', " & _
                    "STRCOMMENTS = '" & Replace(temp11, "'", "''") & "', " & _
                    "STRMODIFINGLOCATION = '" & Replace(temp12, "'", "''") & "', " & _
                    "NUMFACILITYLONGITUDE = '" & Replace(temp13, "'", "''") & "', " & _
                    "NUMFACILITYLATITUDE = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE STRKEY = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next


    End Sub
    Sub TransferHBAPBHeaderData()

        SQL = "Select * " & _
        "from " & DBNameSpace & ".HB_APBHEADERDATA "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        SQL = "DELETE " & DBNameSpace & ".HB_APBHEADERDATA "
        cmd = New OracleCommand(SQL, transferConn)
        If transferConn.State = ConnectionState.Closed Then
            transferConn.Open()
        End If
        dr = cmd.ExecuteReader
        dr.Close()

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("STRKEY")) Then
                temp = ""
            Else
                temp = drDSRow("STRKEY")
            End If
            If IsDBNull(drDSRow("STRAIRSNUMBER")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("STRAIRSNUMBER")
            End If
            If IsDBNull(drDSRow("STROPERATIONALSTATUS")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("STROPERATIONALSTATUS")
            End If
            If IsDBNull(drDSRow("STRCLASS")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("STRCLASS")
            End If
            If IsDBNull(drDSRow("STRAIRPROGRAMCODES")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("STRAIRPROGRAMCODES")
            End If
            If IsDBNull(drDSRow("STRSICCODE")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("STRSICCODE")
            End If
            If IsDBNull(drDSRow("STRFEINUMBER")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("STRFEINUMBER")
            End If
            If IsDBNull(drDSRow("STRMODIFINGPERSON")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("STRMODIFINGPERSON")
            End If
            If IsDBNull(drDSRow("DATMODIFINGDATE")) Then
                temp9 = ""
            Else
                temp9 = Format(drDSRow("DATMODIFINGDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("DATSTARTUPDATE")) Then
                temp10 = ""
            Else
                temp10 = Format(drDSRow("DATSTARTUPDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("DATSHUTDOWNDATE")) Then
                temp11 = ""
            Else
                temp11 = Format(drDSRow("DATSHUTDOWNDATE"), "dd-MMM-yyyy")
            End If
            If IsDBNull(drDSRow("STRCOMMENTS")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("STRCOMMENTS")
            End If
            If IsDBNull(drDSRow("STRPLANTDESCRIPTION")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("STRPLANTDESCRIPTION")
            End If
            If IsDBNull(drDSRow("STRATTAINMENTSTATUS")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("STRATTAINMENTSTATUS")
            End If
            If IsDBNull(drDSRow("STRSTATEPROGRAMCODES")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("STRSTATEPROGRAMCODES")
            End If
            If IsDBNull(drDSRow("STRMODIFINGLOCATION")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("STRMODIFINGLOCATION")
            End If

            SQL = "Select " & _
           "strAIRSNumber " & _
           "from " & DBNameSpace & ".APBMasterAIRS " & _
           "where strAIRSNumber = '" & temp2 & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".HB_APBHEADERDATA " & _
                "WHERE STRKEY = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".HB_APBHEADERDATA " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".HB_APBHEADERDATA SET " & _
                    "STRKEY = '" & Replace(temp, "'", "''") & "', " & _
                    "STRAIRSNUMBER = '" & Replace(temp2, "'", "''") & "', " & _
                    "STROPERATIONALSTATUS = '" & Replace(temp3, "'", "''") & "', " & _
                    "STRCLASS = '" & Replace(temp4, "'", "''") & "', " & _
                    "STRAIRPROGRAMCODES = '" & Replace(temp5, "'", "''") & "', " & _
                    "STRSICCODE = '" & Replace(temp6, "'", "''") & "', " & _
                    "STRFEINUMBER = '" & Replace(temp7, "'", "''") & "', " & _
                    "STRMODIFINGPERSON = '" & Replace(temp8, "'", "''") & "', " & _
                    "DATMODIFINGDATE = '" & Replace(temp9, "'", "''") & "', " & _
                    "DATSTARTUPDATE = '" & Replace(temp10, "'", "''") & "', " & _
                    "DATSHUTDOWNDATE = '" & Replace(temp11, "'", "''") & "', " & _
                    "STRCOMMENTS = '" & Replace(temp12, "'", "''") & "', " & _
                    "STRPLANTDESCRIPTION = '" & Replace(temp13, "'", "''") & "', " & _
                    "STRATTAINMENTSTATUS = '" & Replace(temp14, "'", "''") & "', " & _
                    "STRSTATEPROGRAMCODES = '" & Replace(temp15, "'", "''") & "', " & _
                    "STRMODIFINGLOCATION = '" & Replace(temp16, "'", "''") & "' " & _
                    "WHERE STRKEY = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

    End Sub
    Sub TransferISMPDocumentTypes()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPDocumentType "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strKey")) Then
                temp = ""
            Else
                temp = drDSRow("strKey")
            End If
            If IsDBNull(drDSRow("strDocumentType")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strDocumentType")
            End If
            If IsDBNull(drDSRow("strTableName")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strTableName")
            End If
            If IsDBNull(drDSRow("strAFSPrint")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strAFSPrint")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPDocumentType " & _
            "WHERE strKey = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPDocumentType " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPDocumentType SET " & _
                "strKey = '" & Replace(temp, "'", "''") & "', " & _
                "strDocumentType = '" & Replace(temp2, "'", "''") & "', " & _
                "strTableName = '" & Replace(temp2, "'", "''") & "', " & _
                "strAFSPrint = '" & Replace(temp3, "'", "''") & "' " & _
                "WHERE strKey = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPFacilityAssignment()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPFacilityAssignment "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strISMPUnit")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strISMPUnit")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPFacilityAssignment " & _
            "WHERE strKey = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPFacilityAssignment " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPFacilityAssignment SET " & _
                "strAIRSNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strISMPUnit = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPMaster()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPMaster "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strAIRSnumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAIRSnumber")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp4 = ""
            Else
                temp4 = Format(drDSRow("datModifingDate"), "dd-MMM-yyyy")
            End If

            SQL = "Select " & _
            "strAIRSNumber " & _
            "from " & DBNameSpace & ".APBMasterAIRS " & _
            "where strAIRSNumber = '" & temp2 & "'"

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPMaster " & _
                "WHERE STRUNIT = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPMaster " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPMaster SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAIRSnumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp3, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next

    End Sub
    Sub TransferISMPReferenceNumber()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReferenceNumber "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPReferenceNumber " & _
            "WHERE strKey = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPReferenceNumber " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPReferenceNumber SET " & _
                "strReferenceNumber = '" & Replace(temp, "'", "''") & "' " & _
                "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next




    End Sub
    Sub TransferISMPReportFlare()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportFlare "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMaxOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strLimitationVelocity")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strLimitationVelocity")
            End If
            If IsDBNull(drDSRow("strLimitationHeatCapacity")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strLimitationHeatCapacity")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate1A")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strAllowableEmissionRate1A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate2A")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAllowableEmissionRate2A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate3A")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAllowableEmissionRate3A")
            End If
            If IsDBNull(drDSRow("strAllowEmissionRateUnit1A")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAllowEmissionRateUnit1A")
            End If
            If IsDBNull(drDSRow("strAllowEmissionRateUnit2A")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strAllowEmissionRateUnit2A")
            End If
            If IsDBNull(drDSRow("strAllowEmissionRateUnit3A")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strAllowEmissionRateUnit3A")
            End If
            If IsDBNull(drDSRow("strHeatingValue1A")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strHeatingValue1A")
            End If
            If IsDBNull(drDSRow("strHeatingValue2A")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strHeatingValue2A")
            End If
            If IsDBNull(drDSRow("strHeatingValue3A")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strHeatingValue3A")
            End If
            If IsDBNull(drDSRow("strHeatingValueUnits")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strHeatingValueUnits")
            End If
            If IsDBNull(drDSRow("strHeatingValueAvg")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strHeatingValueAvg")
            End If
            If IsDBNull(drDSRow("strVelocity1A")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strVelocity1A")
            End If
            If IsDBNull(drDSRow("strVelocity2A")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strVelocity2A")
            End If
            If IsDBNull(drDSRow("strVelocity3A")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strVelocity3A")
            End If
            If IsDBNull(drDSRow("strVelocityUnits")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strVelocityUnits")
            End If
            If IsDBNull(drDSRow("strVelocityAvg")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strVelocityAvg")
            End If
            If IsDBNull(drDSRow("strTestDuration")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strTestDuration")
            End If
            If IsDBNull(drDSRow("strTestDurationUnit")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strTestDurationUnit")
            End If
            If IsDBNull(drDSRow("strPollutantConcenIn")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strPollutantConcenIn")
            End If
            If IsDBNull(drDSRow("strPollutantConcenUnitIn")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strPollutantConcenUnitIn")
            End If
            If IsDBNull(drDSRow("strPollutantConcenOut")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strPollutantConcenOut")
            End If
            If IsDBNull(drDSRow("strPollutantConcenUnitOut")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strPollutantConcenUnitOut")
            End If
            If IsDBNull(drDSRow("strEmissionRate")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strEmissionRate")
            End If
            If IsDBNull(drDSRow("strEmissionRateUnit")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strEmissionRateUnit")
            End If
            If IsDBNull(drDSRow("strDestructionEfficiency")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strDestructionEfficiency")
            End If
            If IsDBNull(drDSRow("strPercentAllowable")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strPercentAllowable")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportFlare " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportFlare " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportFlare SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMaxOperatingCapacity = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp3, "'", "''") & "', " & _
                    "strOperatingCapacity = '" & Replace(temp4, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp5, "'", "''") & "', " & _
                    "strLimitationVelocity = '" & Replace(temp6, "'", "''") & "', " & _
                    "strLimitationHeatCapacity = '" & Replace(temp7, "'", "''") & "', " & _
                    "strAllowableEmissionRate1A = '" & Replace(temp8, "'", "''") & "', " & _
                    "strAllowableEmissionRate2A = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAllowableEmissionRate3A = '" & Replace(temp10, "'", "''") & "', " & _
                    "strAllowEmissionRateUnit1A = '" & Replace(temp11, "'", "''") & "', " & _
                    "strAllowEmissionRateUnit2A = '" & Replace(temp12, "'", "''") & "', " & _
                    "strAllowEmissionRateUnit3A = '" & Replace(temp13, "'", "''") & "', " & _
                    "strHeatingValue1A = '" & Replace(temp14, "'", "''") & "', " & _
                    "strHeatingValue2A = '" & Replace(temp15, "'", "''") & "', " & _
                    "strHeatingValue3A = '" & Replace(temp16, "'", "''") & "', " & _
                    "strHeatingValueUnits = '" & Replace(temp17, "'", "''") & "', " & _
                    "strHeatingValueAvg = '" & Replace(temp18, "'", "''") & "', " & _
                    "strVelocity1A = '" & Replace(temp19, "'", "''") & "', " & _
                    "strVelocity2A = '" & Replace(temp20, "'", "''") & "', " & _
                    "strVelocity3A = '" & Replace(temp21, "'", "''") & "', " & _
                    "strVelocityUnits = '" & Replace(temp22, "'", "''") & "', " & _
                    "strVelocityAvg = '" & Replace(temp23, "'", "''") & "', " & _
                    "strTestDuration = '" & Replace(temp24, "'", "''") & "', " & _
                    "strTestDurationUnit = '" & Replace(temp25, "'", "''") & "', " & _
                    "strPollutantConcenIn = '" & Replace(temp26, "'", "''") & "', " & _
                    "strPollutantConcenUnitIn = '" & Replace(temp27, "'", "''") & "', " & _
                    "strPollutantConcenOut = '" & Replace(temp28, "'", "''") & "', " & _
                    "strPollutantConcenUnitOut = '" & Replace(temp29, "'", "''") & "', " & _
                    "strEmissionRate = '" & Replace(temp30, "'", "''") & "', " & _
                    "strEmissionRateUnit = '" & Replace(temp31, "'", "''") & "', " & _
                    "strDestructionEfficiency = '" & Replace(temp32, "'", "''") & "', " & _
                    "strPercentAllowable = '" & Replace(temp33, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPReportInformation()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportInformation "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strPollutant")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strPollutant")
            End If
            If IsDBNull(drDSRow("strEmissionSource")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strEmissionSource")
            End If
            If IsDBNull(drDSRow("strReportType")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strReportType")
            End If
            If IsDBNull(drDSRow("strDocumentType")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strDocumentType")
            End If
            If IsDBNull(drDSRow("strApplicableRequirement")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strApplicableRequirement")
            End If
            If IsDBNull(drDSRow("strTestingFirm")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strTestingFirm")
            End If
            If IsDBNull(drDSRow("strReviewingEngineer")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strReviewingEngineer")
            End If
            If IsDBNull(drDSRow("strWitnessingEngineer")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strWitnessingEngineer")
            End If
            If IsDBNull(drDSRow("strWitnessingEngineer2")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strWitnessingEngineer2")
            End If
            If IsDBNull(drDSRow("strReviewingUnit")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strReviewingUnit")
            End If
            If IsDBNull(drDSRow("datReviewedByUnitManager")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("datReviewedByUnitManager")
            End If
            If IsDBNull(drDSRow("strComplianceManager")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strComplianceManager")
            End If
            If IsDBNull(drDSRow("datTestDateStart")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datTestDateStart")
            End If
            If IsDBNull(drDSRow("datTestDateEnd")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("datTestDateEnd")
            End If
            If IsDBNull(drDSRow("datReceivedDate")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("datReceivedDate")
            End If
            If IsDBNull(drDSRow("datCompleteDate")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("datCompleteDate")
            End If
            If IsDBNull(drDSRow("mmoCommentArea")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("mmoCommentArea")
            End If
            If IsDBNull(drDSRow("strClosed")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strClosed")
            End If
            If IsDBNull(drDSRow("strCommissioner")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strCommissioner")
            End If
            If IsDBNull(drDSRow("strDirector")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strDirector")
            End If
            If IsDBNull(drDSRow("strProgramManager")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strProgramManager")
            End If
            If IsDBNull(drDSRow("strComplianceStatus")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strComplianceStatus")
            End If
            If IsDBNull(drDSRow("strCC")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strCC")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strControlEquipmentData")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strControlEquipmentData")
            End If
            If IsDBNull(drDSRow("strDelete")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strDelete")
            End If
            If IsDBNull(drDSRow("strDeterminationMethod")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strDeterminationMethod")
            End If
            If IsDBNull(drDSRow("strOtherWitnessingEng")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strOtherWitnessingEng")
            End If
            If IsDBNull(drDSRow("strConfidentialData")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strConfidentialData")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPMaster " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportInformation " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportInformation " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportInformation SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strPollutant = '" & Replace(temp2, "'", "''") & "', " & _
                    "strEmissionSource = '" & Replace(temp3, "'", "''") & "', " & _
                    "strReportType = '" & Replace(temp4, "'", "''") & "', " & _
                    "strDocumentType = '" & Replace(temp5, "'", "''") & "', " & _
                    "strApplicableRequirement = '" & Replace(temp6, "'", "''") & "', " & _
                    "strTestingFirm = '" & Replace(temp7, "'", "''") & "', " & _
                    "strReviewingEngineer = '" & Replace(temp8, "'", "''") & "', " & _
                    "strWitnessingEngineer = '" & Replace(temp9, "'", "''") & "', " & _
                    "strWitnessingEngineer2 = '" & Replace(temp10, "'", "''") & "', " & _
                    "strReviewingUnit = '" & Replace(temp11, "'", "''") & "', " & _
                    "datReviewedByUnitManager = '" & Replace(temp12, "'", "''") & "', " & _
                    "strComplianceManager = '" & Replace(temp13, "'", "''") & "', " & _
                    "datTestDateStart = '" & Replace(temp14, "'", "''") & "', " & _
                    "datTestDateEnd = '" & Replace(temp15, "'", "''") & "', " & _
                    "datReceivedDate = '" & Replace(temp16, "'", "''") & "', " & _
                    "datCompleteDate = '" & Replace(temp17, "'", "''") & "', " & _
                    "mmoCommentArea = '" & Replace(temp18, "'", "''") & "', " & _
                    "strClosed = '" & Replace(temp19, "'", "''") & "', " & _
                    "strCommissioner = '" & Replace(temp20, "'", "''") & "', " & _
                    "strDirector = '" & Replace(temp21, "'", "''") & "', " & _
                    "strProgramManager = '" & Replace(temp22, "'", "''") & "', " & _
                    "strComplianceStatus = '" & Replace(temp23, "'", "''") & "', " & _
                    "strCC = '" & Replace(temp24, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp25, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp26, "'", "''") & "', " & _
                    "strControlEquipmentData = '" & Replace(temp27, "'", "''") & "', " & _
                    "strDelete = '" & Replace(temp28, "'", "''") & "', " & _
                    "strDeterminationMethod = '" & Replace(temp29, "'", "''") & "', " & _
                    "strOtherWitnessingEng = '" & Replace(temp30, "'", "''") & "', " & _
                    "strConfidentialData = '" & Replace(temp31, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPREportMemo()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportMemo "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMemorandumField")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMemorandumField")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissioNRate1A")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strAllowableEmissioNRate1A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissioNRate1B")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strAllowableEmissioNRate1B")
            End If
            If IsDBNull(drDSRow("strAllowableEmissioNRate1C")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAllowableEmissioNRate1C")
            End If
            If IsDBNull(drDSRow("strAllowableEmisssionRateUnit1A")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAllowableEmisssionRateUnit1A")
            End If
            If IsDBNull(drDSRow("strAllowableEmisssionRateUnit1B")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAllowableEmisssionRateUnit1B")
            End If
            If IsDBNull(drDSRow("strAllowableEmisssionRateUnit1C")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strAllowableEmisssionRateUnit1C")
            End If
            If IsDBNull(drDSRow("strMonitorManufactureAndModel")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strMonitorManufactureAndModel")
            End If
            If IsDBNull(drDSRow("strMonitorSerialNumber")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strMonitorSerialNumber")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportMemo " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportMemo " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportMemo SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMemorandumField = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacity = '" & Replace(temp3, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp4, "'", "''") & "', " & _
                    "strOperatingCapacity = '" & Replace(temp5, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp6, "'", "''") & "', " & _
                    "strAllowableEmissioNRate1A = '" & Replace(temp7, "'", "''") & "', " & _
                    "strAllowableEmissioNRate1B = '" & Replace(temp8, "'", "''") & "', " & _
                    "strAllowableEmissioNRate1C = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit1A = '" & Replace(temp10, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit1B = '" & Replace(temp11, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit1C = '" & Replace(temp12, "'", "''") & "', " & _
                    "strMonitorManufactureAndModel = '" & Replace(temp13, "'", "''") & "', " & _
                    "strMonitorSerialNumber = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPReportOneStack()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportOneStack "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMaxOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate1")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strAllowableEmissionRate1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate2")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strAllowableEmissionRate2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate3")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strAllowableEmissionRate3")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit1")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAllowableEmissionRateUnit1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit2")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAllowableEmissionRateUnit2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit3")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAllowableEmissionRateUnit3")
            End If
            If IsDBNull(drDSRow("strRunNumber1A")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strRunNumber1A")
            End If
            If IsDBNull(drDSRow("strRunNumber1B")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strRunNumber1B")
            End If
            If IsDBNull(drDSRow("strRunNumber1C")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strRunNumber1C")
            End If
            If IsDBNull(drDSRow("strRunNumber1D")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strRunNumber1D")
            End If
            If IsDBNull(drDSRow("strGasTemperature1A")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strGasTemperature1A")
            End If
            If IsDBNull(drDSRow("strGasTemperature1B")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strGasTemperature1B")
            End If
            If IsDBNull(drDSRow("strGasTemperature1C")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strGasTemperature1C")
            End If
            If IsDBNull(drDSRow("strGasTemperature1D")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strGasTemperature1D")
            End If
            If IsDBNull(drDSRow("strGasMoisture1A")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strGasMoisture1A")
            End If
            If IsDBNull(drDSRow("strGasMoisture1B")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strGasMoisture1B")
            End If
            If IsDBNull(drDSRow("strGasMoisture1C")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strGasMoisture1C")
            End If
            If IsDBNull(drDSRow("strGasMoisture1D")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strGasMoisture1D")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1A")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strGasFlowRateACFM1A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1B")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strGasFlowRateACFM1B")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1C")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strGasFlowRateACFM1C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1D")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strGasFlowRateACFM1D")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1A")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strGasFlowRateDSCFM1A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1B")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strGasFlowRateDSCFM1B")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1C")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strGasFlowRateDSCFM1C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1D")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strGasFlowRateDSCFM1D")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1A")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strPollutantConcentration1A")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1B")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strPollutantConcentration1B")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1C")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("strPollutantConcentration1C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1D")) Then
                temp35 = ""
            Else
                temp35 = drDSRow("strPollutantConcentration1D")
            End If
            If IsDBNull(drDSRow("strPollutantConcentrationUnit")) Then
                temp36 = ""
            Else
                temp36 = drDSRow("strPollutantConcentrationUnit")
            End If
            If IsDBNull(drDSRow("strPollutantConcentrationAvg")) Then
                temp37 = ""
            Else
                temp37 = drDSRow("strPollutantConcentrationAvg")
            End If
            If IsDBNull(drDSRow("strEmissionRate1A")) Then
                temp38 = ""
            Else
                temp38 = drDSRow("strEmissionRate1A")
            End If
            If IsDBNull(drDSRow("strEmissionRate1B")) Then
                temp39 = ""
            Else
                temp39 = drDSRow("strEmissionRate1B")
            End If
            If IsDBNull(drDSRow("strEmissionRate1C")) Then
                temp40 = ""
            Else
                temp40 = drDSRow("strEmissionRate1C")
            End If
            If IsDBNull(drDSRow("strEmissionRate1D")) Then
                temp41 = ""
            Else
                temp41 = drDSRow("strEmissionRate1D")
            End If
            If IsDBNull(drDSRow("strEmissionRateUnit")) Then
                temp42 = ""
            Else
                temp42 = drDSRow("strEmissionRateUnit")
            End If
            If IsDBNull(drDSRow("strEmissionRateAvg")) Then
                temp43 = ""
            Else
                temp43 = drDSRow("strEmissionRateAvg")
            End If
            If IsDBNull(drDSRow("strPercentAllowable")) Then
                temp44 = ""
            Else
                temp44 = drDSRow("strPercentAllowable")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportOneStack " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportOneStack " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "', '" & Replace(temp34, "'", "''") & "', " & _
                    "'" & Replace(temp35, "'", "''") & "', '" & Replace(temp36, "'", "''") & "', " & _
                    "'" & Replace(temp37, "'", "''") & "', '" & Replace(temp38, "'", "''") & "', " & _
                    "'" & Replace(temp39, "'", "''") & "', '" & Replace(temp40, "'", "''") & "', " & _
                    "'" & Replace(temp41, "'", "''") & "', '" & Replace(temp42, "'", "''") & "', " & _
                    "'" & Replace(temp43, "'", "''") & "', '" & Replace(temp44, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportOneStack SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMaxOperatingCapacity = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp3, "'", "''") & "', " & _
                    "strOperatingCapacity = '" & Replace(temp4, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp5, "'", "''") & "', " & _
                    "strAllowableEmissionRate1 = '" & Replace(temp6, "'", "''") & "', " & _
                    "strAllowableEmissionRate2 = '" & Replace(temp7, "'", "''") & "', " & _
                    "strAllowableEmissionRate3 = '" & Replace(temp8, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit1 = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit2 = '" & Replace(temp10, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit3 = '" & Replace(temp11, "'", "''") & "', " & _
                    "strRunNumber1A = '" & Replace(temp12, "'", "''") & "', " & _
                    "strRunNumber1B = '" & Replace(temp13, "'", "''") & "', " & _
                    "strRunNumber1C = '" & Replace(temp14, "'", "''") & "', " & _
                    "strRunNumber1D = '" & Replace(temp15, "'", "''") & "', " & _
                    "strGasTemperature1A = '" & Replace(temp16, "'", "''") & "', " & _
                    "strGasTemperature1B = '" & Replace(temp17, "'", "''") & "', " & _
                    "strGasTemperature1C = '" & Replace(temp18, "'", "''") & "', " & _
                    "strGasTemperature1D = '" & Replace(temp19, "'", "''") & "', " & _
                    "strGasMoisture1A = '" & Replace(temp20, "'", "''") & "', " & _
                    "strGasMoisture1B = '" & Replace(temp21, "'", "''") & "', " & _
                    "strGasMoisture1C = '" & Replace(temp22, "'", "''") & "', " & _
                    "strGasMoisture1D = '" & Replace(temp23, "'", "''") & "', " & _
                    "strGasFlowRateACFM1A = '" & Replace(temp24, "'", "''") & "', " & _
                    "strGasFlowRateACFM1B = '" & Replace(temp25, "'", "''") & "', " & _
                    "strGasFlowRateACFM1C = '" & Replace(temp26, "'", "''") & "', " & _
                    "strGasFlowRateACFM1D = '" & Replace(temp27, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1A = '" & Replace(temp28, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1B = '" & Replace(temp29, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1C = '" & Replace(temp30, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1D = '" & Replace(temp31, "'", "''") & "', " & _
                    "strPollutantConcentration1A = '" & Replace(temp32, "'", "''") & "', " & _
                    "strPollutantConcentration1B = '" & Replace(temp33, "'", "''") & "', " & _
                    "strPollutantConcentration1C = '" & Replace(temp34, "'", "''") & "', " & _
                    "strPollutantConcentration1D = '" & Replace(temp35, "'", "''") & "', " & _
                    "strPollutantConcentrationUnit = '" & Replace(temp36, "'", "''") & "', " & _
                    "strPollutantConcentrationAvg = '" & Replace(temp37, "'", "''") & "', " & _
                    "strEmissionRate1A = '" & Replace(temp38, "'", "''") & "', " & _
                    "strEmissionRate1B = '" & Replace(temp39, "'", "''") & "', " & _
                    "strEmissionRate1C = '" & Replace(temp40, "'", "''") & "', " & _
                    "strEmissionRate1D = '" & Replace(temp41, "'", "''") & "', " & _
                    "strEmissionRateUnit = '" & Replace(temp42, "'", "''") & "', " & _
                    "strEmissionRateAvg = '" & Replace(temp43, "'", "''") & "', " & _
                    "strPercentAllowable = '" & Replace(temp44, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPREportOpacity()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".ISMPReportOpacity "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity1A")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMaxOperatingCapacity1A")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity2A")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacity2A")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity3A")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strMaxOperatingCapacity3A")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity4A")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strMaxOperatingCapacity4A")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity5A")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strMaxOperatingCapacity5A")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity1A")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strOperatingCapacity1A")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity2A")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strOperatingCapacity2A")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity3A")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strOperatingCapacity3A")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity4A")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strOperatingCapacity4A")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity5A")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strOperatingCapacity5A")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate1A")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strAllowableEmissionRate1A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate2A")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strAllowableEmissionRate2A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate3A")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strAllowableEmissionRate3A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate4A")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strAllowableEmissionRate4A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate5A")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strAllowableEmissionRate5A")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strAllowableEmissionRateUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate22")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strAllowableEmissionRate22")
            End If
            If IsDBNull(drDSRow("strOpacityTestDuration")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strOpacityTestDuration")
            End If
            If IsDBNull(drDSRow("strAccumulatedEmissionTime")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strAccumulatedEmissionTime")
            End If
            If IsDBNull(drDSRow("strOpacityPointA")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strOpacityPointA")
            End If
            If IsDBNull(drDSRow("strOpacityPointB")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strOpacityPointB")
            End If
            If IsDBNull(drDSRow("strOpacityPointC")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strOpacityPointC")
            End If
            If IsDBNull(drDSRow("strOpacityPointD")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strOpacityPointD")
            End If
            If IsDBNull(drDSRow("strOpacityPointE")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strOpacityPointE")
            End If
            If IsDBNull(drDSRow("strEquipmentItem1")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strEquipmentItem1")
            End If
            If IsDBNull(drDSRow("strEquipmentItem2")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strEquipmentItem2")
            End If
            If IsDBNull(drDSRow("strEquipmentItem3")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strEquipmentItem#")
            End If
            If IsDBNull(drDSRow("strEquipmentItem4")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strEquipmentItem4")
            End If
            If IsDBNull(drDSRow("strEquipmentItem5")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strEquipmentItem5")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportOpacity " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportOpacity " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportOpacity SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMaxOperatingCapacity1A = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacity2A = '" & Replace(temp3, "'", "''") & "', " & _
                    "strMaxOperatingCapacity3A = '" & Replace(temp4, "'", "''") & "', " & _
                    "strMaxOperatingCapacity4A = '" & Replace(temp5, "'", "''") & "', " & _
                    "strMaxOperatingCapacity5A = '" & Replace(temp6, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp7, "'", "''") & "', " & _
                    "strOperatingCapacity1A = '" & Replace(temp8, "'", "''") & "', " & _
                    "strOperatingCapacity2A = '" & Replace(temp9, "'", "''") & "', " & _
                    "strOperatingCapacity3A = '" & Replace(temp10, "'", "''") & "', " & _
                    "strOperatingCapacity4A = '" & Replace(temp11, "'", "''") & "', " & _
                    "strOperatingCapacity5A = '" & Replace(temp12, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp13, "'", "''") & "', " & _
                    "strAllowableEmissionRate1A = '" & Replace(temp14, "'", "''") & "' " & _
                    "strAllowableEmissionRate2A = '" & Replace(temp15, "'", "''") & "', " & _
                    "strAllowableEmissionRate3A = '" & Replace(temp16, "'", "''") & "', " & _
                    "strAllowableEmissionRate4A = '" & Replace(temp17, "'", "''") & "', " & _
                    "strAllowableEmissionRate5A = '" & Replace(temp18, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit = '" & Replace(temp19, "'", "''") & "', " & _
                    "strAllowableEmissionRate22 = '" & Replace(temp20, "'", "''") & "', " & _
                    "strOpacityTestDuration = '" & Replace(temp21, "'", "''") & "', " & _
                    "strAccumulatedEmissionTime = '" & Replace(temp22, "'", "''") & "', " & _
                    "strOpacityPointA = '" & Replace(temp23, "'", "''") & "', " & _
                    "strOpacityPointB = '" & Replace(temp24, "'", "''") & "', " & _
                    "strOpacityPointC = '" & Replace(temp25, "'", "''") & "', " & _
                    "strOpacityPointD = '" & Replace(temp26, "'", "''") & "', " & _
                    "strOpacityPointE = '" & Replace(temp27, "'", "''") & "', " & _
                    "strEquipmentItem1 = '" & Replace(temp28, "'", "''") & "', " & _
                    "strEquipmentItem2 = '" & Replace(temp29, "'", "''") & "', " & _
                    "strEquipmentItem3 = '" & Replace(temp30, "'", "''") & "', " & _
                    "strEquipmentItem4 = '" & Replace(temp31, "'", "''") & "', " & _
                    "strEquipmentItem5 = '" & Replace(temp32, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPREportPondAndGas()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportPondAndGas "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMaxOperatingcapacity")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMaxOperatingcapacity")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate1")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strAllowableEmissionRate1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate2")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strAllowableEmissionRate2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate3")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strAllowableEmissionRate3")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit1")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAllowableEmissionRateUnit1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit2")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAllowableEmissionRateUnit2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit3")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAllowableEmissionRateUnit3")
            End If
            If IsDBNull(drDSRow("strRunNumber1A")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strRunNumber1A")
            End If
            If IsDBNull(drDSRow("strRunNumber1B")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strRunNumber1B")
            End If
            If IsDBNull(drDSRow("strRunNumber1C")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strRunNumber1C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1A")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strPollutantConcentration1A")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1B")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strPollutantConcentration1B")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1C")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strPollutantConcentration1C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentrationUnit")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strPollutantConcentrationUnit")
            End If
            If IsDBNull(drDSRow("strPollutantConcentractionAvg")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strPollutantConcentractionAvg")
            End If
            If IsDBNull(drDSRow("strEmissionRate1A")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strEmissionRate1A")
            End If
            If IsDBNull(drDSRow("strEmissionRate1B")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strEmissionRate1B")
            End If
            If IsDBNull(drDSRow("strEmissionRate1C")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strEmissionRate1C")
            End If
            If IsDBNull(drDSRow("strEmissionRateUnit")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strEmissionRateUnit")
            End If
            If IsDBNull(drDSRow("strEmissionRateAvg")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strEmissionRateAvg")
            End If
            If IsDBNull(drDSRow("strTreatmentRate1A")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strTreatmentRate1A")
            End If
            If IsDBNull(drDSRow("strTreatmentRate1B")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strTreatmentRate1B")
            End If
            If IsDBNull(drDSRow("strTreatmentRate1C")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strTreatmentRate1C")
            End If
            If IsDBNull(drDSRow("strTreatmentRateUnit")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strTreatmentRateUnit")
            End If
            If IsDBNull(drDSRow("strTreatmentRateAvg")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strTreatmentRateAvg")
            End If
            If IsDBNull(drDSRow("strPercentAllowable")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strPercentAllowable")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportPondAndGas " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportPondAndGas " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportPondAndGas SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMaxOperatingCapacity = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp3, "'", "''") & "', " & _
                    "strOperatingCapacity = '" & Replace(temp4, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp5, "'", "''") & "', " & _
                    "strAllowableEmissionRate1 = '" & Replace(temp6, "'", "''") & "', " & _
                    "strAllowableEmissionRate2 = '" & Replace(temp7, "'", "''") & "', " & _
                    "strAllowableEmissionRate3 = '" & Replace(temp8, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit1 = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit2 = '" & Replace(temp10, "'", "''") & "', " & _
                    "strAllowableEmissionRateUnit3 = '" & Replace(temp11, "'", "''") & "', " & _
                    "strRunNumber1A = '" & Replace(temp12, "'", "''") & "', " & _
                    "strRunNumber1B = '" & Replace(temp13, "'", "''") & "', " & _
                    "strRunNumber1C = '" & Replace(temp14, "'", "''") & "', " & _
                    "strPollutantConcentration1A = '" & Replace(temp15, "'", "''") & "', " & _
                    "strPollutantConcentration1B = '" & Replace(temp16, "'", "''") & "', " & _
                    "strPollutantConcentration1C = '" & Replace(temp17, "'", "''") & "', " & _
                    "strPollutantConcentrationUnit = '" & Replace(temp18, "'", "''") & "', " & _
                    "strPollutantConcentractionAvg = '" & Replace(temp19, "'", "''") & "', " & _
                    "strEmissionRate1A = '" & Replace(temp20, "'", "''") & "', " & _
                    "strEmissionRate1B = '" & Replace(temp21, "'", "''") & "', " & _
                    "strEmissionRate1C = '" & Replace(temp22, "'", "''") & "', " & _
                    "strEmissionRateUnit = '" & Replace(temp23, "'", "''") & "', " & _
                    "strEmissionRateAvg = '" & Replace(temp24, "'", "''") & "', " & _
                    "strTreatmentRate1A = '" & Replace(temp25, "'", "''") & "', " & _
                    "strTreatmentRate1B = '" & Replace(temp26, "'", "''") & "', " & _
                    "strTreatmentRate1C = '" & Replace(temp27, "'", "''") & "', " & _
                    "strTreatmentRateUnit = '" & Replace(temp28, "'", "''") & "', " & _
                    "strTreatmentRateAvg = '" & Replace(temp29, "'", "''") & "', " & _
                    "strPercentAllowable = '" & Replace(temp30, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPReportRATA()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportRata "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strDiluent")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strDiluent")
            End If
            If IsDBNull(drDSRow("strApplicableStandard")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strApplicableStandard")
            End If
            If IsDBNull(drDSRow("strRelativeAccuracyPercent")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strRelativeAccuracyPercent")
            End If
            If IsDBNull(drDSRow("strReferenceMethod1")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strReferenceMethod1")
            End If
            If IsDBNull(drDSRow("strReferenceMethod2")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strReferenceMethod2")
            End If
            If IsDBNull(drDSRow("strReferenceMethod3")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strReferenceMethod3")
            End If
            If IsDBNull(drDSRow("strReferenceMethod4")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strReferenceMethod4")
            End If
            If IsDBNull(drDSRow("strReferenceMethod5")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strReferenceMethod5")
            End If
            If IsDBNull(drDSRow("strReferenceMethod6")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strReferenceMethod6")
            End If
            If IsDBNull(drDSRow("strReferenceMethod7")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strReferenceMethod7")
            End If
            If IsDBNull(drDSRow("strReferenceMethod8")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strReferenceMethod8")
            End If
            If IsDBNull(drDSRow("strReferenceMethod9")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strReferenceMethod9")
            End If
            If IsDBNull(drDSRow("strReferenceMethod10")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strReferenceMethod10")
            End If
            If IsDBNull(drDSRow("strReferenceMethod11")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strReferenceMethod11")
            End If
            If IsDBNull(drDSRow("strReferenceMethod12")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strReferenceMethod12")
            End If
            If IsDBNull(drDSRow("strRataUnits")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strRataUnits")
            End If
            If IsDBNull(drDSRow("strCMS1")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strCMS1")
            End If
            If IsDBNull(drDSRow("strCMS2")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strCMS2")
            End If
            If IsDBNull(drDSRow("strCMS3")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strCMS3")
            End If
            If IsDBNull(drDSRow("strCMS4")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strCMS4")
            End If
            If IsDBNull(drDSRow("strCMS5")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strCMS5")
            End If
            If IsDBNull(drDSRow("strCMS6")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strCMS6")
            End If
            If IsDBNull(drDSRow("strCMS7")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strCMS7")
            End If
            If IsDBNull(drDSRow("strCMS8")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strCMS8")
            End If
            If IsDBNull(drDSRow("strCMS9")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strCMS9")
            End If
            If IsDBNull(drDSRow("strCMS10")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strCMS10")
            End If
            If IsDBNull(drDSRow("strCMS11")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strCMS11")
            End If
            If IsDBNull(drDSRow("strCMS12")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strCMS12")
            End If
            If IsDBNull(drDSRow("strAccuracyChoice")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strAccuracyChoice")
            End If
            If IsDBNull(drDSRow("strAccuracyRequiredPercent")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strAccuracyRequiredPercent")
            End If
            If IsDBNull(drDSRow("strAccuracyRequiredStatement")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strAccuracyRequiredStatement")
            End If
            If IsDBNull(drDSRow("strRunsIncludedKey")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strRunsIncludedKey")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportRata " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportRata " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportRata SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strDiluent = '" & Replace(temp2, "'", "''") & "', " & _
                    "strApplicableStandard = '" & Replace(temp3, "'", "''") & "', " & _
                    "strRelativeAccuracyPercent = '" & Replace(temp4, "'", "''") & "', " & _
                    "strReferenceMethod1 = '" & Replace(temp5, "'", "''") & "', " & _
                    "strReferenceMethod2 = '" & Replace(temp6, "'", "''") & "', " & _
                    "strReferenceMethod3 = '" & Replace(temp7, "'", "''") & "', " & _
                    "strReferenceMethod4 = '" & Replace(temp8, "'", "''") & "', " & _
                    "strReferenceMethod5 = '" & Replace(temp9, "'", "''") & "', " & _
                    "strReferenceMethod6 = '" & Replace(temp10, "'", "''") & "', " & _
                    "strReferenceMethod7 = '" & Replace(temp11, "'", "''") & "', " & _
                    "strReferenceMethod8 = '" & Replace(temp12, "'", "''") & "', " & _
                    "strReferenceMethod9 = '" & Replace(temp13, "'", "''") & "', " & _
                    "strReferenceMethod10 = '" & Replace(temp14, "'", "''") & "', " & _
                    "strReferenceMethod11 = '" & Replace(temp15, "'", "''") & "', " & _
                    "strReferenceMethod12 = '" & Replace(temp16, "'", "''") & "', " & _
                    "strRataUnits = '" & Replace(temp17, "'", "''") & "', " & _
                    "strCMS1 = '" & Replace(temp18, "'", "''") & "', " & _
                    "strCMS2 = '" & Replace(temp19, "'", "''") & "', " & _
                    "strCMS3 = '" & Replace(temp20, "'", "''") & "', " & _
                    "strCMS4 = '" & Replace(temp21, "'", "''") & "', " & _
                    "strCMS5 = '" & Replace(temp22, "'", "''") & "', " & _
                    "strCMS6 = '" & Replace(temp23, "'", "''") & "', " & _
                    "strCMS7 = '" & Replace(temp24, "'", "''") & "', " & _
                    "strCMS8 = '" & Replace(temp25, "'", "''") & "', " & _
                    "strCMS9 = '" & Replace(temp26, "'", "''") & "', " & _
                    "strCMS10 = '" & Replace(temp27, "'", "''") & "', " & _
                    "strCMS11 = '" & Replace(temp28, "'", "''") & "', " & _
                    "strCMS12 = '" & Replace(temp29, "'", "''") & "', " & _
                    "strAccuracyChoice = '" & Replace(temp30, "'", "''") & "', " & _
                    "strAccuracyRequiredPercent = '" & Replace(temp31, "'", "''") & "', " & _
                    "strAccuracyRequiredStatement = '" & Replace(temp32, "'", "''") & "', " & _
                    "strRunsIncludedKey = '" & Replace(temp33, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPREportTwoStack()
        SQL = "Select * " & _
      "from " & DBNameSpace & ".ISMPReportTwoStack "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacity")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMaxOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strMaxOperatingCapacityUnit")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strMaxOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strOperatingCapacity")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strOperatingCapacity")
            End If
            If IsDBNull(drDSRow("strOperatingCapacityUnit")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strOperatingCapacityUnit")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate1")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strAllowableEmissionRate1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate2")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strAllowableEmissionRate2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRate3")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strAllowableEmissionRate3")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit1")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAllowableEmissionRateUnit1")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit2")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAllowableEmissionRateUnit2")
            End If
            If IsDBNull(drDSRow("strAllowableEmissionRateUnit3")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strAllowableEmissionRateUnit3")
            End If
            If IsDBNull(drDSRow("strStackOneName")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strStackOneName")
            End If
            If IsDBNull(drDSRow("strStackTwoName")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strStackTwoName")
            End If
            If IsDBNull(drDSRow("strRunNumber1A")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strRunNumber1A")
            End If
            If IsDBNull(drDSRow("strRunNumber1B")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strRunNumber1B")
            End If
            If IsDBNull(drDSRow("strRunNumber1C")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strRunNumber1C")
            End If
            If IsDBNull(drDSRow("strRunNumber2A")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strRunNumber2A")
            End If
            If IsDBNull(drDSRow("strRunNumber2B")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strRunNumber2B")
            End If
            If IsDBNull(drDSRow("strRunNumber2c")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strRunNumber2C")
            End If
            If IsDBNull(drDSRow("strGasTemperature1A")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strGasTemperature1A")
            End If
            If IsDBNull(drDSRow("strGasTemperature1B")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strGasTemperature1B")
            End If
            If IsDBNull(drDSRow("strGasTemperature1C")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strGasTemperature1C")
            End If
            If IsDBNull(drDSRow("strGasTemperature2A")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strGasTemperature2A")
            End If
            If IsDBNull(drDSRow("strGasTemperature2B")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strGasTemperature2B")
            End If
            If IsDBNull(drDSRow("strGasTemperature2C")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strGasTemperature2C")
            End If
            If IsDBNull(drDSRow("strGasMoisture1A")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strGasMoisture1A")
            End If
            If IsDBNull(drDSRow("strGasMoisture1B")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strGasMoisture1B")
            End If
            If IsDBNull(drDSRow("strGasMoisture1C")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strGasMoisture1C")
            End If
            If IsDBNull(drDSRow("strGasMoisture2A")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strGasMoisture2A")
            End If
            If IsDBNull(drDSRow("strGasMoisture2B")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strGasMoisture2B")
            End If
            If IsDBNull(drDSRow("strGasMoisture2C")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strGasMoisture2C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1A")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strGasFlowRateACFM1A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1B")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strGasFlowRateACFM1B")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM1C")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("strGasFlowRateACFM1C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM2A")) Then
                temp35 = ""
            Else
                temp35 = drDSRow("strGasFlowRateACFM2A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateACFM2B")) Then
                temp36 = ""
            Else
                temp36 = drDSRow("strGasFlowRateACFM2B")
            End If

            If IsDBNull(drDSRow("strGasFlowRateACFM2C")) Then
                temp37 = ""
            Else
                temp37 = drDSRow("strGasFlowRateACFM2C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1A")) Then
                temp38 = ""
            Else
                temp38 = drDSRow("strGasFlowRateDSCFM1A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1B")) Then
                temp39 = ""
            Else
                temp39 = drDSRow("strGasFlowRateDSCFM1B")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM1C")) Then
                temp40 = ""
            Else
                temp40 = drDSRow("strGasFlowRateDSCFM1C")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM2A")) Then
                temp41 = ""
            Else
                temp41 = drDSRow("strGasFlowRateDSCFM2A")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM2B")) Then
                temp42 = ""
            Else
                temp42 = drDSRow("strGasFlowRateDSCFM2B")
            End If
            If IsDBNull(drDSRow("strGasFlowRateDSCFM2C")) Then
                temp43 = ""
            Else
                temp43 = drDSRow("strGasFlowRateDSCFM2C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1A")) Then
                temp44 = ""
            Else
                temp44 = drDSRow("strPollutantConcentration1A")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1B")) Then
                temp45 = ""
            Else
                temp45 = drDSRow("strPollutantConcentration1B")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration1C")) Then
                temp46 = ""
            Else
                temp46 = drDSRow("strPollutantConcentration1C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration2A")) Then
                temp47 = ""
            Else
                temp47 = drDSRow("strPollutantConcentration2A")
            End If

            If IsDBNull(drDSRow("strPollutantConcentration2B")) Then
                temp48 = ""
            Else
                temp48 = drDSRow("strPollutantConcentration2B")
            End If
            If IsDBNull(drDSRow("strPollutantConcentration2C")) Then
                temp49 = ""
            Else
                temp49 = drDSRow("strPollutantConcentration2C")
            End If
            If IsDBNull(drDSRow("strPollutantConcentractionUnit")) Then
                temp50 = ""
            Else
                temp50 = drDSRow("strPollutantConcentractionUnit")
            End If
            If IsDBNull(drDSRow("strPollutantConcentractionAvg1")) Then
                temp51 = ""
            Else
                temp51 = drDSRow("strPollutantConcentractionAvg1")
            End If
            If IsDBNull(drDSRow("strPollutantConcentractionAvg2")) Then
                temp52 = ""
            Else
                temp52 = drDSRow("strPollutantConcentractionAvg2")
            End If
            If IsDBNull(drDSRow("strEmissionRate1A")) Then
                temp53 = ""
            Else
                temp53 = drDSRow("strEmissionRate1A")
            End If
            If IsDBNull(drDSRow("strEmissionRate1B")) Then
                temp54 = ""
            Else
                temp54 = drDSRow("strEmissionRate1B")
            End If
            If IsDBNull(drDSRow("strEmissionRate1C")) Then
                temp55 = ""
            Else
                temp55 = drDSRow("strEmissionRate1C")
            End If
            If IsDBNull(drDSRow("strEmissionRate2A")) Then
                temp56 = ""
            Else
                temp56 = drDSRow("strEmissionRate2A")
            End If
            If IsDBNull(drDSRow("strEmissionRate2B")) Then
                temp57 = ""
            Else
                temp57 = drDSRow("strEmissionRate2B")
            End If
            If IsDBNull(drDSRow("strEmissionRate2C")) Then
                temp58 = ""
            Else
                temp58 = drDSRow("strEmissionRate2C")
            End If
            If IsDBNull(drDSRow("strEmissionRateUnit")) Then
                temp59 = ""
            Else
                temp59 = drDSRow("strEmissionRateUnit")
            End If
            If IsDBNull(drDSRow("strEmissionRateAvg1")) Then
                temp60 = ""
            Else
                temp60 = drDSRow("strEmissionRateAvg1")
            End If
            If IsDBNull(drDSRow("strEmissionRateAvg2")) Then
                temp61 = ""
            Else
                temp61 = drDSRow("strEmissionRateAvg2")
            End If
            If IsDBNull(drDSRow("strEmissionRateTotal1")) Then
                temp62 = ""
            Else
                temp62 = drDSRow("strEmissionRateTotal1")
            End If
            If IsDBNull(drDSRow("strEmissionRateTotal2")) Then
                temp63 = ""
            Else
                temp63 = drDSRow("strEmissionRateTotal2")
            End If
            If IsDBNull(drDSRow("strEmissionRateTotal3")) Then
                temp64 = ""
            Else
                temp64 = drDSRow("strEmissionRateTotal3")
            End If
            If IsDBNull(drDSRow("strEmissionRateTotalAvg")) Then
                temp65 = ""
            Else
                temp65 = drDSRow("strEmissionRateTotalAvg")
            End If
            If IsDBNull(drDSRow("strDestructionPercent")) Then
                temp66 = ""
            Else
                temp66 = drDSRow("strDestructionPercent")
            End If
            If IsDBNull(drDSRow("strPercentAllowable")) Then
                temp67 = ""
            Else
                temp67 = drDSRow("strPercentAllowable")
            End If
           
            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPReportInformation " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".ISMPReportTwoStack " & _
                "WHERE strReferenceNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".ISMPReportTwoStack " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "', '" & Replace(temp34, "'", "''") & "', " & _
                    "'" & Replace(temp35, "'", "''") & "', '" & Replace(temp36, "'", "''") & "', " & _
                    "'" & Replace(temp37, "'", "''") & "', '" & Replace(temp38, "'", "''") & "', " & _
                    "'" & Replace(temp39, "'", "''") & "', '" & Replace(temp40, "'", "''") & "', " & _
                    "'" & Replace(temp41, "'", "''") & "', '" & Replace(temp42, "'", "''") & "', " & _
                    "'" & Replace(temp43, "'", "''") & "', '" & Replace(temp44, "'", "''") & "', " & _
                    "'" & Replace(temp45, "'", "''") & "', '" & Replace(temp46, "'", "''") & "', " & _
                    "'" & Replace(temp47, "'", "''") & "', '" & Replace(temp48, "'", "''") & "', " & _
                    "'" & Replace(temp49, "'", "''") & "', '" & Replace(temp50, "'", "''") & "', " & _
                    "'" & Replace(temp51, "'", "''") & "', '" & Replace(temp52, "'", "''") & "', " & _
                    "'" & Replace(temp53, "'", "''") & "', '" & Replace(temp54, "'", "''") & "', " & _
                    "'" & Replace(temp55, "'", "''") & "', '" & Replace(temp56, "'", "''") & "', " & _
                    "'" & Replace(temp57, "'", "''") & "', '" & Replace(temp58, "'", "''") & "', " & _
                    "'" & Replace(temp59, "'", "''") & "', '" & Replace(temp60, "'", "''") & "', " & _
                    "'" & Replace(temp61, "'", "''") & "', '" & Replace(temp62, "'", "''") & "', " & _
                    "'" & Replace(temp63, "'", "''") & "', '" & Replace(temp64, "'", "''") & "', " & _
                    "'" & Replace(temp65, "'", "''") & "', '" & Replace(temp66, "'", "''") & "', " & _
                    "'" & Replace(temp67, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".ISMPReportTwoStack SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMaxOperatingCapacity = '" & Replace(temp2, "'", "''") & "', " & _
                    "strMaxOperatingCapacityUnit = '" & Replace(temp3, "'", "''") & "', " & _
                    "strOperatingCapacity = '" & Replace(temp4, "'", "''") & "', " & _
                    "strOperatingCapacityUnit = '" & Replace(temp5, "'", "''") & "', " & _
                    "strAllowableEmissioNRate1 = '" & Replace(temp6, "'", "''") & "', " & _
                    "strAllowableEmissioNRate2 = '" & Replace(temp7, "'", "''") & "', " & _
                    "strAllowableEmissioNRate3 = '" & Replace(temp8, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit1 = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit2 = '" & Replace(temp10, "'", "''") & "', " & _
                    "strAllowableEmisssionRateUnit3 = '" & Replace(temp11, "'", "''") & "', " & _
                    "strStackOneName = '" & Replace(temp12, "'", "''") & "', " & _
                    "strStackTwoName = '" & Replace(temp13, "'", "''") & "', " & _
                    "strRunNumber1A = '" & Replace(temp14, "'", "''") & "', " & _
                    "strRunNumber1B = '" & Replace(temp15, "'", "''") & "', " & _
                    "strRunNumber1C = '" & Replace(temp16, "'", "''") & "', " & _
                    "strRunNumber2A = '" & Replace(temp17, "'", "''") & "', " & _
                    "strRunNumber2B = '" & Replace(temp18, "'", "''") & "', " & _
                    "strRunNumber2C = '" & Replace(temp19, "'", "''") & "', " & _
                    "strGasTemperature1A = '" & Replace(temp20, "'", "''") & "', " & _
                    "strGasTemperature1B = '" & Replace(temp21, "'", "''") & "', " & _
                    "strGasTemperature1C = '" & Replace(temp22, "'", "''") & "', " & _
                    "strGasTemperature2A = '" & Replace(temp23, "'", "''") & "', " & _
                    "strGasTemperature2B = '" & Replace(temp24, "'", "''") & "', " & _
                    "strGasTemperature2C = '" & Replace(temp25, "'", "''") & "', " & _
                    "strGasMoisture1A = '" & Replace(temp26, "'", "''") & "', " & _
                    "strGasMoisture1B = '" & Replace(temp27, "'", "''") & "', " & _
                    "strGasMoisture1C = '" & Replace(temp28, "'", "''") & "', " & _
                    "strGasMoisture2A = '" & Replace(temp29, "'", "''") & "', " & _
                    "strGasMoisture2B = '" & Replace(temp30, "'", "''") & "', " & _
                    "strGasMoisture2C = '" & Replace(temp31, "'", "''") & "', " & _
                    "strGasFlowRateACFM1A = '" & Replace(temp32, "'", "''") & "', " & _
                    "strGasFlowRateACFM1B = '" & Replace(temp33, "'", "''") & "', " & _
                    "strGasFlowRateACFM1C = '" & Replace(temp34, "'", "''") & "', " & _
                    "strGasFlowRateACFM2A = '" & Replace(temp35, "'", "''") & "', " & _
                    "strGasFlowRateACFM2B = '" & Replace(temp36, "'", "''") & "', " & _
                    "strGasFlowRateACFM2C = '" & Replace(temp37, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1A = '" & Replace(temp38, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1B = '" & Replace(temp39, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM1C = '" & Replace(temp40, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM2A = '" & Replace(temp41, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM2B = '" & Replace(temp42, "'", "''") & "', " & _
                    "strGasFlowRateDSCFM2C = '" & Replace(temp43, "'", "''") & "', " & _
                    "strPollutantConcentration1A = '" & Replace(temp44, "'", "''") & "', " & _
                    "strPollutantConcentration1B = '" & Replace(temp45, "'", "''") & "', " & _
                    "strPollutantConcentration1C = '" & Replace(temp46, "'", "''") & "', " & _
                    "strPollutantConcentration2A = '" & Replace(temp47, "'", "''") & "', " & _
                    "strPollutantConcentration2B = '" & Replace(temp48, "'", "''") & "', " & _
                    "strPollutantConcentration2C = '" & Replace(temp49, "'", "''") & "', " & _
                    "strPollutantConcentrationUnit = '" & Replace(temp50, "'", "''") & "', " & _
                    "strPollutantConcentrationAVG1 = '" & Replace(temp51, "'", "''") & "', " & _
                    "strPollutantConcentrationAVG2 = '" & Replace(temp52, "'", "''") & "', " & _
                    "strEmissionRate1A = '" & Replace(temp53, "'", "''") & "', " & _
                    "strEmissionRate1B = '" & Replace(temp54, "'", "''") & "', " & _
                    "strEmissionRate1C = '" & Replace(temp55, "'", "''") & "', " & _
                    "strEmissionRate2A = '" & Replace(temp56, "'", "''") & "', " & _
                    "strEmissionRate2B = '" & Replace(temp57, "'", "''") & "', " & _
                    "strEmissionRate2C = '" & Replace(temp58, "'", "''") & "', " & _
                    "strEmissionRateUnit = '" & Replace(temp59, "'", "''") & "', " & _
                    "strEmissionRateAVG1 = '" & Replace(temp60, "'", "''") & "', " & _
                    "strEmissionRateAVG2 = '" & Replace(temp61, "'", "''") & "', " & _
                    "strEmissionRateTotal1 = '" & Replace(temp62, "'", "''") & "', " & _
                    "strEmissionRateTotal2 = '" & Replace(temp63, "'", "''") & "', " & _
                    "strEmissionRateTotal3 = '" & Replace(temp64, "'", "''") & "', " & _
                    "strEmissionRateTotalAvg = '" & Replace(temp65, "'", "''") & "', " & _
                    "strDestructionPercent = '" & Replace(temp66, "'", "''") & "', " & _
                    "strPercentAllowable = '" & Replace(temp67, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferISMPReportType()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPReportType "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strKey")) Then
                temp = ""
            Else
                temp = drDSRow("strKey")
            End If
            If IsDBNull(drDSRow("strReportType")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strReportType")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPReportType " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPReportType " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPReportType SET " & _
                "strKey = '" & Replace(temp, "'", "''") & "', " & _
                "strReportType = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE strKey = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestFirmComments()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestFirmComments "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strCommentsID")) Then
                temp = ""
            Else
                temp = drDSRow("strCommentsID")
            End If
            If IsDBNull(drDSRow("strTestingFirmKey")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strTestingFirmKey")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strTestLogNumber")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strTestLogNumber")
            End If
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strCommentType")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strCommentType")
            End If
            If IsDBNull(drDSRow("strStaffResponsible")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strStaffResponsible")
            End If
            If IsDBNull(drDSRow("datCommentDate")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datCommentDate")
            End If
            If IsDBNull(drDSRow("strComment")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strComment")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestFirmComments " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestFirmComments " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestFirmComments SET " & _
                "strCommentsID = '" & Replace(temp, "'", "''") & "', " & _
                "strTestingFirmKey = '" & Replace(temp2, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp3, "'", "''") & "', " & _
                "strTestLogNumber = '" & Replace(temp4, "'", "''") & "', " & _
                "strReferenceNumber = '" & Replace(temp5, "'", "''") & "', " & _
                "strCommentType = '" & Replace(temp6, "'", "''") & "', " & _
                "strStaffResponsible = '" & Replace(temp7, "'", "''") & "', " & _
                "datCommentDate = '" & Replace(temp8, "'", "''") & "', " & _
                "strComment = '" & Replace(temp9, "'", "''") & "', " & _
                "strModifingPerson = '" & Replace(temp10, "'", "''") & "', " & _
                "datModifingDate = '" & Replace(temp11, "'", "''") & "' " & _
                "WHERE strCommentsID = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestLogLink()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestLogLink "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strTestLogNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strTestLogNumber")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestLogLink " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestLogLink " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestLogLink SET " & _
                "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strTestLogNumber = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestLogNumber()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestLogNumber "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTestLogNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTestLogNumber")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestLogNumber " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestLogNumber " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestLogNumber SET " & _
                "strTestLogNumber = '" & Replace(temp, "'", "''") & "' " & _
                "WHERE strTestLogNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestNotification()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestNotification "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTestLogNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTestLogNumber")
            End If
            If IsDBNull(drDSRow("strEmissinoUnit")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strEmissinoUnit")
            End If

            If IsDBNull(drDSRow("datProposedStartDate")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datProposedStartDate")
            End If
            If IsDBNull(drDSRow("datProposedEndDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datProposedEndDate")
            End If
            If IsDBNull(drDSRow("strComments")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("strUserID")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strUserID")
            End If
            If IsDBNull(drDSRow("strContactEmail")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strContactEmail")
            End If
            If IsDBNull(drDSRow("strConfirmationNumber")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strConfirmationNumber")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strStaffResponsible")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strStaffResponsible")
            End If
            If IsDBNull(drDSRow("strTestPlanAvailable")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strTestPlanAvailable")
            End If
            If IsDBNull(drDSRow("strTimelyNotification")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strTimelyNotification")
            End If
            If IsDBNull(drDSRow("strOnlineFirstName")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strOnlineFirstName")
            End If
            If IsDBNull(drDSRow("strOnlineLastName")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strOnlineLastName")
            End If
            If IsDBNull(drDSRow("strInternalComments")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strInternalComments")
            End If

            If IsDBNull(drDSRow("strModifingStaff")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strModifingStaff")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strTelephone")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strTelephone")
            End If
            If IsDBNull(drDSRow("strFax")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strFax")
            End If
            If IsDBNull(drDSRow("DatTestPlanReceived")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("DatTestPlanReceived")
            End If
            If IsDBNull(drDSRow("datTEstNotification")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("datTEstNotification")
            End If
            If IsDBNull(drDSRow("strPollutants")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strPollutants")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestNotification " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestNotification " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestNotification SET " & _
                "strTestLogNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strEmissionUnit = '" & Replace(temp2, "'", "''") & "', " & _
                "datProposedStartDate = '" & Replace(temp3, "'", "''") & "', " & _
                "datProposedEndDate = '" & Replace(temp4, "'", "''") & "', " & _
                "strComments = '" & Replace(temp5, "'", "''") & "', " & _
                "sttrUserID = '" & Replace(temp6, "'", "''") & "', " & _
                "strContactEmail = '" & Replace(temp7, "'", "''") & "', " & _
                "strConfirmationNumber = '" & Replace(temp8, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp9, "'", "''") & "', " & _
                "strStaffResponsible = '" & Replace(temp10, "'", "''") & "', " & _
                "strTestPlanAvailable = '" & Replace(temp11, "'", "''") & "', " & _
                "strTimelyNotification = '" & Replace(temp12, "'", "''") & "', " & _
                "strOnlineFirstName = '" & Replace(temp13, "'", "''") & "', " & _
                "strOnlineLastName = '" & Replace(temp14, "'", "''") & "', " & _
                "strInternalComments = '" & Replace(temp15, "'", "''") & "', " & _
                "strModifingStaff = '" & Replace(temp16, "'", "''") & "', " & _
                "datModifingDate = '" & Replace(temp17, "'", "''") & "', " & _
                "strTelephone = '" & Replace(temp18, "'", "''") & "', " & _
                "strFax = '" & Replace(temp19, "'", "''") & "', " & _
                "datTestPlantReceived = '" & Replace(temp20, "'", "''") & "', " & _
                "datTestNotification = '" & Replace(temp21, "'", "''") & "', " & _
                "strPollutants = '" & Replace(temp22, "'", "''") & "' " & _
                "WHERE strTestLogNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestNotificationLog()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestNotificationLog "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTestLogNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTestLogNumber")
            End If
            If IsDBNull(drDSRow("strEngineer")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strEngineer")
            End If

            If IsDBNull(drDSRow("strUnit")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUnit")
            End If
            If IsDBNull(drDSRow("strEmissionUnit")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEmissionUnit")
            End If
            If IsDBNull(drDSRow("strAIRSnumber")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strAIRSnumber")
            End If
            If IsDBNull(drDSRow("strFacilityName")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strFacilityName")
            End If
            If IsDBNull(drDSRow("datNotificationDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datNotificationDate")
            End If
            If IsDBNull(drDSRow("datProposedStartDate")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datProposedStartDate")
            End If
            If IsDBNull(drDSRow("datProposedEndDate")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("datProposedEndDate")
            End If
            If IsDBNull(drDSRow("mmoComments")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("mmoComments")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestNotificationLog " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestNotificationLog " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestNotificationLog SET " & _
                "strTestLogNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strEngineer = '" & Replace(temp2, "'", "''") & "', " & _
                "strUnit = '" & Replace(temp3, "'", "''") & "', " & _
                "strEmissionUnit = '" & Replace(temp4, "'", "''") & "', " & _
                "strAIRSNumber = '" & Replace(temp5, "'", "''") & "', " & _
                "strFacilityName = '" & Replace(temp6, "'", "''") & "', " & _
                "datNotificationDate = '" & Replace(temp7, "'", "''") & "', " & _
                "datProposedStartDate = '" & Replace(temp8, "'", "''") & "', " & _
                "datProposedEndDate = '" & Replace(temp9, "'", "''") & "', " & _
                "mmoComments = '" & Replace(temp10, "'", "''") & "' " & _
                "WHERE strTestLogNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPTestREportAids()

    End Sub
    Sub TransferISMPTestREportMemo()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".ISMPTestReportMemo "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strMemorandumField")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMemorandumField")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPTestReportMemo " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPTestReportMemo " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPTestReportMemo SET " & _
                "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strMemorandumField = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferISMPWitnessingEng()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".ISMPWitnessingEng "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strWitnessingEngineer")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strWitnessingEngineer")
            End If

            SQL = "SELECT COUNT(*) " & _
            "FROM " & DBNameSpace & ".ISMPWitnessingEng " & _
            "WHERE strReferenceNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            If recExist = False Or dr.Item(0) = 0 Then
                SQL = "Insert into " & DBNameSpace & ".ISMPWitnessingEng " & _
                "Values " & _
                "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
            Else
                SQL = "UPDATE " & DBNameSpace & ".ISMPWitnessingEng SET " & _
                "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                "strWitnessingEngineer = '" & Replace(temp2, "'", "''") & "' " & _
                "WHERE strReferenceNumber = '" & Replace(temp, "'", "''") & "' "
            End If
            dr.Close()

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()
        Next
    End Sub
    Sub TransferSSCPACCS()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPACCS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strSubmittalNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strSubmittalNumber")
            End If

            If IsDBNull(drDSRow("strPostMarkedOnTime")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strPostMarkedOnTime")
            End If
            If IsDBNull(drDSRow("datPostMarkDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datPostMarkDate")
            End If
            If IsDBNull(drDSRow("strSignedByRO")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strSignedByRO")
            End If
            If IsDBNull(drDSRow("strCorrectACCForms")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strCorrectACCForms")
            End If
            If IsDBNull(drDSRow("strTitleVConditionsListed")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strTitleVConditionsListed")
            End If
            If IsDBNull(drDSRow("strACCCorrectlyFilledOut")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strACCCorrectlyFilledOut")
            End If
            If IsDBNull(drDSRow("strReportedDeviations")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strReportedDeviations")
            End If
            If IsDBNull(drDSRow("strDeviationsUnReported")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strDeviationsUnReported")
            End If
            If IsDBNull(drDSRow("strcomments")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("strEnforcementNeeded")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strEnforcementNeeded")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPACCS " & _
                "WHERE strTrackingNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPACCS " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPACCS SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strSubmittalNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strPostMarkedOnTime = '" & Replace(temp3, "'", "''") & "', " & _
                    "datPostMarkDate = '" & Replace(temp4, "'", "''") & "', " & _
                    "strSignedByRO = '" & Replace(temp5, "'", "''") & "', " & _
                    "strCorrectACCForms = '" & Replace(temp6, "'", "''") & "', " & _
                    "strTitleVConditionsListed = '" & Replace(temp7, "'", "''") & "', " & _
                    "strACCCorrectlyFilledOut = '" & Replace(temp8, "'", "''") & "', " & _
                    "strReportedDeviations = '" & Replace(temp9, "'", "''") & "', " & _
                    "strDeviationsUnReported = '" & Replace(temp10, "'", "''") & "', " & _
                    "strComments = '" & Replace(temp11, "'", "''") & "', " & _
                    "strEnforcementNeeded = '" & Replace(temp12, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp13, "'", "''") & "', " & _
                    "datModifingPerson = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPACCSHistory()
        SQL = "Select * " & _
      "from " & DBNameSpace & ".SSCPACCSHistory "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strSubmittalNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strSubmittalNumber")
            End If

            If IsDBNull(drDSRow("strPostMarkedOnTime")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strPostMarkedOnTime")
            End If
            If IsDBNull(drDSRow("datPostMarkDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datPostMarkDate")
            End If
            If IsDBNull(drDSRow("strSignedByRO")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strSignedByRO")
            End If
            If IsDBNull(drDSRow("strCorrectACCForms")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strCorrectACCForms")
            End If
            If IsDBNull(drDSRow("strTitleVConditionsListed")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strTitleVConditionsListed")
            End If
            If IsDBNull(drDSRow("strACCCorrectlyFilledOut")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strACCCorrectlyFilledOut")
            End If
            If IsDBNull(drDSRow("strReportedDeviations")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strReportedDeviations")
            End If
            If IsDBNull(drDSRow("strDeviationsUnReported")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strDeviationsUnReported")
            End If
            If IsDBNull(drDSRow("strcomments")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("strEnforcementNeeded")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strEnforcementNeeded")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPACCSHistory " & _
                "WHERE strTrackingNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPACCSHistory " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPACCSHistory SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strSubmittalNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strPostMarkedOnTime = '" & Replace(temp3, "'", "''") & "', " & _
                    "datPostMarkDate = '" & Replace(temp4, "'", "''") & "', " & _
                    "strSignedByRO = '" & Replace(temp5, "'", "''") & "', " & _
                    "strCorrectACCForms = '" & Replace(temp6, "'", "''") & "', " & _
                    "strTitleVConditionsListed = '" & Replace(temp7, "'", "''") & "', " & _
                    "strACCCorrectlyFilledOut = '" & Replace(temp8, "'", "''") & "', " & _
                    "strReportedDeviations = '" & Replace(temp9, "'", "''") & "', " & _
                    "strDeviationsUnReported = '" & Replace(temp10, "'", "''") & "', " & _
                    "strComments = '" & Replace(temp11, "'", "''") & "', " & _
                    "strEnforcementNeeded = '" & Replace(temp12, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp13, "'", "''") & "', " & _
                    "datModifingPerson = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPDistrictAssignment()
        SQL = "Select * " & _
   "from " & DBNameSpace & ".SSCPDistrictAssignment "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strDistrictEngineer")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strDistrictEngineer")
            End If

            If IsDBNull(drDSRow("strDistrictAssigningManager")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strDistrictAssigningManager")
            End If
            If IsDBNull(drDSRow("datDistrictAssignmentDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datDistrictAssignmentDate")
            End If
         
            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPDistrictAssignment " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPDistrictAssignment " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPDistrictAssignment SET " & _
                    "strAIRSNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strDistrictEngineer = '" & Replace(temp2, "'", "''") & "', " & _
                    "strDistrictAssigningManager = '" & Replace(temp3, "'", "''") & "', " & _
                    "datDistrictAssignmentDate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPDistrictResponsible()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPDistrictResponsible "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strDistrictResponsible")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strDistrictResponsible")
            End If

            If IsDBNull(drDSRow("strAssigningManager")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAssigningManager")
            End If
            If IsDBNull(drDSRow("datAssigningDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datAssigningDate")
            End If
          
            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPDistrictResponsible " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPDistrictResponsible " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPDistrictResponsible SET " & _
                    "strAIRSNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strDistrictResponsible = '" & Replace(temp2, "'", "''") & "', " & _
                    "strAssigningManager = '" & Replace(temp3, "'", "''") & "', " & _
                    "datAssigningDate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcement()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPEnforcement "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strActionType")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strActionType")
            End If

            If IsDBNull(drDSRow("strGeneralComments")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strGeneralComments")
            End If
            If IsDBNull(drDSRow("datDiscoveryDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datDiscoveryDate")
            End If
            If IsDBNull(drDSRow("datLONSent")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datLONSent")
            End If
            If IsDBNull(drDSRow("strLONComments")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strLONComments")
            End If
            If IsDBNull(drDSRow("strLONResolvedEnforcement")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strLONResolvedEnforcement")
            End If
            If IsDBNull(drDSRow("datDayZero")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datDayZero")
            End If
            If IsDBNull(drDSRow("strHPV")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strHPV")
            End If
            If IsDBNull(drDSRow("strAFSKeyActionNumber")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAFSKeyActionNumber")
            End If
            If IsDBNull(drDSRow("datNOVSent")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datNOVSent")
            End If
            If IsDBNull(drDSRow("strAFSNOVSentNumber")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strAFSNOVSentNumber")
            End If
            If IsDBNull(drDSRow("strNOVCommentsEntry")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strNOVCommentsEntry")
            End If
            If IsDBNull(drDSRow("datNOVResponseReceived")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datNOVResponseReceived")
            End If


            If IsDBNull(drDSRow("strNOVResolvedEnforcement")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strNOVResolvedEnforcement")
            End If
            If IsDBNull(drDSRow("strAFSNOVResolvedNumber")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strAFSNOVResolvedNumber")
            End If
            If IsDBNull(drDSRow("datNFALetterSent")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("datNFALetterSent")
            End If
            If IsDBNull(drDSRow("datCOProposed")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("datCOProposed")
            End If
            If IsDBNull(drDSRow("strAFSCOProposedNumber")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strAFSCOProposedNumber")
            End If
            If IsDBNull(drDSRow("strCOCommentsEntry")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strCOCommentsEntry")
            End If
            If IsDBNull(drDSRow("datCOExecuted")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("datCOExecuted")
            End If
            If IsDBNull(drDSRow("strAFSCOExecutedNumber")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strAFSCOExecutedNumber")
            End If
            If IsDBNull(drDSRow("datCOReceivedFromCompany")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("datCOReceivedFromCompany")
            End If
            If IsDBNull(drDSRow("datCOReceivedFromDirector")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("datCOReceivedFromDirector")
            End If
            If IsDBNull(drDSRow("strCOResolvedEnforcement")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strCOResolvedEnforcement")
            End If
            If IsDBNull(drDSRow("datCOResolved")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("datCOResolved")
            End If
            If IsDBNull(drDSRow("strAFSCOResolvedNumber")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strAFSCOResolvedNumber")
            End If
            If IsDBNull(drDSRow("strCOPenaltyAmount")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strCOPenaltyAmount")
            End If
            If IsDBNull(drDSRow("strCOPenaltyAmountComments")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strCOPenaltyAmountComments")
            End If
            If IsDBNull(drDSRow("strStipulatedPenalty")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strStipulatedPenalty")
            End If
            If IsDBNull(drDSRow("strAOCommentsEntry")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strAOCommentsEntry")
            End If
            If IsDBNull(drDSRow("datAOExecuted")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("datAOExecuted")
            End If

            If IsDBNull(drDSRow("strAFSAOtoAGNumber")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strAFSAOtoAGNumber")
            End If
            If IsDBNull(drDSRow("datAOAppealed")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("datAOAppealed")
            End If
            If IsDBNull(drDSRow("strAFSCivilCourtNumber")) Then
                temp35 = ""
            Else
                temp35 = drDSRow("strAFSCivilCourtNumber")
            End If
            If IsDBNull(drDSRow("datAOResolved")) Then
                temp36 = ""
            Else
                temp36 = drDSRow("datAOResolved")
            End If
            If IsDBNull(drDSRow("strAFSAOResolvedNumber")) Then
                temp37 = ""
            Else
                temp37 = drDSRow("strAFSAOResolvedNumber")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp38 = ""
            Else
                temp38 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp39 = ""
            Else
                temp39 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strPollutants")) Then
                temp40 = ""
            Else
                temp40 = drDSRow("strPollutants")
            End If
            If IsDBNull(drDSRow("strPollutantStatus")) Then
                temp41 = ""
            Else
                temp41 = drDSRow("strPollutantStatus")
            End If
            If IsDBNull(drDSRow("datLONtoUC")) Then
                temp42 = ""
            Else
                temp42 = drDSRow("datLONtoUC")
            End If
            If IsDBNull(drDSRow("datNOVtoUC")) Then
                temp43 = ""
            Else
                temp43 = drDSRow("datNOVtoUC")
            End If
            If IsDBNull(drDSRow("datNOVtoPM")) Then
                temp44 = ""
            Else
                temp44 = drDSRow("datNOVtoPM")
            End If
            If IsDBNull(drDSRow("datNFAtoUC")) Then
                temp45 = ""
            Else
                temp45 = drDSRow("datNFAtoUC")
            End If
            If IsDBNull(drDSRow("datNFAtoPM")) Then
                temp46 = ""
            Else
                temp46 = drDSRow("datNFAtoPM")
            End If
            If IsDBNull(drDSRow("datCOtoUC")) Then
                temp47 = ""
            Else
                temp47 = drDSRow("datCOtoUC")
            End If
            If IsDBNull(drDSRow("datCOToPM")) Then
                temp48 = ""
            Else
                temp48 = drDSRow("datCOToPM")
            End If
            If IsDBNull(drDSRow("strCONumber")) Then
                temp49 = ""
            Else
                temp49 = drDSRow("strCONumber")
            End If
            If IsDBNull(drDSRow("datLONResolved")) Then
                temp50 = ""
            Else
                temp50 = drDSRow("datLONResolved")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcement " & _
                "WHERE strEnforcementNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcement " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "', '" & Replace(temp34, "'", "''") & "', " & _
                    "'" & Replace(temp35, "'", "''") & "', '" & Replace(temp36, "'", "''") & "', " & _
                    "'" & Replace(temp37, "'", "''") & "', '" & Replace(temp38, "'", "''") & "', " & _
                    "'" & Replace(temp39, "'", "''") & "', '" & Replace(temp40, "'", "''") & "', " & _
                    "'" & Replace(temp41, "'", "''") & "', '" & Replace(temp42, "'", "''") & "', " & _
                    "'" & Replace(temp43, "'", "''") & "', '" & Replace(temp44, "'", "''") & "', " & _
                    "'" & Replace(temp45, "'", "''") & "', '" & Replace(temp46, "'", "''") & "', " & _
                    "'" & Replace(temp47, "'", "''") & "', '" & Replace(temp48, "'", "''") & "', " & _
                    "'" & Replace(temp49, "'", "''") & "', '" & Replace(temp50, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcement SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strActionType = '" & Replace(temp2, "'", "''") & "', " & _
                    "strGeneralComments = '" & Replace(temp3, "'", "''") & "', " & _
                    "datDiscoveryDate = '" & Replace(temp4, "'", "''") & "', " & _
                    "datLONSent = '" & Replace(temp5, "'", "''") & "', " & _
                    "strLONComments = '" & Replace(temp6, "'", "''") & "', " & _
                    "strLONResolvedEnforcement = '" & Replace(temp7, "'", "''") & "', " & _
                    "datDayZero = '" & Replace(temp8, "'", "''") & "', " & _
                    "strHPV = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAFSKeyActionNumber = '" & Replace(temp10, "'", "''") & "', " & _
                    "datNOVSent = '" & Replace(temp11, "'", "''") & "', " & _
                    "strAFSNOVSentNumber = '" & Replace(temp12, "'", "''") & "', " & _
                    "strNOVCommentsEntry = '" & Replace(temp13, "'", "''") & "', " & _
                    "datNOVResponseReceived = '" & Replace(temp14, "'", "''") & "', " & _
                    "strNOVResolvedEnforcement = '" & Replace(temp15, "'", "''") & "', " & _
                    "strAFSNOVResolvedNumber = '" & Replace(temp16, "'", "''") & "', " & _
                    "datNFALetterSent = '" & Replace(temp17, "'", "''") & "', " & _
                    "datCOProposed = '" & Replace(temp18, "'", "''") & "', " & _
                    "strAFSCOProposedNumber = '" & Replace(temp19, "'", "''") & "', " & _
                    "strCOCommentsEntry = '" & Replace(temp20, "'", "''") & "', " & _
                    "datCOExecuted = '" & Replace(temp21, "'", "''") & "', " & _
                    "strAFSCOExecutedNumber = '" & Replace(temp22, "'", "''") & "', " & _
                    "datCOReceivedFromCompany = '" & Replace(temp23, "'", "''") & "', " & _
                    "datCORecievedFromDirector = '" & Replace(temp24, "'", "''") & "', " & _
                    "strCOResolvedEnforcement = '" & Replace(temp25, "'", "''") & "', " & _
                    "datCOResolved = '" & Replace(temp26, "'", "''") & "', " & _
                    "strAFSCOResolvedNumber = '" & Replace(temp27, "'", "''") & "', " & _
                    "strCOPenaltyAmount = '" & Replace(temp28, "'", "''") & "', " & _
                    "strCOPenaltyAmountComments = '" & Replace(temp29, "'", "''") & "', " & _
                    "strStipulatedPenalty = '" & Replace(temp30, "'", "''") & "', " & _
                    "strAOCommentsEntry = '" & Replace(temp31, "'", "''") & "', " & _
                    "datAOExecuted = '" & Replace(temp32, "'", "''") & "', " & _
                    "strAFSAOtoAGNumber = '" & Replace(temp33, "'", "''") & "', " & _
                    "datAOAppealed = '" & Replace(temp34, "'", "''") & "', " & _
                    "strAFSCivilCourtNumber = '" & Replace(temp35, "'", "''") & "', " & _
                    "datAOResolved = '" & Replace(temp36, "'", "''") & "', " & _
                    "strAFSAOResolvedNumber = '" & Replace(temp37, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp38, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp39, "'", "''") & "', " & _
                    "strPollutants = '" & Replace(temp40, "'", "''") & "', " & _
                    "strPollutantStatus = '" & Replace(temp41, "'", "''") & "', " & _
                    "datLONtoUC = '" & Replace(temp42, "'", "''") & "', " & _
                    "datNOVtoUC = '" & Replace(temp43, "'", "''") & "', " & _
                    "datNOVtoPM = '" & Replace(temp44, "'", "''") & "', " & _
                    "datNFAtoUC = '" & Replace(temp45, "'", "''") & "', " & _
                    "datNFAtoPM = '" & Replace(temp46, "'", "''") & "', " & _
                    "datCOtoUC = '" & Replace(temp47, "'", "''") & "', " & _
                    "datCOtoPM = '" & Replace(temp48, "'", "''") & "', " & _
                    "strCONumber = '" & Replace(temp49, "'", "''") & "', " & _
                    "datLONResolved = '" & Replace(temp50, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcementAOComments()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPEnforcementAOComments "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strAOEntryNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAOEntryNumber")
            End If

            If IsDBNull(drDSRow("strAOComment")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAOComment")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcementAOComments " & _
                "WHERE strEnforcementNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcementAOComments " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcementAOComments SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAOEntryNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strAOComment = '" & Replace(temp3, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcementCOComments()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPEnforcementCOComments "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strCOEntryNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strCOEntryNumber")
            End If

            If IsDBNull(drDSRow("strCOComment")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strCOComment")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcementCOComments " & _
                "WHERE strEnforcementNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcementCOComments " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcementCOComments SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strCOEntryNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strCOComment = '" & Replace(temp3, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcementItems()
        SQL = "Select * " & _
     "from " & DBNameSpace & ".SSCPEnforcementItems "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strTrackingNumber")
            End If

            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("datEnforcementFinalized")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datEnforcementFinalized")
            End If
            If IsDBNull(drDSRow("strStaffResponsible")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strStaffResponsible")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strStatus")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strStatus")
            End If

            SQL = "SELECT strAIRSnumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp3 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
                "WHERE strEnforcementNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcementItems " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "') " 
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcementItems SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strTrackingNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp3, "'", "''") & "', " & _
                    "datEnforcementFinalized = '" & Replace(temp4, "'", "''") & "', " & _
                    "strStaffResponsible = '" & Replace(temp5, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp6, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp7, "'", "''") & "', " & _
                    "strStatus = '" & Replace(temp8, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcementLetter()

    End Sub
    Sub TransferSSCPEnforceNOVComments()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPEnforcementNOVComments "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strNOVEntryNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strNOVEntryNumber")
            End If

            If IsDBNull(drDSRow("strNOVComment")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strNOVComment")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcementNOVComments " & _
                "WHERE strEnforcementNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcementNOVComments " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcementNOVComments SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strNOVEntryNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strNOVComment = '" & Replace(temp3, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPEnforcementStipulated()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPEnforcementStipulated "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strEnforcementKey")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strEnforcementKey")
            End If

            If IsDBNull(drDSRow("strStipulatedPenalty")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStipulatedPenalty")
            End If
            If IsDBNull(drDSRow("strStipulatedPenaltyComments")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strStipulatedPenaltyComments")
            End If
            If IsDBNull(drDSRow("strAFSStipulatedPenaltyNumber")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strAFSStipulatedPenaltyNumber")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPEnforcementStipulated " & _
                "WHERE strEnforcementNumber = '" & temp & "' " & _
                "and strEnforcementKey = '" & temp2 & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPEnforcementStipulated " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPEnforcementStipulated SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strEnforcementKey = '" & Replace(temp2, "'", "''") & "', " & _
                    "strStipulatedPenalty = '" & Replace(temp3, "'", "''") & "', " & _
                    "strStipulatedPenaltyComments = '" & Replace(temp4, "'", "''") & "', " & _
                    "strAFSStipulatedPenaltyNumber = '" & Replace(temp5, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp6, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp7, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & Replace(temp, "'", "''") & "' " & _
                    "and strEnforcementKey = '" & temp2 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPFacilityAssignment()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPFacilityAssignment "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strSSCPUnit")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strSSCPUnit")
            End If

            If IsDBNull(drDSRow("strSSCPEngineer")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strSSCPEngineer")
            End If
            If IsDBNull(drDSRow("strSSCPAssigningManager")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strSSCPAssigningManager")
            End If
            If IsDBNull(drDSRow("datAssignmentDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datAssignmentDate")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPFacilityAssignment " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPFacilityAssignment " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPFacilityAssignment SET " & _
                    "strAIRSNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strSSCPUnit = '" & Replace(temp2, "'", "''") & "', " & _
                    "strSSCPEngineer = '" & Replace(temp3, "'", "''") & "', " & _
                    "strSSCPAssigningManager = '" & Replace(temp4, "'", "''") & "', " & _
                    "datAssignmentDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPFCE()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPFCE "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strFCENumber")) Then
                temp = ""
            Else
                temp = drDSRow("strFCENumber")
            End If
            If IsDBNull(drDSRow("strFCEStatus")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strFCEStatus")
            End If

            If IsDBNull(drDSRow("strReviewer")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strReviewer")
            End If
            If IsDBNull(drDSRow("datFCECompleted")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datFCECompleted")
            End If
            If IsDBNull(drDSRow("strFCEComments")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strFCEComments")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strSiteInspection")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strSiteInspection")
            End If
            If IsDBNull(drDSRow("strFCEyear")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strFCEyear")
            End If

            SQL = "SELECT strFCENumber " & _
            "FROM " & DBNameSpace & ".SSCPFCEMaster " & _
            "WHERE strFCENumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPFCE " & _
                "WHERE strFCENumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPFCE " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPFCE SET " & _
                    "strFCENumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strFCEStatus = '" & Replace(temp2, "'", "''") & "', " & _
                    "strReviewer = '" & Replace(temp3, "'", "''") & "', " & _
                    "datFCECompleted = '" & Replace(temp4, "'", "''") & "', " & _
                    "strFCEComments = '" & Replace(temp5, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp6, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp7, "'", "''") & "', " & _
                    "strSiteInspection = '" & Replace(temp8, "'", "''") & "', " & _
                    "strFCEYear = '" & Replace(temp9, "'", "''") & "' " & _
                    "WHERE strFCENumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPFCEMaster()
        SQL = "Select * " & _
      "from " & DBNameSpace & ".SSCPFCEMaster "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strFCENumber")) Then
                temp = ""
            Else
                temp = drDSRow("strFCENumber")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAIRSNumber")
            End If

            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp2 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPFCEMaster " & _
                "WHERE strFCENumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPFCEMaster " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPFCEMaster SET " & _
                    "strFCENumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp3, "'", "''") & "', " & _
                    "datModifingdate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strFCENumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPInspectionActivity()
        SQL = "Select * " & _
      "from " & DBNameSpace & ".SSCPInspectionActivity "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("datInspectionDateStart")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("datInspectionDateStart")
            End If

            If IsDBNull(drDSRow("datInspectionDateEnd")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datInspectionDateEnd")
            End If
            If IsDBNull(drDSRow("strInspectingEngineer")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strInspectingEngineer")
            End If
            If IsDBNull(drDSRow("datModified")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModified")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPInspectionActivity " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPInspectionActivity " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPInspectionActivity SET " & _
                    "strAIRSnumber = '" & Replace(temp, "'", "''") & "', " & _
                    "datInspectionDateStart = '" & Replace(temp2, "'", "''") & "', " & _
                    "datInspectionDateEnd = '" & Replace(temp3, "'", "''") & "', " & _
                    "strInspectingEngineer = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModified = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPInspections()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPInspections "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("datInspectionDateStart")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("datInspectionDateStart")
            End If

            If IsDBNull(drDSRow("datInspectionDateEnd")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datInspectionDateEnd")
            End If
            If IsDBNull(drDSRow("strInspectionReason")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strInspectionReason")
            End If
            If IsDBNull(drDSRow("strWeatherConditions")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strWeatherConditions")
            End If
            If IsDBNull(drDSRow("strInspectionGuide")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strInspectionGuide")
            End If
            If IsDBNull(drDSRow("strFacilityOperating")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strFacilityOperating")
            End If
            If IsDBNull(drDSRow("strInspectionComplianceStatus")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strInspectionComplianceStatus")
            End If
            If IsDBNull(drDSRow("strInspectionComments")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strInspectionComments")
            End If
            If IsDBNull(drDSRow("strInspectionFollowUp")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strInspectionFollowUp")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPInspections " & _
                "WHERE strTrackingNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPInspections " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPInspections SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "datInspectionDateStart = '" & Replace(temp2, "'", "''") & "', " & _
                    "datInspectionDateEnd = '" & Replace(temp3, "'", "''") & "', " & _
                    "strInspectionReason = '" & Replace(temp4, "'", "''") & "', " & _
                    "strWeatherConditions = '" & Replace(temp5, "'", "''") & "', " & _
                    "strInspectionGuide = '" & Replace(temp6, "'", "''") & "', " & _
                    "strFacilityOperating = '" & Replace(temp7, "'", "''") & "', " & _
                    "strInspectionComplianceStatus = '" & Replace(temp8, "'", "''") & "', " & _
                    "strInspectionComments = '" & Replace(temp9, "'", "''") & "', " & _
                    "strInspectionFollowUp = '" & Replace(temp10, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp11, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp12, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPInspectionsRequired()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPInspectionsRequired "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strInspectionRequired")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strInspectionRequired")
            End If

            If IsDBNull(drDSRow("strAssigningManager")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAssigningManager")
            End If
            If IsDBNull(drDSRow("datAssigningDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datAssigningDate")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPInspectionsRequired " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPInspectionsRequired " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPInspectionsRequired SET " & _
                    "strAIRSnumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strInspectionRequired = '" & Replace(temp2, "'", "''") & "', " & _
                    "strAssigningManager = '" & Replace(temp3, "'", "''") & "', " & _
                    "datAssigningDate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPInspectionTracking()
        SQL = "Select * " & _
      "from " & DBNameSpace & ".SSCPInspectionTracking "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("inspectionKey")) Then
                temp = ""
            Else
                temp = drDSRow("inspectionKey")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAIRSNumber")
            End If

            If IsDBNull(drDSRow("strInspectingEngineer")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strInspectingEngineer")
            End If
            If IsDBNull(drDSRow("strLockSchedule")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strLockSchedule")
            End If

            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("datScheduledateStart")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("datScheduledateStart")
            End If
            If IsDBNull(drDSRow("datScheduledateEnd")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datScheduledateEnd")
            End If
            If IsDBNull(drDSRow("datCurrentDateStart")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datCurrentDateStart")
            End If
            If IsDBNull(drDSRow("datCurrentDateEnd")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("datCurrentDateEnd")
            End If
            If IsDBNull(drDSRow("datActualDateStart")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("datActualDateStart")
            End If
            If IsDBNull(drDSRow("datActualDateEnd")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datActualDateEnd")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp2 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPInspectionTracking " & _
                "WHERE strAIRSNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPInspectionTracking " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPInspectionTracking SET " & _
                    "InspectionKey = '" & Replace(temp, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strInspectingEngineer = '" & Replace(temp3, "'", "''") & "', " & _
                    "strLockSchedule = '" & Replace(temp4, "'", "''") & "', " & _
                    "SSCPTrackingNumber = '" & Replace(temp5, "'", "''") & "', " & _
                    "datScheduleDateStart = '" & Replace(temp6, "'", "''") & "', " & _
                    "datScheduleDateEnd = '" & Replace(temp7, "'", "''") & "', " & _
                    "datCurrentDateStart = '" & Replace(temp8, "'", "''") & "', " & _
                    "datCurrentDateEnd = '" & Replace(temp9, "'", "''") & "', " & _
                    "datActualDateStart = '" & Replace(temp10, "'", "''") & "', " & _
                    "datActualDateEnd = '" & Replace(temp11, "'", "''") & "' " & _
                    "WHERE InspectionKey = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPItemMaster()
        SQL = "Select * " & _
    "from " & DBNameSpace & ".SSCPItemMaster "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAIRSNumber")
            End If

            If IsDBNull(drDSRow("datReceivedDate")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datReceivedDate")
            End If
            If IsDBNull(drDSRow("strEventType")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strEventType")
            End If

            If IsDBNull(drDSRow("strResponsibleStaff")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strResponsibleStaff")
            End If
            If IsDBNull(drDSRow("datCompleteDate")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("datCompleteDate")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strDelete")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strDelete")
            End If
            If IsDBNull(drDSRow("datAcknoledgmentLetterSent")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("datAcknoledgmentLetterSent")
            End If
            If IsDBNull(drDSRow("datInformationRequestDate")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datInformationRequestDate")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp2 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPItemMaster " & _
                "WHERE strTrackingNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPItemMaster " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPItemMaster SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "datReceivedDate = '" & Replace(temp3, "'", "''") & "', " & _
                    "strEventType = '" & Replace(temp4, "'", "''") & "', " & _
                    "strResponsibleStaff = '" & Replace(temp5, "'", "''") & "', " & _
                    "datCompleteDate = '" & Replace(temp6, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp7, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp8, "'", "''") & "', " & _
                    "strDelete = '" & Replace(temp9, "'", "''") & "', " & _
                    "datAcknoledgmentLetterSent = '" & Replace(temp10, "'", "''") & "', " & _
                    "datInformationRequestDate = '" & Replace(temp11, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPNotifications()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPNotifications "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("datNotificationDue")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("datNotificationDue")
            End If

            If IsDBNull(drDSRow("strNotificationDue")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strNotificationDue")
            End If
            If IsDBNull(drDSRow("datNotificationSent")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datNotificationSent")
            End If

            If IsDBNull(drDSRow("strNotificationSent")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strNotificationSent")
            End If
            If IsDBNull(drDSRow("strNotificationType")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strNotificationType")
            End If
            If IsDBNull(drDSRow("strNotificationTypeOther")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strNotificationTypeOther")
            End If
            If IsDBNull(drDSRow("strNotificationComment")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strNotificationComment")
            End If
            If IsDBNull(drDSRow("strNotificationFollowUp")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strNotificationFollowUp")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPNotifications " & _
                "WHERE strTrackingNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPNotifications " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPNotifications SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "datNotificationDue = '" & Replace(temp2, "'", "''") & "', " & _
                    "strNotificationDue = '" & Replace(temp3, "'", "''") & "', " & _
                    "datNotificationSent = '" & Replace(temp4, "'", "''") & "', " & _
                    "strNotificationSent = '" & Replace(temp5, "'", "''") & "', " & _
                    "strNotificationType = '" & Replace(temp6, "'", "''") & "', " & _
                    "strNotificationTypeOther = '" & Replace(temp7, "'", "''") & "', " & _
                    "strNotificationComment = '" & Replace(temp8, "'", "''") & "', " & _
                    "strNotificationFollowUp = '" & Replace(temp9, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp10, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp11, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPReports()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPReports "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strReportPeriod")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strReportPeriod")
            End If

            If IsDBNull(drDSRow("datReportingPeriodStart")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datReportingPeriodStart")
            End If
            If IsDBNull(drDSRow("datReportingPeriodEnd")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datReportingPeriodEnd")
            End If

            If IsDBNull(drDSRow("strReportingPeriodComments")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strReportingPeriodComments")
            End If
            If IsDBNull(drDSRow("datReportDueDate")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("datReportDueDate")
            End If
            If IsDBNull(drDSRow("datSentByFacilityDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datSentByFacilityDate")
            End If
            If IsDBNull(drDSRow("strCompleteStatus")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strCompleteStatus")
            End If
            If IsDBNull(drDSRow("strEnforcementNeeded")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strEnforcementNeeded")
            End If
            If IsDBNull(drDSRow("strShowDeviation")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strShowDeviation")
            End If
            If IsDBNull(drDSRow("strGeneralComments")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strGeneralComments")
            End If

            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingdate")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("datModifingdate")
            End If
            If IsDBNull(drDSRow("strSubmittalNumber")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strSubmittalNumber")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPReports " & _
                "WHERE strTrackingNumber = '" & temp & "' " & _
                "and strSubmittalNumber = '" & temp14 & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPReports " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPReports SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strReportPeriod = '" & Replace(temp2, "'", "''") & "', " & _
                    "datReportingPeriodStart = '" & Replace(temp3, "'", "''") & "', " & _
                    "datReportingPeriodEnd = '" & Replace(temp4, "'", "''") & "', " & _
                    "strReportingPeriodComments = '" & Replace(temp5, "'", "''") & "', " & _
                    "datReportDueDate = '" & Replace(temp6, "'", "''") & "', " & _
                    "datSentByFacilityDate = '" & Replace(temp7, "'", "''") & "', " & _
                    "strCompleteStatus = '" & Replace(temp8, "'", "''") & "', " & _
                    "strEnforcementNeeded = '" & Replace(temp9, "'", "''") & "', " & _
                    "strShowDeviation = '" & Replace(temp10, "'", "''") & "', " & _
                    "strGeneralComments = '" & Replace(temp11, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp12, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp13, "'", "''") & "', " & _
                    "strSubmittalNumber = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' " & _
                    "and strSubmittalNumber = '" & Replace(temp14, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPReportsHistory()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPReportsHistory "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strSubmittalNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strSubmittalNumber")
            End If
            If IsDBNull(drDSRow("strReportPeriod")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strReportPeriod")
            End If
            If IsDBNull(drDSRow("datReportingPeriodStart")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datReportingPeriodStart")
            End If
            If IsDBNull(drDSRow("datReportingPeriodEnd")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datReportingPeriodEnd")
            End If

            If IsDBNull(drDSRow("strReportingPeriodComments")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strReportingPeriodComments")
            End If
            If IsDBNull(drDSRow("datReportDueDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datReportDueDate")
            End If
            If IsDBNull(drDSRow("datSentByFacilityDate")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datSentByFacilityDate")
            End If
            If IsDBNull(drDSRow("strCompleteStatus")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strCompleteStatus")
            End If
            If IsDBNull(drDSRow("strEnforcementNeeded")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strEnforcementNeeded")
            End If
            If IsDBNull(drDSRow("strShowDeviation")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strShowDeviation")
            End If
            If IsDBNull(drDSRow("strGeneralComments")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strGeneralComments")
            End If

            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingdate")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datModifingdate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPReportsHistory " & _
                "WHERE strTrackingNumber = '" & temp & "' " & _
                "and strSubmittalNumber = '" & temp14 & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPReportsHistory " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPReportsHistory SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strSubmittalNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strReportPeriod = '" & Replace(temp3, "'", "''") & "', " & _
                    "datReportingPeriodStart = '" & Replace(temp4, "'", "''") & "', " & _
                    "datReportingPeriodEnd = '" & Replace(temp5, "'", "''") & "', " & _
                    "strReportingPeriodComments = '" & Replace(temp6, "'", "''") & "', " & _
                    "datReportDueDate = '" & Replace(temp7, "'", "''") & "', " & _
                    "datSentByFacilityDate = '" & Replace(temp8, "'", "''") & "', " & _
                    "strCompleteStatus = '" & Replace(temp9, "'", "''") & "', " & _
                    "strEnforcementNeeded = '" & Replace(temp10, "'", "''") & "', " & _
                    "strShowDeviation = '" & Replace(temp11, "'", "''") & "', " & _
                    "strGeneralComments = '" & Replace(temp12, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp13, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp14, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' " & _
                    "and strSubmittalNumber = '" & Replace(temp2, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSCPTestReports()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSCPTestReports "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strReferenceNumber")
            End If

            If IsDBNull(drDSRow("datTestReportDue")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datTestReportDue")
            End If
            If IsDBNull(drDSRow("strTestReportComments")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strTestReportComments")
            End If

            If IsDBNull(drDSRow("strTestReportFollowup")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strTestReportFollowup")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingdDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datModifingdDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSCPTestReports " & _
                "WHERE strTrackingNumber = '" & temp & "' " 
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSCPTestReports " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSCPTestReports SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strReferenceNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "datTestReportDue = '" & Replace(temp3, "'", "''") & "', " & _
                    "strTestReportComments = '" & Replace(temp4, "'", "''") & "', " & _
                    "strTestReportFollowUp = '" & Replace(temp5, "'", "''") & "', " & _
                    "strModifingperson = '" & Replace(temp6, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp7, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationContact()
        SQL = "Select * " & _
              "from " & DBNameSpace & ".SSPPApplicationContact "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strContactFirstName")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strContactFirstName")
            End If

            If IsDBNull(drDSRow("strContactLastName")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strContactLastName")
            End If
            If IsDBNull(drDSRow("strContactPrefix")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strContactPrefix")
            End If
            If IsDBNull(drDSRow("strContactSuffix")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strContactSuffix")
            End If
            If IsDBNull(drDSRow("strContactTitle")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strContactTitle")
            End If
            If IsDBNull(drDSRow("strContactCompanyName")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strContactCompanyName")
            End If
            If IsDBNull(drDSRow("strContactPhoneNumber1")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strContactPhoneNumber1")
            End If
            If IsDBNull(drDSRow("strContactFaxNumber")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strContactFaxNumber")
            End If
            If IsDBNull(drDSRow("strContactEmail")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strContactEmail")
            End If
            If IsDBNull(drDSRow("strContactAddress1")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strContactAddress1")
            End If
            If IsDBNull(drDSRow("strContactCity")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strContactCity")
            End If
            If IsDBNull(drDSRow("strContactState")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strContactState")
            End If
            If IsDBNull(drDSRow("strContactZipCode")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strContactZipCode")
            End If
            If IsDBNull(drDSRow("strContactDescription")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strContactDescription")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationContact " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationContact " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationContact SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strContactFirstName = '" & Replace(temp2, "'", "''") & "', " & _
                    "strContactLastName = '" & Replace(temp3, "'", "''") & "', " & _
                    "strContactPrefix = '" & Replace(temp4, "'", "''") & "', " & _
                    "strContactSuffix = '" & Replace(temp5, "'", "''") & "', " & _
                    "strContactTitle = '" & Replace(temp6, "'", "''") & "', " & _
                    "strContactCompanyName = '" & Replace(temp7, "'", "''") & "', " & _
                    "strContactPhoneNumber1 = '" & Replace(temp8, "'", "''") & "', " & _
                    "strContactFaxNumber = '" & Replace(temp9, "'", "''") & "', " & _
                    "strContactEmail = '" & Replace(temp10, "'", "''") & "', " & _
                    "strContactAddress1 = '" & Replace(temp11, "'", "''") & "', " & _
                    "strContactCity = '" & Replace(temp12, "'", "''") & "', " & _
                    "strContactState = '" & Replace(temp13, "'", "''") & "', " & _
                    "strContactZipCode = '" & Replace(temp14, "'", "''") & "', " & _
                    "strContactDescription = '" & Replace(temp15, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationData()
        SQL = "Select * " & _
            "from " & DBNameSpace & ".SSPPApplicationData "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strFacilityName")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strFacilityName")
            End If

            If IsDBNull(drDSRow("strFacilityStreet1")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strFacilityStreet1")
            End If
            If IsDBNull(drDSRow("strFacilityStreet2")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strFacilityStreet2")
            End If
            If IsDBNull(drDSRow("strFacilityCity")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strFacilityCity")
            End If
            If IsDBNull(drDSRow("strFacilityState")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strFacilityState")
            End If
            If IsDBNull(drDSRow("strFacilityZipCode")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strFacilityZipCode")
            End If
            If IsDBNull(drDSRow("strOperationalStatus")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strOperationalStatus")
            End If
            If IsDBNull(drDSRow("strClass")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strClass")
            End If
            If IsDBNull(drDSRow("strAIRProgramCodes")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAIRProgramCodes")
            End If
            If IsDBNull(drDSRow("strSICCode")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strSICCode")
            End If
            If IsDBNull(drDSRow("strPermitNumber")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strPermitNumber")
            End If
            If IsDBNull(drDSRow("strPlantDescription")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strPlantDescription")
            End If
            If IsDBNull(drDSRow("strComments")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("strApplicationNotes")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strApplicationNotes")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("strTargeted")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("strTargeted")
            End If
            If IsDBNull(drDSRow("strStateProgramCodes")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strStateProgramCodes")
            End If
            If IsDBNull(drDSRow("strTrackedRules")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("strTrackedRules")
            End If
            If IsDBNull(drDSRow("strPAReady")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strPAReady")
            End If
            If IsDBNull(drDSRow("strPNReady")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("strPNReady")
            End If
            If IsDBNull(drDSRow("strSignificantComments")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strSignificantComments")
            End If
            If IsDBNull(drDSRow("strAppReceivedNotification")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strAppReceivedNotification")
            End If
            If IsDBNull(drDSRow("strDraftOnWebNotification")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("strDraftOnWebNotification")
            End If
            If IsDBNull(drDSRow("strFinalOnWebNotification")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("strFinalOnWebNotification")
            End If
            If IsDBNull(drDSRow("strPublicInvolvement")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("strPublicInvolvement")
            End If
            If IsDBNull(drDSRow("strPAPNComments")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("strPAPNComments")
            End If
            If IsDBNull(drDSRow("strPAPosted")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("strPAPosted")
            End If
            If IsDBNull(drDSRow("strPNPosted")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("strPNPosted")
            End If
            If IsDBNull(drDSRow("strSSCPUnit")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("strSSCPUnit")
            End If
            If IsDBNull(drDSRow("strSSCPReviewer")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("strSSCPReviewer")
            End If
            If IsDBNull(drDSRow("strSSCPComments")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("strSSCPComments")
            End If
            If IsDBNull(drDSRow("strISMPUnit")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("strISMPUnit")
            End If
            If IsDBNull(drDSRow("strISMPReviewer")) Then
                temp35 = ""
            Else
                temp35 = drDSRow("strISMPReviewer")
            End If
            If IsDBNull(drDSRow("strISMPComments")) Then
                temp36 = ""
            Else
                temp36 = drDSRow("strISMPComments")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationData " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationData " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "', '" & Replace(temp34, "'", "''") & "', " & _
                    "'" & Replace(temp35, "'", "''") & "', '" & Replace(temp36, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationData SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strFacilityName = '" & Replace(temp2, "'", "''") & "', " & _
                    "strFacilityStreet1 = '" & Replace(temp3, "'", "''") & "', " & _
                    "strFacilityStreet2 = '" & Replace(temp4, "'", "''") & "', " & _
                    "strFacilityCity = '" & Replace(temp5, "'", "''") & "', " & _
                    "strFacilityState = '" & Replace(temp6, "'", "''") & "', " & _
                    "strFacilityZipCode = '" & Replace(temp7, "'", "''") & "', " & _
                    "strOperationalStatus = '" & Replace(temp8, "'", "''") & "', " & _
                    "strClass = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAirProgramCodes = '" & Replace(temp10, "'", "''") & "', " & _
                    "strSICCode = '" & Replace(temp11, "'", "''") & "', " & _
                    "strPermitNumber = '" & Replace(temp12, "'", "''") & "', " & _
                    "strPlantDescription = '" & Replace(temp13, "'", "''") & "', " & _
                    "strComments = '" & Replace(temp14, "'", "''") & "', " & _
                    "strApplicationNotes = '" & Replace(temp15, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp16, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp17, "'", "''") & "', " & _
                    "strTargeted = '" & Replace(temp18, "'", "''") & "', " & _
                    "strStateProgramCodes = '" & Replace(temp19, "'", "''") & "', " & _
                    "strTrackedRules = '" & Replace(temp20, "'", "''") & "', " & _
                    "strPAReady = '" & Replace(temp21, "'", "''") & "', " & _
                    "strPNReady = '" & Replace(temp22, "'", "''") & "', " & _
                    "strSignificantComments = '" & Replace(temp23, "'", "''") & "', " & _
                    "strAppReceivedNotification = '" & Replace(temp24, "'", "''") & "', " & _
                    "strDraftOnWebNotification = '" & Replace(temp25, "'", "''") & "', " & _
                    "strFinalOnWebNotification = '" & Replace(temp26, "'", "''") & "', " & _
                    "strPublicInvolvement = '" & Replace(temp27, "'", "''") & "', " & _
                    "strPAPNComments = '" & Replace(temp28, "'", "''") & "', " & _
                    "strPAPosted = '" & Replace(temp29, "'", "''") & "', " & _
                    "strPNPosted = '" & Replace(temp30, "'", "''") & "', " & _
                    "strSSCPUnit = '" & Replace(temp31, "'", "''") & "', " & _
                    "strSSCPReviewer = '" & Replace(temp32, "'", "''") & "', " & _
                    "strSSCPComments = '" & Replace(temp33, "'", "''") & "', " & _
                    "strISMPUnit = '" & Replace(temp34, "'", "''") & "', " & _
                    "strISMPReviewer = '" & Replace(temp35, "'", "''") & "', " & _
                    "strISMPComments = '" & Replace(temp36, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationInformation()
        SQL = "Select * " & _
            "from " & DBNameSpace & ".SSPPApplicationInformation "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strRequestKey")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strRequestKey")
            End If

            If IsDBNull(drDSRow("datInformationRequested")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datInformationRequested")
            End If
            If IsDBNull(drDSRow("strInformationRequested")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strInformationRequested")
            End If
            If IsDBNull(drDSRow("datInformationReceived")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datInformationReceived")
            End If
            If IsDBNull(drDSRow("strInformationRecieved")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strInformationRecieved")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datModifingDate")
            End If
         
            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationInformation " & _
                "WHERE strApplicationNumber = '" & temp & "' " & _
                "and strRequestKey = '" & temp2 & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationInformation " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationInformation SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strRequestKey = '" & Replace(temp2, "'", "''") & "', " & _
                    "datInformationRequested = '" & Replace(temp3, "'", "''") & "', " & _
                    "strInformationRequested = '" & Replace(temp4, "'", "''") & "', " & _
                    "datInformationReceived = '" & Replace(temp5, "'", "''") & "', " & _
                    "strInformationRecieved = '" & Replace(temp6, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp7, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp8, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' " & _
                    "and strRequestKey = '" & temp2 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationLinking()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSPPApplicationLinking "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strMasterApplication")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strMasterApplication")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp2 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationLinking " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationLinking " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationLinking SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strMasterApplication = '" & Replace(temp2, "'", "''") & "' " & _
                    "WHERE strMasterApplication = '" & Replace(temp2, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationMaster()
        SQL = "Select * " & _
            "from " & DBNameSpace & ".SSPPApplicationMaster "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAIRSNumber")
            End If

            If IsDBNull(drDSRow("strStaffResponsible")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strStaffResponsible")
            End If
            If IsDBNull(drDSRow("strApplicationType")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strApplicationType")
            End If
            If IsDBNull(drDSRow("strPermitType")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strPermitType")
            End If
            If IsDBNull(drDSRow("APBUnit")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("APBUnit")
            End If
            If IsDBNull(drDSRow("DatFinalizedDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("DatFinalizedDate")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".APBMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp2 & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationMaster " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationMaster SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strStaffResponsible = '" & Replace(temp3, "'", "''") & "', " & _
                    "strApplicationType = '" & Replace(temp4, "'", "''") & "', " & _
                    "strPermitType = '" & Replace(temp5, "'", "''") & "', " & _
                    "APBUnit = '" & Replace(temp6, "'", "''") & "', " & _
                    "datFinalizedDate = '" & Replace(temp7, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp8, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp9, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationQuality()
        SQL = "Select * " & _
            "from " & DBNameSpace & ".SSPPApplicationQuality "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strDifficulty")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strDifficulty")
            End If

            If IsDBNull(drDSRow("strGrammer")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strGrammer")
            End If
            If IsDBNull(drDSRow("strTechnical")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strTechnical")
            End If
            If IsDBNull(drDSRow("strComments")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datModifingDate")
            End If
         
            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationQuality " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationQuality " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationQuality SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strDifficulty = '" & Replace(temp2, "'", "''") & "', " & _
                    "strGrammer = '" & Replace(temp3, "'", "''") & "', " & _
                    "strTechnical = '" & Replace(temp4, "'", "''") & "', " & _
                    "strComments = '" & Replace(temp5, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp6, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp7, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPApplicationTracking()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSPPApplicationTracking "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strSubmittalNumber-")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strSubmittalNumber")
            End If

            If IsDBNull(drDSRow("datApplicationStarted")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("datApplicationStarted")
            End If
            If IsDBNull(drDSRow("datReceivedDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datReceivedDate")
            End If
            If IsDBNull(drDSRow("datSentByFacility")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datSentByFacility")
            End If
            If IsDBNull(drDSRow("datAssignedToEngineer")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("datAssignedToEngineer")
            End If
            If IsDBNull(drDSRow("datReAssignedToEngineer")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("datReAssignedToEngineer")
            End If
            If IsDBNull(drDSRow("datApplicationPackageComplete")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("datApplicationPackageComplete")
            End If
            If IsDBNull(drDSRow("datAcknowledgementLetterSent")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("datAcknowledgementLetterSent")
            End If
            If IsDBNull(drDSRow("datToPMI")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("datToPMI")
            End If
            If IsDBNull(drDSRow("datToPMII")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("datToPMII")
            End If
            If IsDBNull(drDSRow("datReturnedToEngineer")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("datReturnedToEngineer")
            End If
            If IsDBNull(drDSRow("datPermitIssued")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("datPermitIssued")
            End If
            If IsDBNull(drDSRow("datApplicationDeadline")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("datApplicationDeadline")
            End If
            If IsDBNull(drDSRow("datWithdrawn")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("datWithdrawn")
            End If
            If IsDBNull(drDSRow("datDraftIssued")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("datDraftIssued")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("datModifingDate")
            End If
            If IsDBNull(drDSRow("datDraftOnWeb")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("datDraftOnWeb")
            End If
            If IsDBNull(drDSRow("datEPAStatesNotified")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("datEPAStatesNotified")
            End If
            If IsDBNull(drDSRow("datFinalOnWeb")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("datFinalOnWeb")
            End If
            If IsDBNull(drDSRow("datEPANotified")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("datEPANotified")
            End If
            If IsDBNull(drDSRow("datEffective")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("datEffective")
            End If
            If IsDBNull(drDSRow("datEPAStatesNotifiedAppRec")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("datEPAStatesNotifiedAppRec")
            End If
            If IsDBNull(drDSRow("datExperationDate")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("datExperationDate")
            End If
            If IsDBNull(drDSRow("datEPAWaived")) Then
                temp26 = ""
            Else
                temp26 = drDSRow("datEPAWaived")
            End If
            If IsDBNull(drDSRow("datEPAEnds")) Then
                temp27 = ""
            Else
                temp27 = drDSRow("datEPAEnds")
            End If
            If IsDBNull(drDSRow("datToBranchCheif")) Then
                temp28 = ""
            Else
                temp28 = drDSRow("datToBranchCheif")
            End If
            If IsDBNull(drDSRow("datToDirector")) Then
                temp29 = ""
            Else
                temp29 = drDSRow("datToDirector")
            End If
            If IsDBNull(drDSRow("datPAExpires")) Then
                temp30 = ""
            Else
                temp30 = drDSRow("datPAExpires")
            End If
            If IsDBNull(drDSRow("datPNExpires")) Then
                temp31 = ""
            Else
                temp31 = drDSRow("datPNExpires")
            End If
            If IsDBNull(drDSRow("datReviewSubmitted")) Then
                temp32 = ""
            Else
                temp32 = drDSRow("datReviewSubmitted")
            End If
            If IsDBNull(drDSRow("datSSCPReviewDate")) Then
                temp33 = ""
            Else
                temp33 = drDSRow("datSSCPReviewDate")
            End If
            If IsDBNull(drDSRow("datISMPReviewDate")) Then
                temp34 = ""
            Else
                temp34 = drDSRow("datISMPReviewDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPApplicationContact " & _
                "WHERE strApplicationNumber = '" & temp & "' " & _
                "and strSubmittalNumber = '" & temp2 & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPApplicationContact " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "', '" & Replace(temp26, "'", "''") & "', " & _
                    "'" & Replace(temp27, "'", "''") & "', '" & Replace(temp28, "'", "''") & "', " & _
                    "'" & Replace(temp29, "'", "''") & "', '" & Replace(temp30, "'", "''") & "', " & _
                    "'" & Replace(temp31, "'", "''") & "', '" & Replace(temp32, "'", "''") & "', " & _
                    "'" & Replace(temp33, "'", "''") & "', '" & Replace(temp34, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPApplicationContact SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strSubmittalNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "datApplicationStarted = '" & Replace(temp3, "'", "''") & "', " & _
                    "datReceivedDate = '" & Replace(temp4, "'", "''") & "', " & _
                    "datSentByFacility = '" & Replace(temp5, "'", "''") & "', " & _
                    "datAssignedToEngineer = '" & Replace(temp6, "'", "''") & "', " & _
                    "datReassignedToEngineer = '" & Replace(temp7, "'", "''") & "', " & _
                    "datApplicationPackageComplete = '" & Replace(temp8, "'", "''") & "', " & _
                    "datAcknowledgementLetterSent = '" & Replace(temp9, "'", "''") & "', " & _
                    "datToPMI = '" & Replace(temp10, "'", "''") & "', " & _
                    "datToPMII = '" & Replace(temp11, "'", "''") & "', " & _
                    "datReturnedToEngineer = '" & Replace(temp12, "'", "''") & "', " & _
                    "datPermitIssued = '" & Replace(temp13, "'", "''") & "', " & _
                    "datApplicationDeadline = '" & Replace(temp14, "'", "''") & "', " & _
                    "datWithdrawn = '" & Replace(temp15, "'", "''") & "', " & _
                    "datDraftIssued = '" & Replace(temp16, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp17, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp18, "'", "''") & "', " & _
                    "datDraftOnWeb = '" & Replace(temp19, "'", "''") & "', " & _
                    "datEPAStatesNotified = '" & Replace(temp20, "'", "''") & "', " & _
                    "datFinalOnWeb = '" & Replace(temp21, "'", "''") & "', " & _
                    "datEPANotified = '" & Replace(temp22, "'", "''") & "', " & _
                    "datEffective = '" & Replace(temp23, "'", "''") & "', " & _
                    "datEPAStatesNotifiedAppRec = '" & Replace(temp24, "'", "''") & "', " & _
                    "datExperationDate = '" & Replace(temp25, "'", "''") & "', " & _
                    "datEPAWaived = '" & Replace(temp26, "'", "''") & "', " & _
                    "datEPAEnds = '" & Replace(temp27, "'", "''") & "', " & _
                    "datToBranchCheif = '" & Replace(temp28, "'", "''") & "', " & _
                    "datToDirector = '" & Replace(temp29, "'", "''") & "', " & _
                    "datPAExpires = '" & Replace(temp30, "'", "''") & "', " & _
                    "datPNExpires = '" & Replace(temp31, "'", "''") & "', " & _
                    "datReviewSubmitted = '" & Replace(temp32, "'", "''") & "', " & _
                    "datSSCPReviewDate = '" & Replace(temp33, "'", "''") & "', " & _
                    "datISMPReviewDate = '" & Replace(temp34, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' " & _
                    "and strSubmittalNumber = '" & temp2 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPCDS()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".SSPPCDS "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strFacilityName")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strFacilityName")
            End If

            If IsDBNull(drDSRow("strFacilityStreet1")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strFacilityStreet1")
            End If
            If IsDBNull(drDSRow("strFacilityStreet2")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strFacilityStreet2")
            End If
            If IsDBNull(drDSRow("strFacilityCity")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strFacilityCity")
            End If
            If IsDBNull(drDSRow("strFacilityState")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("strFacilityState")
            End If
            If IsDBNull(drDSRow("strFacilityZipCode")) Then
                temp7 = ""
            Else
                temp7 = drDSRow("strFacilityZipCode")
            End If
            If IsDBNull(drDSRow("strOperationalStatus")) Then
                temp8 = ""
            Else
                temp8 = drDSRow("strOperationalStatus")
            End If
            If IsDBNull(drDSRow("strClass")) Then
                temp9 = ""
            Else
                temp9 = drDSRow("strClass")
            End If
            If IsDBNull(drDSRow("strAirProgramCodes")) Then
                temp10 = ""
            Else
                temp10 = drDSRow("strAirProgramCodes")
            End If
            If IsDBNull(drDSRow("strSICCode")) Then
                temp11 = ""
            Else
                temp11 = drDSRow("strSICCode")
            End If
            If IsDBNull(drDSRow("strPermitNumber")) Then
                temp12 = ""
            Else
                temp12 = drDSRow("strPermitNumber")
            End If
            If IsDBNull(drDSRow("strPlantDescription")) Then
                temp13 = ""
            Else
                temp13 = drDSRow("strPlantDescription")
            End If
            If IsDBNull(drDSRow("strActionType")) Then
                temp14 = ""
            Else
                temp14 = drDSRow("strActionType")
            End If
            If IsDBNull(drDSRow("strActionComments")) Then
                temp15 = ""
            Else
                temp15 = drDSRow("strActionComments")
            End If
            If IsDBNull(drDSRow("datEngineerComplete")) Then
                temp16 = ""
            Else
                temp16 = drDSRow("datEngineerComplete")
            End If
            If IsDBNull(drDSRow("strEngineerComplete")) Then
                temp17 = ""
            Else
                temp17 = drDSRow("strEngineerComplete")
            End If
            If IsDBNull(drDSRow("datPMIComplete")) Then
                temp18 = ""
            Else
                temp18 = drDSRow("datPMIComplete")
            End If
            If IsDBNull(drDSRow("strPMIComplete")) Then
                temp19 = ""
            Else
                temp19 = drDSRow("strPMIComplete")
            End If
            If IsDBNull(drDSRow("datPMIIComplete")) Then
                temp20 = ""
            Else
                temp20 = drDSRow("datPMIIComplete")
            End If
            If IsDBNull(drDSRow("strPMIIComplete")) Then
                temp21 = ""
            Else
                temp21 = drDSRow("strPMIIComplete")
            End If
            If IsDBNull(drDSRow("datDirectorComplete")) Then
                temp22 = ""
            Else
                temp22 = drDSRow("datDirectorComplete")
            End If
            If IsDBNull(drDSRow("strDirectorComplete")) Then
                temp23 = ""
            Else
                temp23 = drDSRow("strDirectorComplete")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp24 = ""
            Else
                temp24 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp25 = ""
            Else
                temp25 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "
            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".SSPPCDS " & _
                "WHERE strApplicationNumber = '" & temp & "' "
                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".SSPPCDS " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "', " & _
                    "'" & Replace(temp7, "'", "''") & "', '" & Replace(temp8, "'", "''") & "', " & _
                    "'" & Replace(temp9, "'", "''") & "', '" & Replace(temp10, "'", "''") & "', " & _
                    "'" & Replace(temp11, "'", "''") & "', '" & Replace(temp12, "'", "''") & "', " & _
                    "'" & Replace(temp13, "'", "''") & "', '" & Replace(temp14, "'", "''") & "', " & _
                    "'" & Replace(temp15, "'", "''") & "', '" & Replace(temp16, "'", "''") & "', " & _
                    "'" & Replace(temp17, "'", "''") & "', '" & Replace(temp18, "'", "''") & "', " & _
                    "'" & Replace(temp19, "'", "''") & "', '" & Replace(temp20, "'", "''") & "', " & _
                    "'" & Replace(temp21, "'", "''") & "', '" & Replace(temp22, "'", "''") & "', " & _
                    "'" & Replace(temp23, "'", "''") & "', '" & Replace(temp24, "'", "''") & "', " & _
                    "'" & Replace(temp25, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".SSPPCDS SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strFacilityName = '" & Replace(temp2, "'", "''") & "', " & _
                    "strFacilityStreet1 = '" & Replace(temp3, "'", "''") & "', " & _
                    "strFacilityStreet2 = '" & Replace(temp4, "'", "''") & "', " & _
                    "strFacilityCity = '" & Replace(temp5, "'", "''") & "', " & _
                    "strFacilityState = '" & Replace(temp6, "'", "''") & "', " & _
                    "strFacilityZipCode = '" & Replace(temp7, "'", "''") & "', " & _
                    "strOperationalStatus = '" & Replace(temp8, "'", "''") & "', " & _
                    "strClass = '" & Replace(temp9, "'", "''") & "', " & _
                    "strAirProgramCodes = '" & Replace(temp10, "'", "''") & "', " & _
                    "strSICCode = '" & Replace(temp11, "'", "''") & "', " & _
                    "strPermitNumber = '" & Replace(temp12, "'", "''") & "', " & _
                    "strPlantDescription = '" & Replace(temp13, "'", "''") & "', " & _
                    "strActionType = '" & Replace(temp14, "'", "''") & "', " & _
                    "strActionComments = '" & Replace(temp15, "'", "''") & "', " & _
                    "datEngineerComplete = '" & Replace(temp16, "'", "''") & "', " & _
                    "strEngineerComplete = '" & Replace(temp17, "'", "''") & "', " & _
                    "datPMIComplete = '" & Replace(temp18, "'", "''") & "', " & _
                    "strPMIComplete = '" & Replace(temp19, "'", "''") & "', " & _
                    "datPMIIComplete = '" & Replace(temp20, "'", "''") & "', " & _
                    "strPMIIComplete = '" & Replace(temp21, "'", "''") & "', " & _
                    "datDirectorComplete = '" & Replace(temp22, "'", "''") & "', " & _
                    "strDirectorComplete = '" & Replace(temp23, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp24, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp25, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & Replace(temp, "'", "''") & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferSSPPPublicLetters()

    End Sub
    Sub TransferAFSAirPollutantDate()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSAirPollutantData "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRPollutantKey")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRPollutantKey")
            End If
            If IsDBNull(drDSRow("strPollutantKey")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strPollutantKey")
            End If

            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("strComments")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp6 = ""
            Else
                temp6 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".APBAirProgramPollutants " & _
            "WHERE strAirPollutantKey = '" & temp & "' " & _
            "and strPollutantKey = '" & temp2 & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSAirPollutantData " & _
                "WHERE strAirPollutantKey = '" & temp & "' " & _
                "and strPollutantKey = '" & temp2 & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSAirPollutantData " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "', '" & Replace(temp6, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSAirPollutantData SET " & _
                    "strAIRPollutantKey = '" & Replace(temp, "'", "''") & "', " & _
                    "strPollutantKey = '" & Replace(temp2, "'", "''") & "', " & _
                    "strAIRSNumber = '" & Replace(temp3, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp4, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp5, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp6, "'", "''") & "' " & _
                    "WHERE strAirPollutantKey = '" & temp & "' " & _
                    "and strPollutantKey = '" & temp2 & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSBatchFile()

    End Sub
    Sub TransferAFSFacilityData()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSFacilityData "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strAIRSNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strAIRSNumber")
            End If
            If IsDBNull(drDSRow("strUpdateStatus")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strUpdateStatus")
            End If

            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strAIRSNumber " & _
            "FROM " & DBNameSpace & ".ABPMasterAIRS " & _
            "WHERE strAIRSNumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSFacilityData " & _
                "WHERE strAIRSNumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSFacilityData " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSFacilityData SET " & _
                    "strAIRSNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strUpdateStatus = '" & Replace(temp2, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp3, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp4, "'", "''") & "' " & _
                    "WHERE strAIRSNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSISMPRecords()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSISMPRecords "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strReferenceNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strReferenceNumber")
            End If
            If IsDBNull(drDSRow("strAFSActionNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAFSActionNumber")
            End If

            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strReferenceNumber " & _
            "FROM " & DBNameSpace & ".ISMPMaster " & _
            "WHERE strReferenceNumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSISMPRecords " & _
                "WHERE strReferenceNumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSISMPRecords " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSISMPRecords SET " & _
                    "strReferenceNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAFSActionNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp3, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strReferenceNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSSSCPEnforcementRecords()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSSSCPEnforcementRecords "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strEnforcementNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strEnforcementNumber")
            End If
            If IsDBNull(drDSRow("strAFSActionNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAFSActionNumber")
            End If

            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strEnforcementNumber " & _
            "FROM " & DBNameSpace & ".SSCPEnforcementItems " & _
            "WHERE strEnforcementNumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSSSCPEnforcementRecords " & _
                "WHERE strEnforcementNumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSSSCPEnforcementRecords " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSSSCPEnforcementRecords SET " & _
                    "strEnforcementNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAFSActionNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp3, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strEnforcementNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSSSCPFCERecords()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSSSCPFCERecords "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strFCENumber")) Then
                temp = ""
            Else
                temp = drDSRow("strFCENumber")
            End If
            If IsDBNull(drDSRow("strAFSActionNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAFSActionNumber")
            End If

            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strFCENumber " & _
            "FROM " & DBNameSpace & ".SSCPFCEMaster " & _
            "WHERE strFCENumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSSSCPFCERecords " & _
                "WHERE strFCENumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSSSCPFCERecords " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSSSCPFCERecords SET " & _
                    "strFCENumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAFSActionNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp3, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strFCENumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSSSCPRecords()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSSSCPRecords "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strTrackingNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strTrackingNumber")
            End If
            If IsDBNull(drDSRow("strAFSActionNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAFSActionNumber")
            End If

            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strTrackingNumber " & _
            "FROM " & DBNameSpace & ".SSCPItemMaster " & _
            "WHERE strTrackingNumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSSSCPRecords " & _
                "WHERE strTrackingNumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSSSCPRecords " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSSSCPRecords SET " & _
                    "strTrackingNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAFSActionNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp3, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strTrackingNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Sub TransferAFSSSPPRecords()
        SQL = "Select * " & _
        "from " & DBNameSpace & ".AFSSSPPRecords "

        dsTemp = New DataSet
        daTemp = New OracleDataAdapter(SQL, conn)
        If conn.State = ConnectionState.Closed Then
            conn.Open()
        End If
        daTemp.Fill(dsTemp, "Temp")

        For Each drDSRow In dsTemp.Tables("Temp").Select()
            If IsDBNull(drDSRow("strApplicationNumber")) Then
                temp = ""
            Else
                temp = drDSRow("strApplicationNumber")
            End If
            If IsDBNull(drDSRow("strAFSActionNumber")) Then
                temp2 = ""
            Else
                temp2 = drDSRow("strAFSActionNumber")
            End If

            If IsDBNull(drDSRow("strUpDateStatus")) Then
                temp3 = ""
            Else
                temp3 = drDSRow("strUpDateStatus")
            End If
            If IsDBNull(drDSRow("strModifingPerson")) Then
                temp4 = ""
            Else
                temp4 = drDSRow("strModifingPerson")
            End If
            If IsDBNull(drDSRow("datModifingDate")) Then
                temp5 = ""
            Else
                temp5 = drDSRow("datModifingDate")
            End If

            SQL = "SELECT strApplicationNumber " & _
            "FROM " & DBNameSpace & ".SSPPApplicationMaster " & _
            "WHERE strApplicationNumber = '" & temp & "' "

            cmd = New OracleCommand(SQL, transferConn)
            If transferConn.State = ConnectionState.Closed Then
                transferConn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read
            dr.Close()
            If recExist = True Then
                SQL = "SELECT COUNT(*) " & _
                "FROM " & DBNameSpace & ".AFSSSPPRecords " & _
                "WHERE strTrackingNumber = '" & temp & "' "

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = False Or dr.Item(0) = 0 Then
                    SQL = "Insert into " & DBNameSpace & ".AFSSSPPRecords " & _
                    "Values " & _
                    "('" & Replace(temp, "'", "''") & "', '" & Replace(temp2, "'", "''") & "', " & _
                    "'" & Replace(temp3, "'", "''") & "', '" & Replace(temp4, "'", "''") & "', " & _
                    "'" & Replace(temp5, "'", "''") & "') "
                Else
                    SQL = "UPDATE " & DBNameSpace & ".AFSSSPPRecords SET " & _
                    "strApplicationNumber = '" & Replace(temp, "'", "''") & "', " & _
                    "strAFSActionNumber = '" & Replace(temp2, "'", "''") & "', " & _
                    "strUpDateStatus = '" & Replace(temp3, "'", "''") & "', " & _
                    "strModifingPerson = '" & Replace(temp4, "'", "''") & "', " & _
                    "datModifingDate = '" & Replace(temp5, "'", "''") & "' " & _
                    "WHERE strApplicationNumber = '" & temp & "' "
                End If
                dr.Close()

                cmd = New OracleCommand(SQL, transferConn)
                If transferConn.State = ConnectionState.Closed Then
                    transferConn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
            End If
        Next
    End Sub
    Private Sub bgwTransfer_RunWorkerCompleted(ByVal sender As Object, ByVal e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles bgwTransfer.RunWorkerCompleted
        btnTransferData.Enabled = True
        btnClearSelection.Enabled = True
        lblTransfer.Text = "Data Transfer Complete."

    End Sub
    Private Sub btnSearchForAFSFile_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSearchForAFSFile.Click
        Try
            Dim FileName As String = ""
            Dim path As New OpenFileDialog
            Dim temp As String = ""

            path.InitialDirectory = My.Computer.FileSystem.SpecialDirectories.Desktop
            path.FileName = FileName
            path.Filter = "Text files (*.txt)|*.txt|All files (*.*)|*.*"
            path.FilterIndex = 1

            If path.ShowDialog = Windows.Forms.DialogResult.OK Then
                temp = path.FileName.ToString
            Else
                temp = "N/A"
            End If

            If temp.Length > 3 Then
                If Mid(temp, (temp.Length - 3)).ToUpper = ".TXT" Then
                    txtAFSFile.Text = temp
                Else
                End If
            Else
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try

    End Sub
    Sub LoadAFSData()
        Try
            Dim DefaultText As String = ""
            Dim AIRSNumber As String = ""
            Dim TransactionType As String = ""
            Dim FacilityName As String = ""
            Dim IAIPFacilityName As String = ""
            Dim FacilityAddress As String = ""
            Dim IAIPFacilityAddress As String = ""
            Dim FacilityCity As String = ""
            Dim IAIPFacilityCity As String = ""
            Dim FacilityZipCode As String = ""
            Dim IAIPFacilityZipCode As String = ""
            Dim FacilitySIC As String = ""
            Dim IAIPFacilitySIC As String = ""
            Dim FacilityNAICS As String = ""
            Dim IAIPFacilityNAICS As String = ""
            Dim FacilityContactPerson As String = ""
            Dim IAIPFacilityContactPerson As String = ""
            Dim FacilityContactNumber As String = ""
            Dim IAIPFacilityContactNumber As String = ""
            Dim FacilityDescription As String = ""
            Dim IAIPFacilityDescription As String = ""
            Dim AirProgramCode As String = ""
            Dim IAIPAirProgramCode As String = ""
            Dim ProgramStatus As String = ""
            Dim IAIPProgramStatus As String = ""
            Dim Pollutant As String = ""
            Dim IAIPPollutant As String = ""
            Dim SubPart1 As String = ""
            Dim IAIPSubPart As String = ""
            Dim SubPart2 As String = ""
            Dim SubPart3 As String = ""
            Dim SubPart4 As String = ""
            Dim SubPart5 As String = ""
            Dim SubPart6 As String = ""
            Dim SubPart7 As String = ""
            Dim SubPart8 As String = ""
            Dim SubPart9 As String = ""
            Dim FacilityClassification As String = ""
            Dim IAIPFacilityClassification As String = ""
            Dim ComplianceStatus As String = ""
            Dim IAIPComplianceStatus As String = ""
            Dim AttainmentStatus As String = ""
            Dim IAIPAttainmentStatus As String = ""
            Dim SICCode As String = ""
            Dim IAIPSICCode As String = ""
            Dim ActionNumber As String = ""
            Dim IAIPActionNumber As String = ""
            Dim ActionType As String = ""
            Dim IAIPActionType As String = ""
            Dim DateScheduled As String = ""
            Dim IAIPDateScheduled As String = ""
            Dim DateAcheived As String = ""
            Dim IAIPDateAcheived As String = ""
            Dim ResultCode As String = ""
            Dim IAIPResultCode As String = ""
            Dim PenaltyAmount As String = ""
            Dim IAIPPenaltyAmount As String = ""
            Dim Pollutant161 As String = ""
            Dim IAIPPollutant161 As String = ""
            Dim KeyActionNumber As String = ""
            Dim IAIPKeyActionNumber As String = ""
            Dim ActionNumber163 As String = ""
            Dim IAIPActionNumber163 As String = ""
            Dim ActionNumber164 As String = ""
            Dim IAIPActionNumber164 As String = ""
            Dim KeyActionNumber164 As String = ""
            Dim IAIPKeyActionNumber164 As String = ""
            Dim ViolationType As String = ""
            Dim IAIPViolationType As String = ""
            Dim Pollutant163 As String = ""
            Dim IAIPPollutant163 As String = ""
            Dim CMSStatus As String = ""
            Dim IAIPCMSStatus As String = ""

            dgvAFSData.Columns.Clear()
            If File.Exists(txtAFSFile.Text) Then
                dgvAFSData.Rows.Clear()

                If rdbCompareAFSDataOnly.Checked = True Or rdbCompareFullIAIPdata.Checked = True Then
                    dgvAFSData.Columns.Add("AIRSNumber", "AIRS Number")
                    dgvAFSData.Columns.Add("TransactionType", "Transaction Type")
                    dgvAFSData.Columns.Add("FacilityName", "AFS Facility Name")
                    dgvAFSData.Columns("FacilityName").Width = 200
                    dgvAFSData.Columns.Add("IAIPFacilityName", "IAIP Facility Name")
                    dgvAFSData.Columns("IAIPFacilityName").Width = 200
                    dgvAFSData.Columns.Add("FacilityAddress", "AFS Facility Address")
                    dgvAFSData.Columns("FacilityAddress").Width = 200
                    dgvAFSData.Columns.Add("IAIPFacilityAddress", "IAIP Facility Address")
                    dgvAFSData.Columns("IAIPFacilityAddress").Width = 200
                    dgvAFSData.Columns.Add("City", "City")
                    dgvAFSData.Columns.Add("IAIPCity", "IAIP City")
                    dgvAFSData.Columns.Add("ZipCode", "Zip Code")
                    dgvAFSData.Columns.Add("IAIPZipCode", "IAIP Zip Code")
                    dgvAFSData.Columns.Add("SICCode", "SIC Code")
                    dgvAFSData.Columns.Add("IAIPSICCode", "IAIP SIC Code")
                    dgvAFSData.Columns.Add("ContactPerson", "Contact Person")
                    dgvAFSData.Columns.Add("IAIPContactPerson", "IAIP Contact Person")
                    dgvAFSData.Columns.Add("ContactNumber", "Contact Number")
                    dgvAFSData.Columns.Add("IAIPContactNumber", "IAIP Contact Number")
                    dgvAFSData.Columns.Add("FacilityDescription", "Facility Description")
                    dgvAFSData.Columns("FacilityDescription").Width = 200
                    dgvAFSData.Columns.Add("IAIPFacilityDescription", "IAIP Facility Description")
                    dgvAFSData.Columns("IAIPFacilityDescription").Width = 200
                    dgvAFSData.Columns.Add("AirProgramCode", "Air Program Code")
                    dgvAFSData.Columns.Add("IAIPAirProgramCode", "IAIP Air Program Code")
                    dgvAFSData.Columns.Add("ProgramCodeStatus", "Program Code Status")
                    dgvAFSData.Columns.Add("IAIPProgramCodeStatus", "IAIP Program Code Status")
                    dgvAFSData.Columns.Add("IAIPSubPart", "IAIP Sub Part 1")
                    dgvAFSData.Columns.Add("SubPart1", "Sub Part 1")
                    dgvAFSData.Columns.Add("SubPart2", "Sub Part 2")
                    dgvAFSData.Columns.Add("SubPart3", "Sub Part 3")
                    dgvAFSData.Columns.Add("SubPart4", "Sub Part 4")
                    dgvAFSData.Columns.Add("SubPart5", "Sub Part 5")
                    dgvAFSData.Columns.Add("SubPart6", "Sub Part 6")
                    dgvAFSData.Columns.Add("SubPart7", "Sub Part 7")
                    dgvAFSData.Columns.Add("SubPart8", "Sub Part 8")
                    dgvAFSData.Columns.Add("SubPart9", "Sub Part 9")
                    dgvAFSData.Columns.Add("Pollutant", "Pollutant")
                    dgvAFSData.Columns.Add("IAIPPollutant", "IAIP Pollutant")
                    dgvAFSData.Columns.Add("Class", "Classification")
                    dgvAFSData.Columns.Add("IAIPClass", "IAIP Classification")
                    dgvAFSData.Columns.Add("ComplianceStauts", "Compliance Status")
                    dgvAFSData.Columns.Add("IAIPComplianceStauts", "IAIP Compliance Status")
                    dgvAFSData.Columns.Add("AttainmentStatus", "Attainment Status")
                    dgvAFSData.Columns.Add("IAIPAttainmentStatus", "IAIP Attainment Status")
                    dgvAFSData.Columns.Add("SICCode2", "SIC Code")
                    dgvAFSData.Columns.Add("IAIPSICCode2", "IAIP SIC Code")
                    dgvAFSData.Columns.Add("ActionNumber", "Action Number")
                    dgvAFSData.Columns.Add("IAIPActionNumber", "IAIP Action Number")
                    dgvAFSData.Columns.Add("ActionType", "Action Type")
                    dgvAFSData.Columns.Add("IAIPActionType", "IAIP Action Type")
                    dgvAFSData.Columns.Add("DateScheduled", "Date Scheduled")
                    dgvAFSData.Columns.Add("IAIPDateScheduled", "IAIP Date Scheduled")
                    dgvAFSData.Columns.Add("DateAcheived", "Date Acheived")
                    dgvAFSData.Columns.Add("IAIPDateAcheived", "IAIP Date Acheived")
                    dgvAFSData.Columns.Add("ResultCode", "Result Code")
                    dgvAFSData.Columns.Add("IAIPResultCode", "IAIP Result Code")
                    dgvAFSData.Columns.Add("PenaltyAmount", "Penalty Amount")
                    dgvAFSData.Columns.Add("IAIPPenaltyAmount", "IAIP Penalty Amount")
                    dgvAFSData.Columns.Add("Pollutant161", "Pollutant")
                    dgvAFSData.Columns.Add("IAIPPollutant161", "IAIP Pollutant")
                    dgvAFSData.Columns.Add("KeyActionNumber", "Key Action Number")
                    dgvAFSData.Columns.Add("IAIPKeyActionNumber", "IAIP Key Action Number")
                    dgvAFSData.Columns.Add("ActionNumber163", "Action Number")
                    dgvAFSData.Columns.Add("IAIPActionNumber163", "IAIP Action Number")
                    dgvAFSData.Columns.Add("Pollutant163", "Pollutant")
                    dgvAFSData.Columns.Add("IAIPPollutant163", "IAIP Pollutant")

                    dgvAFSData.Columns.Add("ActionNumber164", "Action Number")
                    dgvAFSData.Columns.Add("IAIPActionNumber164", "IAIP Action Number")
                    dgvAFSData.Columns.Add("KeyActionNumber164", "Key Action Number")
                    dgvAFSData.Columns.Add("IAIPKeyActionNumber164", "IAIP Key Action Number")
                    dgvAFSData.Columns.Add("ViolationType", "Violation Type")
                    dgvAFSData.Columns.Add("IAIPViolationType", "IAIP Violation Type")
                    dgvAFSData.Columns.Add("CMSStatus", "CMS Status")
                    dgvAFSData.Columns.Add("IAIPCMSStatus", "IAIP CMS Status")

                    If chb101Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("FacilityName").Visible = False
                        dgvAFSData.Columns("IAIPFacilityName").Visible = False
                    End If
                    If chb102Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("FacilityAddress").Visible = False
                        dgvAFSData.Columns("IAIPFacilityAddress").Visible = False
                    End If
                    If chb103Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("City").Visible = False
                        dgvAFSData.Columns("ZipCode").Visible = False
                        dgvAFSData.Columns("SICCode").Visible = False
                        dgvAFSData.Columns("IAIPCity").Visible = False
                        dgvAFSData.Columns("IAIPZipCode").Visible = False
                        dgvAFSData.Columns("IAIPSICCode").Visible = False
                    End If
                    If chb105Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ContactPerson").Visible = False
                        dgvAFSData.Columns("ContactNumber").Visible = False
                        dgvAFSData.Columns("FacilityDescription").Visible = False
                        dgvAFSData.Columns("IAIPContactPerson").Visible = False
                        dgvAFSData.Columns("IAIPContactNumber").Visible = False
                        dgvAFSData.Columns("IAIPFacilityDescription").Visible = False
                    End If
                    If chb121Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("AirProgramCode").Visible = False
                        dgvAFSData.Columns("ProgramCodeStatus").Visible = False
                        dgvAFSData.Columns("IAIPAirProgramCode").Visible = False
                        dgvAFSData.Columns("IAIPProgramCodeStatus").Visible = False
                    End If
                    If chb122Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("SubPart1").Visible = False
                        dgvAFSData.Columns("SubPart2").Visible = False
                        dgvAFSData.Columns("SubPart3").Visible = False
                        dgvAFSData.Columns("SubPart4").Visible = False
                        dgvAFSData.Columns("SubPart5").Visible = False
                        dgvAFSData.Columns("SubPart6").Visible = False
                        dgvAFSData.Columns("SubPart7").Visible = False
                        dgvAFSData.Columns("SubPart8").Visible = False
                        dgvAFSData.Columns("SubPart9").Visible = False
                        dgvAFSData.Columns("IAIPSubPart").Visible = False
                    End If
                    If chb131Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("Pollutant").Visible = False
                        dgvAFSData.Columns("Class").Visible = False
                        dgvAFSData.Columns("ComplianceStauts").Visible = False
                        dgvAFSData.Columns("AttainmentStatus").Visible = False
                        dgvAFSData.Columns("SICCode2").Visible = False
                        dgvAFSData.Columns("IAIPPollutant").Visible = False
                        dgvAFSData.Columns("IAIPClass").Visible = False
                        dgvAFSData.Columns("IAIPComplianceStauts").Visible = False
                        dgvAFSData.Columns("IAIPAttainmentStatus").Visible = False
                        dgvAFSData.Columns("IAIPSICCode2").Visible = False
                    End If
                    If chb161Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ActionNumber").Visible = False
                        dgvAFSData.Columns("ActionType").Visible = False
                        dgvAFSData.Columns("DateScheduled").Visible = False
                        dgvAFSData.Columns("DateAcheived").Visible = False
                        dgvAFSData.Columns("ResultCode").Visible = False
                        dgvAFSData.Columns("PenaltyAmount").Visible = False
                        dgvAFSData.Columns("Pollutant161").Visible = False
                        dgvAFSData.Columns("IAIPActionNumber").Visible = False
                        dgvAFSData.Columns("IAIPActionType").Visible = False
                        dgvAFSData.Columns("IAIPDateScheduled").Visible = False
                        dgvAFSData.Columns("IAIPDateAcheived").Visible = False
                        dgvAFSData.Columns("IAIPResultCode").Visible = False
                        dgvAFSData.Columns("IAIPPenaltyAmount").Visible = False
                        dgvAFSData.Columns("IAIPPollutant161").Visible = False
                    End If
                    If chb163Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("KeyActionNumber").Visible = False
                        dgvAFSData.Columns("IAIPKeyActionNumber").Visible = False
                        dgvAFSData.Columns("ActionNumber163").Visible = False
                        dgvAFSData.Columns("IAIPActionNumber163").Visible = False
                        dgvAFSData.Columns("Pollutant163").Visible = False
                        dgvAFSData.Columns("IAIPPollutant163").Visible = False
                    End If
                    If chb164Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ActionNumber164").Visible = False
                        dgvAFSData.Columns("IAIPActionNumber164").Visible = False
                        dgvAFSData.Columns("KeyActionNumber164").Visible = False
                        dgvAFSData.Columns("IAIPKeyActionNumber164").Visible = False
                        dgvAFSData.Columns("ViolationType").Visible = False
                        dgvAFSData.Columns("IAIPViolationType").Visible = False
                    End If
                    If chb181Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("CMSStatus").Visible = False
                        dgvAFSData.Columns("IAIPCMSStatus").Visible = False
                    End If

                    Dim reader As StreamReader = New StreamReader(txtAFSFile.Text)
                    Do
                        DefaultText = reader.ReadLine
                        AIRSNumber = Mid(DefaultText, 3, 8)
                        TransactionType = Mid(DefaultText, 11, 3)
                        Select Case TransactionType
                            Case "101"
                                If chb101Card.Checked = True Then
                                    FacilityName = Mid(DefaultText, 16, 40)
                                    IAIPFacilityName = "NULL"

                                    SQL = "Select upper(strFacilityName) as strFacilityName " & _
                                    "from " & DBNameSpace & ".APBFacilityInformation " & _
                                    "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strFacilityName")) Then
                                            IAIPFacilityName = "NULL"
                                        Else
                                            IAIPFacilityName = dr.Item("strFacilityName")
                                        End If
                                    End While
                                    dr.Close()
                                    If Replace(Mid(IAIPFacilityName, 1, 40), " ", "") = Replace(FacilityName, " ", "") Then
                                        IAIPFacilityName = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, FacilityName, IAIPFacilityName)
                                End If
                            Case "102"
                                If chb102Card.Checked = True Then
                                    FacilityAddress = Mid(DefaultText, 16, 30)
                                    IAIPFacilityAddress = "NULL"

                                    SQL = "Select upper(strFacilityStreet1) as strFacilityStreet1 " & _
                                    "from " & DBNameSpace & ".APBFacilityInformation " & _
                                    "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strFacilityStreet1")) Then
                                            IAIPFacilityAddress = "NULL"
                                        Else
                                            IAIPFacilityAddress = dr.Item("strFacilityStreet1")
                                        End If
                                    End While
                                    dr.Close()
                                    If Mid(IAIPFacilityAddress, 1, 30) = FacilityAddress Then
                                        IAIPFacilityAddress = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", FacilityAddress, IAIPFacilityAddress)
                                End If
                            Case "103"
                                If chb103Card.Checked = True Then
                                    FacilityCity = Mid(DefaultText, 16, 30)
                                    FacilityZipCode = Mid(DefaultText, 46, 9)
                                    FacilitySIC = Mid(DefaultText, 55, 4)
                                    IAIPFacilityCity = "NULL"
                                    IAIPFacilityZipCode = "NULL"
                                    IAIPFacilitySIC = "NULL"

                                    SQL = "Select " & _
                                    "Upper(strFacilityCity) as strFacilityCity, " & _
                                    "Upper(strFacilityZipCode) as strFacilityZipCode, " & _
                                    "upper(strSICCode) as strSICCode " & _
                                    "from " & DBNameSpace & ".APBFacilityInformation, " & DBNameSpace & ".APBHeaderData " & _
                                    "where " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                    "and " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber = '0413" & AIRSNumber & "' "
                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strFacilityCity")) Then
                                            IAIPFacilityCity = "NULL"
                                        Else
                                            IAIPFacilityCity = dr.Item("strFacilityCity")
                                        End If
                                        If IsDBNull(dr.Item("strFacilityZipCode")) Then
                                            IAIPFacilityZipCode = "NULL"
                                        Else
                                            IAIPFacilityZipCode = dr.Item("strFacilityZipCode")
                                        End If
                                        If IsDBNull(dr.Item("strSICCode")) Then
                                            IAIPFacilitySIC = "NULL"
                                        Else
                                            IAIPFacilitySIC = dr.Item("strSICCode")
                                        End If
                                    End While
                                    dr.Close()
                                    If Mid(IAIPFacilityCity, 1, 30) = FacilityCity Then
                                        IAIPFacilityCity = ""
                                    End If
                                    If Replace(IAIPFacilityCity, " ", "") = Replace(FacilityCity, " ", "") Then
                                        IAIPFacilityCity = ""
                                    End If
                                    If Mid(IAIPFacilityZipCode, 1, 5) = FacilityZipCode Then
                                        IAIPFacilityZipCode = ""
                                    End If
                                    If Replace(IAIPFacilityZipCode, " ", "") = Replace(FacilityZipCode, " ", "") Then
                                        IAIPFacilityZipCode = ""
                                    End If
                                    If Mid(IAIPFacilitySIC, 1, 4) = FacilitySIC Then
                                        IAIPFacilitySIC = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", FacilityCity, IAIPFacilityCity, _
                                                        FacilityZipCode, IAIPFacilityZipCode, FacilitySIC, IAIPFacilitySIC)
                                End If
                            Case "104"
                                    'Ignore
                                    'FacilityNAICS = Mid(DefaultText, 57, 6)
                            Case "105"
                                If chb105Card.Checked = True Then
                                    FacilityContactPerson = Mid(DefaultText, 14, 20)
                                    FacilityContactNumber = Mid(DefaultText, 34, 10)
                                    FacilityDescription = Mid(DefaultText, 44, 25)
                                    IAIPFacilityContactPerson = "NULL"
                                    IAIPFacilityContactNumber = "NULL"
                                    IAIPFacilityDescription = "NULL"

                                    SQL = "select " & _
                                    "upper(strContactFirstName||' '||strContactLastName) as strContactName,  " & _
                                    "strContactPhoneNumber1,  " & _
                                    "upper(strPlantDescription) as strPlantDescription  " & _
                                    "from " & DBNameSpace & ".APBContactInformation, " & DBNameSpace & ".APBHeaderData  " & _
                                    "where " & DBNameSpace & ".apbcontactinformation.strAIRSNumber = " & DBNameSpace & ".apbheaderdata.strairsnumber  " & _
                                    "and " & DBNameSpace & ".APBHeaderData.strairsnumber = '0413" & AIRSNumber & "'  " & _
                                    "and strkey = '30'"

                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strContactName")) Then
                                            IAIPFacilityContactPerson = "NULL"
                                        Else
                                            IAIPFacilityContactPerson = Mid(dr.Item("strContactName"), 1, 20)
                                        End If
                                        If IsDBNull(dr.Item("strContactPhoneNumber1")) Then
                                            IAIPFacilityContactNumber = "NULL"
                                        Else
                                            IAIPFacilityContactNumber = Mid(dr.Item("strContactPhoneNumber1"), 1, 10)
                                        End If
                                        If IsDBNull(dr.Item("strPlantDescription")) Then
                                            IAIPFacilityDescription = "NULL"
                                        Else
                                            IAIPFacilityDescription = Mid(dr.Item("strPlantDescription"), 1, 25)
                                        End If
                                    End While
                                    dr.Close()
                                    If Mid(IAIPFacilityContactPerson, 1, 30) = FacilityContactPerson Then
                                        IAIPFacilityContactPerson = ""
                                    End If
                                    If Replace(IAIPFacilityContactPerson, " ", "") = Replace(FacilityContactPerson, " ", "") Then
                                        IAIPFacilityContactPerson = ""
                                    End If
                                    If Mid(IAIPFacilityContactNumber, 1, 30) = FacilityContactNumber Then
                                        IAIPFacilityContactNumber = ""
                                    End If
                                    If Replace(IAIPFacilityContactNumber, " ", "") = Replace(FacilityContactNumber, " ", "") Then
                                        IAIPFacilityContactNumber = ""
                                    End If
                                    If Mid(IAIPFacilityDescription, 1, 30) = FacilityDescription Then
                                        IAIPFacilityDescription = ""
                                    End If
                                    If Replace(IAIPFacilityDescription, " ", "") = Replace(FacilityDescription, " ", "") Then
                                        IAIPFacilityDescription = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", _
                                                        FacilityContactPerson, IAIPFacilityContactPerson, FacilityContactNumber, _
                                                        IAIPFacilityContactNumber, FacilityDescription, IAIPFacilityDescription)
                                End If
                            Case "106"
                                    'Ignore
                            Case "107"
                                    'Ignore
                            Case "121"
                                If chb121Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    ProgramStatus = Mid(DefaultText, 15, 1)
                                    IAIPAirProgramCode = "NULL"
                                    IAIPProgramStatus = "NULL"

                                    Select Case AirProgramCode
                                        Case "0"
                                            IAIPAirProgramCode = "0"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 1, 1) = '1' "
                                        Case "1"
                                            IAIPAirProgramCode = "1"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 2, 1) = '1' "
                                        Case "3"
                                            IAIPAirProgramCode = "3"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 3, 1) = '1' "
                                        Case "4"
                                            IAIPAirProgramCode = "4"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 4, 1) = '1' "
                                        Case "6"
                                            IAIPAirProgramCode = "6"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 5, 1) = '1' "
                                        Case "7"
                                            IAIPAirProgramCode = "7"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 6, 1) = '1' "
                                        Case "8"
                                            IAIPAirProgramCode = "8"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 7, 1) = '1' "
                                        Case "9"
                                            IAIPAirProgramCode = "9"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 8, 1) = '1' "
                                        Case "A"
                                            IAIPAirProgramCode = "A"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 9, 1) = '1' "
                                        Case "F"
                                            IAIPAirProgramCode = "F"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 10, 1) = '1' "
                                        Case "I"
                                            IAIPAirProgramCode = "I"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 11, 1) = '1' "
                                        Case "M"
                                            IAIPAirProgramCode = "M"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 12, 1) = '1' "
                                        Case "V"
                                            IAIPAirProgramCode = "V"
                                            SQL = "select " & _
                                            "strOperationalStatus  " & _
                                            "from " & DBNameSpace & ".APBHeaderData  " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and substr(strAirProgramCodes, 13, 1) = '1' "
                                        Case Else
                                            SQL = ""
                                            IAIPAirProgramCode = "NULL"
                                            IAIPProgramStatus = "NULL"
                                    End Select
                                    If SQL <> "" Then
                                        cmd = New OracleCommand(SQL, conn)
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strOperationalStatus")) Then
                                                IAIPProgramStatus = "NULL"
                                            Else
                                                IAIPProgramStatus = dr.Item("strOperationalStatus")
                                            End If
                                        End While
                                        dr.Close()
                                    End If

                                    If IAIPAirProgramCode = AirProgramCode Then
                                        IAIPAirProgramCode = ""
                                    End If
                                    If IAIPProgramStatus = ProgramStatus Then
                                        IAIPProgramStatus = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, IAIPAirProgramCode, ProgramStatus, IAIPProgramStatus)
                                End If
                            Case "122"
                                If chb122Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    SubPart1 = Replace(Mid(DefaultText, 16, 5), " ", "")
                                    SubPart2 = Replace(Mid(DefaultText, 21, 5), " ", "")
                                    SubPart3 = Replace(Mid(DefaultText, 26, 5), " ", "")
                                    SubPart4 = Replace(Mid(DefaultText, 31, 5), " ", "")
                                    SubPart5 = Replace(Mid(DefaultText, 36, 5), " ", "")
                                    SubPart6 = Replace(Mid(DefaultText, 41, 5), " ", "")
                                    SubPart7 = Replace(Mid(DefaultText, 46, 5), " ", "")
                                    SubPart8 = Replace(Mid(DefaultText, 51, 5), " ", "")
                                    SubPart9 = Replace(Mid(DefaultText, 56, 5), " ", "")
                                    IAIPAirProgramCode = "NULL"
                                    IAIPSubPart = "NULL"

                                    Select Case AirProgramCode
                                        Case "0"
                                            IAIPAirProgramCode = "0"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "0' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "1"
                                            IAIPAirProgramCode = "1"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "1' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "3"
                                            IAIPAirProgramCode = "3"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "3' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "4"
                                            IAIPAirProgramCode = "4"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "4' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "6"
                                            IAIPAirProgramCode = "6"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "6' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "7"
                                            IAIPAirProgramCode = "7"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "7' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "8"
                                            IAIPAirProgramCode = "8"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "8' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "9"
                                            IAIPAirProgramCode = "9"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "9' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "A"
                                            IAIPAirProgramCode = "A"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "A' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "F"
                                            IAIPAirProgramCode = "F"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "F' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "I"
                                            IAIPAirProgramCode = "I"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "I' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "M"
                                            IAIPAirProgramCode = "M"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "M' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case "V"
                                            IAIPAirProgramCode = "V"
                                            SQL = "select " & _
                                            "distinct(strAIRSNumber) as subPartTest " & _
                                            "from " & DBNameSpace & ".APBSubPartData  " & _
                                            "where strsubpartkey = '0413" & AIRSNumber & "V' " & _
                                            "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                            "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                            "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                            "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                            "or strsubpart = '" & SubPart9 & "') "
                                        Case Else
                                            SQL = ""
                                            IAIPAirProgramCode = "NULL"
                                    End Select
                                    If SQL <> "" Then
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("subPartTest")) Then
                                                IAIPSubPart = "NULL"
                                            Else
                                                IAIPSubPart = dr.Item("subPartTest")
                                            End If
                                        End While
                                        dr.Close()
                                    End If

                                    If IAIPAirProgramCode = AirProgramCode Then
                                        IAIPAirProgramCode = ""
                                    End If
                                    If IAIPSubPart <> "NULL" Then
                                        IAIPSubPart = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, _
                                                        "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, IAIPAirProgramCode, "", "", IAIPSubPart, SubPart1, SubPart2, SubPart3, _
                                                        SubPart4, SubPart5, SubPart6, SubPart7, SubPart8, SubPart9)
                                End If
                            Case "131"
                                If chb131Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    Pollutant = Mid(DefaultText, 15, 9)
                                    FacilityClassification = Mid(DefaultText, 25, 2)
                                    ComplianceStatus = Mid(DefaultText, 24, 1)
                                    AttainmentStatus = Mid(DefaultText, 27, 1)
                                    SICCode = Mid(DefaultText, 35, 4)
                                    IAIPAirProgramCode = "NULL"
                                    IAIPPollutant = "NULL"
                                    IAIPComplianceStatus = "NULL"
                                    IAIPFacilityClassification = "NULL"
                                    IAIPAttainmentStatus = "NULL"
                                    IAIPSICCode = "NULL"

                                    Select Case AirProgramCode
                                        Case "0"
                                            IAIPAirProgramCode = "0"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "0' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "1"
                                            IAIPAirProgramCode = "1"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "1' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "3"
                                            IAIPAirProgramCode = "3"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "3' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "4"
                                            IAIPAirProgramCode = "4"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "4' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "6"
                                            IAIPAirProgramCode = "6"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "6' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "7"
                                            IAIPAirProgramCode = "7"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "7' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "8"
                                            IAIPAirProgramCode = "8"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "8' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "9"
                                            IAIPAirProgramCode = "9"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "9' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "A"
                                            IAIPAirProgramCode = "A"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "A' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "F"
                                            IAIPAirProgramCode = "F"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "F' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "I"
                                            IAIPAirProgramCode = "I"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "I' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "M"
                                            IAIPAirProgramCode = "M"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "M' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case "V"
                                            IAIPAirProgramCode = "V"
                                            SQL = "Select " & _
                                            "strPollutantKey, strComplianceStatus " & _
                                            "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                            "where strAirPollutantKey = '0413" & AIRSNumber & "V' " & _
                                            "and strPollutantKey = '" & Pollutant & "' "
                                        Case Else
                                            SQL = ""
                                            IAIPAirProgramCode = "NULL"
                                    End Select

                                    If SQL <> "" Then
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strPollutantKey")) Then
                                                IAIPPollutant = "NULL"
                                            Else
                                                IAIPPollutant = dr.Item("strPollutantKey")
                                            End If
                                            If IsDBNull(dr.Item("strComplianceStatus")) Then
                                                IAIPComplianceStatus = "NULL"
                                            Else
                                                IAIPComplianceStatus = dr.Item("strComplianceStatus")
                                            End If
                                        End While
                                        dr.Close()

                                        SQL = "Select " & _
                                        "strClass, strAttainmentStatus, " & _
                                        "strSICCode " & _
                                        "from " & DBNameSpace & ".APBHeaderData " & _
                                        "where strAIRSNumber = '0413" & AIRSNumber & "' "

                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strClass")) Then
                                                IAIPFacilityClassification = "NULL"
                                            Else
                                                IAIPFacilityClassification = dr.Item("strClass")
                                            End If
                                            If IsDBNull(dr.Item("strAttainmentStatus")) Then
                                                IAIPAttainmentStatus = "NULL"
                                            Else
                                                IAIPAttainmentStatus = dr.Item("strAttainmentStatus")
                                            End If
                                            If IsDBNull(dr.Item("strSICCode")) Then
                                                IAIPSICCode = "NULL"
                                            Else
                                                IAIPSICCode = dr.Item("strSICCode")
                                            End If
                                        End While
                                        dr.Close()
                                    End If

                                    If IAIPAirProgramCode = AirProgramCode Then
                                        IAIPAirProgramCode = ""
                                    End If
                                    If IAIPPollutant = Pollutant Then
                                        IAIPPollutant = ""
                                    End If
                                    If IAIPFacilityClassification = FacilityClassification Then
                                        IAIPFacilityClassification = ""
                                    End If
                                    If Replace(IAIPFacilityClassification, " ", "") = Replace(FacilityClassification, " ", "") Then
                                        IAIPFacilityClassification = ""
                                    End If

                                    If IAIPComplianceStatus = ComplianceStatus Then
                                        IAIPComplianceStatus = ""
                                    End If
                                    If IAIPAttainmentStatus <> "0000" Then
                                        IAIPAttainmentStatus = "A"
                                    Else
                                        IAIPAttainmentStatus = "N"
                                    End If
                                    If IAIPAttainmentStatus = AttainmentStatus Then
                                        IAIPAttainmentStatus = ""
                                    End If
                                    If IAIPSICCode = SICCode Then
                                        IAIPSICCode = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, IAIPAirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", _
                                                              Pollutant, IAIPPollutant, FacilityClassification, IAIPFacilityClassification, _
                                                              ComplianceStatus, IAIPComplianceStatus, AttainmentStatus, IAIPAttainmentStatus, _
                                                              SICCode, IAIPSICCode)
                                End If
                            Case "141"
                                'Ignore
                            Case "151"
                                'Ignore
                            Case "161" 'Various Action Types
                                If chb161Card.Checked = True Then
                                    SQL = ""
                                    ActionNumber = Mid(DefaultText, 14, 3)
                                    AirProgramCode = Mid(DefaultText, 17, 6)
                                    ActionType = Mid(DefaultText, 23, 2)
                                    DateScheduled = Mid(DefaultText, 41, 6)
                                    DateAcheived = Mid(DefaultText, 47, 6)
                                    ResultCode = Mid(DefaultText, 53, 2)
                                    PenaltyAmount = Mid(DefaultText, 55, 7)
                                    Pollutant161 = Mid(DefaultText, 67, 5)
                                    IAIPActionNumber = "NULL"
                                    IAIPAirProgramCode = "NULL"
                                    IAIPDateScheduled = "NULL"
                                    IAIPDateAcheived = "NULL"
                                    IAIPResultCode = "NULL"
                                    IAIPPenaltyAmount = "NULL"
                                    IAIPPollutant161 = "NULL"

                                    Select Case ActionType
                                        Case "00"
                                            SQL = ""
                                        Case "33"
                                            SQL = ""
                                        Case "34"
                                            SQL = ""
                                        Case "35"
                                            SQL = ""
                                        Case "36"
                                            SQL = ""
                                        Case "FS"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datFCECompleted as DatCompleteDate, " & _
                                            "case " & _
                                            "when strFCEStatus = 'True' then '21' " & _
                                            "else '' " & _
                                            "end ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPFCERecords, " & DBNameSpace & ".SSCPFCEMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPFCE  " & _
                                            "where " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.StrFCENumber " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and strSiteInspection = 'True' " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "FF"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datFCECompleted as DatCompleteDate" & _
                                            "case " & _
                                            "when strFCEStatus = 'True' then '21' " & _
                                            "else '' " & _
                                            "end ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPFCERecords, " & DBNameSpace & ".SSCPFCEMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPFCE  " & _
                                            "where " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.StrFCENumber " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and strSiteInspection <> 'True' " & _
                                            "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "37"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData " & _
                                            "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "27"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData " & _
                                            "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "SR"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCompleteDate, " & _
                                            "case " & _
                                            "when strEnforcementNumber is Null then 'MC' " & _
                                            "when strEnforcementNumber is Not Null then 'MV' " & _
                                            "else 'MC' " & _
                                            "end ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcementItems " & _
                                            "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPEnforcementItems.strTrackingNumber (+) " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "CS"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'       ' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                            "" & DBNameSpace & ".APBHeaderData " & _
                                            "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber  = '" & ActionNumber & "' "
                                        Case "04"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datDayZero as datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "VZ"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datDayZero as datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "56"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datNOVSent as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "AW"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datNFALetterSent as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "57"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCOProposed as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "X1"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCOExecuted as datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "strCOPenaltyAmount as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "AS"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datCOResolved as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "Z4"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "" & DBNameSpace & ".SSCPEnforcementStipulated.datModifingDate as datCompleteDate, " & _
                                            "'01' as ResultCode, " & _
                                            "" & DBNameSpace & ".SSCPEnforcementStipulated.strStipulatedPenalty as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement, " & _
                                            "" & DBNameSpace & ".SSCPEnforcementStipulated " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementITems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementStipulated.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "60"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datAOExecuted as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "64"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datAOAppealed as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "XX"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datAOResolved as datCompleteDate, " & _
                                            "'  ' as ResultCode, " & _
                                            "'0000000' as PenaltyAmount, " & _
                                            "'  ' as Pollutant " & _
                                            "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                            "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                            "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                             & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                            "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "TR"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "case " & _
                                            "when strWitnessingEngineer = '0' then 'TR' " & _
                                            "else '23' " & _
                                            "end ActionType, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datTestDateEnd as datCompleteDate, " & _
                                            "case " & _
                                            "when strComplianceStatus = '01' then 'N/A' " & _
                                            "when strCompliancestatus = '02' then 'PP'  " & _
                                            "when strComplianceStatus = '03' then 'PP'  " & _
                                            "when strComplianceStatus = '04' then 'N/A' " & _
                                            "when strComplianceStatus = '05' then 'FF' " & _
                                            "else '01' " & _
                                            "end ResultCode, " & _
                                            "'       ' as PenaltyAmount, " & _
                                            "case  " & _
                                            "when strAFSCode = 'True' then strPollutantCode " & _
                                            "else '     ' " & _
                                            "end Pollutant  " & _
                                            "from " & DBNameSpace & ".AFSISMPRecords, " & DBNameSpace & ".ISMPMaster, " & _
                                            "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".APBHeaderData, " & _
                                            "" & DBNameSpace & ".LookUpPollutants " & _
                                            "where " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber = " & DBNameSpace & ".ISMPMaster.strReferenceNumber " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strAIRSnumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case "23"
                                            SQL = "select " & _
                                            "strAIRProgramCodes, " & _
                                            "strAFSActionNumber, " & _
                                            "case " & _
                                            "when strWitnessingEngineer = '0' then 'TR' " & _
                                            "else '23' " & _
                                            "end ActionType, " & _
                                            "'000000' as DateScheduled, " & _
                                            "datTestDateEnd as datCompleteDate, " & _
                                            "case " & _
                                            "when strComplianceStatus = '01' then 'N/A' " & _
                                            "when strCompliancestatus = '02' then 'PP'  " & _
                                            "when strComplianceStatus = '03' then 'PP'  " & _
                                            "when strComplianceStatus = '04' then 'N/A' " & _
                                            "when strComplianceStatus = '05' then 'FF' " & _
                                            "else '01' " & _
                                            "end ResultCode, " & _
                                            "'       ' as PenaltyAmount, " & _
                                            "case  " & _
                                            "when strAFSCode = 'True' then strPollutantCode " & _
                                            "else '     ' " & _
                                            "end Pollutant  " & _
                                            "from " & DBNameSpace & ".AFSISMPRecords, " & DBNameSpace & ".ISMPMaster, " & _
                                            "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".APBHeaderData, " & _
                                            "" & DBNameSpace & ".LookUpPollutants " & _
                                            "where " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber = " & DBNameSpace & ".ISMPMaster.strReferenceNumber " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                            "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode " & _
                                            "and " & DBNameSpace & ".ISMPMaster.strAIRSnumber = '0413" & AIRSNumber & "' " & _
                                            "and strAFSActionNumber = '" & ActionNumber & "' "
                                        Case Else
                                            SQL = ""
                                    End Select

                                    If SQL <> "" Then
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                                IAIPActionNumber = "NULL"
                                            Else
                                                IAIPActionNumber = dr.Item("strAFSActionNumber")
                                            End If
                                            If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                                                IAIPAirProgramCode = "NULL"
                                            Else
                                                IAIPAirProgramCode = dr.Item("strAIRProgramCodes")
                                            End If
                                            If IsDBNull(dr.Item("DateScheduled")) Then
                                                IAIPDateScheduled = "NULL"
                                            Else
                                                IAIPDateScheduled = dr.Item("DateScheduled")
                                            End If
                                            If IsDBNull(dr.Item("datCompleteDate")) Then
                                                IAIPDateAcheived = "NULL"
                                            Else
                                                IAIPDateAcheived = dr.Item("datCompleteDate")
                                            End If
                                            If IsDBNull(dr.Item("ResultCode")) Then
                                                IAIPResultCode = "NULL"
                                            Else
                                                IAIPResultCode = dr.Item("ResultCode")
                                            End If
                                            If IsDBNull(dr.Item("PenaltyAmount")) Then
                                                IAIPPenaltyAmount = "NULL"
                                            Else
                                                IAIPPenaltyAmount = dr.Item("PenaltyAmount")
                                            End If
                                            If IsDBNull(dr.Item("Pollutant")) Then
                                                IAIPPollutant161 = "NULL"
                                            Else
                                                IAIPPollutant161 = dr.Item("Pollutant")
                                            End If
                                        End While
                                        dr.Close()
                                    End If

                                    If IAIPActionNumber = ActionNumber Then
                                        IAIPActionNumber = ""
                                    End If
                                    If IAIPActionType = ActionType Then
                                        IAIPActionType = ""
                                    End If
                                    If IAIPDateScheduled = DateScheduled Then
                                        IAIPDateScheduled = ""
                                    End If
                                    If IAIPDateScheduled = "000000" Then
                                        IAIPDateScheduled = ""
                                    End If

                                    If IAIPDateAcheived.Length > 4 And IAIPDateAcheived.Contains("/") Then
                                        temp = Mid(IAIPDateAcheived, IAIPDateAcheived.IndexOf("/") + 2)
                                        temp = Mid(temp, 1, temp.ToString.IndexOf("/"))
                                        If temp.ToString.Length = 1 Then
                                            temp = "0" & temp
                                        End If
                                        temp2 = Mid(IAIPDateAcheived, 1, (IAIPDateAcheived.IndexOf("/")))
                                        If temp2.ToString.Length = 1 Then
                                            temp2 = "0" & temp2
                                        End If
                                        IAIPDateAcheived = Mid(IAIPDateAcheived, (IAIPDateAcheived.Length - 1), 2) & temp2 & temp
                                    End If
                                    If IAIPDateAcheived = DateAcheived Then
                                        IAIPDateAcheived = ""
                                    End If
                                    If IAIPDateAcheived = "000000" Then
                                        IAIPDateAcheived = ""
                                    End If
                                    If IAIPResultCode = ResultCode Then
                                        IAIPResultCode = ""
                                    End If
                                    If IAIPPenaltyAmount.Length < 7 And IAIPPenaltyAmount <> "NULL" Then
                                        Do Until IAIPPenaltyAmount.Length = 7
                                            IAIPPenaltyAmount = "0" & IAIPPenaltyAmount
                                        Loop
                                    End If
                                    If IAIPPenaltyAmount = PenaltyAmount Then
                                        IAIPPenaltyAmount = ""
                                    End If
                                    If IAIPPenaltyAmount = "0000000" Then
                                        IAIPPenaltyAmount = ""
                                    End If
                                    If Replace(IAIPPollutant161, " ", "") = Replace(Pollutant161, " ", "") Then
                                        IAIPPollutant161 = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, IAIPAirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        "", "", "", "", "", "", "", "", "", "", _
                                                        ActionNumber, IAIPActionNumber, ActionType, IAIPActionType, DateScheduled, IAIPDateScheduled, _
                                                        DateAcheived, IAIPDateAcheived, ResultCode, IAIPResultCode, PenaltyAmount, IAIPPenaltyAmount, _
                                                        Pollutant161, IAIPPollutant161)
                                End If
                            Case "163"
                                If chb163Card.Checked = True Then
                                    ActionNumber163 = Mid(DefaultText, 14, 3)
                                    KeyActionNumber = Mid(DefaultText, 17, 3)
                                    Pollutant163 = Mid(DefaultText, 43, 5)

                                    IAIPActionNumber163 = "NULL"
                                    IAIPKeyActionNumber = "NULL"
                                    IAIPPollutant163 = "NULL"

                                    SQL = "Select  " & _
                                    "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,    " & _
                                    "" & DBNameSpace & ".APBHeaderData.strAIRSNumber,    " & _
                                    "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber,    " & _
                                    "strAFSKeyActionNumber,  " & _
                                    "strPollutants,   " & _
                                    "" & DBNameSpace & ".AFSSSCPRecords.strAFSActionNumber as LinkingEvent  " & _
                                    "from  " & DBNameSpace & ".AFSSSCPEnforcementRecords,    " & _
                                    "" & DBNameSpace & ".SSCPEnforcementItems,  " & DBNameSpace & ".SSCPEnforcement,    " & _
                                    "" & DBNameSpace & ".APBHeaderData,  " & DBNameSpace & ".SSCPENforcementStipulated, " & _
                                    "" & DBNameSpace & ".SSCPItemMaster, " & DBNameSpace & ".AFSSSCPRecords    " & _
                                    "where " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber =  " _
                                             & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber    " & _
                                    "and  " & DBNameSpace & ".APBHeaderData.strAIRSNumber =  " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber    " & _
                                    "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber    " & _
                                    "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " _
                                            & DBNameSpace & ".SSCPENforcementStipulated.strEnforcementNumber (+)    " & _
                                    "and  " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber =  " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber (+)   " & _
                                    "and " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber = " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber (+) " & _
                                    "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                    "and " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = '" & ActionNumber163 & "' " & _
                                    "and strAFSKeyActionNumber = '" & KeyActionNumber & "' " 

                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If

                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                            IAIPActionNumber163 = "NULL"
                                        Else
                                            IAIPActionNumber163 = dr.Item("strAFSActionNumber")
                                        End If
                                        If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                                            IAIPKeyActionNumber = "NULL"
                                        Else
                                            IAIPKeyActionNumber = dr.Item("strAFSKeyActionNumber")
                                        End If
                                        If IsDBNull(dr.Item("LinkingEvent")) Then
                                            IAIPActionNumber163 = IAIPActionNumber163
                                        Else
                                            '  IAIPActionNumber163 = dr.Item("LinkingEvent")
                                        End If
                                        If IsDBNull(dr.Item("strPollutants")) Then
                                            IAIPPollutant163 = "NULL"
                                        Else
                                            IAIPPollutant163 = dr.Item("strPollutants")
                                        End If
                                    End While
                                    dr.Close()


                                    If IAIPActionNumber163 = ActionNumber163 Then
                                        IAIPActionNumber163 = ""
                                    End If
                                    If IAIPKeyActionNumber = KeyActionNumber Then
                                        IAIPKeyActionNumber = ""
                                    End If
                                    If IAIPPollutant163 <> "NULL" Then
                                        IAIPPollutant163 = Mid(IAIPPollutant163, 2, IAIPPollutant163.IndexOf(",") - 1)
                                    End If
                                    If Replace(IAIPPollutant163, " ", "") = Replace(Pollutant163, " ", "") Then
                                        IAIPPollutant163 = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        "", "", "", "", "", "", _
                                                        "", "", ActionNumber163, IAIPActionNumber163, KeyActionNumber, IAIPKeyActionNumber, Pollutant163, IAIPPollutant163)
                                End If

                            Case "164"
                                    If chb164Card.Checked = True Then
                                    ActionNumber164 = Mid(DefaultText, 14, 3)
                                    KeyActionNumber164 = Mid(DefaultText, 17, 3)
                                    ViolationType = Mid(DefaultText, 42, 3)
                                    IAIPActionNumber164 = "NULL"
                                    IAIPKeyActionNumber164 = "NULL"
                                    ViolationType = "NULL"

                                    SQL = "Select " & _
                                    "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,    " & _
                                    "" & DBNameSpace & ".APBHeaderData.strAIRSNumber,    " & _
                                    "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber,    " & _
                                    "strAFSKeyActionNumber, " & _
                                    "strHPV " & _
                                    "from  " & DBNameSpace & ".AFSSSCPEnforcementRecords,    " & _
                                    "" & DBNameSpace & ".SSCPEnforcementItems,  " & DBNameSpace & ".SSCPEnforcement,    " & _
                                    "" & DBNameSpace & ".APBHeaderData " & _
                                    "where " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber =  " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber    " & _
                                    "and  " & DBNameSpace & ".APBHeaderData.strAIRSNumber =  " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber    " & _
                                    "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber    " & _
                                    "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '041312100816' " & _
                                    "and " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = '007' " & _
                                    "and strAFSKeyActionNumber = '007' "

                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                            IAIPActionNumber164 = "NULL"
                                        Else
                                            IAIPActionNumber164 = dr.Item("strAFSActionNumber")
                                        End If
                                        If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                                            IAIPKeyActionNumber164 = "NULL"
                                        Else
                                            IAIPKeyActionNumber164 = dr.Item("strAFSKeyActionNumber")
                                        End If
                                        If IsDBNull(dr.Item("strHPV")) Then
                                            IAIPViolationType = "NULL"
                                        Else
                                            IAIPViolationType = dr.Item("strHPV")
                                        End If
                                    End While
                                    dr.Close()

                                    If IAIPActionNumber164 = ActionNumber164 Then
                                        IAIPActionNumber164 = ""
                                    End If
                                    If IAIPKeyActionNumber164 = KeyActionNumber164 Then
                                        IAIPKeyActionNumber164 = ""
                                    End If
                                    If IAIPViolationType = ViolationType Then
                                        IAIPViolationType = ""
                                    End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        AirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                        ActionNumber164, IAIPActionNumber164, KeyActionNumber164, IAIPKeyActionNumber164, _
                                                        ViolationType, IAIPViolationType)
                                End If
                            Case "171" 'Comments
                                    'Ignore
                            Case "181"
                                    If chb181Card.Checked = True Then
                                        CMSStatus = Mid(DefaultText, 14, 2)
                                        IAIPCMSStatus = "NULL"

                                        SQL = "Select " & _
                                        "strCMSMember " & _
                                        "from " & DBNameSpace & ".APBSupplamentalData " & _
                                        "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strCMSMember")) Then
                                                IAIPCMSStatus = "NULL"
                                            Else
                                                IAIPCMSStatus = dr.Item("strCMSMember")
                                            End If
                                        End While
                                        dr.Close()

                                        If IAIPCMSStatus = "A" Then
                                            IAIPCMSStatus = "A2"
                                        End If
                                        If IAIPCMSStatus = "S" Then
                                            IAIPCMSStatus = "S5"
                                        End If

                                        If IAIPCMSStatus = CMSStatus Then
                                            IAIPCMSStatus = ""
                                        End If

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", CMSStatus, IAIPCMSStatus)
                                    End If
                            Case Else

                        End Select

                    Loop Until reader.Peek = -1
                    reader.Close()

                Else
                    dgvAFSData.Columns.Add("AIRSNumber", "AIRS Number")
                    dgvAFSData.Columns.Add("TransactionType", "Transaction Type")
                    dgvAFSData.Columns.Add("FacilityName", "Facility Name")
                    dgvAFSData.Columns("FacilityName").Width = 200
                    dgvAFSData.Columns.Add("FacilityAddress", "Facility Address")
                    dgvAFSData.Columns("FacilityAddress").Width = 200
                    dgvAFSData.Columns.Add("City", "City")
                    dgvAFSData.Columns.Add("ZipCode", "Zip Code")
                    dgvAFSData.Columns.Add("SICCode", "SIC Code")
                    dgvAFSData.Columns.Add("ContactPerson", "Contact Person")
                    dgvAFSData.Columns.Add("ContactNumber", "Contact Number")
                    dgvAFSData.Columns.Add("FacilityDescription", "Facility Description")
                    dgvAFSData.Columns("FacilityDescription").Width = 200
                    dgvAFSData.Columns.Add("AirProgramCode", "Air Program Code")
                    dgvAFSData.Columns.Add("ProgramCodeStatus", "Program Code Status")
                    dgvAFSData.Columns.Add("SubPart1", "Sub Part 1")
                    dgvAFSData.Columns.Add("SubPart2", "Sub Part 2")
                    dgvAFSData.Columns.Add("SubPart3", "Sub Part 3")
                    dgvAFSData.Columns.Add("SubPart4", "Sub Part 4")
                    dgvAFSData.Columns.Add("SubPart5", "Sub Part 5")
                    dgvAFSData.Columns.Add("SubPart6", "Sub Part 6")
                    dgvAFSData.Columns.Add("SubPart7", "Sub Part 7")
                    dgvAFSData.Columns.Add("SubPart8", "Sub Part 8")
                    dgvAFSData.Columns.Add("SubPart9", "Sub Part 9")
                    dgvAFSData.Columns.Add("Pollutant", "Pollutant")
                    dgvAFSData.Columns.Add("Class", "Classification")
                    dgvAFSData.Columns.Add("ComplianceStauts", "Compliance Status")
                    dgvAFSData.Columns.Add("AttainmentStatus", "Attainment Status")
                    dgvAFSData.Columns.Add("SICCode2", "SIC Code")
                    dgvAFSData.Columns.Add("ActionNumber", "Action Number")
                    dgvAFSData.Columns.Add("ActionType", "Action Type")
                    dgvAFSData.Columns.Add("DateScheduled", "Date Scheduled")
                    dgvAFSData.Columns.Add("DateAcheived", "Date Acheived")
                    dgvAFSData.Columns.Add("ResultCode", "Result Code")
                    dgvAFSData.Columns.Add("PenaltyAmount", "Penalty Amount")
                    dgvAFSData.Columns.Add("KeyActionNumber", "Key Action Number")
                    dgvAFSData.Columns.Add("ActionNumber163", "Action Number")
                    dgvAFSData.Columns.Add("ViolationType", "Violation Type")
                    dgvAFSData.Columns.Add("CMSStatus", "CMS Status")

                    If chb101Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("FacilityName").Visible = False
                    End If
                    If chb102Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("FacilityAddress").Visible = False
                    End If
                    If chb103Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("City").Visible = False
                        dgvAFSData.Columns("ZipCode").Visible = False
                        dgvAFSData.Columns("SICCode").Visible = False
                    End If
                    If chb105Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ContactPerson").Visible = False
                        dgvAFSData.Columns("ContactNumber").Visible = False
                        dgvAFSData.Columns("FacilityDescription").Visible = False
                    End If
                    If chb121Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("AirProgramCode").Visible = False
                        dgvAFSData.Columns("ProgramCodeStatus").Visible = False
                    End If
                    If chb122Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("SubPart1").Visible = False
                        dgvAFSData.Columns("SubPart2").Visible = False
                        dgvAFSData.Columns("SubPart3").Visible = False
                        dgvAFSData.Columns("SubPart4").Visible = False
                        dgvAFSData.Columns("SubPart5").Visible = False
                        dgvAFSData.Columns("SubPart6").Visible = False
                        dgvAFSData.Columns("SubPart7").Visible = False
                        dgvAFSData.Columns("SubPart8").Visible = False
                        dgvAFSData.Columns("SubPart9").Visible = False
                    End If
                    If chb131Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("Pollutant").Visible = False
                        dgvAFSData.Columns("Class").Visible = False
                        dgvAFSData.Columns("ComplianceStauts").Visible = False
                        dgvAFSData.Columns("AttainmentStatus").Visible = False
                        dgvAFSData.Columns("SICCode2").Visible = False
                    End If
                    If chb161Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ActionNumber").Visible = False
                        dgvAFSData.Columns("ActionType").Visible = False
                        dgvAFSData.Columns("DateScheduled").Visible = False
                        dgvAFSData.Columns("DateAcheived").Visible = False
                        dgvAFSData.Columns("ResultCode").Visible = False
                        dgvAFSData.Columns("PenaltyAmount").Visible = False
                    End If
                    If chb163Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("KeyActionNumber").Visible = False
                        dgvAFSData.Columns("ActionNumber163").Visible = False
                    End If
                    If chb164Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("ViolationType").Visible = False
                    End If
                    If chb181Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("CMSStatus").Visible = False
                    End If

                    Dim reader As StreamReader = New StreamReader(txtAFSFile.Text)
                    Do
                        DefaultText = reader.ReadLine
                        AIRSNumber = Mid(DefaultText, 3, 8)
                        TransactionType = Mid(DefaultText, 11, 3)
                        Select Case TransactionType
                            Case "101"
                                If chb101Card.Checked = True Then
                                    FacilityName = Mid(DefaultText, 16, 40)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, FacilityName)
                                End If
                            Case "102"
                                If chb102Card.Checked = True Then
                                    FacilityAddress = Mid(DefaultText, 16, 30)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", FacilityAddress)
                                End If
                            Case "103"
                                If chb103Card.Checked = True Then
                                    FacilityCity = Mid(DefaultText, 16, 30)
                                    FacilityZipCode = Mid(DefaultText, 46, 9)
                                    FacilitySIC = Mid(DefaultText, 55, 4)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", FacilityCity, FacilityZipCode, FacilitySIC)
                                End If
                            Case "104"
                                'Ignore
                                'FacilityNAICS = Mid(DefaultText, 57, 6)
                            Case "105"
                                If chb105Card.Checked = True Then
                                    FacilityContactPerson = Mid(DefaultText, 14, 20)
                                    FacilityContactNumber = Mid(DefaultText, 34, 10)
                                    FacilityDescription = Mid(DefaultText, 44, 25)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", FacilityContactPerson, FacilityContactNumber, FacilityDescription)
                                End If
                            Case "106"
                                'Ignore
                            Case "107"
                                'Ignore
                            Case "121"
                                If chb121Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    ProgramStatus = Mid(DefaultText, 15, 1)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, ProgramStatus)
                                End If


                            Case "122"
                                If chb122Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    SubPart1 = Mid(DefaultText, 16, 5)
                                    SubPart2 = Mid(DefaultText, 21, 5)
                                    SubPart3 = Mid(DefaultText, 26, 5)
                                    SubPart4 = Mid(DefaultText, 31, 5)
                                    SubPart5 = Mid(DefaultText, 36, 5)
                                    SubPart6 = Mid(DefaultText, 41, 5)
                                    SubPart7 = Mid(DefaultText, 46, 5)
                                    SubPart8 = Mid(DefaultText, 51, 5)
                                    SubPart9 = Mid(DefaultText, 56, 5)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", SubPart1, SubPart2, SubPart3, _
                                                        SubPart4, SubPart5, SubPart6, SubPart7, SubPart8, SubPart9)
                                End If
                            Case "131"
                                If chb131Card.Checked = True Then
                                    AirProgramCode = Mid(DefaultText, 14, 1)
                                    Pollutant = Mid(DefaultText, 15, 9)
                                    FacilityClassification = Mid(DefaultText, 25, 2)
                                    ComplianceStatus = Mid(DefaultText, 24, 1)
                                    AttainmentStatus = Mid(DefaultText, 27, 1)
                                    SICCode = Mid(DefaultText, 35, 4)


                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", "", "", "", _
                                                         "", "", "", "", "", "", Pollutant, FacilityClassification, ComplianceStatus, AttainmentStatus, _
                                                         SICCode)
                                End If
                            Case "141"
                                'Ignore
                            Case "151"
                                'Ignore
                            Case "161" 'Various Action Types
                                If chb161Card.Checked = True Then
                                    ActionNumber = Mid(DefaultText, 14, 3)
                                    AirProgramCode = Mid(DefaultText, 17, 6)
                                    ActionType = Mid(DefaultText, 23, 2)
                                    DateScheduled = Mid(DefaultText, 41, 6)
                                    DateAcheived = Mid(DefaultText, 47, 6)
                                    ResultCode = Mid(DefaultText, 53, 2)
                                    PenaltyAmount = Mid(DefaultText, 55, 7)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", ActionNumber, ActionType, DateScheduled, DateAcheived, _
                                                         ResultCode, PenaltyAmount)
                                End If
                            Case "163"
                                If chb163Card.Checked = True Then
                                    ActionNumber = Mid(DefaultText, 14, 3)
                                    KeyActionNumber = Mid(DefaultText, 17, 3)
                                    Pollutant163 = Mid(DefaultText, 43, 5)

                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", KeyActionNumber, Pollutant163)
                                End If



                            Case "164"
                                If chb164Card.Checked = True Then
                                    ActionNumber = Mid(DefaultText, 14, 3)
                                    ViolationType = Mid(DefaultText, 42, 3)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", ViolationType)
                                End If
                            Case "171" 'Comments
                                'Ignore
                            Case "181"
                                If chb181Card.Checked = True Then
                                    CMSStatus = Mid(DefaultText, 14, 2)
                                    dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                         "", "", "", "", "", "", CMSStatus)
                                End If
                            Case Else

                        End Select

                    Loop Until reader.Peek = -1
                    reader.Close()
                End If
            Else

            End If
            txtAFSDataCount.Text = dgvAFSData.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub

    Sub LoadAFSData2()
        Try
            Dim DefaultText As String = ""
            Dim AIRSNumber As String = ""
            Dim IAIPAIRSNumber As String = ""
            Dim TransactionType As String = ""
            Dim FacilityName As String = ""
            Dim IAIPFacilityName As String = ""
            Dim FacilityAddress As String = ""
            Dim IAIPFacilityAddress As String = ""
            Dim FacilityCity As String = ""
            Dim IAIPFacilityCity As String = ""
            Dim FacilityZipCode As String = ""
            Dim IAIPFacilityZipCode As String = ""
            Dim FacilitySIC As String = ""
            Dim IAIPFacilitySIC As String = ""
            Dim FacilityNAICS As String = ""
            Dim IAIPFacilityNAICS As String = ""
            Dim FacilityContactPerson As String = ""
            Dim IAIPFacilityContactPerson As String = ""
            Dim FacilityContactNumber As String = ""
            Dim IAIPFacilityContactNumber As String = ""
            Dim FacilityDescription As String = ""
            Dim IAIPFacilityDescription As String = ""
            Dim AirProgramCode As String = ""
            Dim IAIPAirProgramCode As String = ""
            Dim ProgramStatus As String = ""
            Dim IAIPProgramStatus As String = ""
            Dim Pollutant As String = ""
            Dim IAIPPollutant As String = ""
            Dim SubPart1 As String = ""
            Dim IAIPSubPart As String = ""
            Dim SubPart2 As String = ""
            Dim SubPart3 As String = ""
            Dim SubPart4 As String = ""
            Dim SubPart5 As String = ""
            Dim SubPart6 As String = ""
            Dim SubPart7 As String = ""
            Dim SubPart8 As String = ""
            Dim SubPart9 As String = ""
            Dim FacilityClassification As String = ""
            Dim IAIPFacilityClassification As String = ""
            Dim ComplianceStatus As String = ""
            Dim IAIPComplianceStatus As String = ""
            Dim AttainmentStatus As String = ""
            Dim IAIPAttainmentStatus As String = ""
            Dim SICCode As String = ""
            Dim IAIPSICCode As String = ""
            Dim ActionNumber As String = ""
            Dim IAIPActionNumber As String = ""
            Dim ActionType As String = ""
            Dim IAIPActionType As String = ""
            Dim DateScheduled As String = ""
            Dim IAIPDateScheduled As String = ""
            Dim DateAcheived As String = ""
            Dim IAIPDateAcheived As String = ""
            Dim ResultCode As String = ""
            Dim IAIPResultCode As String = ""
            Dim PenaltyAmount As String = ""
            Dim IAIPPenaltyAmount As String = ""
            Dim Pollutant161 As String = ""
            Dim IAIPPollutant161 As String = ""
            Dim KeyActionNumber As String = ""
            Dim IAIPKeyActionNumber As String = ""
            Dim ActionNumber163 As String = ""
            Dim IAIPActionNumber163 As String = ""
            Dim ActionNumber164 As String = ""
            Dim IAIPActionNumber164 As String = ""
            Dim KeyActionNumber164 As String = ""
            Dim IAIPKeyActionNumber164 As String = ""
            Dim ViolationType As String = ""
            Dim IAIPViolationType As String = ""
            Dim Pollutant163 As String = ""
            Dim IAIPPollutant163 As String = ""
            Dim CMSStatus As String = ""
            Dim IAIPCMSStatus As String = ""
            Dim ErrorCompare As String = ""
            Dim intCounter As Integer = 0

            dgvAFSData.Columns.Clear()
            If File.Exists(txtAFSFile.Text) Then
                dgvAFSData.Rows.Clear()

                If rdbCompareFullIAIPdata.Checked = True Then
                    dgvAFSData.Columns.Add("TransactionType", "Transaction Type")
                    dgvAFSData.Columns.Add("Errors", "Error Status")
                    dgvAFSData.Columns.Add("AFSAIRSNumber", "AFS AIRS Number")
                    dgvAFSData.Columns.Add("AFSFacilityName", "AFS Facility Name")
                    dgvAFSData.Columns("AFSFacilityName").Width = 200
                    dgvAFSData.Columns.Add("IAIPAIRSNumber", "IAIP AIRS Number")
                    dgvAFSData.Columns.Add("IAIPFacilityName", "IAIP Facility Name")
                    dgvAFSData.Columns("IAIPFacilityName").Width = 200

                    If chb101Card.Checked = True Then
                    Else
                        dgvAFSData.Columns("AFSFacilityName").Visible = False
                        dgvAFSData.Columns("IAIPFacilityName").Visible = False
                    End If

                    Dim reader As StreamReader = New StreamReader(txtAFSFile.Text)
                    Do
                        DefaultText = reader.ReadLine
                        AIRSNumber = Mid(DefaultText, 3, 8)
                        TransactionType = Mid(DefaultText, 11, 3)
                        ErrorCompare = ""

                        Select TransactionType
                            Case "101"
                                If chb101Card.Checked = True Then
                                    FacilityName = Mid(DefaultText, 16, 40)
                                    IAIPAIRSNumber = AIRSNumber
                                    IAIPFacilityName = "NULL"

                                    SQL = "Select upper(strFacilityName) as strFacilityName " & _
                                    "from " & DBNameSpace & ".APBFacilityInformation " & _
                                    "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                    cmd = New OracleCommand(SQL, conn)
                                    If conn.State = ConnectionState.Closed Then
                                        conn.Open()
                                    End If
                                    dr = cmd.ExecuteReader
                                    While dr.Read
                                        If IsDBNull(dr.Item("strFacilityName")) Then
                                            IAIPFacilityName = "NULL"
                                        Else
                                            IAIPFacilityName = dr.Item("strFacilityName")
                                        End If
                                    End While
                                    dr.Close()


                                    If Replace(Mid(IAIPFacilityName, 1, 40), " ", "") = Replace(FacilityName, " ", "") Then
                                        IAIPFacilityName = ""
                                    Else
                                        If IAIPFacilityName = "NULL" Then
                                            IAIPAIRSNumber = "---"
                                            IAIPFacilityName = "---"
                                            ErrorCompare = "No IAIP Value"
                                        Else
                                            ErrorCompare = "Mismatch Name"
                                        End If
                                    End If

                                    dgvAFSData.Rows.Add(TransactionType, ErrorCompare, AIRSNumber, FacilityName, IAIPAIRSNumber, IAIPFacilityName)
                                End If

                        End Select

                    Loop Until reader.Peek = -1
                    reader.Close()

                    If chb101Card.Checked = True Then
                        SQL = "Select " & _
                        "substr(strAIRSNumber, 5) as strAIRSNumber, " & _
                        "upper(strFacilityName) as strFacilityName " & _
                        "from " & DBNameSpace & ".APBFacilityInformation " & _
                        "order by strAIRSNumber "

                        ds = New DataSet
                        da = New OracleDataAdapter(SQL, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        da.Fill(ds, "FacilityCheck")

                        For Each drDSRow In ds.Tables("FacilityCheck").Select()
                            If IsDBNull(drDSRow("strAIRSNumber")) Then
                                IAIPAIRSNumber = ""
                            Else
                                IAIPAIRSNumber = drDSRow("strAIRSNumber")
                            End If
                            If IsDBNull(drDSRow("strFacilityName")) Then
                                IAIPFacilityName = ""
                            Else
                                IAIPFacilityName = drDSRow("strFacilityName")
                            End If
                            intCounter = 0
                            temp = "False"
                            For Each row As DataGridViewRow In dgvAFSData.Rows
                                If dgvAFSData.Rows(intCounter).Cells(2).Value = IAIPAIRSNumber Then
                                    temp = "True"
                                Else

                                End If
                                intCounter += 1
                            Next row
                            If temp <> "True" Then
                                TransactionType = "101"
                                ErrorCompare = "No AFS value"
                                AIRSNumber = "---"
                                FacilityName = "---"
                                dgvAFSData.Rows.Add(TransactionType, ErrorCompare, AIRSNumber, FacilityName, IAIPAIRSNumber, IAIPFacilityName)
                            End If
                        Next
                    End If


                Else
                    If rdbCompareAFSDataOnly.Checked = True Then
                        dgvAFSData.Columns.Add("AIRSNumber", "AIRS Number")
                        dgvAFSData.Columns.Add("TransactionType", "Transaction Type")
                        dgvAFSData.Columns.Add("FacilityName", "AFS Facility Name")
                        dgvAFSData.Columns("FacilityName").Width = 200
                        dgvAFSData.Columns.Add("IAIPFacilityName", "IAIP Facility Name")
                        dgvAFSData.Columns("IAIPFacilityName").Width = 200
                        dgvAFSData.Columns.Add("FacilityAddress", "AFS Facility Address")
                        dgvAFSData.Columns("FacilityAddress").Width = 200
                        dgvAFSData.Columns.Add("IAIPFacilityAddress", "IAIP Facility Address")
                        dgvAFSData.Columns("IAIPFacilityAddress").Width = 200
                        dgvAFSData.Columns.Add("City", "City")
                        dgvAFSData.Columns.Add("IAIPCity", "IAIP City")
                        dgvAFSData.Columns.Add("ZipCode", "Zip Code")
                        dgvAFSData.Columns.Add("IAIPZipCode", "IAIP Zip Code")
                        dgvAFSData.Columns.Add("SICCode", "SIC Code")
                        dgvAFSData.Columns.Add("IAIPSICCode", "IAIP SIC Code")
                        dgvAFSData.Columns.Add("ContactPerson", "Contact Person")
                        dgvAFSData.Columns.Add("IAIPContactPerson", "IAIP Contact Person")
                        dgvAFSData.Columns.Add("ContactNumber", "Contact Number")
                        dgvAFSData.Columns.Add("IAIPContactNumber", "IAIP Contact Number")
                        dgvAFSData.Columns.Add("FacilityDescription", "Facility Description")
                        dgvAFSData.Columns("FacilityDescription").Width = 200
                        dgvAFSData.Columns.Add("IAIPFacilityDescription", "IAIP Facility Description")
                        dgvAFSData.Columns("IAIPFacilityDescription").Width = 200
                        dgvAFSData.Columns.Add("AirProgramCode", "Air Program Code")
                        dgvAFSData.Columns.Add("IAIPAirProgramCode", "IAIP Air Program Code")
                        dgvAFSData.Columns.Add("ProgramCodeStatus", "Program Code Status")
                        dgvAFSData.Columns.Add("IAIPProgramCodeStatus", "IAIP Program Code Status")
                        dgvAFSData.Columns.Add("IAIPSubPart", "IAIP Sub Part 1")
                        dgvAFSData.Columns.Add("SubPart1", "Sub Part 1")
                        dgvAFSData.Columns.Add("SubPart2", "Sub Part 2")
                        dgvAFSData.Columns.Add("SubPart3", "Sub Part 3")
                        dgvAFSData.Columns.Add("SubPart4", "Sub Part 4")
                        dgvAFSData.Columns.Add("SubPart5", "Sub Part 5")
                        dgvAFSData.Columns.Add("SubPart6", "Sub Part 6")
                        dgvAFSData.Columns.Add("SubPart7", "Sub Part 7")
                        dgvAFSData.Columns.Add("SubPart8", "Sub Part 8")
                        dgvAFSData.Columns.Add("SubPart9", "Sub Part 9")
                        dgvAFSData.Columns.Add("Pollutant", "Pollutant")
                        dgvAFSData.Columns.Add("IAIPPollutant", "IAIP Pollutant")
                        dgvAFSData.Columns.Add("Class", "Classification")
                        dgvAFSData.Columns.Add("IAIPClass", "IAIP Classification")
                        dgvAFSData.Columns.Add("ComplianceStauts", "Compliance Status")
                        dgvAFSData.Columns.Add("IAIPComplianceStauts", "IAIP Compliance Status")
                        dgvAFSData.Columns.Add("AttainmentStatus", "Attainment Status")
                        dgvAFSData.Columns.Add("IAIPAttainmentStatus", "IAIP Attainment Status")
                        dgvAFSData.Columns.Add("SICCode2", "SIC Code")
                        dgvAFSData.Columns.Add("IAIPSICCode2", "IAIP SIC Code")
                        dgvAFSData.Columns.Add("ActionNumber", "Action Number")
                        dgvAFSData.Columns.Add("IAIPActionNumber", "IAIP Action Number")
                        dgvAFSData.Columns.Add("ActionType", "Action Type")
                        dgvAFSData.Columns.Add("IAIPActionType", "IAIP Action Type")
                        dgvAFSData.Columns.Add("DateScheduled", "Date Scheduled")
                        dgvAFSData.Columns.Add("IAIPDateScheduled", "IAIP Date Scheduled")
                        dgvAFSData.Columns.Add("DateAcheived", "Date Acheived")
                        dgvAFSData.Columns.Add("IAIPDateAcheived", "IAIP Date Acheived")
                        dgvAFSData.Columns.Add("ResultCode", "Result Code")
                        dgvAFSData.Columns.Add("IAIPResultCode", "IAIP Result Code")
                        dgvAFSData.Columns.Add("PenaltyAmount", "Penalty Amount")
                        dgvAFSData.Columns.Add("IAIPPenaltyAmount", "IAIP Penalty Amount")
                        dgvAFSData.Columns.Add("Pollutant161", "Pollutant")
                        dgvAFSData.Columns.Add("IAIPPollutant161", "IAIP Pollutant")
                        dgvAFSData.Columns.Add("KeyActionNumber", "Key Action Number")
                        dgvAFSData.Columns.Add("IAIPKeyActionNumber", "IAIP Key Action Number")
                        dgvAFSData.Columns.Add("ActionNumber163", "Action Number")
                        dgvAFSData.Columns.Add("IAIPActionNumber163", "IAIP Action Number")
                        dgvAFSData.Columns.Add("Pollutant163", "Pollutant")
                        dgvAFSData.Columns.Add("IAIPPollutant163", "IAIP Pollutant")

                        dgvAFSData.Columns.Add("ActionNumber164", "Action Number")
                        dgvAFSData.Columns.Add("IAIPActionNumber164", "IAIP Action Number")
                        dgvAFSData.Columns.Add("KeyActionNumber164", "Key Action Number")
                        dgvAFSData.Columns.Add("IAIPKeyActionNumber164", "IAIP Key Action Number")
                        dgvAFSData.Columns.Add("ViolationType", "Violation Type")
                        dgvAFSData.Columns.Add("IAIPViolationType", "IAIP Violation Type")
                        dgvAFSData.Columns.Add("CMSStatus", "CMS Status")
                        dgvAFSData.Columns.Add("IAIPCMSStatus", "IAIP CMS Status")

                        If chb101Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("FacilityName").Visible = False
                            dgvAFSData.Columns("IAIPFacilityName").Visible = False
                        End If
                        If chb102Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("FacilityAddress").Visible = False
                            dgvAFSData.Columns("IAIPFacilityAddress").Visible = False
                        End If
                        If chb103Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("City").Visible = False
                            dgvAFSData.Columns("ZipCode").Visible = False
                            dgvAFSData.Columns("SICCode").Visible = False
                            dgvAFSData.Columns("IAIPCity").Visible = False
                            dgvAFSData.Columns("IAIPZipCode").Visible = False
                            dgvAFSData.Columns("IAIPSICCode").Visible = False
                        End If
                        If chb105Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ContactPerson").Visible = False
                            dgvAFSData.Columns("ContactNumber").Visible = False
                            dgvAFSData.Columns("FacilityDescription").Visible = False
                            dgvAFSData.Columns("IAIPContactPerson").Visible = False
                            dgvAFSData.Columns("IAIPContactNumber").Visible = False
                            dgvAFSData.Columns("IAIPFacilityDescription").Visible = False
                        End If
                        If chb121Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("AirProgramCode").Visible = False
                            dgvAFSData.Columns("ProgramCodeStatus").Visible = False
                            dgvAFSData.Columns("IAIPAirProgramCode").Visible = False
                            dgvAFSData.Columns("IAIPProgramCodeStatus").Visible = False
                        End If
                        If chb122Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("SubPart1").Visible = False
                            dgvAFSData.Columns("SubPart2").Visible = False
                            dgvAFSData.Columns("SubPart3").Visible = False
                            dgvAFSData.Columns("SubPart4").Visible = False
                            dgvAFSData.Columns("SubPart5").Visible = False
                            dgvAFSData.Columns("SubPart6").Visible = False
                            dgvAFSData.Columns("SubPart7").Visible = False
                            dgvAFSData.Columns("SubPart8").Visible = False
                            dgvAFSData.Columns("SubPart9").Visible = False
                            dgvAFSData.Columns("IAIPSubPart").Visible = False
                        End If
                        If chb131Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("Pollutant").Visible = False
                            dgvAFSData.Columns("Class").Visible = False
                            dgvAFSData.Columns("ComplianceStauts").Visible = False
                            dgvAFSData.Columns("AttainmentStatus").Visible = False
                            dgvAFSData.Columns("SICCode2").Visible = False
                            dgvAFSData.Columns("IAIPPollutant").Visible = False
                            dgvAFSData.Columns("IAIPClass").Visible = False
                            dgvAFSData.Columns("IAIPComplianceStauts").Visible = False
                            dgvAFSData.Columns("IAIPAttainmentStatus").Visible = False
                            dgvAFSData.Columns("IAIPSICCode2").Visible = False
                        End If
                        If chb161Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ActionNumber").Visible = False
                            dgvAFSData.Columns("ActionType").Visible = False
                            dgvAFSData.Columns("DateScheduled").Visible = False
                            dgvAFSData.Columns("DateAcheived").Visible = False
                            dgvAFSData.Columns("ResultCode").Visible = False
                            dgvAFSData.Columns("PenaltyAmount").Visible = False
                            dgvAFSData.Columns("Pollutant161").Visible = False
                            dgvAFSData.Columns("IAIPActionNumber").Visible = False
                            dgvAFSData.Columns("IAIPActionType").Visible = False
                            dgvAFSData.Columns("IAIPDateScheduled").Visible = False
                            dgvAFSData.Columns("IAIPDateAcheived").Visible = False
                            dgvAFSData.Columns("IAIPResultCode").Visible = False
                            dgvAFSData.Columns("IAIPPenaltyAmount").Visible = False
                            dgvAFSData.Columns("IAIPPollutant161").Visible = False
                        End If
                        If chb163Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("KeyActionNumber").Visible = False
                            dgvAFSData.Columns("IAIPKeyActionNumber").Visible = False
                            dgvAFSData.Columns("ActionNumber163").Visible = False
                            dgvAFSData.Columns("IAIPActionNumber163").Visible = False
                            dgvAFSData.Columns("Pollutant163").Visible = False
                            dgvAFSData.Columns("IAIPPollutant163").Visible = False
                        End If
                        If chb164Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ActionNumber164").Visible = False
                            dgvAFSData.Columns("IAIPActionNumber164").Visible = False
                            dgvAFSData.Columns("KeyActionNumber164").Visible = False
                            dgvAFSData.Columns("IAIPKeyActionNumber164").Visible = False
                            dgvAFSData.Columns("ViolationType").Visible = False
                            dgvAFSData.Columns("IAIPViolationType").Visible = False
                        End If
                        If chb181Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("CMSStatus").Visible = False
                            dgvAFSData.Columns("IAIPCMSStatus").Visible = False
                        End If

                        Dim reader As StreamReader = New StreamReader(txtAFSFile.Text)
                        Do
                            DefaultText = reader.ReadLine
                            AIRSNumber = Mid(DefaultText, 3, 8)
                            TransactionType = Mid(DefaultText, 11, 3)
                            Select Case TransactionType
                                Case "101"
                                    If chb101Card.Checked = True Then
                                        FacilityName = Mid(DefaultText, 16, 40)
                                        IAIPFacilityName = "NULL"

                                        SQL = "Select upper(strFacilityName) as strFacilityName " & _
                                        "from " & DBNameSpace & ".APBFacilityInformation " & _
                                        "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strFacilityName")) Then
                                                IAIPFacilityName = "NULL"
                                            Else
                                                IAIPFacilityName = dr.Item("strFacilityName")
                                            End If
                                        End While
                                        dr.Close()
                                        If Replace(Mid(IAIPFacilityName, 1, 40), " ", "") = Replace(FacilityName, " ", "") Then
                                            IAIPFacilityName = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, FacilityName, IAIPFacilityName)
                                    End If
                                Case "102"
                                    If chb102Card.Checked = True Then
                                        FacilityAddress = Mid(DefaultText, 16, 30)
                                        IAIPFacilityAddress = "NULL"

                                        SQL = "Select upper(strFacilityStreet1) as strFacilityStreet1 " & _
                                        "from " & DBNameSpace & ".APBFacilityInformation " & _
                                        "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strFacilityStreet1")) Then
                                                IAIPFacilityAddress = "NULL"
                                            Else
                                                IAIPFacilityAddress = dr.Item("strFacilityStreet1")
                                            End If
                                        End While
                                        dr.Close()
                                        If Mid(IAIPFacilityAddress, 1, 30) = FacilityAddress Then
                                            IAIPFacilityAddress = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", FacilityAddress, IAIPFacilityAddress)
                                    End If
                                Case "103"
                                    If chb103Card.Checked = True Then
                                        FacilityCity = Mid(DefaultText, 16, 30)
                                        FacilityZipCode = Mid(DefaultText, 46, 9)
                                        FacilitySIC = Mid(DefaultText, 55, 4)
                                        IAIPFacilityCity = "NULL"
                                        IAIPFacilityZipCode = "NULL"
                                        IAIPFacilitySIC = "NULL"

                                        SQL = "Select " & _
                                        "Upper(strFacilityCity) as strFacilityCity, " & _
                                        "Upper(strFacilityZipCode) as strFacilityZipCode, " & _
                                        "upper(strSICCode) as strSICCode " & _
                                        "from " & DBNameSpace & ".APBFacilityInformation, " & DBNameSpace & ".APBHeaderData " & _
                                        "where " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                        "and " & DBNameSpace & ".APBFacilityInformation.strAIRSNumber = '0413" & AIRSNumber & "' "
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strFacilityCity")) Then
                                                IAIPFacilityCity = "NULL"
                                            Else
                                                IAIPFacilityCity = dr.Item("strFacilityCity")
                                            End If
                                            If IsDBNull(dr.Item("strFacilityZipCode")) Then
                                                IAIPFacilityZipCode = "NULL"
                                            Else
                                                IAIPFacilityZipCode = dr.Item("strFacilityZipCode")
                                            End If
                                            If IsDBNull(dr.Item("strSICCode")) Then
                                                IAIPFacilitySIC = "NULL"
                                            Else
                                                IAIPFacilitySIC = dr.Item("strSICCode")
                                            End If
                                        End While
                                        dr.Close()
                                        If Mid(IAIPFacilityCity, 1, 30) = FacilityCity Then
                                            IAIPFacilityCity = ""
                                        End If
                                        If Replace(IAIPFacilityCity, " ", "") = Replace(FacilityCity, " ", "") Then
                                            IAIPFacilityCity = ""
                                        End If
                                        If Mid(IAIPFacilityZipCode, 1, 5) = FacilityZipCode Then
                                            IAIPFacilityZipCode = ""
                                        End If
                                        If Replace(IAIPFacilityZipCode, " ", "") = Replace(FacilityZipCode, " ", "") Then
                                            IAIPFacilityZipCode = ""
                                        End If
                                        If Mid(IAIPFacilitySIC, 1, 4) = FacilitySIC Then
                                            IAIPFacilitySIC = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", FacilityCity, IAIPFacilityCity, _
                                                            FacilityZipCode, IAIPFacilityZipCode, FacilitySIC, IAIPFacilitySIC)
                                    End If
                                Case "104"
                                    'Ignore
                                    'FacilityNAICS = Mid(DefaultText, 57, 6)
                                Case "105"
                                    If chb105Card.Checked = True Then
                                        FacilityContactPerson = Mid(DefaultText, 14, 20)
                                        FacilityContactNumber = Mid(DefaultText, 34, 10)
                                        FacilityDescription = Mid(DefaultText, 44, 25)
                                        IAIPFacilityContactPerson = "NULL"
                                        IAIPFacilityContactNumber = "NULL"
                                        IAIPFacilityDescription = "NULL"

                                        SQL = "select " & _
                                        "upper(strContactFirstName||' '||strContactLastName) as strContactName,  " & _
                                        "strContactPhoneNumber1,  " & _
                                        "upper(strPlantDescription) as strPlantDescription  " & _
                                        "from " & DBNameSpace & ".APBContactInformation, " & DBNameSpace & ".APBHeaderData  " & _
                                        "where " & DBNameSpace & ".apbcontactinformation.strAIRSNumber = " & DBNameSpace & ".apbheaderdata.strairsnumber  " & _
                                        "and " & DBNameSpace & ".APBHeaderData.strairsnumber = '0413" & AIRSNumber & "'  " & _
                                        "and strkey = '30'"

                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strContactName")) Then
                                                IAIPFacilityContactPerson = "NULL"
                                            Else
                                                IAIPFacilityContactPerson = Mid(dr.Item("strContactName"), 1, 20)
                                            End If
                                            If IsDBNull(dr.Item("strContactPhoneNumber1")) Then
                                                IAIPFacilityContactNumber = "NULL"
                                            Else
                                                IAIPFacilityContactNumber = Mid(dr.Item("strContactPhoneNumber1"), 1, 10)
                                            End If
                                            If IsDBNull(dr.Item("strPlantDescription")) Then
                                                IAIPFacilityDescription = "NULL"
                                            Else
                                                IAIPFacilityDescription = Mid(dr.Item("strPlantDescription"), 1, 25)
                                            End If
                                        End While
                                        dr.Close()
                                        If Mid(IAIPFacilityContactPerson, 1, 30) = FacilityContactPerson Then
                                            IAIPFacilityContactPerson = ""
                                        End If
                                        If Replace(IAIPFacilityContactPerson, " ", "") = Replace(FacilityContactPerson, " ", "") Then
                                            IAIPFacilityContactPerson = ""
                                        End If
                                        If Mid(IAIPFacilityContactNumber, 1, 30) = FacilityContactNumber Then
                                            IAIPFacilityContactNumber = ""
                                        End If
                                        If Replace(IAIPFacilityContactNumber, " ", "") = Replace(FacilityContactNumber, " ", "") Then
                                            IAIPFacilityContactNumber = ""
                                        End If
                                        If Mid(IAIPFacilityDescription, 1, 30) = FacilityDescription Then
                                            IAIPFacilityDescription = ""
                                        End If
                                        If Replace(IAIPFacilityDescription, " ", "") = Replace(FacilityDescription, " ", "") Then
                                            IAIPFacilityDescription = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", _
                                                            FacilityContactPerson, IAIPFacilityContactPerson, FacilityContactNumber, _
                                                            IAIPFacilityContactNumber, FacilityDescription, IAIPFacilityDescription)
                                    End If
                                Case "106"
                                    'Ignore
                                Case "107"
                                    'Ignore
                                Case "121"
                                    If chb121Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        ProgramStatus = Mid(DefaultText, 15, 1)
                                        IAIPAirProgramCode = "NULL"
                                        IAIPProgramStatus = "NULL"

                                        Select Case AirProgramCode
                                            Case "0"
                                                IAIPAirProgramCode = "0"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 1, 1) = '1' "
                                            Case "1"
                                                IAIPAirProgramCode = "1"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 2, 1) = '1' "
                                            Case "3"
                                                IAIPAirProgramCode = "3"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 3, 1) = '1' "
                                            Case "4"
                                                IAIPAirProgramCode = "4"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 4, 1) = '1' "
                                            Case "6"
                                                IAIPAirProgramCode = "6"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 5, 1) = '1' "
                                            Case "7"
                                                IAIPAirProgramCode = "7"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 6, 1) = '1' "
                                            Case "8"
                                                IAIPAirProgramCode = "8"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 7, 1) = '1' "
                                            Case "9"
                                                IAIPAirProgramCode = "9"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 8, 1) = '1' "
                                            Case "A"
                                                IAIPAirProgramCode = "A"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 9, 1) = '1' "
                                            Case "F"
                                                IAIPAirProgramCode = "F"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 10, 1) = '1' "
                                            Case "I"
                                                IAIPAirProgramCode = "I"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 11, 1) = '1' "
                                            Case "M"
                                                IAIPAirProgramCode = "M"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 12, 1) = '1' "
                                            Case "V"
                                                IAIPAirProgramCode = "V"
                                                SQL = "select " & _
                                                "strOperationalStatus  " & _
                                                "from " & DBNameSpace & ".APBHeaderData  " & _
                                                "where strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and substr(strAirProgramCodes, 13, 1) = '1' "
                                            Case Else
                                                SQL = ""
                                                IAIPAirProgramCode = "NULL"
                                                IAIPProgramStatus = "NULL"
                                        End Select
                                        If SQL <> "" Then
                                            cmd = New OracleCommand(SQL, conn)
                                            dr = cmd.ExecuteReader
                                            While dr.Read
                                                If IsDBNull(dr.Item("strOperationalStatus")) Then
                                                    IAIPProgramStatus = "NULL"
                                                Else
                                                    IAIPProgramStatus = dr.Item("strOperationalStatus")
                                                End If
                                            End While
                                            dr.Close()
                                        End If

                                        If IAIPAirProgramCode = AirProgramCode Then
                                            IAIPAirProgramCode = ""
                                        End If
                                        If IAIPProgramStatus = ProgramStatus Then
                                            IAIPProgramStatus = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, IAIPAirProgramCode, ProgramStatus, IAIPProgramStatus)
                                    End If
                                Case "122"
                                    If chb122Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        SubPart1 = Replace(Mid(DefaultText, 16, 5), " ", "")
                                        SubPart2 = Replace(Mid(DefaultText, 21, 5), " ", "")
                                        SubPart3 = Replace(Mid(DefaultText, 26, 5), " ", "")
                                        SubPart4 = Replace(Mid(DefaultText, 31, 5), " ", "")
                                        SubPart5 = Replace(Mid(DefaultText, 36, 5), " ", "")
                                        SubPart6 = Replace(Mid(DefaultText, 41, 5), " ", "")
                                        SubPart7 = Replace(Mid(DefaultText, 46, 5), " ", "")
                                        SubPart8 = Replace(Mid(DefaultText, 51, 5), " ", "")
                                        SubPart9 = Replace(Mid(DefaultText, 56, 5), " ", "")
                                        IAIPAirProgramCode = "NULL"
                                        IAIPSubPart = "NULL"

                                        Select Case AirProgramCode
                                            Case "0"
                                                IAIPAirProgramCode = "0"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "0' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "1"
                                                IAIPAirProgramCode = "1"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "1' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "3"
                                                IAIPAirProgramCode = "3"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "3' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "4"
                                                IAIPAirProgramCode = "4"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "4' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "6"
                                                IAIPAirProgramCode = "6"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "6' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "7"
                                                IAIPAirProgramCode = "7"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "7' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "8"
                                                IAIPAirProgramCode = "8"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "8' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "9"
                                                IAIPAirProgramCode = "9"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "9' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "A"
                                                IAIPAirProgramCode = "A"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "A' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "F"
                                                IAIPAirProgramCode = "F"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "F' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "I"
                                                IAIPAirProgramCode = "I"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "I' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "M"
                                                IAIPAirProgramCode = "M"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "M' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case "V"
                                                IAIPAirProgramCode = "V"
                                                SQL = "select " & _
                                                "distinct(strAIRSNumber) as subPartTest " & _
                                                "from " & DBNameSpace & ".APBSubPartData  " & _
                                                "where strsubpartkey = '0413" & AIRSNumber & "V' " & _
                                                "and (strSubPart = '" & SubPart1 & "' or strsubpart = '" & SubPart2 & "' " & _
                                                "or strsubpart = '" & SubPart3 & "' or strsubpart = '" & SubPart4 & "' " & _
                                                "or strsubpart = '" & SubPart5 & "' or strsubpart = '" & SubPart6 & "' " & _
                                                "or strsubpart = '" & SubPart7 & "' or strsubpart = '" & SubPart8 & "' " & _
                                                "or strsubpart = '" & SubPart9 & "') "
                                            Case Else
                                                SQL = ""
                                                IAIPAirProgramCode = "NULL"
                                        End Select
                                        If SQL <> "" Then
                                            cmd = New OracleCommand(SQL, conn)
                                            If conn.State = ConnectionState.Closed Then
                                                conn.Open()
                                            End If
                                            dr = cmd.ExecuteReader
                                            While dr.Read
                                                If IsDBNull(dr.Item("subPartTest")) Then
                                                    IAIPSubPart = "NULL"
                                                Else
                                                    IAIPSubPart = dr.Item("subPartTest")
                                                End If
                                            End While
                                            dr.Close()
                                        End If

                                        If IAIPAirProgramCode = AirProgramCode Then
                                            IAIPAirProgramCode = ""
                                        End If
                                        If IAIPSubPart <> "NULL" Then
                                            IAIPSubPart = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, _
                                                            "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, IAIPAirProgramCode, "", "", IAIPSubPart, SubPart1, SubPart2, SubPart3, _
                                                            SubPart4, SubPart5, SubPart6, SubPart7, SubPart8, SubPart9)
                                    End If
                                Case "131"
                                    If chb131Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        Pollutant = Mid(DefaultText, 15, 9)
                                        FacilityClassification = Mid(DefaultText, 25, 2)
                                        ComplianceStatus = Mid(DefaultText, 24, 1)
                                        AttainmentStatus = Mid(DefaultText, 27, 1)
                                        SICCode = Mid(DefaultText, 35, 4)
                                        IAIPAirProgramCode = "NULL"
                                        IAIPPollutant = "NULL"
                                        IAIPComplianceStatus = "NULL"
                                        IAIPFacilityClassification = "NULL"
                                        IAIPAttainmentStatus = "NULL"
                                        IAIPSICCode = "NULL"

                                        Select Case AirProgramCode
                                            Case "0"
                                                IAIPAirProgramCode = "0"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "0' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "1"
                                                IAIPAirProgramCode = "1"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "1' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "3"
                                                IAIPAirProgramCode = "3"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "3' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "4"
                                                IAIPAirProgramCode = "4"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "4' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "6"
                                                IAIPAirProgramCode = "6"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "6' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "7"
                                                IAIPAirProgramCode = "7"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "7' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "8"
                                                IAIPAirProgramCode = "8"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "8' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "9"
                                                IAIPAirProgramCode = "9"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "9' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "A"
                                                IAIPAirProgramCode = "A"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "A' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "F"
                                                IAIPAirProgramCode = "F"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "F' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "I"
                                                IAIPAirProgramCode = "I"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "I' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "M"
                                                IAIPAirProgramCode = "M"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "M' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case "V"
                                                IAIPAirProgramCode = "V"
                                                SQL = "Select " & _
                                                "strPollutantKey, strComplianceStatus " & _
                                                "from " & DBNameSpace & ".APBAirProgramPollutants " & _
                                                "where strAirPollutantKey = '0413" & AIRSNumber & "V' " & _
                                                "and strPollutantKey = '" & Pollutant & "' "
                                            Case Else
                                                SQL = ""
                                                IAIPAirProgramCode = "NULL"
                                        End Select

                                        If SQL <> "" Then
                                            cmd = New OracleCommand(SQL, conn)
                                            If conn.State = ConnectionState.Closed Then
                                                conn.Open()
                                            End If
                                            dr = cmd.ExecuteReader
                                            While dr.Read
                                                If IsDBNull(dr.Item("strPollutantKey")) Then
                                                    IAIPPollutant = "NULL"
                                                Else
                                                    IAIPPollutant = dr.Item("strPollutantKey")
                                                End If
                                                If IsDBNull(dr.Item("strComplianceStatus")) Then
                                                    IAIPComplianceStatus = "NULL"
                                                Else
                                                    IAIPComplianceStatus = dr.Item("strComplianceStatus")
                                                End If
                                            End While
                                            dr.Close()

                                            SQL = "Select " & _
                                            "strClass, strAttainmentStatus, " & _
                                            "strSICCode " & _
                                            "from " & DBNameSpace & ".APBHeaderData " & _
                                            "where strAIRSNumber = '0413" & AIRSNumber & "' "

                                            cmd = New OracleCommand(SQL, conn)
                                            If conn.State = ConnectionState.Closed Then
                                                conn.Open()
                                            End If
                                            dr = cmd.ExecuteReader
                                            While dr.Read
                                                If IsDBNull(dr.Item("strClass")) Then
                                                    IAIPFacilityClassification = "NULL"
                                                Else
                                                    IAIPFacilityClassification = dr.Item("strClass")
                                                End If
                                                If IsDBNull(dr.Item("strAttainmentStatus")) Then
                                                    IAIPAttainmentStatus = "NULL"
                                                Else
                                                    IAIPAttainmentStatus = dr.Item("strAttainmentStatus")
                                                End If
                                                If IsDBNull(dr.Item("strSICCode")) Then
                                                    IAIPSICCode = "NULL"
                                                Else
                                                    IAIPSICCode = dr.Item("strSICCode")
                                                End If
                                            End While
                                            dr.Close()
                                        End If

                                        If IAIPAirProgramCode = AirProgramCode Then
                                            IAIPAirProgramCode = ""
                                        End If
                                        If IAIPPollutant = Pollutant Then
                                            IAIPPollutant = ""
                                        End If
                                        If IAIPFacilityClassification = FacilityClassification Then
                                            IAIPFacilityClassification = ""
                                        End If
                                        If Replace(IAIPFacilityClassification, " ", "") = Replace(FacilityClassification, " ", "") Then
                                            IAIPFacilityClassification = ""
                                        End If

                                        If IAIPComplianceStatus = ComplianceStatus Then
                                            IAIPComplianceStatus = ""
                                        End If
                                        If IAIPAttainmentStatus <> "0000" Then
                                            IAIPAttainmentStatus = "A"
                                        Else
                                            IAIPAttainmentStatus = "N"
                                        End If
                                        If IAIPAttainmentStatus = AttainmentStatus Then
                                            IAIPAttainmentStatus = ""
                                        End If
                                        If IAIPSICCode = SICCode Then
                                            IAIPSICCode = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, IAIPAirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", _
                                                                  Pollutant, IAIPPollutant, FacilityClassification, IAIPFacilityClassification, _
                                                                  ComplianceStatus, IAIPComplianceStatus, AttainmentStatus, IAIPAttainmentStatus, _
                                                                  SICCode, IAIPSICCode)
                                    End If
                                Case "141"
                                    'Ignore
                                Case "151"
                                    'Ignore
                                Case "161" 'Various Action Types
                                    If chb161Card.Checked = True Then
                                        SQL = ""
                                        ActionNumber = Mid(DefaultText, 14, 3)
                                        AirProgramCode = Mid(DefaultText, 17, 6)
                                        ActionType = Mid(DefaultText, 23, 2)
                                        DateScheduled = Mid(DefaultText, 41, 6)
                                        DateAcheived = Mid(DefaultText, 47, 6)
                                        ResultCode = Mid(DefaultText, 53, 2)
                                        PenaltyAmount = Mid(DefaultText, 55, 7)
                                        Pollutant161 = Mid(DefaultText, 67, 5)
                                        IAIPActionNumber = "NULL"
                                        IAIPAirProgramCode = "NULL"
                                        IAIPDateScheduled = "NULL"
                                        IAIPDateAcheived = "NULL"
                                        IAIPResultCode = "NULL"
                                        IAIPPenaltyAmount = "NULL"
                                        IAIPPollutant161 = "NULL"

                                        Select Case ActionType
                                            Case "00"
                                                SQL = ""
                                            Case "33"
                                                SQL = ""
                                            Case "34"
                                                SQL = ""
                                            Case "35"
                                                SQL = ""
                                            Case "36"
                                                SQL = ""
                                            Case "FS"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datFCECompleted as DatCompleteDate, " & _
                                                "case " & _
                                                "when strFCEStatus = 'True' then '21' " & _
                                                "else '' " & _
                                                "end ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPFCERecords, " & DBNameSpace & ".SSCPFCEMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPFCE  " & _
                                                "where " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.StrFCENumber " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and strSiteInspection = 'True' " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "FF"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datFCECompleted as DatCompleteDate" & _
                                                "case " & _
                                                "when strFCEStatus = 'True' then '21' " & _
                                                "else '' " & _
                                                "end ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPFCERecords, " & DBNameSpace & ".SSCPFCEMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPFCE  " & _
                                                "where " & DBNameSpace & ".AFSSSCPFCERecords.strFCENumber = " & DBNameSpace & ".SSCPFCEMaster.StrFCENumber " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strFCENumber = " & DBNameSpace & ".SSCPFCE.strFCENumber " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and strSiteInspection <> 'True' " & _
                                                "and " & DBNameSpace & ".SSCPFCEMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "37"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData " & _
                                                "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "27"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData " & _
                                                "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "SR"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCompleteDate, " & _
                                                "case " & _
                                                "when strEnforcementNumber is Null then 'MC' " & _
                                                "when strEnforcementNumber is Not Null then 'MV' " & _
                                                "else 'MC' " & _
                                                "end ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcementItems " & _
                                                "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber = " & DBNameSpace & ".SSCPEnforcementItems.strTrackingNumber (+) " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "CS"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'       ' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPRecords, " & DBNameSpace & ".SSCPItemMaster, " & _
                                                "" & DBNameSpace & ".APBHeaderData " & _
                                                "where " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber = " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".SSCPItemMaster.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber  = '" & ActionNumber & "' "
                                            Case "04"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datDayZero as datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "VZ"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datDayZero as datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "56"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datNOVSent as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "AW"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datNFALetterSent as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "57"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCOProposed as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "X1"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCOExecuted as datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "strCOPenaltyAmount as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "AS"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datCOResolved as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "Z4"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "" & DBNameSpace & ".SSCPEnforcementStipulated.datModifingDate as datCompleteDate, " & _
                                                "'01' as ResultCode, " & _
                                                "" & DBNameSpace & ".SSCPEnforcementStipulated.strStipulatedPenalty as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement, " & _
                                                "" & DBNameSpace & ".SSCPEnforcementStipulated " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementITems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementStipulated.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "60"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datAOExecuted as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "64"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datAOAppealed as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "XX"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datAOResolved as datCompleteDate, " & _
                                                "'  ' as ResultCode, " & _
                                                "'0000000' as PenaltyAmount, " & _
                                                "'  ' as Pollutant " & _
                                                "from " & DBNameSpace & ".AFSSSCPEnforcementRecords, " & DBNameSpace & ".SSCPEnforcementItems, " & _
                                                "" & DBNameSpace & ".APBHeaderData, " & DBNameSpace & ".SSCPEnforcement " & _
                                                "where " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber = " _
                                                                 & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber  " & _
                                                "and " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "TR"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "case " & _
                                                "when strWitnessingEngineer = '0' then 'TR' " & _
                                                "else '23' " & _
                                                "end ActionType, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datTestDateEnd as datCompleteDate, " & _
                                                "case " & _
                                                "when strComplianceStatus = '01' then 'N/A' " & _
                                                "when strCompliancestatus = '02' then 'PP'  " & _
                                                "when strComplianceStatus = '03' then 'PP'  " & _
                                                "when strComplianceStatus = '04' then 'N/A' " & _
                                                "when strComplianceStatus = '05' then 'FF' " & _
                                                "else '01' " & _
                                                "end ResultCode, " & _
                                                "'       ' as PenaltyAmount, " & _
                                                "case  " & _
                                                "when strAFSCode = 'True' then strPollutantCode " & _
                                                "else '     ' " & _
                                                "end Pollutant  " & _
                                                "from " & DBNameSpace & ".AFSISMPRecords, " & DBNameSpace & ".ISMPMaster, " & _
                                                "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".APBHeaderData, " & _
                                                "" & DBNameSpace & ".LookUpPollutants " & _
                                                "where " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber = " & DBNameSpace & ".ISMPMaster.strReferenceNumber " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strAIRSnumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case "23"
                                                SQL = "select " & _
                                                "strAIRProgramCodes, " & _
                                                "strAFSActionNumber, " & _
                                                "case " & _
                                                "when strWitnessingEngineer = '0' then 'TR' " & _
                                                "else '23' " & _
                                                "end ActionType, " & _
                                                "'000000' as DateScheduled, " & _
                                                "datTestDateEnd as datCompleteDate, " & _
                                                "case " & _
                                                "when strComplianceStatus = '01' then 'N/A' " & _
                                                "when strCompliancestatus = '02' then 'PP'  " & _
                                                "when strComplianceStatus = '03' then 'PP'  " & _
                                                "when strComplianceStatus = '04' then 'N/A' " & _
                                                "when strComplianceStatus = '05' then 'FF' " & _
                                                "else '01' " & _
                                                "end ResultCode, " & _
                                                "'       ' as PenaltyAmount, " & _
                                                "case  " & _
                                                "when strAFSCode = 'True' then strPollutantCode " & _
                                                "else '     ' " & _
                                                "end Pollutant  " & _
                                                "from " & DBNameSpace & ".AFSISMPRecords, " & DBNameSpace & ".ISMPMaster, " & _
                                                "" & DBNameSpace & ".ISMPReportInformation, " & DBNameSpace & ".APBHeaderData, " & _
                                                "" & DBNameSpace & ".LookUpPollutants " & _
                                                "where " & DBNameSpace & ".AFSISMPRecords.strReferenceNumber = " & DBNameSpace & ".ISMPMaster.strReferenceNumber " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strReferenceNumber = " & DBNameSpace & ".ISMPReportInformation.strReferenceNumber " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strAIRSNumber = " & DBNameSpace & ".APBHeaderData.strAIRSNumber " & _
                                                "and " & DBNameSpace & ".ISMPReportInformation.strPollutant = " & DBNameSpace & ".LookUpPollutants.strPollutantCode " & _
                                                "and " & DBNameSpace & ".ISMPMaster.strAIRSnumber = '0413" & AIRSNumber & "' " & _
                                                "and strAFSActionNumber = '" & ActionNumber & "' "
                                            Case Else
                                                SQL = ""
                                        End Select

                                        If SQL <> "" Then
                                            cmd = New OracleCommand(SQL, conn)
                                            If conn.State = ConnectionState.Closed Then
                                                conn.Open()
                                            End If
                                            dr = cmd.ExecuteReader
                                            While dr.Read
                                                If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                                    IAIPActionNumber = "NULL"
                                                Else
                                                    IAIPActionNumber = dr.Item("strAFSActionNumber")
                                                End If
                                                If IsDBNull(dr.Item("strAIRProgramCodes")) Then
                                                    IAIPAirProgramCode = "NULL"
                                                Else
                                                    IAIPAirProgramCode = dr.Item("strAIRProgramCodes")
                                                End If
                                                If IsDBNull(dr.Item("DateScheduled")) Then
                                                    IAIPDateScheduled = "NULL"
                                                Else
                                                    IAIPDateScheduled = dr.Item("DateScheduled")
                                                End If
                                                If IsDBNull(dr.Item("datCompleteDate")) Then
                                                    IAIPDateAcheived = "NULL"
                                                Else
                                                    IAIPDateAcheived = dr.Item("datCompleteDate")
                                                End If
                                                If IsDBNull(dr.Item("ResultCode")) Then
                                                    IAIPResultCode = "NULL"
                                                Else
                                                    IAIPResultCode = dr.Item("ResultCode")
                                                End If
                                                If IsDBNull(dr.Item("PenaltyAmount")) Then
                                                    IAIPPenaltyAmount = "NULL"
                                                Else
                                                    IAIPPenaltyAmount = dr.Item("PenaltyAmount")
                                                End If
                                                If IsDBNull(dr.Item("Pollutant")) Then
                                                    IAIPPollutant161 = "NULL"
                                                Else
                                                    IAIPPollutant161 = dr.Item("Pollutant")
                                                End If
                                            End While
                                            dr.Close()
                                        End If

                                        If IAIPActionNumber = ActionNumber Then
                                            IAIPActionNumber = ""
                                        End If
                                        If IAIPActionType = ActionType Then
                                            IAIPActionType = ""
                                        End If
                                        If IAIPDateScheduled = DateScheduled Then
                                            IAIPDateScheduled = ""
                                        End If
                                        If IAIPDateScheduled = "000000" Then
                                            IAIPDateScheduled = ""
                                        End If

                                        If IAIPDateAcheived.Length > 4 And IAIPDateAcheived.Contains("/") Then
                                            temp = Mid(IAIPDateAcheived, IAIPDateAcheived.IndexOf("/") + 2)
                                            temp = Mid(temp, 1, temp.ToString.IndexOf("/"))
                                            If temp.ToString.Length = 1 Then
                                                temp = "0" & temp
                                            End If
                                            temp2 = Mid(IAIPDateAcheived, 1, (IAIPDateAcheived.IndexOf("/")))
                                            If temp2.ToString.Length = 1 Then
                                                temp2 = "0" & temp2
                                            End If
                                            IAIPDateAcheived = Mid(IAIPDateAcheived, (IAIPDateAcheived.Length - 1), 2) & temp2 & temp
                                        End If
                                        If IAIPDateAcheived = DateAcheived Then
                                            IAIPDateAcheived = ""
                                        End If
                                        If IAIPDateAcheived = "000000" Then
                                            IAIPDateAcheived = ""
                                        End If
                                        If IAIPResultCode = ResultCode Then
                                            IAIPResultCode = ""
                                        End If
                                        If IAIPPenaltyAmount.Length < 7 And IAIPPenaltyAmount <> "NULL" Then
                                            Do Until IAIPPenaltyAmount.Length = 7
                                                IAIPPenaltyAmount = "0" & IAIPPenaltyAmount
                                            Loop
                                        End If
                                        If IAIPPenaltyAmount = PenaltyAmount Then
                                            IAIPPenaltyAmount = ""
                                        End If
                                        If IAIPPenaltyAmount = "0000000" Then
                                            IAIPPenaltyAmount = ""
                                        End If
                                        If Replace(IAIPPollutant161, " ", "") = Replace(Pollutant161, " ", "") Then
                                            IAIPPollutant161 = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, IAIPAirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            "", "", "", "", "", "", "", "", "", "", _
                                                            ActionNumber, IAIPActionNumber, ActionType, IAIPActionType, DateScheduled, IAIPDateScheduled, _
                                                            DateAcheived, IAIPDateAcheived, ResultCode, IAIPResultCode, PenaltyAmount, IAIPPenaltyAmount, _
                                                            Pollutant161, IAIPPollutant161)
                                    End If
                                Case "163"
                                    If chb163Card.Checked = True Then
                                        ActionNumber163 = Mid(DefaultText, 14, 3)
                                        KeyActionNumber = Mid(DefaultText, 17, 3)
                                        Pollutant163 = Mid(DefaultText, 43, 5)

                                        IAIPActionNumber163 = "NULL"
                                        IAIPKeyActionNumber = "NULL"
                                        IAIPPollutant163 = "NULL"

                                        SQL = "Select  " & _
                                        "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,    " & _
                                        "" & DBNameSpace & ".APBHeaderData.strAIRSNumber,    " & _
                                        "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber,    " & _
                                        "strAFSKeyActionNumber,  " & _
                                        "strPollutants,   " & _
                                        "" & DBNameSpace & ".AFSSSCPRecords.strAFSActionNumber as LinkingEvent  " & _
                                        "from  " & DBNameSpace & ".AFSSSCPEnforcementRecords,    " & _
                                        "" & DBNameSpace & ".SSCPEnforcementItems,  " & DBNameSpace & ".SSCPEnforcement,    " & _
                                        "" & DBNameSpace & ".APBHeaderData,  " & DBNameSpace & ".SSCPENforcementStipulated, " & _
                                        "" & DBNameSpace & ".SSCPItemMaster, " & DBNameSpace & ".AFSSSCPRecords    " & _
                                        "where " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber =  " _
                                                 & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber    " & _
                                        "and  " & DBNameSpace & ".APBHeaderData.strAIRSNumber =  " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber    " & _
                                        "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber    " & _
                                        "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " _
                                                & DBNameSpace & ".SSCPENforcementStipulated.strEnforcementNumber (+)    " & _
                                        "and  " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber =  " & DBNameSpace & ".SSCPItemMaster.strTrackingNumber (+)   " & _
                                        "and " & DBNameSpace & ".sscpEnforcementItems.strTrackingNumber = " & DBNameSpace & ".AFSSSCPRecords.strTrackingNumber (+) " & _
                                        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '0413" & AIRSNumber & "' " & _
                                        "and " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = '" & ActionNumber163 & "' " & _
                                        "and strAFSKeyActionNumber = '" & KeyActionNumber & "' "

                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If

                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                                IAIPActionNumber163 = "NULL"
                                            Else
                                                IAIPActionNumber163 = dr.Item("strAFSActionNumber")
                                            End If
                                            If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                                                IAIPKeyActionNumber = "NULL"
                                            Else
                                                IAIPKeyActionNumber = dr.Item("strAFSKeyActionNumber")
                                            End If
                                            If IsDBNull(dr.Item("LinkingEvent")) Then
                                                IAIPActionNumber163 = IAIPActionNumber163
                                            Else
                                                '  IAIPActionNumber163 = dr.Item("LinkingEvent")
                                            End If
                                            If IsDBNull(dr.Item("strPollutants")) Then
                                                IAIPPollutant163 = "NULL"
                                            Else
                                                IAIPPollutant163 = dr.Item("strPollutants")
                                            End If
                                        End While
                                        dr.Close()


                                        If IAIPActionNumber163 = ActionNumber163 Then
                                            IAIPActionNumber163 = ""
                                        End If
                                        If IAIPKeyActionNumber = KeyActionNumber Then
                                            IAIPKeyActionNumber = ""
                                        End If
                                        If IAIPPollutant163 <> "NULL" Then
                                            IAIPPollutant163 = Mid(IAIPPollutant163, 2, IAIPPollutant163.IndexOf(",") - 1)
                                        End If
                                        If Replace(IAIPPollutant163, " ", "") = Replace(Pollutant163, " ", "") Then
                                            IAIPPollutant163 = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            "", "", "", "", "", "", _
                                                            "", "", ActionNumber163, IAIPActionNumber163, KeyActionNumber, IAIPKeyActionNumber, Pollutant163, IAIPPollutant163)
                                    End If

                                Case "164"
                                    If chb164Card.Checked = True Then
                                        ActionNumber164 = Mid(DefaultText, 14, 3)
                                        KeyActionNumber164 = Mid(DefaultText, 17, 3)
                                        ViolationType = Mid(DefaultText, 42, 3)
                                        IAIPActionNumber164 = "NULL"
                                        IAIPKeyActionNumber164 = "NULL"
                                        ViolationType = "NULL"

                                        SQL = "Select " & _
                                        "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber,    " & _
                                        "" & DBNameSpace & ".APBHeaderData.strAIRSNumber,    " & _
                                        "" & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber,    " & _
                                        "strAFSKeyActionNumber, " & _
                                        "strHPV " & _
                                        "from  " & DBNameSpace & ".AFSSSCPEnforcementRecords,    " & _
                                        "" & DBNameSpace & ".SSCPEnforcementItems,  " & DBNameSpace & ".SSCPEnforcement,    " & _
                                        "" & DBNameSpace & ".APBHeaderData " & _
                                        "where " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber =  " & DBNameSpace & ".AFSSSCPEnforcementRecords.strEnforcementNumber    " & _
                                        "and  " & DBNameSpace & ".APBHeaderData.strAIRSNumber =  " & DBNameSpace & ".SSCPEnforcementItems.strAIRSNumber    " & _
                                        "and  " & DBNameSpace & ".SSCPEnforcementItems.strEnforcementNumber =  " & DBNameSpace & ".SSCPEnforcement.strEnforcementNumber    " & _
                                        "and " & DBNameSpace & ".APBHeaderData.strAIRSNumber = '041312100816' " & _
                                        "and " & DBNameSpace & ".AFSSSCPEnforcementRecords.strAFSActionNumber = '007' " & _
                                        "and strAFSKeyActionNumber = '007' "

                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strAFSActionNumber")) Then
                                                IAIPActionNumber164 = "NULL"
                                            Else
                                                IAIPActionNumber164 = dr.Item("strAFSActionNumber")
                                            End If
                                            If IsDBNull(dr.Item("strAFSKeyActionNumber")) Then
                                                IAIPKeyActionNumber164 = "NULL"
                                            Else
                                                IAIPKeyActionNumber164 = dr.Item("strAFSKeyActionNumber")
                                            End If
                                            If IsDBNull(dr.Item("strHPV")) Then
                                                IAIPViolationType = "NULL"
                                            Else
                                                IAIPViolationType = dr.Item("strHPV")
                                            End If
                                        End While
                                        dr.Close()

                                        If IAIPActionNumber164 = ActionNumber164 Then
                                            IAIPActionNumber164 = ""
                                        End If
                                        If IAIPKeyActionNumber164 = KeyActionNumber164 Then
                                            IAIPKeyActionNumber164 = ""
                                        End If
                                        If IAIPViolationType = ViolationType Then
                                            IAIPViolationType = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            AirProgramCode, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                            ActionNumber164, IAIPActionNumber164, KeyActionNumber164, IAIPKeyActionNumber164, _
                                                            ViolationType, IAIPViolationType)
                                    End If
                                Case "171" 'Comments
                                    'Ignore
                                Case "181"
                                    If chb181Card.Checked = True Then
                                        CMSStatus = Mid(DefaultText, 14, 2)
                                        IAIPCMSStatus = "NULL"

                                        SQL = "Select " & _
                                        "strCMSMember " & _
                                        "from " & DBNameSpace & ".APBSupplamentalData " & _
                                        "where strAIRSNumber = '0413" & AIRSNumber & "' "
                                        cmd = New OracleCommand(SQL, conn)
                                        If conn.State = ConnectionState.Closed Then
                                            conn.Open()
                                        End If
                                        dr = cmd.ExecuteReader
                                        While dr.Read
                                            If IsDBNull(dr.Item("strCMSMember")) Then
                                                IAIPCMSStatus = "NULL"
                                            Else
                                                IAIPCMSStatus = dr.Item("strCMSMember")
                                            End If
                                        End While
                                        dr.Close()

                                        If IAIPCMSStatus = "A" Then
                                            IAIPCMSStatus = "A2"
                                        End If
                                        If IAIPCMSStatus = "S" Then
                                            IAIPCMSStatus = "S5"
                                        End If

                                        If IAIPCMSStatus = CMSStatus Then
                                            IAIPCMSStatus = ""
                                        End If

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", CMSStatus, IAIPCMSStatus)
                                    End If
                                Case Else

                            End Select

                        Loop Until reader.Peek = -1
                        reader.Close()

                    Else
                        dgvAFSData.Columns.Add("AIRSNumber", "AIRS Number")
                        dgvAFSData.Columns.Add("TransactionType", "Transaction Type")
                        dgvAFSData.Columns.Add("FacilityName", "Facility Name")
                        dgvAFSData.Columns("FacilityName").Width = 200
                        dgvAFSData.Columns.Add("FacilityAddress", "Facility Address")
                        dgvAFSData.Columns("FacilityAddress").Width = 200
                        dgvAFSData.Columns.Add("City", "City")
                        dgvAFSData.Columns.Add("ZipCode", "Zip Code")
                        dgvAFSData.Columns.Add("SICCode", "SIC Code")
                        dgvAFSData.Columns.Add("ContactPerson", "Contact Person")
                        dgvAFSData.Columns.Add("ContactNumber", "Contact Number")
                        dgvAFSData.Columns.Add("FacilityDescription", "Facility Description")
                        dgvAFSData.Columns("FacilityDescription").Width = 200
                        dgvAFSData.Columns.Add("AirProgramCode", "Air Program Code")
                        dgvAFSData.Columns.Add("ProgramCodeStatus", "Program Code Status")
                        dgvAFSData.Columns.Add("SubPart1", "Sub Part 1")
                        dgvAFSData.Columns.Add("SubPart2", "Sub Part 2")
                        dgvAFSData.Columns.Add("SubPart3", "Sub Part 3")
                        dgvAFSData.Columns.Add("SubPart4", "Sub Part 4")
                        dgvAFSData.Columns.Add("SubPart5", "Sub Part 5")
                        dgvAFSData.Columns.Add("SubPart6", "Sub Part 6")
                        dgvAFSData.Columns.Add("SubPart7", "Sub Part 7")
                        dgvAFSData.Columns.Add("SubPart8", "Sub Part 8")
                        dgvAFSData.Columns.Add("SubPart9", "Sub Part 9")
                        dgvAFSData.Columns.Add("Pollutant", "Pollutant")
                        dgvAFSData.Columns.Add("Class", "Classification")
                        dgvAFSData.Columns.Add("ComplianceStauts", "Compliance Status")
                        dgvAFSData.Columns.Add("AttainmentStatus", "Attainment Status")
                        dgvAFSData.Columns.Add("SICCode2", "SIC Code")
                        dgvAFSData.Columns.Add("ActionNumber", "Action Number")
                        dgvAFSData.Columns.Add("ActionType", "Action Type")
                        dgvAFSData.Columns.Add("DateScheduled", "Date Scheduled")
                        dgvAFSData.Columns.Add("DateAcheived", "Date Acheived")
                        dgvAFSData.Columns.Add("ResultCode", "Result Code")
                        dgvAFSData.Columns.Add("PenaltyAmount", "Penalty Amount")
                        dgvAFSData.Columns.Add("KeyActionNumber", "Key Action Number")
                        dgvAFSData.Columns.Add("ActionNumber163", "Action Number")
                        dgvAFSData.Columns.Add("ViolationType", "Violation Type")
                        dgvAFSData.Columns.Add("CMSStatus", "CMS Status")

                        If chb101Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("FacilityName").Visible = False
                        End If
                        If chb102Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("FacilityAddress").Visible = False
                        End If
                        If chb103Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("City").Visible = False
                            dgvAFSData.Columns("ZipCode").Visible = False
                            dgvAFSData.Columns("SICCode").Visible = False
                        End If
                        If chb105Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ContactPerson").Visible = False
                            dgvAFSData.Columns("ContactNumber").Visible = False
                            dgvAFSData.Columns("FacilityDescription").Visible = False
                        End If
                        If chb121Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("AirProgramCode").Visible = False
                            dgvAFSData.Columns("ProgramCodeStatus").Visible = False
                        End If
                        If chb122Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("SubPart1").Visible = False
                            dgvAFSData.Columns("SubPart2").Visible = False
                            dgvAFSData.Columns("SubPart3").Visible = False
                            dgvAFSData.Columns("SubPart4").Visible = False
                            dgvAFSData.Columns("SubPart5").Visible = False
                            dgvAFSData.Columns("SubPart6").Visible = False
                            dgvAFSData.Columns("SubPart7").Visible = False
                            dgvAFSData.Columns("SubPart8").Visible = False
                            dgvAFSData.Columns("SubPart9").Visible = False
                        End If
                        If chb131Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("Pollutant").Visible = False
                            dgvAFSData.Columns("Class").Visible = False
                            dgvAFSData.Columns("ComplianceStauts").Visible = False
                            dgvAFSData.Columns("AttainmentStatus").Visible = False
                            dgvAFSData.Columns("SICCode2").Visible = False
                        End If
                        If chb161Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ActionNumber").Visible = False
                            dgvAFSData.Columns("ActionType").Visible = False
                            dgvAFSData.Columns("DateScheduled").Visible = False
                            dgvAFSData.Columns("DateAcheived").Visible = False
                            dgvAFSData.Columns("ResultCode").Visible = False
                            dgvAFSData.Columns("PenaltyAmount").Visible = False
                        End If
                        If chb163Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("KeyActionNumber").Visible = False
                            dgvAFSData.Columns("ActionNumber163").Visible = False
                        End If
                        If chb164Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("ViolationType").Visible = False
                        End If
                        If chb181Card.Checked = True Then
                        Else
                            dgvAFSData.Columns("CMSStatus").Visible = False
                        End If

                        Dim reader As StreamReader = New StreamReader(txtAFSFile.Text)
                        Do
                            DefaultText = reader.ReadLine
                            AIRSNumber = Mid(DefaultText, 3, 8)
                            TransactionType = Mid(DefaultText, 11, 3)
                            Select Case TransactionType
                                Case "101"
                                    If chb101Card.Checked = True Then
                                        FacilityName = Mid(DefaultText, 16, 40)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, FacilityName)
                                    End If
                                Case "102"
                                    If chb102Card.Checked = True Then
                                        FacilityAddress = Mid(DefaultText, 16, 30)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", FacilityAddress)
                                    End If
                                Case "103"
                                    If chb103Card.Checked = True Then
                                        FacilityCity = Mid(DefaultText, 16, 30)
                                        FacilityZipCode = Mid(DefaultText, 46, 9)
                                        FacilitySIC = Mid(DefaultText, 55, 4)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", FacilityCity, FacilityZipCode, FacilitySIC)
                                    End If
                                Case "104"
                                    'Ignore
                                    'FacilityNAICS = Mid(DefaultText, 57, 6)
                                Case "105"
                                    If chb105Card.Checked = True Then
                                        FacilityContactPerson = Mid(DefaultText, 14, 20)
                                        FacilityContactNumber = Mid(DefaultText, 34, 10)
                                        FacilityDescription = Mid(DefaultText, 44, 25)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", FacilityContactPerson, FacilityContactNumber, FacilityDescription)
                                    End If
                                Case "106"
                                    'Ignore
                                Case "107"
                                    'Ignore
                                Case "121"
                                    If chb121Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        ProgramStatus = Mid(DefaultText, 15, 1)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, ProgramStatus)
                                    End If


                                Case "122"
                                    If chb122Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        SubPart1 = Mid(DefaultText, 16, 5)
                                        SubPart2 = Mid(DefaultText, 21, 5)
                                        SubPart3 = Mid(DefaultText, 26, 5)
                                        SubPart4 = Mid(DefaultText, 31, 5)
                                        SubPart5 = Mid(DefaultText, 36, 5)
                                        SubPart6 = Mid(DefaultText, 41, 5)
                                        SubPart7 = Mid(DefaultText, 46, 5)
                                        SubPart8 = Mid(DefaultText, 51, 5)
                                        SubPart9 = Mid(DefaultText, 56, 5)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", SubPart1, SubPart2, SubPart3, _
                                                            SubPart4, SubPart5, SubPart6, SubPart7, SubPart8, SubPart9)
                                    End If
                                Case "131"
                                    If chb131Card.Checked = True Then
                                        AirProgramCode = Mid(DefaultText, 14, 1)
                                        Pollutant = Mid(DefaultText, 15, 9)
                                        FacilityClassification = Mid(DefaultText, 25, 2)
                                        ComplianceStatus = Mid(DefaultText, 24, 1)
                                        AttainmentStatus = Mid(DefaultText, 27, 1)
                                        SICCode = Mid(DefaultText, 35, 4)


                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", "", "", "", _
                                                             "", "", "", "", "", "", Pollutant, FacilityClassification, ComplianceStatus, AttainmentStatus, _
                                                             SICCode)
                                    End If
                                Case "141"
                                    'Ignore
                                Case "151"
                                    'Ignore
                                Case "161" 'Various Action Types
                                    If chb161Card.Checked = True Then
                                        ActionNumber = Mid(DefaultText, 14, 3)
                                        AirProgramCode = Mid(DefaultText, 17, 6)
                                        ActionType = Mid(DefaultText, 23, 2)
                                        DateScheduled = Mid(DefaultText, 41, 6)
                                        DateAcheived = Mid(DefaultText, 47, 6)
                                        ResultCode = Mid(DefaultText, 53, 2)
                                        PenaltyAmount = Mid(DefaultText, 55, 7)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", AirProgramCode, "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", ActionNumber, ActionType, DateScheduled, DateAcheived, _
                                                             ResultCode, PenaltyAmount)
                                    End If
                                Case "163"
                                    If chb163Card.Checked = True Then
                                        ActionNumber = Mid(DefaultText, 14, 3)
                                        KeyActionNumber = Mid(DefaultText, 17, 3)
                                        Pollutant163 = Mid(DefaultText, 43, 5)

                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", KeyActionNumber, Pollutant163)
                                    End If



                                Case "164"
                                    If chb164Card.Checked = True Then
                                        ActionNumber = Mid(DefaultText, 14, 3)
                                        ViolationType = Mid(DefaultText, 42, 3)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", ViolationType)
                                    End If
                                Case "171" 'Comments
                                    'Ignore
                                Case "181"
                                    If chb181Card.Checked = True Then
                                        CMSStatus = Mid(DefaultText, 14, 2)
                                        dgvAFSData.Rows.Add(AIRSNumber, TransactionType, "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", "", "", "", "", "", "", "", "", _
                                                             "", "", "", "", "", "", CMSStatus)
                                    End If
                                Case Else

                            End Select

                        Loop Until reader.Peek = -1
                        reader.Close()
                    End If
                End If
                Else

                End If
            txtAFSDataCount.Text = dgvAFSData.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub

    Private Sub btnLoadAFSData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnLoadAFSData.Click
        Try
            LoadAFSData2()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnExportAFSData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnExportAFSData.Click
        Try
            Dim ExcelApp As New Microsoft.Office.Interop.Excel.Application
            'Dim ExcelDoc As Microsoft.Office.Interop.Excel.Workbook
            'Dim ExcelApp As New Excel.Application
            Dim i, j As Integer

            If ExcelApp.Visible = False Then
                ExcelApp.Visible = True
            End If

            If dgvAFSData.RowCount <> 0 Then
                With ExcelApp
                    .SheetsInNewWorkbook = 1
                    .Workbooks.Add()
                    .Worksheets(1).Select()

                    'For displaying the column name in the the excel file.
                    For i = 0 To dgvAFSData.ColumnCount - 1
                        .Cells(1, i + 1) = dgvAFSData.Columns(i).HeaderText.ToString
                    Next

                    For i = 0 To dgvAFSData.ColumnCount - 1
                        For j = 0 To dgvAFSData.RowCount - 2
                            temp = dgvAFSData.Item(i, j).Value

                            If temp Is Nothing Then
                                .Cells(j + 2, i + 1).numberformat = "@"
                                .Cells(j + 2, i + 1).value = " "
                            Else
                                If dgvAFSData.Item(i, j).Value.ToString = Nothing Then
                                    .Cells(j + 2, i + 1).numberformat = "@"
                                    .Cells(j + 2, i + 1).value = " "
                                Else
                                    .Cells(j + 2, i + 1).numberformat = "@"
                                    .Cells(j + 2, i + 1).value = dgvAFSData.Item(i, j).Value.ToString
                                End If
                            End If

                        Next
                    Next
                End With

                If ExcelApp.Visible = False Then
                    ExcelApp.Visible = True
                End If
            End If

        Catch ex As Exception
            If ex.ToString.Contains("RPC_E_CALL_REJECTED") Then
                MsgBox("Error in exporting data." & vbCrLf & "Please run the export again.")
            Else
                ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
            End If
        End Try

    End Sub
    Private Sub btnPreLoadNewFacility_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnPreLoadNewFacility.Click
        Try
            If txtApplicationNumber.Text <> "App No." Then
                SQL = "select " & _
                "strFacilityName, strFacilityStreet1, " & _
                "strFacilityCity, strFacilityZipCode, " & _
                "strOperationalStatus, strClass, " & _
                "strAirProgramCodes, strSICCode, " & _
                "strPlantDescription, strContactFirstName, " & _
                "strContactLastName, strContactpreFix, " & _
                "strContactSuffix, strContactTitle, " & _
                "strContactPhoneNumber1 " & _
                "from " & DBNameSpace & ".SSPPApplicationdata, " & _
                "" & DBNameSpace & ".SSPPApplicationContact " & _
                "where " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = " & DBNameSpace & ".SSPPApplicationContact.strApplicationNumber " & _
                "and " & DBNameSpace & ".SSPPApplicationData.strApplicationNumber = '" & txtApplicationNumber.Text & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                If recExist = True Then
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        txtCDSFacilityName.Clear()
                    Else
                        txtCDSFacilityName.Text = dr.Item("strFacilityname")
                    End If
                    If IsDBNull(dr.Item("strFacilityStreet1")) Then
                        txtCDSStreetAddress.Clear()
                        txtMailingAddress.Clear()
                    Else
                        txtCDSStreetAddress.Text = dr.Item("strFacilityStreet1")
                        txtMailingAddress.Text = dr.Item("strFacilityStreet1")
                    End If
                    If IsDBNull(dr.Item("strFacilityCity")) Then
                        txtCDSCity.Clear()
                        txtMailingCity.Clear()
                    Else
                        txtCDSCity.Text = dr.Item("strFacilityCity")
                        txtMailingCity.Text = dr.Item("strFacilityCity")
                    End If
                    If IsDBNull(dr.Item("strFacilityZipCode")) Then
                        mtbCDSZipCode.Clear()
                        mtbMailingZipCode.Clear()
                    Else
                        mtbCDSZipCode.Text = dr.Item("strFacilityZipCode")
                        mtbMailingZipCode.Text = dr.Item("strFacilityZipCode")
                    End If
                    If IsDBNull(dr.Item("strOperationalStatus")) Then
                        cboCDSOperationalStatus.Text = ""
                    Else
                        temp = dr.Item("strOperationalStatus")
                        Select Case temp.ToString
                            Case "O"
                                cboCDSOperationalStatus.Text = "O - Operating"
                            Case "P"
                                cboCDSOperationalStatus.Text = "P - Planned"
                            Case "C"
                                cboCDSOperationalStatus.Text = "C - Under Construction"
                            Case "T"
                                cboCDSOperationalStatus.Text = "T - Temporarily Closed"
                            Case "X"
                                cboCDSOperationalStatus.Text = "X - Permanently Closed"
                            Case "I"
                                cboCDSOperationalStatus.Text = "I - Seasonal Operation"
                            Case Else
                                cboCDSOperationalStatus.Text = " "
                        End Select
                        '  cboCDSOperationalStatus.SelectedText = dr.Item("stroperationalStatus")
                    End If
                    If IsDBNull(dr.Item("strClass")) Then
                        cboCDSClassCode.Text = ""
                    Else
                        cboCDSClassCode.Text = dr.Item("strClass")
                    End If
                    If IsDBNull(dr.Item("strAirProgramCodes")) Then
                        chbCDS_1.Checked = False
                        chbCDS_2.Checked = False
                        chbCDS_3.Checked = False
                        chbCDS_4.Checked = False
                        chbCDS_5.Checked = False
                        chbCDS_6.Checked = False
                        chbCDS_7.Checked = False
                        chbCDS_8.Checked = False
                        chbCDS_9.Checked = False
                        chbCDS_10.Checked = False
                        chbCDS_11.Checked = False
                        chbCDS_12.Checked = False
                        chbCDS_13.Checked = False
                    Else
                        temp = dr.Item("strAirProgramCodes")
                        If Mid(temp, 1, 1) = "0" Then
                            chbCDS_1.Checked = False
                        Else
                            chbCDS_1.Checked = True
                        End If
                        If Mid(temp, 2, 1) = "0" Then
                            chbCDS_2.Checked = False
                        Else
                            chbCDS_2.Checked = True
                        End If
                        If Mid(temp, 3, 1) = "0" Then
                            chbCDS_3.Checked = False
                        Else
                            chbCDS_3.Checked = True
                        End If
                        If Mid(temp, 4, 1) = "0" Then
                            chbCDS_4.Checked = False
                        Else
                            chbCDS_4.Checked = True
                        End If
                        If Mid(temp, 5, 1) = "0" Then
                            chbCDS_5.Checked = False
                        Else
                            chbCDS_5.Checked = True
                        End If
                        If Mid(temp, 6, 1) = "0" Then
                            chbCDS_6.Checked = False
                        Else
                            chbCDS_6.Checked = True
                        End If
                        If Mid(temp, 7, 1) = "0" Then
                            chbCDS_7.Checked = False
                        Else
                            chbCDS_7.Checked = True
                        End If
                        If Mid(temp, 8, 1) = "0" Then
                            chbCDS_8.Checked = False
                        Else
                            chbCDS_8.Checked = True
                        End If
                        If Mid(temp, 9, 1) = "0" Then
                            chbCDS_9.Checked = False
                        Else
                            chbCDS_9.Checked = True
                        End If
                        If Mid(temp, 10, 1) = "0" Then
                            chbCDS_10.Checked = False
                        Else
                            chbCDS_10.Checked = True
                        End If
                        If Mid(temp, 11, 1) = "0" Then
                            chbCDS_11.Checked = False
                        Else
                            chbCDS_11.Checked = True
                        End If
                        If Mid(temp, 12, 1) = "0" Then
                            chbCDS_12.Checked = False
                        Else
                            chbCDS_12.Checked = True
                        End If
                        If Mid(temp, 13, 1) = "0" Then
                            chbCDS_13.Checked = False
                        Else
                            chbCDS_13.Checked = True
                        End If
                    End If
                    If IsDBNull(dr.Item("strSICCode")) Then
                        mtbCDSSICCode.Clear()
                    Else
                        mtbCDSSICCode.Text = dr.Item("strSICCode")
                    End If
                    If IsDBNull(dr.Item("strPlantDescription")) Then
                        txtFacilityDescription.Clear()
                    Else
                        txtFacilityDescription.Text = dr.Item("strPlantDescription")
                    End If
                    If IsDBNull(dr.Item("strContactFirstName")) Then
                        txtContactFirstName.Clear()
                    Else
                        txtContactFirstName.Text = dr.Item("strContactFirstName")
                    End If
                    If IsDBNull(dr.Item("strContactLastName")) Then
                        txtContactLastName.Clear()
                    Else
                        txtContactLastName.Text = dr.Item("strContactLastName")
                    End If
                    If IsDBNull(dr.Item("strContactPreFix")) Then
                        txtContactSocialTitle.Clear()
                    Else
                        txtContactSocialTitle.Text = dr.Item("strContactPrefix")
                    End If
                    If IsDBNull(dr.Item("strContactSuffix")) Then
                        txtContactPedigree.Clear()
                    Else
                        txtContactPedigree.Text = dr.Item("strContactSuffix")
                    End If
                    If IsDBNull(dr.Item("strContactTitle")) Then
                        txtContactTitle.Clear()
                    Else
                        txtContactTitle.Text = dr.Item("strContactTitle")
                    End If
                    If IsDBNull(dr.Item("strCOntactphoneNumber1")) Then
                        mtbContactPhoneNumber.Clear()
                        mtbContactNumberExtension.Clear()
                    Else
                        mtbContactPhoneNumber.Text = Mid(dr.Item("strContactPhoneNumber1"), 1, 10)
                        mtbContactNumberExtension.Text = Mid(dr.Item("strcontactPhoneNumber1"), 11)
                    End If
                End If
                dr.Close()
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub MmiHelp_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MmiHelp.Click
        Try
            Help.ShowHelp(Label1, HELP_URL)
        Catch ex As Exception
        End Try

    End Sub
    Private Sub llbViewUserData_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles llbViewUserData.LinkClicked
        Try
            If mtbAIRSNumber.Text.Length <> 8 Then
                MsgBox("Please enter a complete 8 digit AIRS #.", MsgBoxStyle.Information, "DMU Tools")
            Else
                lblFacilityName.Text = "Facility Name"
                airsno = mtbAIRSNumber.Text
                SQL = "Select strFacilityName " & _
                "from " & DBNameSpace & ".APBFacilityInformation " & _
                "where strAIRSNumber = '0413" & airsno & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                While dr.Read
                    If IsDBNull(dr.Item("strFacilityName")) Then
                        lblFacilityName.Text = "Facility Name"
                    Else
                        lblFacilityName.Text = dr.Item("strFacilityName")
                    End If
                End While
                dr.Close()

                FormatDataGridForWorkEntry()
                LoadDataGrid()
            End If

            If lblFacilityName.Text = "Facility Name" Then
                pnlUser.Visible = False
            Else
               pnlUser.Visible = True
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblViewEmailData_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEmailData.LinkClicked
        Try
            LoadDataGridFacility(txtWebUserEmail.Text)
            LoadUserInfo(txtWebUserEmail.Text)
            FormatDataGridForWorkEnTryEmail()

            If txtWebUserID.Text = "" Then
                pnlUserInfo.Visible = False
                pnlUserFacility.Visible = False
            Else
                pnlUserInfo.Visible = True
                pnlUserFacility.Visible = True
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub cboUserEmail_SelectedValueChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cboUserEmail.SelectedValueChanged
        Try
            txtWebUserEmail.Text = cboUserEmail.Text
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Private Sub btnEditUserData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEditUserData.Click
        Try
            txtEditFirstName.Visible = True
            txtEditLastName.Visible = True
            txtEditTitle.Visible = True
            txtEditCompany.Visible = True
            txtEditAddress.Visible = True
            txtEditCity.Visible = True
            mtbEditState.Visible = True
            mtbEditZipCode.Visible = True
            mtbEditPhoneNumber.Visible = True
            mtbEditFaxNumber.Visible = True
            btnSaveEditedData.Visible = True
            txtEditUserPassword.Visible = True
            btnChangeEmailAddress.Visible = True
            txtEditEmail.Visible = True
            btnUpdatePassword.Visible = True
            gbSmokeSchoolRegistration.Visible = True
            LoadSmokeSchoolRegistration()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Sub UpdateWebUserData()
        Try

            SQL = "Update " & DBNameSpace & ".OLAPUserProfile set " & _
            "strFirstName = '" & Replace(txtEditFirstName.Text, "'", "''") & "', " & _
            "strLastName = '" & Replace(txtEditLastName.Text, "'", "''") & "', " & _
            "strTitle = '" & Replace(txtEditTitle.Text, "'", "''") & "', " & _
            "strCompanyName = '" & Replace(txtEditCompany.Text, "'", "''") & "', " & _
            "strAddress = '" & Replace(txtEditAddress.Text, "'", "''") & "', " & _
            "strCity = '" & Replace(txtEditCity.Text, "'", "''") & "', " & _
            "strState = '" & Replace(mtbEditState.Text, "'", "''") & "', " & _
            "strZip= '" & mtbEditZipCode.Text & "', " & _
            "strPhoneNumber = '" & mtbEditPhoneNumber.Text & "', " & _
            "strFaxNumber = '" & mtbEditFaxNumber.Text & "' " & _
            "where numUserID = '" & txtWebUserID.Text & "' "
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            dr.Close()


            lblFName.Text = "First Name: " & txtEditFirstName.Text
            lblLName.Text = "Last Name: " & txtEditLastName.Text
            lblTitle.Text = "Title: " & txtEditTitle.Text
            lblCoName.Text = "Company Name: " & txtEditCompany.Text
            lblAddress.Text = txtEditAddress.Text
            lblCityStateZip.Text = txtEditCity.Text & ", " & mtbEditState.Text & " " & mtbEditZipCode.Text
            lblPhoneNo.Text = "Phone Number: " & mtbEditPhoneNumber.Text
            lblFaxNo.Text = "Fax Number: " & mtbEditFaxNumber.Text

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Private Sub btnSaveEditedData_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveEditedData.Click
        Try

            If txtWebUserID.Text <> "" Then
                UpdateWebUserData()
                txtEditFirstName.Visible = False
                txtEditLastName.Visible = False
                txtEditTitle.Visible = False
                txtEditCompany.Visible = False
                txtEditAddress.Visible = False
                txtEditCity.Visible = False
                mtbEditState.Visible = False
                mtbEditZipCode.Visible = False
                mtbEditPhoneNumber.Visible = False
                mtbEditFaxNumber.Visible = False
                btnSaveEditedData.Visible = False
                txtEditUserPassword.Visible = False
                btnChangeEmailAddress.Visible = False
                txtEditEmail.Visible = False
                btnUpdatePassword.Visible = False
                gbSmokeSchoolRegistration.Visible = False
            Else

            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Private Sub btnUpdatePassword_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUpdatePassword.Click
        Try
            If txtWebUserID.Text <> "" And txtEditUserPassword.Text <> "" Then
                'SQL = "Update " & DBNameSpace & ".OLAPUserLogIN set " & _
                '"strUserPassword = '" & EncryptDecrypt.EncryptText(txtEditUserPassword.Text) & "' " & _
                '"where numUserID = '" & txtWebUserID.Text & "' "

                'New password change code 6/30/2010
                SQL = "Update " & DBNameSpace & ".OLAPUserLogIN set " & _
                "strUserPassword = '" & getMd5Hash(txtEditUserPassword.Text) & "' " & _
                "where numUserID = '" & txtWebUserID.Text & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()

                txtEditUserPassword.Clear()
                txtEditFirstName.Visible = False
                txtEditLastName.Visible = False
                txtEditTitle.Visible = False
                txtEditCompany.Visible = False
                txtEditAddress.Visible = False
                txtEditCity.Visible = False
                mtbEditState.Visible = False
                mtbEditZipCode.Visible = False
                mtbEditPhoneNumber.Visible = False
                mtbEditFaxNumber.Visible = False
                btnSaveEditedData.Visible = False
                txtEditUserPassword.Visible = False
                btnChangeEmailAddress.Visible = False
                txtEditEmail.Visible = False
                btnUpdatePassword.Visible = False
                gbSmokeSchoolRegistration.Visible = False

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Private Sub btnChangeEmailAddress_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnChangeEmailAddress.Click
        Try
            If txtWebUserID.Text <> "" Then
                If EmailAddressCheck(txtEditEmail.Text) = True Then
                    SQL = "Update " & DBNameSpace & ".OLAPUserLogIn set " & _
                    "strUserEmail = '" & Replace(txtEditEmail.Text.ToUpper, "'", "''") & "' " & _
                    "where numUserID = '" & txtWebUserID.Text & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    dr.Close()

                    cboUserEmail.Text = ""
                    txtWebUserEmail.Text = txtEditEmail.Text

                    LoadDataGridFacility(txtWebUserEmail.Text)
                    LoadUserInfo(txtWebUserEmail.Text)
                    FormatDataGridForWorkEnTryEmail()

                    If txtWebUserID.Text = "" Then
                        pnlUserInfo.Visible = False
                        pnlUserFacility.Visible = False
                    Else
                        pnlUserInfo.Visible = True
                        pnlUserFacility.Visible = True
                    End If

                Else
                    MsgBox("Invalid Email Address", MsgBoxStyle.Exclamation, "DMU Tools")
                End If
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally
        End Try
    End Sub
    Sub LoadSmokeSchoolRegistration()
        Try
            cboSmokeSchoolLectures.Items.Clear()
            SQL = "Select " & _
            "strSchedule " & _
            "from " & DBNameSpace & ".SmokeSchoolSchedule " & _
            "where strDisplay = 'YES' " & _
            "order by to_date(strStartDate, 'MON-dd-YYYY') desc "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                cboSmokeSchoolLectures.Items.Add(dr.Item("strSchedule"))
            End While
            dr.Close()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnSaveSmokeSchool_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveSmokeSchool.Click
        Try
            Dim title As String = txtEditTitle.Text
            Dim facility As String = txtEditCompany.Text
            Dim address1 As String = txtEditAddress.Text
            Dim city As String = txtEditCity.Text
            Dim state As String = mtbEditState.Text.ToUpper
            Dim zip As String = mtbEditZipCode.Text
            Dim phone As String = mtbEditPhoneNumber.Text
            Dim fax As String = mtbEditFaxNumber.Text
            Dim email As String = txtEditEmail.Text
            Dim ConfirmNbr As String = ""
            Dim LocationTerm As String = cboSmokeSchoolLectures.SelectedValue
            Dim fname As String = txtEditFirstName.Text
            Dim lname As String = txtEditLastName.Text
            Dim numUserID As Decimal = 0

            If cboSmokeSchoolLectures.Text <> "" And cboSmokeSchoolLectures.Items.Contains(cboSmokeSchoolLectures.Text) = True Then
                SQL = "Select " & _
                "strFirstName, strLastName " & _
                "from " & DBNameSpace & ".SmokeSchoolReservation " & _
                "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "' " & _
                "and upper(strEmail) = '" & txtWebUserEmail.Text.ToUpper & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = True Then
                    MsgBox("Student: " & txtEditFirstName.Text & " " & txtEditLastName.Text & " is already registered in the database", MsgBoxStyle.Information, "DMU Tools")
                Else
                    ConfirmNbr = ""
                    ConfirmNbr = "1111" & Now.Date.ToString("yyyy MM dd").Replace(" ", "") & Now.Hour & Now.Minute & Now.Second


                    SQL = "Insert into " & DBNameSpace & ".SmokeSchoolReservation " & _
                    "values " & _
                    "('" & Replace(txtEditTitle.Text, "'", "''") & "', " & _
                    "'" & Replace(txtEditCompany.Text, "'", "''") & "', " & _
                    "'" & Replace(txtEditAddress.Text, "'", "''") & "', " & _
                    "'', " & _
                    "'" & Replace(txtEditCity.Text, "'", "''") & "', " & _
                    "'" & mtbEditState.Text & "', " & _
                    "'" & mtbEditZipCode.Text & "', " & _
                    "'" & mtbEditPhoneNumber.Text & "', " & _
                    "'" & mtbEditFaxNumber.Text & "', " & _
                    "'" & Replace(txtWebUserEmail.Text, "'", "''") & "', " & _
                    "'" & Replace(ConfirmNbr, "'", "''") & "', " & _
                    "'" & cboSmokeSchoolLectures.Text & "', " & _
                    "'', '', " & _
                    "'" & OracleDate & "', " & _
                    "'" & Replace(txtEditFirstName.Text, "'", "''") & "', " & _
                    "'" & Replace(txtEditLastName.Text, "'", "''") & "', " & _
                    "(select " & _
                    "case when (max(numUserID) + 1) is Null then 1 " & _
                    "else max(numUserID) + 1 " & _
                    "end numUserID " & _
                    "from " & DBNameSpace & ".SmokeSchoolReservation " & _
                    "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "'), " & _
                    "'', " & _
                    "'') "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    dr.Close()

                    txtEditUserPassword.Clear()
                    txtEditFirstName.Visible = False
                    txtEditLastName.Visible = False
                    txtEditTitle.Visible = False
                    txtEditCompany.Visible = False
                    txtEditAddress.Visible = False
                    txtEditCity.Visible = False
                    mtbEditState.Visible = False
                    mtbEditZipCode.Visible = False
                    mtbEditPhoneNumber.Visible = False
                    mtbEditFaxNumber.Visible = False
                    btnSaveEditedData.Visible = False
                    txtEditUserPassword.Visible = False
                    btnChangeEmailAddress.Visible = False
                    txtEditEmail.Visible = False
                    btnUpdatePassword.Visible = False
                    gbSmokeSchoolRegistration.Visible = False
                End If
            Else
                MsgBox("Please select a valid term form the drop down box.")
            End If


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnSaveOverSmokeSchool_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveOverSmokeSchool.Click
        Try
            Dim title As String = txtEditTitle.Text
            Dim facility As String = txtEditCompany.Text
            Dim address1 As String = txtEditAddress.Text
            Dim city As String = txtEditCity.Text
            Dim state As String = mtbEditState.Text.ToUpper
            Dim zip As String = mtbEditZipCode.Text
            Dim phone As String = mtbEditPhoneNumber.Text
            Dim fax As String = mtbEditFaxNumber.Text
            Dim email As String = txtEditEmail.Text
            Dim ConfirmNbr As String = ""
            Dim LocationTerm As String = cboSmokeSchoolLectures.SelectedValue
            Dim fname As String = txtEditFirstName.Text
            Dim lname As String = txtEditLastName.Text
            Dim numUserID As Decimal = 3

            If cboSmokeSchoolLectures.Text <> "" And cboSmokeSchoolLectures.Items.Contains(cboSmokeSchoolLectures.Text) = True Then
                SQL = "Select " & _
                "strFirstName, strLastName " & _
                "from " & DBNameSpace & ".SmokeSchoolReservation " & _
                "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "' " & _
                "and upper(strEmail) = '" & txtWebUserEmail.Text.ToUpper & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = True Then
                    ConfirmNbr = ""
                    ConfirmNbr = "1111" & Now.Date.ToString("yyyy MM dd").Replace(" ", "") & Now.Hour & Now.Minute & Now.Second

                    SQL = "Update " & DBNameSpace & ".SmokeSchoolReservation set " & _
                    "strFirstName = '" & Replace(txtEditFirstName.Text, "'", "''") & "', " & _
                    "strLastName = '" & Replace(txtEditLastName.Text, "'", "''") & "', " & _
                    "strTitle = '" & Replace(txtEditTitle.Text, "'", "''") & "', " & _
                    "strCompanyName = '" & Replace(txtEditCompany.Text, "'", "''") & "', " & _
                    "strAddress1 = '" & Replace(txtEditAddress.Text, "'", "''") & "', " & _
                    "strCity = '" & Replace(txtEditCity.Text, "'", "''") & "', " & _
                    "strState = '" & mtbEditState.Text & "', " & _
                    "strZip = '" & mtbEditZipCode.Text & "', " & _
                    "strPhoneNumber = '" & mtbEditPhoneNumber.Text & "', " & _
                    "strFax = '" & mtbEditFaxNumber.Text & "', " & _
                    "strConfirmationNbr = '" & ConfirmNbr & "', " & _
                    "strLocationDate = '" & cboSmokeSchoolLectures.Text & "', " & _
                    "datTransactionDate = '" & OracleDate & "' " & _
                    "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "' " & _
                    "and upper(strEmail) = Upper('" & txtWebUserEmail.Text.ToUpper & "') "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    dr.Close()

                    txtEditUserPassword.Clear()
                    txtEditFirstName.Visible = False
                    txtEditLastName.Visible = False
                    txtEditTitle.Visible = False
                    txtEditCompany.Visible = False
                    txtEditAddress.Visible = False
                    txtEditCity.Visible = False
                    mtbEditState.Visible = False
                    mtbEditZipCode.Visible = False
                    mtbEditPhoneNumber.Visible = False
                    mtbEditFaxNumber.Visible = False
                    btnSaveEditedData.Visible = False
                    txtEditUserPassword.Visible = False
                    btnChangeEmailAddress.Visible = False
                    txtEditEmail.Visible = False
                    btnUpdatePassword.Visible = False
                    gbSmokeSchoolRegistration.Visible = False
                Else
                    MsgBox("Student: " & txtEditFirstName.Text & " " & txtEditLastName.Text & " is not registered in the database for this term.", _
                           MsgBoxStyle.Information, "DMU Tools")
                End If
            Else
                MsgBox("Please select a valid term form the drop down box.")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnDeleteSmokeSchool_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDeleteSmokeSchool.Click
        Try
            If cboSmokeSchoolLectures.Text <> "" And cboSmokeSchoolLectures.Items.Contains(cboSmokeSchoolLectures.Text) = True Then
                SQL = "Select " & _
                "strFirstName, strLastName " & _
                "from " & DBNameSpace & ".SmokeSchoolReservation " & _
                "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "' " & _
                "and upper(strEmail) = '" & txtWebUserEmail.Text.ToUpper & "' "
                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = True Then
                    SQL = "Delete " & DBNameSpace & ".SmokeSchoolReservation " & _
                    "where strLocationDate = '" & cboSmokeSchoolLectures.Text & "' " & _
                    "and upper(strEmail) = '" & txtWebUserEmail.Text.ToUpper & "' "
                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read
                    dr.Close()

                    txtEditUserPassword.Clear()
                    txtEditFirstName.Visible = False
                    txtEditLastName.Visible = False
                    txtEditTitle.Visible = False
                    txtEditCompany.Visible = False
                    txtEditAddress.Visible = False
                    txtEditCity.Visible = False
                    mtbEditState.Visible = False
                    mtbEditZipCode.Visible = False
                    mtbEditPhoneNumber.Visible = False
                    mtbEditFaxNumber.Visible = False
                    btnSaveEditedData.Visible = False
                    txtEditUserPassword.Visible = False
                    btnChangeEmailAddress.Visible = False
                    txtEditEmail.Visible = False
                    btnUpdatePassword.Visible = False
                    gbSmokeSchoolRegistration.Visible = False
                Else
                    MsgBox("Student: " & txtEditFirstName.Text & " " & txtEditLastName.Text & " is not registered in the database for this term.", _
                           MsgBoxStyle.Information, "DMU Tools")
                End If
            Else
                MsgBox("Please select a valid term form the drop down box.")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnEnroll_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnEnroll.Click
        Try
            If cboEIEnrollmentYear.Text = "" Then
                MsgBox("Please choose a Year!", MsgBoxStyle.Information, "EI Enrollment")
            Else
                Mailoutenrollment()
                cboEIEnrollmentYear.Items.Clear()
                loadEIEnrollmentYear()
                cboEIEnrollmentYear.Text = ""
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Sub Mailoutenrollment()
        Dim AirsNo As String
        Dim FacilityName As String
        Dim EIYear As Integer = CInt(cboEIEnrollmentYear.SelectedItem)
        Dim airsYear As String

        Try
            SQL = "Select * " & _
            "FROM " & DBNameSpace & ".EISI " & _
            "where STRINVENTORYYEAR = '" & EIYear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist = True Then
                MsgBox("That year " & EIYear & " is already enrolled.", MsgBoxStyle.Information, "EI Enrollment")
            Else
                SQL = "Select EImailout.STRAIRSNUMBER, eimailout.STRFACILITYNAME " & _
                "FROM " & DBNameSpace & ".EImailout " & _
                "where EImailout.STRINVENTORYYEAR = '" & EIYear & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Read()
                Do
                    AirsNo = dr("strAirsNumber")
                    airsYear = AirsNo & EIYear
                    FacilityName = dr("STRFACILITYNAME")
                    SQL2 = "Insert into " & DBNameSpace & ".EISI " & _
                    "(EISI.STRAIRSNUMBER, " & _
                    "EISI.STRFACILITYNAME, " & _
                    "EISI.STRTRANSACTIONDATE, " & _
                    "EISI.STRINVENTORYYEAR, " & _
                    "EISI.NUMUSERID, " & _
                    "EISI.STRAIRSYEAR) " & _
                    "values " & _
                    "('" & Replace(AirsNo, "'", "''") & "', " & _
                    "'" & Replace(FacilityName, "'", "''") & "', " & _
                    "'" & OracleDate & "', " & _
                    "'" & Replace(EIYear, "'", "''") & "', " & _
                    "'3', " & _
                    "'" & airsYear & "' )"

                    cmd2 = New OracleCommand(SQL2, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr2 = cmd2.ExecuteReader
                    dr2.Close()
                Loop While dr.Read
                MsgBox("The facilities for year " & EIYear & " have been enrolled", MsgBoxStyle.Information, "EI Enrollment")
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnDeEnroll_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDeEnroll.Click

        Dim EIYear As Integer = CInt(cboEIEnrollmentYear.SelectedItem)
        Dim sql As String
        Try
            If cboEIEnrollmentYear.Text = "" Then
                MsgBox("Please choose a year!", MsgBoxStyle.Information, "EI Enrollment")
            Else
                Dim intAnswer As DialogResult
                intAnswer = MessageBox.Show("Remove the enrollment?", "EI Enrollment", MessageBoxButtons.OKCancel, MessageBoxIcon.Information)
                Select Case intAnswer
                    Case Windows.Forms.DialogResult.OK
                        sql = "delete from " & DBNameSpace & ".EISI " & _
                        "where EISI.STRINVENTORYYEAR = '" & EIYear & "'"
                        cmd = New OracleCommand(sql, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()
                        MsgBox("Enrollment has been removed!", MsgBoxStyle.Information, "EI Enrollment")
                    Case Else
                        MsgBox("Enrollment has not been removed!", MsgBoxStyle.Information, "EI Enrollment")
                End Select

                cboEIEnrollmentYear.Items.Clear()
                loadEIEnrollmentYear()
                cboEIEnrollmentYear.Text = ""
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnaddEIlist_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnaddEIlist.Click
        Try
            addonefacilityEI()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub addonefacilityEI()
        Dim AirsNo As String = "0413" & txtEIairsNumber.Text
        Dim EIYear As Integer = txtaddEIYear.Text
        Dim airsYear As String = AirsNo & EIYear
        Dim facilityName As String


        Try

            SQL = "Select " & DBNameSpace & ".EISI.STRINVENTORYYEAR " & _
          "FROM " & DBNameSpace & ".EISI " & _
          "where  EISI.STRINVENTORYYEAR = '" & EIYear & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read


            If recExist = True Then


                SQL = "Select " & DBNameSpace & ".APBFACILITYINFORMATION.STRFACILITYNAME " & _
               "FROM " & DBNameSpace & ".APBFACILITYINFORMATION " & _
               "where  APBFACILITYINFORMATION.STRAIRSNUMBER = '" & AirsNo & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read


                If recExist = True Then
                    facilityName = dr("STRFACILITYNAME")

                    SQL = "Select * " & _
                             "FROM " & DBNameSpace & ".EISI " & _
                             "where STRINVENTORYYEAR = '" & EIYear & "' " & _
                             " And STRAIRSNUMBER = '" & AirsNo & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read

                    If recExist = True Then
                        MsgBox("This facility (" & AirsNo & ") is already enrolled for " & EIYear & ".", MsgBoxStyle.Information, "EI Enrollment")
                    Else
                        SQL2 = "Insert into " & DBNameSpace & ".EISI " & _
                        "(EISI.STRAIRSNUMBER, " & _
                        "EISI.STRFACILITYNAME, " & _
                        "EISI.STRTRANSACTIONDATE, " & _
                        "EISI.STRINVENTORYYEAR, " & _
                        "EISI.NUMUSERID, " & _
                        "EISI.STRAIRSYEAR) " & _
                        "values " & _
                        "('" & Replace(AirsNo, "'", "''") & "', " & _
                        "'" & Replace(facilityName, "'", "''") & "', " & _
                        "'" & OracleDate & "', " & _
                        "'" & Replace(EIYear, "'", "''") & "', " & _
                        "'3', " & _
                        "'" & airsYear & "' )"

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader
                        dr2.Close()

                        MsgBox("This facility (" & AirsNo & ") have been enrolled for " & EIYear & ".", MsgBoxStyle.Information, "EI Enrollment")
                    End If

                Else

                    MsgBox("This Airs Number (" & AirsNo & ") is not valid. Please enter valid Airs Number.", MsgBoxStyle.Information, "EI Enrollment")
                End If
            Else
                MsgBox("This year (" & EIYear & ") have not been enrolled.", MsgBoxStyle.Information, "EI Enrollment")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnremoveEIlist_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnremoveEIlist.Click
        Dim EIYear As Integer = txtaddEIYear.Text
        Dim AirsNo As String = "0413" & txtEIairsNumber.Text

        Dim sql As String
        Try

            Dim intAnswer As DialogResult
            intAnswer = MessageBox.Show("Remove this facility (" & AirsNo & ") for " & EIYear & "?", "EI Enrollment", MessageBoxButtons.OKCancel, MessageBoxIcon.Information)
            Select Case intAnswer
                Case Windows.Forms.DialogResult.OK
                    sql = "delete from " & DBNameSpace & ".EISI " & _
                    "where EISI.STRINVENTORYYEAR = '" & EIYear & "'" & _
                    " And STROPTOUT is null" & _
                    " And STRAIRSNUMBER = '" & AirsNo & "'"
                    cmd = New OracleCommand(sql, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    dr.Close()
                    MsgBox("This Facility (" & AirsNo & ") has been removed for " & EIYear & "!", MsgBoxStyle.Information, "EI Enrollment")
                Case Else
                    MsgBox("This Facility (" & AirsNo & ") has not been removed for " & EIYear & "!", MsgBoxStyle.Information, "EI Enrollment")
            End Select
            'Dim intAnswer As Integer
            'intAnswer = MsgBox("Remove this facility?", MsgBoxStyle.OkCancel)
            'If intAnswer = vbOK Then
            '    sql = "delete from " & DBNameSpace & ".EISI " & _
            '        "where STRINVENTORYYEAR = '" & EIYear & "' " & _
            '        " And STRAIRSNUMBER = '" & AirsNo & "'"
            '    cmd = New OracleCommand(sql, conn)
            '    If conn.State = ConnectionState.Closed Then
            '        conn.Open()
            '    End If
            '    dr = cmd.ExecuteReader
            '    dr.Close()
            '    MsgBox("This Facility has been removed!", MsgBoxStyle.Information, "EI Enrollment")
            'Else
            '    MsgBox("This Facility has not been removed!", MsgBoxStyle.Information, "EI Enrollment")
            'End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewEIExtraResponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewEIExtraResponse.LinkClicked
        Try

            Dim year As String = txtEIYear.Text


            SQL = "SELECT dt_NotInMailout.SchemaAIRS, " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTCOMPANYNAME, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".EISI.STRCONTACTPHONENUMBER1 " & _
            "from (Select " & DBNameSpace & ".EISI.STRAIRSYEAR AS SchemaAIRS, " & _
            "" & DBNameSpace & ".EIMailout.STRAIRSYEAR AS MailoutAIRS" & _
            " From " & DBNameSpace & ".EIMailout, " & DBNameSpace & ".EISI" & _
            " Where " & DBNameSpace & ".EIMailout.STRAIRSYEAR (+)= " & DBNameSpace & ".EISI.STRAIRSYEAR " & _
            "AND " & DBNameSpace & ".EISI.STRINVENTORYYEAR=  '" & year & "' " & _
            "AND " & DBNameSpace & ".EISI.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".EISI " & _
            "Where " & DBNameSpace & ".EISI.STRAIRSYEAR = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"

            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").HeaderText = "Phone No."
            dgvEIDataCount.Columns("STRCONTACTPHONENUMBER1").DisplayIndex = 6

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

            'txtEIRecordNumber.Text = txtextraResponse.Text
            'clearEIData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewRemovedFacilities_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewRemovedFacilities.LinkClicked
        Try

            Dim year As String = txtEIYear.Text


            SQL = "SELECT " & DBNameSpace & ".eiMailOut.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".eiMailOut.STRFACILITYNAME " & _
            "from  " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
            "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & year & "' " & _
            "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".EISI.STRAIRSYEAR is NULL"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"

            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString
            'clearEIData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblViewMailoutNonResponses_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewMailoutNonResponses.LinkClicked
        Try

            Dim year As String = txtEIYear.Text


            SQL = "SELECT " & DBNameSpace & ".eiMailOut.STRAIRSNUMBER, " & _
             "" & DBNameSpace & ".eiMailOut.STRFACILITYNAME, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTFIRSTNAME, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTLASTNAME, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTCOMPANYname, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTADDRESS1, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTCITY, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTSTATE, " & _
             "" & DBNameSpace & ".eiMailOut.STRCONTACTZIPCODE, " & _
              "" & DBNameSpace & ".eiMailOut.STRCONTACTEMAIL " & _
            "from  " & DBNameSpace & ".eImailout, " & DBNameSpace & ".EISI " & _
             "where " & DBNameSpace & ".eImailout.STRINVENTORYYEAR = '" & year & "' " & _
             "and " & DBNameSpace & ".eImailout.STRAIRSYEAR = " & DBNameSpace & ".EISI.STRAIRSYEAR(+) " & _
             "and " & DBNameSpace & ".EISI.strOptOut is NULL"


            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"

            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvEIDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvEIDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").HeaderText = "Contact Company"
            dgvEIDataCount.Columns("STRCONTACTCOMPANYNAME").DisplayIndex = 4
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Contact Address"
            dgvEIDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvEIDataCount.Columns("STRCONTACTCITY").HeaderText = "Contact City"
            dgvEIDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvEIDataCount.Columns("STRCONTACTSTATE").HeaderText = "Contact State"
            dgvEIDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Contact Zip"
            dgvEIDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvEIDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvEIDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

            'clearEIData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewExtraNonResponses_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewExtraNonResponses.LinkClicked
        Try

            Dim year As String = txtEIYear.Text


            SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".EISI.STRFACILITYNAME " & _
           "from " & DBNameSpace & ".EISI " & _
                " where  not exists (select * from " & DBNameSpace & ".EIMAILOUT " & _
                " where " & DBNameSpace & ".EISI.STRAIRSNUMBER = " & DBNameSpace & ".EIMAILOUT.STRAIRSNUMBER" & _
                " and EISI.STRINVENTORYYEAR = EIMAILOUT.STRINVENTORYYEAR) " & _
                " and " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "' " & _
                " and " & DBNameSpace & ".EISI.STROPTOUT is null"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIDataCount.DataSource = dsViewCount
            dgvEIDataCount.DataMember = "ViewCount"

            dgvEIDataCount.RowHeadersVisible = False
            dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIDataCount.AllowUserToResizeColumns = True
            dgvEIDataCount.AllowUserToAddRows = False
            dgvEIDataCount.AllowUserToDeleteRows = False
            dgvEIDataCount.AllowUserToOrderColumns = True
            dgvEIDataCount.AllowUserToResizeRows = True

            dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1

            txtextraResponse.Text = dgvEIDataCount.RowCount.ToString

            txtEIRecordNumber.Text = txtExtraNonResponses.Text
            'clearEIData()
            'ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblViewEnrollmentlist_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblViewEnrollmentlist.LinkClicked
        Try

            Dim year As String = cboEIEnrollmentYear.Text

            If cboEIEnrollmentYear.Text = "" Then

                MsgBox("Please choose a year to view!", MsgBoxStyle.Information, "EI Enrollment")

            Else
                SQL = "SELECT " & DBNameSpace & ".EISI.STRAIRSNUMBER, " & _
        "" & DBNameSpace & ".EISI.STRFACILITYNAME, " & _
        "" & DBNameSpace & ".EISI.STRTRANSACTIONDATE " & _
        "from " & DBNameSpace & ".EISI " & _
        "where " & DBNameSpace & ".EISI.STRINVENTORYYEAR = '" & year & "'"

                dsViewCount = New DataSet
                daViewCount = New OracleDataAdapter(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                daViewCount.Fill(dsViewCount, "ViewCount")
                dgvEIDataCount.DataSource = dsViewCount
                dgvEIDataCount.DataMember = "ViewCount"

                dgvEIDataCount.RowHeadersVisible = False
                dgvEIDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                dgvEIDataCount.AllowUserToResizeColumns = True
                dgvEIDataCount.AllowUserToAddRows = False
                dgvEIDataCount.AllowUserToDeleteRows = False
                dgvEIDataCount.AllowUserToOrderColumns = True
                dgvEIDataCount.AllowUserToResizeRows = True

                dgvEIDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
                dgvEIDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
                dgvEIDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
                dgvEIDataCount.Columns("strFacilityName").DisplayIndex = 1
                dgvEIDataCount.Columns("STRTRANSACTIONDATE").HeaderText = "Transaction Date"
                dgvEIDataCount.Columns("STRTRANSACTIONDATE").DisplayIndex = 2

                txtEIRecordNumber.Text = dgvEIDataCount.RowCount.ToString

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btncheckEnrollment_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btncheckEnrollment.Click
        Dim AirsNo As String = "0413" & txtEIairsNumber.Text
        Dim EIYear As Integer = txtaddEIYear.Text
        Dim airsYear As String = AirsNo & EIYear

        Try
            SQL = "Select * " & _
            "FROM " & DBNameSpace & ".EISI " & _
            "where STRINVENTORYYEAR = '" & EIYear & "' " & _
            " And STRAIRSNUMBER = '" & AirsNo & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist = True Then
                MsgBox("This facility (" & AirsNo & ") have been enrolled for " & EIYear & "!", MsgBoxStyle.Information, "EI Enrollment")
            Else
                MsgBox("This facility (" & AirsNo & ") is not enrolled for " & EIYear & "!", MsgBoxStyle.Information, "EI Enrollment")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnESenrollment_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnESenrollment.Click
        Try
            If cboESYear.Text = "" Then
                MsgBox("Please choose a Year!", MsgBoxStyle.Information, "ES Enrollment")
            Else
                ESMailoutenrollment()
                cboESYear.Items.Clear()
                loadESEnrollmentYear()
                cboESYear.Text = ""
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Sub ESMailoutenrollment()
        Dim AirsNo As String
        Dim FacilityName As String
        Dim ESYear As Integer = CInt(cboESYear.SelectedItem)
        Dim airsYear As String

        Try
            SQL = "Select * " & _
            "FROM " & DBNameSpace & ".ESSCHEMA " & _
            "where ESSCHEMA.INTESYEAR = '" & ESYear & "'"

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist = True Then
                MsgBox("That year " & ESYear & " is already enrolled.", MsgBoxStyle.Information, "EI Enrollment")
            Else
                SQL = "Select ESMAILOUT.STRAIRSNUMBER, ESMAILOUT.STRFACILITYNAME " & _
                "FROM " & DBNameSpace & ".ESMAILOUT " & _
                "where ESMAILOUT.STRESYEAR = '" & ESYear & "'"

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Read()
                Do
                    AirsNo = dr("strAirsNumber")
                    airsYear = AirsNo & ESYear
                    FacilityName = dr("STRFACILITYNAME")
                    SQL2 = "Insert into " & DBNameSpace & ".ESSCHEMA " & _
                    "(ESSCHEMA.STRAIRSNUMBER, " & _
                    "ESSCHEMA.STRFACILITYNAME, " & _
                    "ESSCHEMA.DATTRANSACTION, " & _
                    "ESSCHEMA.INTESYEAR, " & _
                    "ESSCHEMA.NUMUSERID, " & _
                    "ESSCHEMA.STRAIRSYEAR) " & _
                    "values " & _
                    "('" & Replace(AirsNo, "'", "''") & "', " & _
                    "'" & Replace(FacilityName, "'", "''") & "', " & _
                    "'" & OracleDate & "', " & _
                    "'" & Replace(ESYear, "'", "''") & "', " & _
                    "'3', " & _
                    "'" & airsYear & "' )"

                    cmd2 = New OracleCommand(SQL2, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr2 = cmd2.ExecuteReader
                    dr2.Close()
                Loop While dr.Read
                MsgBox("The facilities for year " & ESYear & " have been enrolled", MsgBoxStyle.Information, "EI Enrollment")
            End If
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnESdeenrollment_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnESdeenrollment.Click
        Dim ESYear As Integer = CInt(cboESYear.SelectedItem)
        Dim sql As String
        Try
            If cboESYear.Text = "" Then
                MsgBox("Please choose a year!", MsgBoxStyle.Information, "ES Enrollment")
            Else
                Dim intAnswer As DialogResult
                intAnswer = MessageBox.Show("Remove the enrollment?", "ES Enrollment", MessageBoxButtons.OKCancel, MessageBoxIcon.Information)
                Select Case intAnswer
                    Case Windows.Forms.DialogResult.OK
                        sql = "delete from " & DBNameSpace & ".ESSCHEMA " & _
                        "where ESSCHEMA.INTESYEAR = '" & ESYear & "'"
                        cmd = New OracleCommand(sql, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr = cmd.ExecuteReader
                        dr.Close()
                        MsgBox("Enrollment has been removed!", MsgBoxStyle.Information, "ES Enrollment")
                    Case Else
                        MsgBox("Enrollment has not been removed!", MsgBoxStyle.Information, "ES Enrollment")
                End Select

                cboESYear.Items.Clear()
                loadESEnrollmentYear()
                cboESYear.Text = ""
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnaddfacilitytoES_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnaddfacilitytoES.Click
        Try
            addonefacilityES()
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub addonefacilityES()
        Dim AirsNo As String = "0413" & txtESairNumber.Text
        Dim ESYear As Integer = txtESYearforFacility.Text
        Dim airsYear As String = AirsNo & ESYear
        Dim facilityName As String


        Try

            SQL = "Select " & DBNameSpace & ".ESSCHEMA.INTESYEAR " & _
          "FROM " & DBNameSpace & ".ESSCHEMA " & _
          "where  ESSCHEMA.INTESYEAR = '" & ESYear & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read


            If recExist = True Then


                SQL = "Select " & DBNameSpace & ".APBFACILITYINFORMATION.STRFACILITYNAME " & _
               "FROM " & DBNameSpace & ".APBFACILITYINFORMATION " & _
               "where  APBFACILITYINFORMATION.STRAIRSNUMBER = '" & AirsNo & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read


                If recExist = True Then
                    facilityName = dr("STRFACILITYNAME")

                    SQL = "Select * " & _
                             "FROM " & DBNameSpace & ".ESSCHEMA " & _
                             "where ESSCHEMA.INTESYEAR = '" & ESYear & "' " & _
                             " And ESSCHEMA.STRAIRSNUMBER = '" & AirsNo & "' "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    recExist = dr.Read

                    If recExist = True Then
                        MsgBox("This facility (" & AirsNo & ") is already enrolled for " & ESYear & ".", MsgBoxStyle.Information, "ES Enrollment")
                    Else
                        SQL2 = "Insert into " & DBNameSpace & ".ESSCHEMA " & _
                        "(ESSCHEMA.STRAIRSNUMBER, " & _
                        "ESSCHEMA.STRFACILITYNAME, " & _
                        "ESSCHEMA.DATTRANSACTION, " & _
                        "ESSCHEMA.INTESYEAR, " & _
                        "ESSCHEMA.NUMUSERID, " & _
                        "ESSCHEMA.STRAIRSYEAR) " & _
                        "values " & _
                        "('" & Replace(AirsNo, "'", "''") & "', " & _
                        "'" & Replace(facilityName, "'", "''") & "', " & _
                        "'" & OracleDate & "', " & _
                        "'" & Replace(ESYear, "'", "''") & "', " & _
                        "'3', " & _
                        "'" & airsYear & "' )"

                        cmd2 = New OracleCommand(SQL2, conn)
                        If conn.State = ConnectionState.Closed Then
                            conn.Open()
                        End If
                        dr2 = cmd2.ExecuteReader
                        dr2.Close()

                        MsgBox("This facility (" & AirsNo & ") has been enrolled for " & ESYear & ".", MsgBoxStyle.Information, "ES Enrollment")
                    End If

                Else

                    MsgBox("This Airs Number (" & AirsNo & ") is not valid. Please enter valid Airs Number.", MsgBoxStyle.Information, "ES Enrollment")
                End If
            Else
                MsgBox("This year (" & ESYear & ") has not been enrolled.", MsgBoxStyle.Information, "ES Enrollment")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnremoveFacilityES_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnremoveFacilityES.Click
        Dim ESYear As Integer = txtESYearforFacility.Text
        Dim AirsNo As String = "0413" & txtESairNumber.Text

        Dim sql As String
        Try

            Dim intAnswer As DialogResult
            intAnswer = MessageBox.Show("Remove this facility (" & AirsNo & ") for " & ESYear & "?", "ES Enrollment", MessageBoxButtons.OKCancel, MessageBoxIcon.Information)
            Select Case intAnswer
                Case Windows.Forms.DialogResult.OK
                    sql = "delete from " & DBNameSpace & ".ESSCHEMA " & _
                    "where ESSCHEMA.INTESYEAR = '" & ESYear & "'" & _
                    " And ESSCHEMA.STRAIRSNUMBER = '" & AirsNo & "'"
                    cmd = New OracleCommand(sql, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    dr.Close()
                    MsgBox("This Facility (" & AirsNo & ") has been removed for " & ESYear & "!", MsgBoxStyle.Information, "ES Enrollment")
                Case Else
                    MsgBox("This Facility (" & AirsNo & ") has not been removed for " & ESYear & "!", MsgBoxStyle.Information, "ES Enrollment")
            End Select

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnCheckESstatus_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnCheckESstatus.Click
        Dim AirsNo As String = "0413" & txtESairNumber.Text
        Dim ESYear As Integer = txtESYearforFacility.Text
        Dim airsYear As String = AirsNo & ESYear

        Try
            SQL = "Select strAIRSYear as RowCount " & _
            "FROM " & DBNameSpace & ".ESSCHEMA " & _
            "where " & DBNameSpace & ".ESSCHEMA.INTESYEAR = '" & ESYear & "' " & _
            " And " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER = '" & AirsNo & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader

            recExist = dr.Read

            If recExist = True Then
                MsgBox("This facility (" & AirsNo & ") has been enrolled for " & ESYear & "!", MsgBoxStyle.Information, "ES Enrollment")
            Else
                MsgBox("This facility (" & AirsNo & ") is not enrolled for " & ESYear & "!", MsgBoxStyle.Information, "ES Enrollment")
            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewESenrollment_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewESenrollment.LinkClicked
        Try

            Dim year As String = cboESYear.Text

            If cboESYear.Text = "" Then

                MsgBox("Please choose a year to view!", MsgBoxStyle.Information, "ES Enrollment")

            Else
                SQL = "SELECT " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER, " & _
        "" & DBNameSpace & ".ESSCHEMA.STRFACILITYNAME, " & _
        "" & DBNameSpace & ".ESSCHEMA.DATTRANSACTION " & _
        "from " & DBNameSpace & ".ESSCHEMA " & _
        "where " & DBNameSpace & ".ESSCHEMA.INTESYEAR = '" & year & "'"

                dsViewCount = New DataSet
                daViewCount = New OracleDataAdapter(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                daViewCount.Fill(dsViewCount, "ViewCount")
                dgvESDataCount.DataSource = dsViewCount
                dgvESDataCount.DataMember = "ViewCount"

                dgvESDataCount.RowHeadersVisible = False
                dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                dgvESDataCount.AllowUserToResizeColumns = True
                dgvESDataCount.AllowUserToAddRows = False
                dgvESDataCount.AllowUserToDeleteRows = False
                dgvESDataCount.AllowUserToOrderColumns = True
                dgvESDataCount.AllowUserToResizeRows = True

                dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
                dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
                dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
                dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
                dgvESDataCount.Columns("DATTRANSACTION").HeaderText = "Transaction Date"
                dgvESDataCount.Columns("DATTRANSACTION").DisplayIndex = 2

                txtRecordNumber.Text = dgvESDataCount.RowCount.ToString



            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewESextraresponder_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewESextraresponder.LinkClicked
        Try

            Dim year As String = txtESYear.Text
            Dim intyear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".esSchema.STRFACILITYNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTFIRSTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTLASTNAME, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTCOMPANY, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTEMAIL, " & _
            "" & DBNameSpace & ".esSchema.STRCONTACTPHONENUMBER " & _
            "from (Select " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER AS SchemaAIRS, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRAIRSNUMBER AS MailoutAIRS" & _
            " From " & DBNameSpace & ".ESMailout, " & DBNameSpace & ".ESSCHEMA" & _
            " Where " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR (+)= " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR " & _
            "AND ESSCHEMA.INTESYEAR=  '" & intyear & "' " & _
            "AND " & DBNameSpace & ".ESSCHEMA.STROPTOUT IS NOT NULL) " & _
            "dt_NotInMailout, " & _
            "" & DBNameSpace & ".ESSCHEMA " & _
            "Where " & DBNameSpace & ".ESSCHEMA.STRAIRSNUMBER = SchemaAIRS " & _
            "AND MailoutAIRS is NULL"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"

            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANY").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANY").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").HeaderText = "Phone No."
            dgvESDataCount.Columns("STRCONTACTPHONENUMBER").DisplayIndex = 6

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString
            '    txtextraResponse.Text = dgvESDataCount.RowCount.ToString

            clearESData()
            ClearMailOut()

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewESremovedfacility_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewESremovedfacility.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try

            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".ESMAILOUT.STRAIRSNUMBER, " & _
            "" & DBNameSpace & ".ESMAILOUT.STRFACILITYNAME " & _
            "from " & DBNameSpace & ".esSchema, " & DBNameSpace & ".esmailout " & _
            "where " & DBNameSpace & ".esMailOut.strESyear = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esSchema.STRAIRSYEAR is null " & _
            "and " & DBNameSpace & ".ESMAILOUT.STRAIRSYEAR = " & DBNameSpace & ".ESSCHEMA.STRAIRSYEAR(+) " & _
            "order by " & DBNameSpace & ".ESMAILOUT.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"

            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewmailoutnonresponder_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewmailoutnonresponder.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try

            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esMailOut.STRAIRSNUMBER, " & _
             "" & DBNameSpace & ".esMailOut.STRFACILITYNAME, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTFIRSTNAME, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTLASTNAME, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTCOMPANYname, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTADDRESS1, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTCITY, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTSTATE, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTZIPCODE, " & _
             "" & DBNameSpace & ".esMailOut.STRCONTACTEMAIL " & _
            "from  " & DBNameSpace & ".esmailout, " & DBNameSpace & ".ESSchema " & _
            "where " & DBNameSpace & ".esmailout.strESYEAR = '" & intYear & "' " & _
            "and " & DBNameSpace & ".esmailout.STRAIRSYEAR = " & DBNameSpace & ".ESSchema.STRAIRSYEAR(+) " & _
            "and " & DBNameSpace & ".ESSchema.strOptOut is NULL " & _
            "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"

            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").HeaderText = "Contact First Name"
            dgvESDataCount.Columns("STRCONTACTFIRSTNAME").DisplayIndex = 2
            dgvESDataCount.Columns("STRCONTACTLASTNAME").HeaderText = "Contact Last Name"
            dgvESDataCount.Columns("STRCONTACTLASTNAME").DisplayIndex = 3
            dgvESDataCount.Columns("STRCONTACTCOMPANYNAME").HeaderText = "Contact Company"
            dgvESDataCount.Columns("STRCONTACTCOMPANYNAME").DisplayIndex = 4
            dgvESDataCount.Columns("STRCONTACTADDRESS1").HeaderText = "Contact Address"
            dgvESDataCount.Columns("STRCONTACTADDRESS1").DisplayIndex = 5
            dgvESDataCount.Columns("STRCONTACTCITY").HeaderText = "Contact City"
            dgvESDataCount.Columns("STRCONTACTCITY").DisplayIndex = 6
            dgvESDataCount.Columns("STRCONTACTSTATE").HeaderText = "Contact State"
            dgvESDataCount.Columns("STRCONTACTSTATE").DisplayIndex = 7
            dgvESDataCount.Columns("STRCONTACTZIPCODE").HeaderText = "Contact Zip"
            dgvESDataCount.Columns("STRCONTACTZIPCODE").DisplayIndex = 8
            dgvESDataCount.Columns("STRCONTACTEMAIL").HeaderText = "Contact Email"
            dgvESDataCount.Columns("STRCONTACTEMAIL").DisplayIndex = 9

            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewextraNonresponse_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewextraNonresponse.LinkClicked
        txtESYear.Text = cboYear.SelectedItem
        Try

            Dim year As String = txtESYear.Text
            Dim intYear As Integer = Int(year)

            SQL = "SELECT " & DBNameSpace & ".esSchema.STRAIRSNUMBER, " & _
                "" & DBNameSpace & ".esSchema.STRFACILITYNAME " & _
                "from " & DBNameSpace & ".ESSchema " & _
                " where  not exists (select * from " & DBNameSpace & ".ESMAILOUT " & _
                " where " & DBNameSpace & ".ESSchema.STRAIRSNUMBER = " & DBNameSpace & ".ESMAILOUT.STRAIRSNUMBER" & _
                " and ESSchema.INTESYEAR = ESMAILOUT.strESYEAR) " & _
                " and " & DBNameSpace & ".ESSchema.INTESYEAR = '" & intYear & "' " & _
                " and " & DBNameSpace & ".ESSchema.STROPTOUT is null   " & _
                "order by " & DBNameSpace & ".esSchema.STRFACILITYNAME"


            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvESDataCount.DataSource = dsViewCount
            dgvESDataCount.DataMember = "ViewCount"

            dgvESDataCount.RowHeadersVisible = False
            dgvESDataCount.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvESDataCount.AllowUserToResizeColumns = True
            dgvESDataCount.AllowUserToAddRows = False
            dgvESDataCount.AllowUserToDeleteRows = False
            dgvESDataCount.AllowUserToOrderColumns = True
            dgvESDataCount.AllowUserToResizeRows = True

            dgvESDataCount.Columns("STRAIRSNUMBER").HeaderText = "Airs No."
            dgvESDataCount.Columns("STRAIRSNUMBER").DisplayIndex = 0
            dgvESDataCount.Columns("strFacilityName").HeaderText = "Facility Name"
            dgvESDataCount.Columns("strFacilityName").DisplayIndex = 1
            txtRecordNumber.Text = dgvESDataCount.RowCount.ToString

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewEIThreshold_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewEIThreshold.LinkClicked

        Try

            Dim EItype As String = cboEItype.SelectedItem
            Dim EItypeYear As String = lblEITypeYear.Text

            SQL = "SELECT " & DBNameSpace & ".EITHRESHOLDYEARS.STREITYPE " & _
                   "from  " & DBNameSpace & ".EITHRESHOLDYEARS  " & _
          "where " & DBNameSpace & ".EITHRESHOLDYEARS.STRYEAR = '" & EItypeYear & "' "
            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            While dr.Read
                If IsDBNull(dr("STREITYPE")) Then
                    cboEItype.Text = ""
                Else
                    cboEItype.Text = dr("STREITYPE")
                End If
                EItype = cboEItype.SelectedItem
            End While
            SQL = "SELECT " & DBNameSpace & ".EITHRESHOLDS.STRPOLLUTANT, " & _
            "" & DBNameSpace & ".EITHRESHOLDS.NUMTHRESHOLD, " & _
                "" & DBNameSpace & ".EITHRESHOLDS.NUMTHRESHOLDNAA " & _
            "from  " & DBNameSpace & ".EITHRESHOLDS  " & _
            "where " & DBNameSpace & ".EITHRESHOLDS.STRTYPE = '" & EItype & "' " & _
             " order by " & DBNameSpace & ".EITHRESHOLDS.STRPOLLUTANT"

            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIThreshold.DataSource = dsViewCount
            dgvEIThreshold.DataMember = "ViewCount"

            dgvEIThreshold.RowHeadersVisible = False
            dgvEIThreshold.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIThreshold.AllowUserToResizeColumns = True
            dgvEIThreshold.AllowUserToAddRows = False
            dgvEIThreshold.AllowUserToDeleteRows = False
            dgvEIThreshold.AllowUserToOrderColumns = True
            dgvEIThreshold.AllowUserToResizeRows = True

            dgvEIThreshold.Columns("STRPOLLUTANT").HeaderText = "Pollutant Name"
            dgvEIThreshold.Columns("STRPOLLUTANT").DisplayIndex = 0
            dgvEIThreshold.Columns("NUMTHRESHOLD").HeaderText = "Threshold (TPY)"
            dgvEIThreshold.Columns("NUMTHRESHOLD").DisplayIndex = 1
            dgvEIThreshold.Columns("NUMTHRESHOLDNAA").HeaderText = "Threshold in NAA (TPY)"
            dgvEIThreshold.Columns("NUMTHRESHOLDNAA").DisplayIndex = 2


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub cboEIMailoutYear_TextChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cboEIMailoutYear.TextChanged
        Try
            lblEITypeYear.Text = cboEIMailoutYear.Text
        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub
    Private Sub btnSaveEIType_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveEIType.Click
        Dim EItype As String = cboEItype.Text
        Dim EItypeYear As String = lblEITypeYear.Text


        Try

            SQL = "Select " & DBNameSpace & ".EITHRESHOLDYEARS.STRYEAR " & _
          "FROM " & DBNameSpace & ".EITHRESHOLDYEARS " & _
          "where  EITHRESHOLDYEARS.STRYEAR = '" & EItypeYear & "' "

            cmd = New OracleCommand(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            dr = cmd.ExecuteReader
            recExist = dr.Read

            If recExist = True Then
                SQL = "Update " & DBNameSpace & ".EITHRESHOLDYEARS set " & _
                "STREITYPE = '" & EItype & "' " & _
                "where " & DBNameSpace & ".EITHRESHOLDYEARS.STRYEAR = '" & EItypeYear & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                dr.Close()
                MsgBox("The info has been updated", MsgBoxStyle.Information, "EI Tools")

            Else

                SQL = "Insert into " & DBNameSpace & ".EITHRESHOLDYEARS " & _
                 "(STRYEAR, STREITYPE ) " & _
                 "values " & _
                 "('" & EItypeYear & "', '" & EItype & "') "

                MsgBox("The info has been inserted", MsgBoxStyle.Information, "EI Tools")

            End If

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnAddNewEIType_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnAddNewEIType.Click
        Dim EItype2 As String = txtNewEIType.Text
        Dim EItypeYear As String = lblEITypeYear.Text
        Dim temp As String

        Try
            If txtNewEIType.Text = "" Then
                MsgBox("Please enter new EI type!", MsgBoxStyle.Information, "EI Tools")
            Else
                SQL = "Select " & DBNameSpace & ".EITHRESHOLDS.STRTYPE " & _
                                " FROM " & DBNameSpace & ".EITHRESHOLDS " & _
                                "where   " & DBNameSpace & ".EITHRESHOLDS.STRTYPE = '" & Replace(EItype2, "'", "''") & "' "

                cmd = New OracleCommand(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                dr = cmd.ExecuteReader
                recExist = dr.Read
                dr.Close()

                If recExist = True Then
                    MsgBox("EI type already exist. Please enter new type! ", MsgBoxStyle.Information, "EI Tools")
                Else
                    SQL = "Select distinct(" & DBNameSpace & ".EITHRESHOLDS.STRPOLLUTANT) as Pollutant " & _
                   " FROM " & DBNameSpace & ".EITHRESHOLDS "

                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If

                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("Pollutant")) Then
                            temp = ""
                        Else
                            temp = dr.Item("Pollutant")
                        End If

                        If temp <> "" Then
                            SQL = "Insert into AIRBranch.EIThresholds " & _
                                "Values " & _
                                "('" & Replace(temp, "'", "''") & "', " & _
                                "'', '', '" & Replace(EItype2, "'", "''") & "', " & _
                                "(Select max(PollutantID) + 1 from AIRBranch.EIThresholds) ) "
                            cmd2 = New OracleCommand(SQL, conn)
                            If conn.State = ConnectionState.Closed Then
                                conn.Open()
                            End If
                            dr2 = cmd2.ExecuteReader
                            dr2.Close()
                        End If
                    End While
                    cboEIType2.Items.Clear()
                    cboEItype.Items.Clear()
                    loadEIType()
                    cboEIType2.Text = ""
                    cboEItype.Text = ""
                    dr.Close()

                    MsgBox("The info has been inserted", MsgBoxStyle.Information, "EI Tools")

                End If



                SQL = "Select * " & _
                    " FROM " & DBNameSpace & ".EITHRESHOLDS " & _
                    "where   " & DBNameSpace & ".EITHRESHOLDS.STRTYPE = '" & Replace(EItype2, "'", "''") & "' "

                dsViewCount = New DataSet
                daViewCount = New OracleDataAdapter(SQL, conn)
                If conn.State = ConnectionState.Closed Then
                    conn.Open()
                End If
                cmdBuild = New OracleCommandBuilder(daViewCount)

                daViewCount.Fill(dsViewCount, "ViewCount")
                dgvEIThresholds.DataSource = dsViewCount
                dgvEIThresholds.DataMember = "ViewCount"

                dgvEIThresholds.RowHeadersVisible = True
                dgvEIThresholds.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
                dgvEIThresholds.AllowUserToResizeColumns = True
                dgvEIThresholds.AllowUserToAddRows = True
                dgvEIThresholds.AllowUserToDeleteRows = True
                dgvEIThresholds.AllowUserToOrderColumns = True
                dgvEIThresholds.AllowUserToResizeRows = True


                dgvEIThresholds.Columns("STRPOLLUTANT").HeaderText = "Pollutant Name"
                dgvEIThresholds.Columns("STRPOLLUTANT").DisplayIndex = 0
                dgvEIThresholds.Columns("NUMTHRESHOLD").HeaderText = "Thresholds (TPY)"
                dgvEIThresholds.Columns("NUMTHRESHOLD").DisplayIndex = 1
                dgvEIThresholds.Columns("NUMTHRESHOLDNAA").HeaderText = "Thresholds in NAA (TPY)"
                dgvEIThresholds.Columns("NUMTHRESHOLDNAA").DisplayIndex = 2
                dgvEIThresholds.Columns("STRTYPE").HeaderText = "EI Type"
                dgvEIThresholds.Columns("STRTYPE").DisplayIndex = 3


            End If



        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub btnSaveEIThresholds_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSaveEIThresholds.Click
        Try

            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            daViewCount.Update(dsViewCount, "ViewCount")
            conn.Close()

            MessageBox.Show("The Update has Completed!", "EI Tool")

        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub lblviewEIthreshold2_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles lblviewEIthreshold2.LinkClicked
        Try
            Dim EItype2 As String = cboEIType2.SelectedItem

            SQL = "Select * " & _
                " FROM " & DBNameSpace & ".EITHRESHOLDS " & _
                "where   " & DBNameSpace & ".EITHRESHOLDS.STRTYPE = '" & Replace(EItype2, "'", "''") & "' "


            dsViewCount = New DataSet
            daViewCount = New OracleDataAdapter(SQL, conn)
            If conn.State = ConnectionState.Closed Then
                conn.Open()
            End If
            cmdBuild = New OracleCommandBuilder(daViewCount)

            daViewCount.Fill(dsViewCount, "ViewCount")
            dgvEIThresholds.DataSource = dsViewCount
            dgvEIThresholds.DataMember = "ViewCount"

            dgvEIThresholds.RowHeadersVisible = False
            dgvEIThresholds.AlternatingRowsDefaultCellStyle.BackColor = Color.WhiteSmoke
            dgvEIThresholds.AllowUserToResizeColumns = True
            dgvEIThresholds.AllowUserToAddRows = False
            dgvEIThresholds.AllowUserToDeleteRows = False
            dgvEIThresholds.AllowUserToOrderColumns = True
            dgvEIThresholds.AllowUserToResizeRows = True

            dgvEIThresholds.Columns("STRPOLLUTANT").HeaderText = "Pollutant Name"
            dgvEIThresholds.Columns("STRPOLLUTANT").DisplayIndex = 0
            dgvEIThresholds.Columns("NUMTHRESHOLD").HeaderText = "Threshold (TPY)"
            dgvEIThresholds.Columns("NUMTHRESHOLD").DisplayIndex = 1
            dgvEIThresholds.Columns("NUMTHRESHOLDNAA").HeaderText = "Threshold in NAA (TPY)"
            dgvEIThresholds.Columns("NUMTHRESHOLDNAA").DisplayIndex = 2
            dgvEIThresholds.Columns("STRTYPE").HeaderText = "EI Type"
            dgvEIThresholds.Columns("STRTYPE").DisplayIndex = 3


        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        Finally

        End Try
    End Sub
    Private Sub mtbAIRSNumber_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles mtbAIRSNumber.KeyPress
        Try
            If e.KeyChar = Microsoft.VisualBasic.ChrW(13) Then
                If mtbAIRSNumber.Text.Length <> 8 Then
                    MsgBox("Please enter a complete 8 digit AIRS #.", MsgBoxStyle.Information, "DMU Tools")
                Else
                    lblFacilityName.Text = "Facility Name"
                    airsno = mtbAIRSNumber.Text
                    SQL = "Select strFacilityName " & _
                    "from " & DBNameSpace & ".APBFacilityInformation " & _
                    "where strAIRSNumber = '0413" & airsno & "' "
                    cmd = New OracleCommand(SQL, conn)
                    If conn.State = ConnectionState.Closed Then
                        conn.Open()
                    End If
                    dr = cmd.ExecuteReader
                    While dr.Read
                        If IsDBNull(dr.Item("strFacilityName")) Then
                            lblFacilityName.Text = "Facility Name"
                        Else
                            lblFacilityName.Text = dr.Item("strFacilityName")
                        End If
                    End While
                    dr.Close()

                    FormatDataGridForWorkEntry()
                    LoadDataGrid()
                End If

                If lblFacilityName.Text = "Facility Name" Then
                    pnlUser.Visible = False
                Else
                    pnlUser.Visible = True
                End If
            End If



        Catch ex As Exception
            ErrorReport(ex.ToString(), Me.Name & "." & System.Reflection.MethodBase.GetCurrentMethod.Name)
        End Try
    End Sub

End Class